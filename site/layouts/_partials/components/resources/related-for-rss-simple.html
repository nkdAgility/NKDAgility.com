{{ $page := .Page }}
{{- $relatedResources := partial "functions/get-related-as-pages.html" (dict "Page" .Page "EntryKind" "resource") }}
{{- $relatedResources := where $relatedResources "Type" "ne" "guides" }}
{{- $relatedResources := first 6 $relatedResources }}

{{ if gt (len $relatedResources) 0 }}
  <h3>What to read next?</h3>
  <p>Generated via dense vector embeddings and cosine similarity, not clickbait heuristics. These are the closest semantic matches to this post; AI-approved, relevance-assured. <a href="https://nkdagility.com/resources/engineering-notes/leveraging-ai-embeddings-for-related-content-classification/">Learn how it works</a>.</p>
  {{- partial "components/resources/resource-list-for-rss.html" (dict "context" . "resources" $relatedResources "includeMeta" false) }}
{{ end }}

{{- $relatedCourses := partial "functions/get-related-as-pages.html" (dict "Page" .Page "EntryKind" "program") }}
{{- $relatedCourses := first 3 $relatedCourses }}
{{ if gt (len $relatedCourses) 0 }}
  <h3>Programs that align</h3>
  <p>Suggested based on semantic overlap with this post. These aren't just top sellersâ€”they align with the themes and intent of what you just read.</p>
  {{ partial "components/programs/programs-list-for-rss.html" (dict "context" . "programs" $relatedCourses "includeMeta" false) }}
{{ end }}
