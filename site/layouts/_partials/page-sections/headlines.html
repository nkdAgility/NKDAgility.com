{{/* Sections Template - Renders dynamic page sections based on frontmatter configuration

  This template processes an array of sections defined in page frontmatter and renders
  each section with appropriate partial templates based on the section type.
*/}}

{{- $site := .Site }}
{{- $page := . }}
<section class="container">
  <div class="row d-lg-flex flex-lg-row-reverse">
    <div class="col-12 col-lg-9">
      {{- if .Params.headlines }}
        {{- range $index, $section := .Params.headlines }}
          {{- partial "page-sections/section-wrapper.html" (dict "site" $site "page" $page "section" $section "index" $index) }}
        {{- end }}
      {{- end }}
    </div>
    <div class="col-12 col-lg-3 d-none d-lg-block">
      <div class="card shadow-sm my-5 small">
        {{- $currentSection := .Parent }}
        <div class="card-header">
          <h5 class="card-title mb-0">{{ $currentSection.Params.title_alt | default $currentSection.Title }}</h5>
        </div>
        <div class="card-body">
          <nav class="nav nav-pills flex-column mb-3">
            {{- if $currentSection }}
              {{- range $currentSection.Pages.ByWeight }}
                {{- if not .Draft }}
                  {{- if ne .Permalink $page.Permalink }}
                    <a class="nav-link" href="{{ .Permalink }}" title="{{ .Title }}">{{ .Params.short_title | default .Title }}</a>
                  {{- else }}
                    <a class="nav-link active" href="{{ .Permalink }}" title="{{ .Title }}">{{ .Params.short_title | default .Title }}</a>
                  {{- end }}
                {{- end }}
              {{- end }}
            {{- end }}
          </nav>
          {{- if $currentSection.Description }}
            <hr />
            <h6 class="card-subtitle mb-2 text-muted small">More information</h6>
            <p class="card-text small">{{ $currentSection.Description }}</p>
          {{- end }}
        </div>
      </div>
    </div>
  </div>
</section>
