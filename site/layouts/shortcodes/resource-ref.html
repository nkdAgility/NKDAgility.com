{{- $resourceId := .Get 0 -}}
{{- $page := "" -}}
{{- range site.Pages -}}
  {{- if eq .Params.ResourceId $resourceId -}}
    {{- $page = . -}}
    {{- break -}}
  {{- end -}}
{{- end -}}
{{- if and $page (not $page.Draft) -}}
  {{- if lt $page.PublishDate now -}}
    {{- $page.RelPermalink -}}
  {{- else -}}
    {{- if eq hugo.Environment "production" -}}
      {{- $page.RelPermalink -}}
    {{- else -}}
      {{- printf "https://preview.nkdagility.com/resources/%s" $resourceId -}}
    {{- end -}}
  {{- end -}}
{{- else -}}
  {{- if and (ne hugo.Environment "production") (regexMatch "^[a-zA-Z0-9_-]{8,15}$" $resourceId) -}}
    {{- printf "https://preview.nkdagility.com/resources/%s" $resourceId -}}
  {{- else -}}
    {{- "" -}}
  {{- end -}}
{{- end -}}
