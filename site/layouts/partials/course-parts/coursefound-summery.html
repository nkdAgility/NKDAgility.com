<!-- Card HTML -->
<div class="flip-card">
  <div class="flip-card-inner">
    <!-- Front Side (Existing Card HTML) -->
    <div class="flip-card-front h-100">
      <div class="card  h-100">
        <div class="card-header" {{ if .Params.brandColour }}style="color: white;background-color: {{ .Params.brandColour }}"{{ end }}>{{ .Params.shorttitle }}</div>
        <div class="card-body">
          <p class="card-text text-muted">GOAL: 6 participants</p>
          <h5 class="card-title"></h5>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar bg-nkdagility-accent" role="progressbar" style="width: 66.7%;" aria-valuenow="66" aria-valuemin="0" aria-valuemax="100"></div>
          </div>
          <div class="row justify-content-between">
            <div class="col-auto">4 Participants</div>
            <div class="col-auto">30 days left</div>
          </div>
          <div class="row p-2">
            <div class="col-4 d-flex align-items-center">
              {{ if .Params.previewIcon }}
                {{ $image := .Resources.GetMatch (printf "images/%s" .Params.previewIcon) }}
                {{ if $image }}
                  {{ $resized := $image.Fit "100x100 webp" }}
                  <img src="{{ $resized.RelPermalink }}" class="img-fluid" />
                {{ else }}
                  NOICON
                {{ end }}
              {{ end }}
            </div>
            <div class="col-8">
              <p class="card-text">Backing this class gives you access to additional coaching, future discounts, and participation in the scheduling and format of the delivery.</p>
            </div>
          </div>
          <div class="d-grid gap-2">
            <div class="d-flex">
              <a href="#" class="btn btn-nkdagility-primary w-100 position-relative m-1">
                <i class="fas fa-ticket position-absolute start-0 top-50 translate-middle-y ms-2"></i>
                Preorder
              </a>
              <div id="preproduct-pledge" data-id="9881307152724" data-headless="true" data-domain="273187-62.myshopify.com" style="text-align: left; padding: 10px 0px;"></div>
              <script type="text/javascript" async src="https://api.preproduct.io/preproduct-embed.js"></script>
            </div>
            <a href="#" class="btn btn-nkdagility-secondary w-100 position-relative" title="Sign-up to be the first to know" data-bs-toggle="modal" data-bs-target="#followModal">
              <i class="fas fa-heart position-absolute start-0 top-50 translate-middle-y ms-2"></i>
              Follow
            </a>
            <a href="#" class="text-center mt-2 flip-trigger">learn more</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Back Side -->
    <div class="flip-card-back h-100">
      <div class="card h-100 p-2">
        <div class="position-absolute top-0 end-0 p-2"><a href="#" class="flip-trigger">Close</a></div>
        <div class="card-body">
          <h5 class="card-title small">About Our Funding Model</h5>
          <p class="card-text small">Our funding model supports busy professionals by ensuring courses are fully funded and guaranteed. Through pre-orders, we gather participants to meet enrollment targets for effective delivery.</p>
          <h5 class="card-title small">Funding Mode</h5>
          <p class="card-text small">We proceed with courses only when the participant goal is met, ensuring value and support for everyone involved.</p>
          <h5 class="card-title small">Collaboration Benefits</h5>
          <p class="card-text small">Pre-ordering gives exclusive access to help shape the courseâ€™s start date, schedule, and format.</p>
          <h5 class="card-title small">Possible Risks</h5>
          <p class="card-text small">Meeting participant goals may impact the start date. Funds are only taken once the target is met.</p>
          <a href="#" class="text-center mt-2">Get more information</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Structure -->
<div class="modal fade" id="followModal" tabindex="-1" aria-labelledby="followModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="followModalLabel">Follow Course</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Styles for Flip Card -->
<style>
  .flip-card {
    perspective: 1000px;
    width: 100%;
    max-width: 400px;
  }
  .flip-card-inner {
    display: grid;
    width: 100%;
    transition: transform 0.6s;
    transform-style: preserve-3d;
  }
  .flip-card-front,
  .flip-card-back {
    grid-area: 1 / 1 / 2 / 2;
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
  .flip-card-front {
    z-index: 2;
  }
  .flip-card-back {
    transform: rotateY(180deg);
  }
  .flip-card.flipped .flip-card-inner {
    transform: rotateY(180deg);
  }
</style>

<!-- JavaScript for Flip Effect -->
<script>
  document.querySelectorAll(".flip-trigger").forEach(function (element) {
    element.addEventListener("click", function (event) {
      event.preventDefault();
      this.closest(".flip-card").classList.toggle("flipped");
    });
  });
</script>
