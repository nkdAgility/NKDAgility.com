{{- $.Scratch.Add "routes" slice -}}
{{- range $p := sort site.AllPages "Path" }}
  {{- range $alias := sort $p.Params.aliasesFor404 }}
    {{- if not (strings.HasSuffix $alias "/") }}
      {{- $alias = printf "%s/" $alias }}
    {{- end }}
    {{- $.Scratch.Add "routes" (dict
      "route" $alias
      "redirect" $p.RelPermalink
      "statusCode" 301
      )
    -}}
  {{- end }}
{{- end }}
{{- $routes := dict "routes" ($.Scratch.Get "routes") }}
{{- $jsonOutput := $routes | jsonify }}
{{- (resources.FromString "static.routes.json" $jsonOutput).Publish }}
