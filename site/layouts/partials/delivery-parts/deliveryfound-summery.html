<!-- Card HTML -->
<div class="flip-card">
  <div class="flip-card-inner ">
    <!-- Front Side (Existing Card HTML) -->
    <div class="flip-card-front">
      <div class="card h-100">
        <div class="card-header" {{- if .Params.brandColour }}style="color: white;background-color: {{- .Params.brandColour }}"{{- end }}>
          {{- .Params.code }} |
          {{- $courseVendors := index .Params "course-vendors" }}
          {{- range $index, $vendor := $courseVendors }}
            {{- if gt $index 0 }},{{- end }}{{- $vendor }}
          {{- end }}
          |
          {{- .Params.level | title }}
        </div>
        <div class="card-body">
          <p class="card-text text-muted">GOAL: 6 participants</p>
          <h5 class="card-title"></h5>
          <div class="progress" style="height: 10px;">
            <div class="progress-bar bg-nkdagility-accent" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
          </div>
          <div class="row justify-content-between">
            <div class="col-auto">0 Participants</div>
            <div class="col-auto">Rolling delivery</div>
          </div>
          <div class="row p-2">
            <div class="col-4 d-flex align-items-center">
              {{- if .Params.previewIcon }}
                {{- $image := .Resources.GetMatch (printf "images/%s" .Params.previewIcon) }}
                {{- if $image }}
                  {{- $resized := $image.Fit "100x100 webp" }}
                  <img src="{{- $resized.RelPermalink }}" loading="lazy" class="img-fluid" />
                {{- else }}
                  NOICON
                {{- end }}
              {{- end }}
            </div>
            <div class="col-8">
              <p class="card-text small">Preordering grants you extra coaching, future discounts, and input on scheduling and format.</p>
            </div>
          </div>
          <div class="d-grid gap-2">
            {{- if eq hugo.Environment "development" }}
              {{/* <div id="preproduct-pledge" data-id="9881307152724" data-headless="true" data-domain="273187-62.myshopify.com" style="text-align: left; padding: 10px 0px;"></div>
                <script type="text/javascript" async src="https://api.preproduct.io/preproduct-embed.js"></script>
              */}}
              <div id="my-product"></div>
            {{- else }}
              <a href="#" class="btn btn-nkdagility-primary w-100 position-relative disabled "> <i class="fas fa-ticket position-absolute start-0 top-50 translate-middle-y ms-2"></i>Preorder </a>
            {{- end }}
            <a href="#" class="btn btn-nkdagility-secondary w-100 position-relative" title="Sign-up to be the first to know" data-bs-toggle="modal" data-bs-target="#followModal">
              <i class="fas fa-heart position-absolute start-0 top-50 translate-middle-y ms-2"></i>
              Follow
            </a>
            <a href="#" class="text-center mt-2 flip-trigger">learn more</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Back Side -->
    <div class="flip-card-back h-100">
      <div class="card h-100 p-2">
        <div class="position-absolute top-0 end-0 p-2"><a href="#" class="flip-trigger">Close</a></div>
        <div class="card-body">
          <h5 class="card-title small">About Our Funding Model</h5>
          <p class="card-text small">Our funding model supports busy professionals by ensuring courses are fully funded and guaranteed.</p>
          <h5 class="card-title small">Funding Mode</h5>
          <p class="card-text small">We proceed with courses only when the participant goal is met, ensuring value and support for everyone involved. Funds are only taken once the target is met.</p>
          <h5 class="card-title small">Collaboration Benefits</h5>
          <p class="card-text small">Pre-ordering gives exclusive access to help shape the courseâ€™s start date, schedule, and format.</p>
          <a href="/book-online" class="text-center mt-2">Get more information</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Structure -->
<div class="modal fade" id="followModal" tabindex="-1" aria-labelledby="followModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="followModalLabel">Follow Course</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <!-- Begin Mailchimp Signup Form -->
        <link href="//cdn-images.mailchimp.com/embedcode/classic-071822.css" rel="stylesheet" type="text/css" />

        <div id="mc_embed_signup">
          <form
            action="https://nkdagility.us6.list-manage.com/subscribe/post?u=8f1debed5aa20a5cfafd20918&amp;id=94de9849c1&amp;f_id=00640de3f0"
            method="post"
            id="mc-embedded-subscribe-form"
            name="mc-embedded-subscribe-form"
            class="validate"
            target="_blank"
            novalidate>
            <div id="mc_embed_signup_scroll">
              <h2>Subscribe</h2>
              <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
              <div class="mc-field-group">
                <label for="mce-EMAIL">Email Address <span class="asterisk">*</span> </label>
                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required />
                <span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
              </div>
              <div class="mc-field-group">
                <label for="mce-FNAME">First Name </label>
                <input type="text" value="" name="FNAME" class="" id="mce-FNAME" />
                <span id="mce-FNAME-HELPERTEXT" class="helper_text"></span>
              </div>
              <div class="mc-field-group">
                <label for="mce-LNAME">Last Name </label>
                <input type="text" value="" name="LNAME" class="" id="mce-LNAME" />
                <span id="mce-LNAME-HELPERTEXT" class="helper_text"></span>
              </div>
              <div class="mc-field-group input-group">
                <strong>Notify me of </strong>
                <ul>
                  <li>
                    <input type="checkbox" value="4" name="group[18025][4]" id="mce-group[18025]-18025-0" />
                    <label for="mce-group[18025]-18025-0">New Blog Posts</label>
                  </li>
                  <li>
                    <input type="checkbox" value="16" name="group[18025][16]" id="mce-group[18025]-18025-1" />
                    <label for="mce-group[18025]-18025-1">Weekly Updates</label>
                  </li>
                  <li>
                    <input type="checkbox" value="8" name="group[18025][8]" id="mce-group[18025]-18025-2" />
                    <label for="mce-group[18025]-18025-2">Upcoming Classes</label>
                  </li>
                </ul>
                <span id="mce-group[18025]-HELPERTEXT" class="helper_text"></span>
              </div>
              <div id="mce-responses" class="clear">
                <div class="response" id="mce-error-response" style="display:none"></div>
                <div class="response" id="mce-success-response" style="display:none"></div>
              </div>
              <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
              <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_8f1debed5aa20a5cfafd20918_94de9849c1" tabindex="-1" value="" /></div>
              <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button" /></div>
            </div>
          </form>
        </div>
        <script type="text/javascript" src="//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js"></script>
        <script type="text/javascript">
          (function ($) {
            window.fnames = new Array();
            window.ftypes = new Array();
            fnames[0] = "EMAIL";
            ftypes[0] = "email";
            fnames[1] = "FNAME";
            ftypes[1] = "text";
            fnames[2] = "LNAME";
            ftypes[2] = "text";
            fnames[3] = "CNAME";
            ftypes[3] = "text";
          })(jQuery);
          var $mcj = jQuery.noConflict(true);
        </script>
        <!--End mc_embed_signup-->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Styles for Flip Card -->
<style>
  .flip-card {
    perspective: 1000px;
    width: 100%;
  }
  .flip-card-inner {
    display: grid;
    width: 100%;
    transition: transform 0.6s;
    transform-style: preserve-3d;
  }
  .flip-card-front,
  .flip-card-back {
    grid-area: 1 / 1 / 2 / 2;
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
  .flip-card-front {
    z-index: 2;
  }
  .flip-card-back {
    transform: rotateY(180deg);
  }
  .flip-card.flipped .flip-card-inner {
    transform: rotateY(180deg);
  }
</style>

<!-- JavaScript for Flip Effect -->
<script>
  document.querySelectorAll(".flip-trigger").forEach(function (element) {
    element.addEventListener("click", function (event) {
      event.preventDefault();
      this.closest(".flip-card").classList.toggle("flipped");
    });
  });
</script>

{{- if eq hugo.Environment "development" }}
  <script src="https://sdks.shopifycdn.com/js-buy-sdk/v2/latest/index.umd.min.js"></script>
  <script src="https://sdks.shopifycdn.com/buy-button/latest/buy-button-storefront.min.js"></script>
  <script>
    var client = ShopifyBuy.buildClient({
      domain: "273187-62.myshopify.com",
      storefrontAccessToken: "1af5a4c4ebcf8458c6982b47ee2fff4c",
      appId: "6", // Standard app ID for Shopify stores
    });
  </script>

  <script>
    // Replace 'productId' with your actual Shopify product ID
    var productId = "gid://shopify/Product/9881307152724";
    var ui = ShopifyBuy.UI.init(client);

    ui.createComponent("product", {
      id: 9881307152724,
      node: document.getElementById("my-product"),
      options: {
        product: {
          iframe: false,
          contents: {
            img: false, // Hide product image
            title: false, // Hide product title
            price: false, // Hide product price
            options: false, // Hide product options
            description: false, // Hide product description
            button: true, // Only show the buy button
          },
          text: {
            button: "Preorder",
          },
          classes: {
            product: "my-custom-product", // Add custom class to the product container
            button: "buy-button btn btn-nkdagility-primary w-100 position-relative", // Add custom classes to the button itself
          },
        },
        cart: {
          startOpen: false,
        },
        modalProduct: {
          iframe: false,
        },
        toggle: {
          iframe: false,
          contents: {
            count: true,
            icon: true,
          },
        },
      },
    });
  </script>
{{- end }}
