post:
  title: Calling an object method in a data trigger
  link: https://nkdagility.com/blog/calling-an-object-method-in-a-data-trigger/
  pubDate: Wed, 27 Aug 2008 11:16:18 +0000
  creator: MrHinsh
  guid:
    _: >-
      http://geekswithblogs.net/hinshelm/archive/2008/08/27/calling-an-object-method-in-a-data-trigger.aspx
    $:
      isPermaLink: 'false'
  description: ''
  encoded:
  - "<p>Calling a method on an instance of an object in WPF is not as easy to figure out, but with the help of this Internet thing I managed it.</p>  <p>Say you have a DataTemplate that renders a WorkItemType as a button that is selectable:</p>  <div class=\"csharpcode-wrapper\">   <div class=\"csharpcode\">     <pre><span class=\"lnum\">   1:</span> <span class=\"kwrd\">&lt;</span><span class=\"html\">DataTemplate</span> <span class=\"attr\">DataType</span><span class=\"kwrd\">=\"{x:Type tfswitc:WorkItemType}\"</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   2:</span>     <span class=\"kwrd\">&lt;</span><span class=\"html\">DockPanel</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   3:</span>         <span class=\"kwrd\">&lt;</span><span class=\"html\">Image</span> <span class=\"attr\">DockPanel</span>.<span class=\"attr\">Dock</span><span class=\"kwrd\">=\"Left\"</span> </pre>\n\n    <pre><span class=\"lnum\">   4:</span>                <span class=\"attr\">x:Name</span><span class=\"kwrd\">=\"wiImage\"</span> </pre>\n\n    <pre><span class=\"lnum\">   5:</span>                <span class=\"attr\">Width</span><span class=\"kwrd\">=\"16\"</span> </pre>\n\n    <pre><span class=\"lnum\">   6:</span>                <span class=\"attr\">Height</span><span class=\"kwrd\">=\"16\"</span> </pre>\n\n    <pre><span class=\"lnum\">   7:</span>                <span class=\"attr\">Source</span><span class=\"kwrd\">=\"pack://application:,,/Resources/Images/WorkItems/unknown.gif\"</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   8:</span>         <span class=\"kwrd\">&lt;/</span><span class=\"html\">Image</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   9:</span>         <span class=\"kwrd\">&lt;</span><span class=\"html\">Button</span> <span class=\"attr\">x:Name</span><span class=\"kwrd\">=\"wiButton\"</span> </pre>\n\n    <pre><span class=\"lnum\">  10:</span>                 <span class=\"attr\">Content</span><span class=\"kwrd\">=\"{Binding Name}\"</span> </pre>\n\n    <pre><span class=\"lnum\">  11:</span>                 <span class=\"attr\">Style</span><span class=\"kwrd\">=\"{DynamicResource WelcomeButtonStyle}\"</span> </pre>\n\n    <pre><span class=\"lnum\">  12:</span>                 <span class=\"attr\">CommandParameter</span><span class=\"kwrd\">=\"{Binding}\"</span> </pre>\n\n    <pre><span class=\"lnum\">  13:</span>                 <span class=\"attr\">Command</span><span class=\"kwrd\">=\"Controlers:TeamSystemCommands.ChangeWorkItemTypeCommand\"</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  14:</span>         <span class=\"kwrd\">&lt;/</span><span class=\"html\">Button</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  15:</span>     <span class=\"kwrd\">&lt;/</span><span class=\"html\">DockPanel</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  16:</span> <span class=\"kwrd\">&lt;/</span><span class=\"html\">DataTemplate</span><span class=\"kwrd\">&gt;</span></pre>\n  </div>\n</div>\n\n<p>Now, if I wanted to call a method on an instance of that WorkItemType and perform some action, then I would need a DataTrigger:</p>\n\n<div class=\"csharpcode-wrapper\">\n  <div class=\"csharpcode\">\n    <pre><span class=\"lnum\">   1:</span> <span class=\"kwrd\">&lt;</span><span class=\"html\">DataTemplate</span> <span class=\"attr\">DataType</span><span class=\"kwrd\">=\"{x:Type tfswitc:WorkItemType}\"</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   2:</span>     <span class=\"kwrd\">&lt;</span><span class=\"html\">DockPanel</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   3:</span>         <span class=\"kwrd\">&lt;</span><span class=\"html\">Image</span> <span class=\"attr\">DockPanel</span>.<span class=\"attr\">Dock</span><span class=\"kwrd\">=\"Left\"</span> </pre>\n\n    <pre><span class=\"lnum\">   4:</span>                <span class=\"attr\">x:Name</span><span class=\"kwrd\">=\"wiImage\"</span> </pre>\n\n    <pre><span class=\"lnum\">   5:</span>                <span class=\"attr\">Width</span><span class=\"kwrd\">=\"16\"</span> </pre>\n\n    <pre><span class=\"lnum\">   6:</span>                <span class=\"attr\">Height</span><span class=\"kwrd\">=\"16\"</span> </pre>\n\n    <pre><span class=\"lnum\">   7:</span>                <span class=\"attr\">Source</span><span class=\"kwrd\">=\"pack://application:,,/Resources/Images/WorkItems/unknown.gif\"</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   8:</span>         <span class=\"kwrd\">&lt;/</span><span class=\"html\">Image</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   9:</span>         <span class=\"kwrd\">&lt;</span><span class=\"html\">Button</span> <span class=\"attr\">x:Name</span><span class=\"kwrd\">=\"wiButton\"</span> </pre>\n\n    <pre><span class=\"lnum\">  10:</span>                 <span class=\"attr\">Content</span><span class=\"kwrd\">=\"{Binding Name}\"</span> </pre>\n\n    <pre><span class=\"lnum\">  11:</span>                 <span class=\"attr\">Style</span><span class=\"kwrd\">=\"{DynamicResource WelcomeButtonStyle}\"</span> </pre>\n\n    <pre><span class=\"lnum\">  12:</span>                 <span class=\"attr\">CommandParameter</span><span class=\"kwrd\">=\"{Binding}\"</span> </pre>\n\n    <pre><span class=\"lnum\">  13:</span>                 <span class=\"attr\">Command</span><span class=\"kwrd\">=\"Controlers:TeamSystemCommands.ChangeWorkItemTypeCommand\"</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  14:</span>         <span class=\"kwrd\">&lt;/</span><span class=\"html\">Button</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  15:</span>     <span class=\"kwrd\">&lt;/</span><span class=\"html\">DockPanel</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  16:</span>     <span class=\"kwrd\">&lt;</span><span class=\"html\">DataTemplate.Triggers</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  17:</span>         <span class=\"kwrd\">&lt;</span><span class=\"html\">DataTrigger</span> <span class=\"attr\">Value</span><span class=\"kwrd\">=\"False\"</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  18:</span>             <span class=\"kwrd\">&lt;</span><span class=\"html\">DataTrigger.Binding</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  19:</span>                 <span class=\"kwrd\">&lt;</span><span class=\"html\">Binding</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  20:</span>                     <span class=\"kwrd\">&lt;</span><span class=\"html\">Binding.Source</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  21:</span>                         <span class=\"kwrd\">&lt;</span><span class=\"html\">ObjectDataProvider</span> <span class=\"attr\">ObjectType</span><span class=\"kwrd\">=\"{x:Type tfswitc:WorkItemType}\"</span> </pre>\n\n    <pre><span class=\"lnum\">  22:</span>                                             <span class=\"attr\">MethodName</span><span class=\"kwrd\">=\"SupportedByHeat\"</span> <span class=\"kwrd\">/&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  23:</span>                     <span class=\"kwrd\">&lt;/</span><span class=\"html\">Binding.Source</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  24:</span>                 <span class=\"kwrd\">&lt;/</span><span class=\"html\">Binding</span><span class=\"kwrd\">&gt;</span>                        </pre>\n\n    <pre><span class=\"lnum\">  25:</span>             <span class=\"kwrd\">&lt;/</span><span class=\"html\">DataTrigger.Binding</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  26:</span>             <span class=\"kwrd\">&lt;</span><span class=\"html\">Setter</span> <span class=\"attr\">TargetName</span><span class=\"kwrd\">=\"wiButton\"</span> </pre>\n\n    <pre><span class=\"lnum\">  27:</span>                     <span class=\"attr\">Property</span><span class=\"kwrd\">=\"IsEnabled\"</span> </pre>\n\n    <pre><span class=\"lnum\">  28:</span>                     <span class=\"attr\">Value</span><span class=\"kwrd\">=\"False\"</span> <span class=\"kwrd\">/&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  29:</span>             <span class=\"kwrd\">&lt;</span><span class=\"html\">Setter</span> <span class=\"attr\">TargetName</span><span class=\"kwrd\">=\"wiButton\"</span> </pre>\n\n    <pre><span class=\"lnum\">  30:</span>                     <span class=\"attr\">Property</span><span class=\"kwrd\">=\"ToolTip\"</span> </pre>\n\n    <pre><span class=\"lnum\">  31:</span>                     <span class=\"attr\">Value</span><span class=\"kwrd\">=\"You will need to add the 'HeatITSM.Ref' field to use this work item.\"</span> <span class=\"kwrd\">/&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  32:</span>         <span class=\"kwrd\">&lt;/</span><span class=\"html\">DataTrigger</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  33:</span>     <span class=\"kwrd\">&lt;/</span><span class=\"html\">DataTemplate.Triggers</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">  34:</span> <span class=\"kwrd\">&lt;/</span><span class=\"html\">DataTemplate</span><span class=\"kwrd\">&gt;</span></pre>\n  </div>\n</div>\n\n<p>This will Call the method and if it returns false, it will disable the button and set a tooltip.</p>\n\n<p>Now, this should work, but my SupportedByHeat method is an Extension method defined as:</p>\n\n<div class=\"csharpcode-wrapper\">\n  <div class=\"csharpcode\">\n    <pre><span class=\"lnum\">   1:</span> <span class=\"kwrd\">Imports</span> Microsoft.TeamFoundation.WorkItemTracking.Client</pre>\n\n    <pre><span class=\"lnum\">   2:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   3:</span> <span class=\"kwrd\">Namespace</span> TeamFoundationExtensions</pre>\n\n    <pre><span class=\"lnum\">   4:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   5:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   6:</span>     <span class=\"kwrd\">Module</span> WorkItemTypeExtensions</pre>\n\n    <pre><span class=\"lnum\">   7:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   8:</span>         &lt;System.Runtime.CompilerServices.Extension()&gt; _</pre>\n\n    <pre><span class=\"lnum\">   9:</span>       <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Function</span> SupportedByHeat(<span class=\"kwrd\">ByVal</span> wit <span class=\"kwrd\">As</span> WorkItemType) <span class=\"kwrd\">As</span> <span class=\"kwrd\">Boolean</span></pre>\n\n    <pre><span class=\"lnum\">  10:</span>             <span class=\"kwrd\">Dim</span> c <span class=\"kwrd\">As</span> Controlers.TeamSystemControler(Of MainWindow)</pre>\n\n    <pre><span class=\"lnum\">  11:</span>             c = Application.ControlerFactory.GetControler(Of Controlers.TeamSystemControler(Of MainWindow))()</pre>\n\n    <pre><span class=\"lnum\">  12:</span>             <span class=\"kwrd\">Return</span> c.CheckWorkItemField(wit)</pre>\n\n    <pre><span class=\"lnum\">  13:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Function</span></pre>\n\n    <pre><span class=\"lnum\">  14:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  15:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Module</span></pre>\n\n    <pre><span class=\"lnum\">  16:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  17:</span> <span class=\"kwrd\">End</span> <span class=\"kwrd\">Namespace</span></pre>\n  </div>\n</div>\n\n<p>And this does not seam to work even if I import the namespace in the XAML:</p>\n\n<div class=\"csharpcode-wrapper\">\n  <div class=\"csharpcode\">\n    <pre><span class=\"lnum\">   1:</span> <span class=\"kwrd\">&lt;</span><span class=\"html\">UserControl</span> <span class=\"attr\">x:Class</span><span class=\"kwrd\">=\"SelectWorkItemType\"</span></pre>\n\n    <pre><span class=\"lnum\">   2:</span>   <span class=\"attr\">xmlns</span><span class=\"kwrd\">=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"</span></pre>\n\n    <pre><span class=\"lnum\">   3:</span>   <span class=\"attr\">xmlns:x</span><span class=\"kwrd\">=\"http://schemas.microsoft.com/winfx/2006/xaml\"</span> </pre>\n\n    <pre><span class=\"lnum\">   4:</span>   <span class=\"attr\">xmlns:d</span><span class=\"kwrd\">=\"http://schemas.microsoft.com/expression/blend/2006\"</span> </pre>\n\n    <pre><span class=\"lnum\">   5:</span>   <span class=\"attr\">xmlns:tfs</span><span class=\"kwrd\">=\"clr-namespace:Microsoft.TeamFoundation.Client;assembly=Microsoft.TeamFoundation.Client\"</span></pre>\n\n    <pre><span class=\"lnum\">   6:</span>   <span class=\"attr\">xmlns:tfswitc</span><span class=\"kwrd\">=\"clr-namespace:Microsoft.TeamFoundation.WorkItemTracking.Client;assembly=Microsoft.TeamFoundation.WorkItemTracking.Client\"</span>    </pre>\n\n    <pre><span class=\"lnum\">   7:</span>   <span class=\"attr\">xmlns:tfse</span><span class=\"kwrd\">=\"clr-namespace:Hinshelwood.TFSHeatITSM.TeamFoundationExtensions\"</span></pre>\n\n    <pre><span class=\"lnum\">   8:</span>   <span class=\"attr\">xmlns:local</span><span class=\"kwrd\">=\"clr-namespace:Hinshelwood.TFSHeatITSM\"</span></pre>\n\n    <pre><span class=\"lnum\">   9:</span>   <span class=\"attr\">xmlns:Controlers</span><span class=\"kwrd\">=\"clr-namespace:Hinshelwood.TFSHeatITSM.Controlers\"</span></pre>\n\n    <pre><span class=\"lnum\">  10:</span>   <span class=\"attr\">xmlns:mc</span><span class=\"kwrd\">=\"http://schemas.openxmlformats.org/markup-compatibility/2006\"</span> </pre>\n\n    <pre><span class=\"lnum\">  11:</span>   <span class=\"attr\">mc:Ignorable</span><span class=\"kwrd\">=\"d\"</span><span class=\"kwrd\">&gt;</span></pre>\n  </div>\n</div>\n\n<p>The error message that is received is:</p>\n\n<blockquote>\n  <p><em>System.Windows.Data Error: 34 : ObjectDataProvider: Failure trying to invoke method on type; Method='SupportedByHeat'; Type='WorkItemType'; Error='No method was found with matching parameter signature.' MissingMethodException:'System.MissingMethodException: Method 'Microsoft.TeamFoundation.WorkItemTracking.Client.WorkItemType.SupportedByHeat' not found.\n      <br />\_\_ at System.RuntimeType.InvokeMember(String name, BindingFlags bindingFlags, Binder binder, Object target, Object[] providedArgs, ParameterModifier[] modifiers, CultureInfo culture, String[] namedParams)\n\n      <br />\_\_ at System.Type.InvokeMember(String name, BindingFlags invokeAttr, Binder binder, Object target, Object[] args, CultureInfo culture)\n\n      <br />\_\_ at System.Windows.Data.ObjectDataProvider.InvokeMethodOnInstance(Exception&amp; e)'</em></p>\n</blockquote>\n\n<p>As you can see, during the binding the extension method is not evaluated.</p>\n\n<p>During my investigation I came across <a href=\"http://www.fikrimvar.net/lestirelim/?p=23\" target=\"_blank\">WPFix Part 3 (Extension Methods)</a> that intoned that there is indeed some solution, but it is complicated requiring the use of Lambda expressions.</p>\n\n<p>I am looking for an easy solution :)</p><div style=\"padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px\" class=\"wlWriterEditableSmartContent\">Technorati Tags: <a href=\"http://technorati.com/tags/.NET\" rel=\"tag\">.NET</a>\_<a href=\"http://technorati.com/tags/WPF\" rel=\"tag\">WPF</a>\_<a href=\"http://technorati.com/tags/WIT\" rel=\"tag\">WIT</a>\_<a href=\"http://technorati.com/tags/TFS\" rel=\"tag\">TFS</a>\_</div>"
  - ''
  post_id: '205'
  post_date: '2008-08-27 11:16:18'
  post_date_gmt: '2008-08-27 11:16:18'
  post_modified: '2008-08-27 11:16:18'
  post_modified_gmt: '2008-08-27 11:16:18'
  comment_status: open
  ping_status: open
  post_name: calling-an-object-method-in-a-data-trigger
  status: publish
  post_parent: '0'
  menu_order: '0'
  post_type: post
  post_password: ''
  is_sticky: '0'
  category: {}
  postmeta:
  - meta_key: authorsure_include_css
    meta_value: ''
  - meta_key: dsq_thread_id
    meta_value: '312217087'
  - meta_key: _flattr_post_language
    meta_value: ''
  - meta_key: _flattr_post_category
    meta_value: ''
  - meta_key: _flattr_post_hidden
    meta_value: ''
  - meta_key: _flattr_btn_disabled
    meta_value: ''
  - meta_key: _thumbnail_id
    meta_value: '7080'
  - meta_key: authorsure_include_css
    meta_value: ''
  - meta_key: _views_template
    meta_value: '0'
  - meta_key: _wpbitly
    meta_value: http://nkdalm.net/1a6Ussk
  - meta_key: _jetpack_related_posts_cache
    meta_value: >-
      a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1474516757;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:88;}i:1;a:1:{s:2:"id";i:58;}i:2;a:1:{s:2:"id";i:179;}}}}
  - meta_key: _wpghs_github_path
    meta_value: _posts/2008-08-27-calling-an-object-method-in-a-data-trigger.md
  - meta_key: _sha
    meta_value: ''
  - meta_key: _wpml_media_has_media
    meta_value: '1'
  - meta_key: _tribe_ticket_capacity
    meta_value: '0'
  - meta_key: _tribe_ticket_version
    meta_value: 4.12.1.2
  - meta_key: ekit_post_views_count
    meta_value: '627'
