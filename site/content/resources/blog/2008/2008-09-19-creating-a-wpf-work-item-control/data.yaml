post:
  title: Creating a WPF Work Item Control
  link: https://nkdagility.com/blog/creating-a-wpf-work-item-control/
  pubDate: Fri, 19 Sep 2008 12:14:21 +0000
  creator: MrHinsh
  guid:
    _: >-
      http://geekswithblogs.net/hinshelm/archive/2008/09/19/creating-a-wpf-work-item-control.aspx
    $:
      isPermaLink: 'false'
  description: ''
  encoded:
  - "<p>I have a little custom control I need added to my <a title=\"Visual Studio Team System\" href=\"http://msdn2.microsoft.com/en-us/teamsystem/default.aspx\" target=\"_blank\">Visual Studio Team System</a> projects. This control will allow specific groups of users as representatives of Advocacy groups with in the life cycle model to sign off a Requirement or Change Request from within Visual Studio.</p>  <p>But, just to make things a little more fun, I wanted to create the custom work item tracking control using WPF.</p>  <p>In order to do this you need a wrapper control that allows you to load any WPF control that inherits from IWorkItemControl.</p>  <p>Here is an example WPF Work Item Control:</p>  <p>[<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/FileView.aspx?itemId=35593&amp;changeSetId=1459\">Get SignOffControl.xaml.vb source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/DirectoryView.aspx?SourcePath=%24%2fTFSWitWpfControls&amp;changeSetId=1459\">Get full source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/ListDownloadableCommits.aspx\">Get latest full source</a>]</p>  <div class=\"csharpcode-wrapper\">   <div class=\"csharpcode\">     <pre><span class=\"lnum\">   1:</span> <span class=\"kwrd\">Imports</span> Microsoft.TeamFoundation.WorkItemTracking.Client</pre>\n\n    <pre><span class=\"lnum\">   2:</span> <span class=\"kwrd\">Imports</span> Microsoft.TeamFoundation.WorkItemTracking.Controls</pre>\n\n    <pre><span class=\"lnum\">   3:</span> <span class=\"rem\">'Imports Microsoft.VisualStudio.TeamFoundation.WorkItemTracking</span></pre>\n\n    <pre><span class=\"lnum\">   4:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   5:</span> <span class=\"kwrd\">Namespace</span> SignOff</pre>\n\n    <pre><span class=\"lnum\">   6:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   7:</span>     Partial <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Class</span> SignOffControl</pre>\n\n    <pre><span class=\"lnum\">   8:</span>         <span class=\"kwrd\">Implements</span> IWorkItemControl</pre>\n\n    <pre><span class=\"lnum\">   9:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  10:</span> <span class=\"preproc\">#Region</span> <span class=\"str\">\" IWorkItemControl \"</span></pre>\n\n    <pre><span class=\"lnum\">  11:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  12:</span>         <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Event</span> AfterUpdateDatasource(<span class=\"kwrd\">ByVal</span> sender <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span>, <span class=\"kwrd\">ByVal</span> e <span class=\"kwrd\">As</span> System.EventArgs) <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.AfterUpdateDatasource</pre>\n\n    <pre><span class=\"lnum\">  13:</span>         <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Event</span> BeforeUpdateDatasource(<span class=\"kwrd\">ByVal</span> sender <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span>, <span class=\"kwrd\">ByVal</span> e <span class=\"kwrd\">As</span> System.EventArgs) <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.BeforeUpdateDatasource</pre>\n\n    <pre><span class=\"lnum\">  14:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  15:</span>         <span class=\"kwrd\">Protected</span> m_serviceProvider <span class=\"kwrd\">As</span> IServiceProvider = <span class=\"kwrd\">Nothing</span></pre>\n\n    <pre><span class=\"lnum\">  16:</span>         <span class=\"kwrd\">Protected</span> m_workItem <span class=\"kwrd\">As</span> WorkItem = <span class=\"kwrd\">Nothing</span></pre>\n\n    <pre><span class=\"lnum\">  17:</span>         <span class=\"kwrd\">Protected</span> m_workItemFieldName <span class=\"kwrd\">As</span> <span class=\"kwrd\">String</span> = <span class=\"kwrd\">Nothing</span></pre>\n\n    <pre><span class=\"lnum\">  18:</span>         <span class=\"kwrd\">Protected</span> m_properties <span class=\"kwrd\">As</span> System.Collections.Specialized.StringDictionary</pre>\n\n    <pre><span class=\"lnum\">  19:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  20:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  21:</span>         <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Property</span> [<span class=\"kwrd\">ReadOnly</span>]() <span class=\"kwrd\">As</span> <span class=\"kwrd\">Boolean</span> <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.<span class=\"kwrd\">ReadOnly</span></pre>\n\n    <pre><span class=\"lnum\">  22:</span>             <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  23:</span>                 <span class=\"kwrd\">Return</span> <span class=\"kwrd\">Me</span>.IsEnabled</pre>\n\n    <pre><span class=\"lnum\">  24:</span>             <span class=\"kwrd\">End</span> <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  25:</span>             <span class=\"kwrd\">Set</span>(<span class=\"kwrd\">ByVal</span> value <span class=\"kwrd\">As</span> <span class=\"kwrd\">Boolean</span>)</pre>\n\n    <pre><span class=\"lnum\">  26:</span>                 <span class=\"kwrd\">Me</span>.IsEnabled = value</pre>\n\n    <pre><span class=\"lnum\">  27:</span>             <span class=\"kwrd\">End</span> <span class=\"kwrd\">Set</span></pre>\n\n    <pre><span class=\"lnum\">  28:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Property</span></pre>\n\n    <pre><span class=\"lnum\">  29:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  30:</span>         <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Sub</span> SetSite(<span class=\"kwrd\">ByVal</span> serviceProvider <span class=\"kwrd\">As</span> System.IServiceProvider) <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.SetSite</pre>\n\n    <pre><span class=\"lnum\">  31:</span>             m_serviceProvider = serviceProvider</pre>\n\n    <pre><span class=\"lnum\">  32:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  33:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  34:</span>         <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Property</span> WorkItemDatasource() <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span> <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.WorkItemDatasource</pre>\n\n    <pre><span class=\"lnum\">  35:</span>             <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  36:</span>                 <span class=\"kwrd\">Return</span> m_workItem</pre>\n\n    <pre><span class=\"lnum\">  37:</span>             <span class=\"kwrd\">End</span> <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  38:</span>             <span class=\"kwrd\">Set</span>(<span class=\"kwrd\">ByVal</span> value <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span>)</pre>\n\n    <pre><span class=\"lnum\">  39:</span>                 <span class=\"kwrd\">If</span> value <span class=\"kwrd\">Is</span> <span class=\"kwrd\">Nothing</span> <span class=\"kwrd\">And</span> <span class=\"kwrd\">Not</span> m_workItem <span class=\"kwrd\">Is</span> <span class=\"kwrd\">Nothing</span> <span class=\"kwrd\">Then</span></pre>\n\n    <pre><span class=\"lnum\">  40:</span>                     <span class=\"kwrd\">RemoveHandler</span> m_workItem.FieldChanged, <span class=\"kwrd\">AddressOf</span> OnFieldChanged</pre>\n\n    <pre><span class=\"lnum\">  41:</span>                 <span class=\"kwrd\">End</span> <span class=\"kwrd\">If</span></pre>\n\n    <pre><span class=\"lnum\">  42:</span>                 m_workItem = value</pre>\n\n    <pre><span class=\"lnum\">  43:</span>                 <span class=\"kwrd\">If</span> <span class=\"kwrd\">Not</span> m_workItem <span class=\"kwrd\">Is</span> <span class=\"kwrd\">Nothing</span> <span class=\"kwrd\">Then</span></pre>\n\n    <pre><span class=\"lnum\">  44:</span>                     <span class=\"kwrd\">AddHandler</span> m_workItem.FieldChanged, <span class=\"kwrd\">New</span> WorkItemFieldChangeEventHandler(<span class=\"kwrd\">AddressOf</span> OnFieldChanged)</pre>\n\n    <pre><span class=\"lnum\">  45:</span>                 <span class=\"kwrd\">End</span> <span class=\"kwrd\">If</span></pre>\n\n    <pre><span class=\"lnum\">  46:</span>             <span class=\"kwrd\">End</span> <span class=\"kwrd\">Set</span></pre>\n\n    <pre><span class=\"lnum\">  47:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Property</span></pre>\n\n    <pre><span class=\"lnum\">  48:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  49:</span>         <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Property</span> WorkItemFieldName() <span class=\"kwrd\">As</span> <span class=\"kwrd\">String</span> <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.WorkItemFieldName</pre>\n\n    <pre><span class=\"lnum\">  50:</span>             <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  51:</span>                 <span class=\"kwrd\">Return</span> m_workItemFieldName</pre>\n\n    <pre><span class=\"lnum\">  52:</span>             <span class=\"kwrd\">End</span> <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  53:</span>             <span class=\"kwrd\">Set</span>(<span class=\"kwrd\">ByVal</span> value <span class=\"kwrd\">As</span> <span class=\"kwrd\">String</span>)</pre>\n\n    <pre><span class=\"lnum\">  54:</span>                 m_workItemFieldName = value</pre>\n\n    <pre><span class=\"lnum\">  55:</span>             <span class=\"kwrd\">End</span> <span class=\"kwrd\">Set</span></pre>\n\n    <pre><span class=\"lnum\">  56:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Property</span></pre>\n\n    <pre><span class=\"lnum\">  57:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  58:</span>         <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Property</span> Properties() <span class=\"kwrd\">As</span> System.Collections.Specialized.StringDictionary <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.Properties</pre>\n\n    <pre><span class=\"lnum\">  59:</span>             <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  60:</span>                 <span class=\"kwrd\">Return</span> m_properties</pre>\n\n    <pre><span class=\"lnum\">  61:</span>             <span class=\"kwrd\">End</span> <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  62:</span>             <span class=\"kwrd\">Set</span>(<span class=\"kwrd\">ByVal</span> value <span class=\"kwrd\">As</span> System.Collections.Specialized.StringDictionary)</pre>\n\n    <pre><span class=\"lnum\">  63:</span>                 m_properties = value</pre>\n\n    <pre><span class=\"lnum\">  64:</span>             <span class=\"kwrd\">End</span> <span class=\"kwrd\">Set</span></pre>\n\n    <pre><span class=\"lnum\">  65:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Property</span></pre>\n\n    <pre><span class=\"lnum\">  66:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  67:</span>         <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Sub</span> Clear() <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.Clear</pre>\n\n    <pre><span class=\"lnum\">  68:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  69:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  70:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  71:</span>         <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Sub</span> FlushToDatasource() <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.FlushToDatasource</pre>\n\n    <pre><span class=\"lnum\">  72:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  73:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  74:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  75:</span>         <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Sub</span> InvalidateDatasource() <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.InvalidateDatasource</pre>\n\n    <pre><span class=\"lnum\">  76:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  77:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  78:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  79:</span> <span class=\"preproc\">#End Region</span></pre>\n\n    <pre><span class=\"lnum\">  80:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  81:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  82:</span>         <span class=\"kwrd\">Protected</span> <span class=\"kwrd\">Sub</span> OnFieldChanged(<span class=\"kwrd\">ByVal</span> sender <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span>, <span class=\"kwrd\">ByVal</span> e <span class=\"kwrd\">As</span> WorkItemEventArgs)</pre>\n\n    <pre><span class=\"lnum\">  83:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  84:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  85:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  86:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Class</span></pre>\n\n    <pre><span class=\"lnum\">  87:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  88:</span> <span class=\"kwrd\">End</span> Namespace</pre>\n  </div>\n</div>\n\n<p>\n\n</p><p>It does not yet do anything, but the base wrapper is there. The visual elements only contain a couple of button to get me started testing the wapper and to make sure that the control is displayed:</p>\n\n<p>[<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/FileView.aspx?itemId=35594&amp;changeSetId=1459\">Get SignOffControl.xaml source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/DirectoryView.aspx?SourcePath=%24%2fTFSWitWpfControls&amp;changeSetId=1459\">Get full source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/ListDownloadableCommits.aspx\">Get latest full source</a>]</p>\n\n<div class=\"csharpcode-wrapper\">\n  <div class=\"csharpcode\">\n    <pre><span class=\"lnum\">   1:</span> <span class=\"kwrd\">&lt;</span><span class=\"html\">UserControl</span> <span class=\"attr\">x:Class</span><span class=\"kwrd\">=\"SignOff.SignOffControl\"</span></pre>\n\n    <pre><span class=\"lnum\">   2:</span>     <span class=\"attr\">xmlns</span><span class=\"kwrd\">=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"</span></pre>\n\n    <pre><span class=\"lnum\">   3:</span>     <span class=\"attr\">xmlns:x</span><span class=\"kwrd\">=\"http://schemas.microsoft.com/winfx/2006/xaml\"</span> <span class=\"attr\">Width</span><span class=\"kwrd\">=\"317\"</span> <span class=\"attr\">Height</span><span class=\"kwrd\">=\"46\"</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   4:</span>     <span class=\"kwrd\">&lt;</span><span class=\"html\">StackPanel</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   5:</span>         <span class=\"kwrd\">&lt;</span><span class=\"html\">Button</span><span class=\"kwrd\">&gt;</span>SignOff<span class=\"kwrd\">&lt;/</span><span class=\"html\">Button</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   6:</span>         <span class=\"kwrd\">&lt;</span><span class=\"html\">Button</span><span class=\"kwrd\">&gt;</span>Clear<span class=\"kwrd\">&lt;/</span><span class=\"html\">Button</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   7:</span>     <span class=\"kwrd\">&lt;/</span><span class=\"html\">StackPanel</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   8:</span> <span class=\"kwrd\">&lt;/</span><span class=\"html\">UserControl</span><span class=\"kwrd\">&gt;</span></pre>\n  </div>\n</div>\n\n<p>\n\n</p><p>This will display 2 buttons, but does nothing.</p>\n\n<p><a href=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_2.png\"><img style=\"border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px\" border=\"0\" alt=\"image\" src=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_thumb.png\" width=\"244\" height=\"62\" /></a> </p>\n\n<p>You then need to create your wrapper control. This is a forms control that has the Element Host forms control to host the button. I have gone down the generic rout to minimise the amount of code I would use to create an individual “stub” when creating multiple controls.</p>\n\n<p>here is an example “stub” which is created as a simple class:</p>\n\n<p>[<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/FileView.aspx?itemId=35595&amp;changeSetId=1459\">Get SignOffHostControl.vb source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/DirectoryView.aspx?SourcePath=%24%2fTFSWitWpfControls&amp;changeSetId=1459\">Get full source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/ListDownloadableCommits.aspx\">Get latest full source</a>]</p>\n\n<div class=\"csharpcode-wrapper\">\n  <div class=\"csharpcode\">\n    <pre><span class=\"lnum\">   1:</span> <span class=\"kwrd\">Namespace</span> SignOff</pre>\n\n    <pre><span class=\"lnum\">   2:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   3:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Class</span> SignOffHostControl</pre>\n\n    <pre><span class=\"lnum\">   4:</span>         <span class=\"kwrd\">Inherits</span> WitCustomControlBase(Of SignOffControl)</pre>\n\n    <pre><span class=\"lnum\">   5:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   6:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Class</span></pre>\n\n    <pre><span class=\"lnum\">   7:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   8:</span> <span class=\"kwrd\">End</span> Namespace</pre>\n  </div>\n</div>\n\n<blockquote>\n  <p><em><font color=\"#ff0000\">note: although this inherits from user control you will not be able to view it in the designer because of the generic nature of its inheritance. This is OK and does not hamper development.</font></em></p>\n\n  <p><a href=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_4.png\"><em><font color=\"#ff0000\"></font></em></a><a href=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_4.png\"><img style=\"border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px\" border=\"0\" alt=\"image\" src=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_thumb_1.png\" width=\"404\" height=\"217\" /></a> </p>\n</blockquote>\n\n<p>All the heavy lifting for this control is done in the WitCustomControlBase and the generic type passed needs to meet the requirements of New, UIElement and IWorkItemControl. This ensures that it is a WPF control that inherits from IWorkItemControl.</p>\n\n<p>To create this control you need to create a new Windows Forms control and call it WitCustomControlBase. Add a WPF “Element Host” to it and make that host dock to the total area.</p>\n\n<p>Then we need to make the designer generic.</p>\n\n<p>[<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/FileView.aspx?itemId=35597&amp;changeSetId=1459\">Get WitCustomControlBase.Designer.vb source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/DirectoryView.aspx?SourcePath=%24%2fTFSWitWpfControls&amp;changeSetId=1459\">Get full source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/ListDownloadableCommits.aspx\">Get latest full source</a>]</p>\n\n<div class=\"csharpcode-wrapper\">\n  <div class=\"csharpcode\">\n    <pre><span class=\"lnum\">   1:</span> <span class=\"kwrd\">Imports</span> Microsoft.TeamFoundation.WorkItemTracking.Client</pre>\n\n    <pre><span class=\"lnum\">   2:</span> <span class=\"kwrd\">Imports</span> Microsoft.TeamFoundation.WorkItemTracking.Controls</pre>\n\n    <pre><span class=\"lnum\">   3:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   4:</span> &lt;<span class=\"kwrd\">Global</span>.Microsoft.VisualBasic.CompilerServices.DesignerGenerated()&gt; _</pre>\n\n    <pre><span class=\"lnum\">   5:</span> Partial <span class=\"kwrd\">Class</span> WitCustomControlBase(Of TWitWpfCustomControl <span class=\"kwrd\">As</span> {<span class=\"kwrd\">New</span>, UIElement, IWorkItemControl})</pre>\n\n    <pre><span class=\"lnum\">   6:</span>     <span class=\"kwrd\">Inherits</span> System.Windows.Forms.UserControl</pre>\n\n    <pre><span class=\"lnum\">   7:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   8:</span>     <span class=\"rem\">'UserControl overrides dispose to clean up the component list.</span></pre>\n\n    <pre><span class=\"lnum\">   9:</span>     &lt;System.Diagnostics.DebuggerNonUserCode()&gt; _</pre>\n\n    <pre><span class=\"lnum\">  10:</span>     <span class=\"kwrd\">Protected</span> <span class=\"kwrd\">Overrides</span> <span class=\"kwrd\">Sub</span> Dispose(<span class=\"kwrd\">ByVal</span> disposing <span class=\"kwrd\">As</span> <span class=\"kwrd\">Boolean</span>)</pre>\n\n    <pre><span class=\"lnum\">  11:</span>         <span class=\"kwrd\">Try</span></pre>\n\n    <pre><span class=\"lnum\">  12:</span>             <span class=\"kwrd\">If</span> disposing <span class=\"kwrd\">AndAlso</span> components IsNot <span class=\"kwrd\">Nothing</span> <span class=\"kwrd\">Then</span></pre>\n\n    <pre><span class=\"lnum\">  13:</span>                 components.Dispose()</pre>\n\n    <pre><span class=\"lnum\">  14:</span>             <span class=\"kwrd\">End</span> <span class=\"kwrd\">If</span></pre>\n\n    <pre><span class=\"lnum\">  15:</span>         <span class=\"kwrd\">Finally</span></pre>\n\n    <pre><span class=\"lnum\">  16:</span>             <span class=\"kwrd\">MyBase</span>.Dispose(disposing)</pre>\n\n    <pre><span class=\"lnum\">  17:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Try</span></pre>\n\n    <pre><span class=\"lnum\">  18:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  19:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  20:</span>     <span class=\"rem\">'Required by the Windows Form Designer</span></pre>\n\n    <pre><span class=\"lnum\">  21:</span>     <span class=\"kwrd\">Private</span> components <span class=\"kwrd\">As</span> System.ComponentModel.IContainer</pre>\n\n    <pre><span class=\"lnum\">  22:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  23:</span>     <span class=\"rem\">'NOTE: The following procedure is required by the Windows Form Designer</span></pre>\n\n    <pre><span class=\"lnum\">  24:</span>     <span class=\"rem\">'It can be modified using the Windows Form Designer.  </span></pre>\n\n    <pre><span class=\"lnum\">  25:</span>     <span class=\"rem\">'Do not modify it using the code editor.</span></pre>\n\n    <pre><span class=\"lnum\">  26:</span>     &lt;System.Diagnostics.DebuggerStepThrough()&gt; _</pre>\n\n    <pre><span class=\"lnum\">  27:</span>     <span class=\"kwrd\">Private</span> <span class=\"kwrd\">Sub</span> InitializeComponent()</pre>\n\n    <pre><span class=\"lnum\">  28:</span>         <span class=\"kwrd\">Me</span>.uxElementHost = <span class=\"kwrd\">New</span> System.Windows.Forms.Integration.ElementHost</pre>\n\n    <pre><span class=\"lnum\">  29:</span>         <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl = <span class=\"kwrd\">New</span> TWitWpfCustomControl</pre>\n\n    <pre><span class=\"lnum\">  30:</span>         <span class=\"kwrd\">Me</span>.SuspendLayout()</pre>\n\n    <pre><span class=\"lnum\">  31:</span>         <span class=\"rem\">'</span></pre>\n\n    <pre><span class=\"lnum\">  32:</span>         <span class=\"rem\">'uxElementHost1</span></pre>\n\n    <pre><span class=\"lnum\">  33:</span>         <span class=\"rem\">'</span></pre>\n\n    <pre><span class=\"lnum\">  34:</span>         <span class=\"kwrd\">Me</span>.uxElementHost.Dock = System.Windows.Forms.DockStyle.Fill</pre>\n\n    <pre><span class=\"lnum\">  35:</span>         <span class=\"kwrd\">Me</span>.uxElementHost.Location = <span class=\"kwrd\">New</span> System.Drawing.Point(0, 0)</pre>\n\n    <pre><span class=\"lnum\">  36:</span>         <span class=\"kwrd\">Me</span>.uxElementHost.Name = <span class=\"str\">\"uxElementHost\"</span></pre>\n\n    <pre><span class=\"lnum\">  37:</span>         <span class=\"kwrd\">Me</span>.uxElementHost.Size = <span class=\"kwrd\">New</span> System.Drawing.Size(222, 72)</pre>\n\n    <pre><span class=\"lnum\">  38:</span>         <span class=\"kwrd\">Me</span>.uxElementHost.TabIndex = 0</pre>\n\n    <pre><span class=\"lnum\">  39:</span>         <span class=\"kwrd\">Me</span>.uxElementHost.Text = <span class=\"str\">\"uxElementHost\"</span></pre>\n\n    <pre><span class=\"lnum\">  40:</span>         <span class=\"kwrd\">Me</span>.uxElementHost.Child = <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl</pre>\n\n    <pre><span class=\"lnum\">  41:</span>         <span class=\"rem\">'</span></pre>\n\n    <pre><span class=\"lnum\">  42:</span>         <span class=\"rem\">'WitCustomHostCOntrol</span></pre>\n\n    <pre><span class=\"lnum\">  43:</span>         <span class=\"rem\">'</span></pre>\n\n    <pre><span class=\"lnum\">  44:</span>         <span class=\"kwrd\">Me</span>.AutoScaleDimensions = <span class=\"kwrd\">New</span> System.Drawing.SizeF(6.0!, 13.0!)</pre>\n\n    <pre><span class=\"lnum\">  45:</span>         <span class=\"kwrd\">Me</span>.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font</pre>\n\n    <pre><span class=\"lnum\">  46:</span>         <span class=\"kwrd\">Me</span>.Controls.Add(<span class=\"kwrd\">Me</span>.uxElementHost)</pre>\n\n    <pre><span class=\"lnum\">  47:</span>         <span class=\"kwrd\">Me</span>.Name = <span class=\"str\">\"WitCustomHostCOntrol\"</span></pre>\n\n    <pre><span class=\"lnum\">  48:</span>         <span class=\"kwrd\">Me</span>.Size = <span class=\"kwrd\">New</span> System.Drawing.Size(222, 72)</pre>\n\n    <pre><span class=\"lnum\">  49:</span>         <span class=\"kwrd\">Me</span>.ResumeLayout(<span class=\"kwrd\">False</span>)</pre>\n\n    <pre><span class=\"lnum\">  50:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  51:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  52:</span>     <span class=\"kwrd\">Friend</span> <span class=\"kwrd\">WithEvents</span> uxElementHost <span class=\"kwrd\">As</span> System.Windows.Forms.Integration.ElementHost</pre>\n\n    <pre><span class=\"lnum\">  53:</span>     <span class=\"kwrd\">Friend</span> <span class=\"kwrd\">WithEvents</span> uxWitWpfCustomControl <span class=\"kwrd\">As</span> TWitWpfCustomControl</pre>\n\n    <pre><span class=\"lnum\">  54:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  55:</span> <span class=\"kwrd\">End</span> <span class=\"kwrd\">Class</span></pre>\n  </div>\n</div>\n\n<p>As you can see the only changes that have been made are to the class to add the generic type (line 5) and to the type used on the control instance (lines 29, 53).</p>\n\n<blockquote>\n  <p><font color=\"#ff0000\">note: Once you have made these and the following changes to the designer, you will no longer be able to view the designer in VS because we have made modifications for the designer.</font></p>\n\n  <p><a href=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_6.png\"><font color=\"#ff0000\"></font></a><a href=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_6.png\"><img style=\"border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px\" border=\"0\" alt=\"image\" src=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_thumb_2.png\" width=\"404\" height=\"259\" /></a> </p>\n</blockquote>\n\n<p>\n\n</p><p>Now we have changed the designer, we need to move on to the main control code and change it to pass all calls and implementation of the IWorkItemControl interface to the WPF control.</p>\n\n<p>[<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/FileView.aspx?itemId=35599&amp;changeSetId=1459\">Get WitCustomControlBase.vb source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/DirectoryView.aspx?SourcePath=%24%2fTFSWitWpfControls&amp;changeSetId=1459\">Get full source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/ListDownloadableCommits.aspx\">Get latest full source</a>]</p>\n\n<div class=\"csharpcode-wrapper\">\n  <div class=\"csharpcode\">\n    <pre><span class=\"lnum\">   1:</span> <span class=\"kwrd\">Imports</span> Microsoft.TeamFoundation.WorkItemTracking.Client</pre>\n\n    <pre><span class=\"lnum\">   2:</span> <span class=\"kwrd\">Imports</span> Microsoft.TeamFoundation.WorkItemTracking.Controls</pre>\n\n    <pre><span class=\"lnum\">   3:</span> <span class=\"rem\">'Imports Microsoft.VisualStudio.TeamFoundation.WorkItemTracking</span></pre>\n\n    <pre><span class=\"lnum\">   4:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   5:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   6:</span> <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Class</span> WitCustomControlBase(Of TWitWpfCustomControl <span class=\"kwrd\">As</span> {<span class=\"kwrd\">New</span>, UIElement, IWorkItemControl})</pre>\n\n    <pre><span class=\"lnum\">   7:</span>     <span class=\"kwrd\">Implements</span> IWorkItemControl</pre>\n\n    <pre><span class=\"lnum\">   8:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">   9:</span> <span class=\"preproc\">#Region</span> <span class=\"str\">\" IWorkItemControl \"</span></pre>\n\n    <pre><span class=\"lnum\">  10:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  11:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Event</span> AfterUpdateDatasource(<span class=\"kwrd\">ByVal</span> sender <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span>, <span class=\"kwrd\">ByVal</span> e <span class=\"kwrd\">As</span> System.EventArgs) <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.AfterUpdateDatasource</pre>\n\n    <pre><span class=\"lnum\">  12:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Event</span> BeforeUpdateDatasource(<span class=\"kwrd\">ByVal</span> sender <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span>, <span class=\"kwrd\">ByVal</span> e <span class=\"kwrd\">As</span> System.EventArgs) <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.BeforeUpdateDatasource</pre>\n\n    <pre><span class=\"lnum\">  13:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  14:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Property</span> [<span class=\"kwrd\">ReadOnly</span>]() <span class=\"kwrd\">As</span> <span class=\"kwrd\">Boolean</span> <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.<span class=\"kwrd\">ReadOnly</span></pre>\n\n    <pre><span class=\"lnum\">  15:</span>         <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  16:</span>             <span class=\"kwrd\">Return</span> <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.[<span class=\"kwrd\">ReadOnly</span>]</pre>\n\n    <pre><span class=\"lnum\">  17:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  18:</span>         <span class=\"kwrd\">Set</span>(<span class=\"kwrd\">ByVal</span> value <span class=\"kwrd\">As</span> <span class=\"kwrd\">Boolean</span>)</pre>\n\n    <pre><span class=\"lnum\">  19:</span>             <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.[<span class=\"kwrd\">ReadOnly</span>] = value</pre>\n\n    <pre><span class=\"lnum\">  20:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Set</span></pre>\n\n    <pre><span class=\"lnum\">  21:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Property</span></pre>\n\n    <pre><span class=\"lnum\">  22:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  23:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Sub</span> SetSite(<span class=\"kwrd\">ByVal</span> serviceProvider <span class=\"kwrd\">As</span> System.IServiceProvider) <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.SetSite</pre>\n\n    <pre><span class=\"lnum\">  24:</span>         <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.SetSite(serviceProvider)</pre>\n\n    <pre><span class=\"lnum\">  25:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  26:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  27:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Property</span> WorkItemDatasource() <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span> <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.WorkItemDatasource</pre>\n\n    <pre><span class=\"lnum\">  28:</span>         <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  29:</span>             <span class=\"kwrd\">Return</span> <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.WorkItemDatasource</pre>\n\n    <pre><span class=\"lnum\">  30:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  31:</span>         <span class=\"kwrd\">Set</span>(<span class=\"kwrd\">ByVal</span> value <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span>)</pre>\n\n    <pre><span class=\"lnum\">  32:</span>             <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.WorkItemDatasource = value</pre>\n\n    <pre><span class=\"lnum\">  33:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Set</span></pre>\n\n    <pre><span class=\"lnum\">  34:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Property</span></pre>\n\n    <pre><span class=\"lnum\">  35:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  36:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Property</span> WorkItemFieldName() <span class=\"kwrd\">As</span> <span class=\"kwrd\">String</span> <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.WorkItemFieldName</pre>\n\n    <pre><span class=\"lnum\">  37:</span>         <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  38:</span>             <span class=\"kwrd\">Return</span> <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.WorkItemFieldName</pre>\n\n    <pre><span class=\"lnum\">  39:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  40:</span>         <span class=\"kwrd\">Set</span>(<span class=\"kwrd\">ByVal</span> value <span class=\"kwrd\">As</span> <span class=\"kwrd\">String</span>)</pre>\n\n    <pre><span class=\"lnum\">  41:</span>             <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.WorkItemFieldName = value</pre>\n\n    <pre><span class=\"lnum\">  42:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Set</span></pre>\n\n    <pre><span class=\"lnum\">  43:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Property</span></pre>\n\n    <pre><span class=\"lnum\">  44:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  45:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Property</span> Properties() <span class=\"kwrd\">As</span> System.Collections.Specialized.StringDictionary <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.Properties</pre>\n\n    <pre><span class=\"lnum\">  46:</span>         <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  47:</span>             <span class=\"kwrd\">Return</span> <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.Properties</pre>\n\n    <pre><span class=\"lnum\">  48:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Get</span></pre>\n\n    <pre><span class=\"lnum\">  49:</span>         <span class=\"kwrd\">Set</span>(<span class=\"kwrd\">ByVal</span> value <span class=\"kwrd\">As</span> System.Collections.Specialized.StringDictionary)</pre>\n\n    <pre><span class=\"lnum\">  50:</span>             <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.Properties = value</pre>\n\n    <pre><span class=\"lnum\">  51:</span>         <span class=\"kwrd\">End</span> <span class=\"kwrd\">Set</span></pre>\n\n    <pre><span class=\"lnum\">  52:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Property</span></pre>\n\n    <pre><span class=\"lnum\">  53:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  54:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Sub</span> Clear() <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.Clear</pre>\n\n    <pre><span class=\"lnum\">  55:</span>         <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.Clear()</pre>\n\n    <pre><span class=\"lnum\">  56:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  57:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  58:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Sub</span> FlushToDatasource() <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.FlushToDatasource</pre>\n\n    <pre><span class=\"lnum\">  59:</span>         <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.FlushToDatasource()</pre>\n\n    <pre><span class=\"lnum\">  60:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  61:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  62:</span>     <span class=\"kwrd\">Public</span> <span class=\"kwrd\">Sub</span> InvalidateDatasource() <span class=\"kwrd\">Implements</span> Microsoft.TeamFoundation.WorkItemTracking.Controls.IWorkItemControl.InvalidateDatasource</pre>\n\n    <pre><span class=\"lnum\">  63:</span>         <span class=\"kwrd\">Me</span>.uxWitWpfCustomControl.InvalidateDatasource()</pre>\n\n    <pre><span class=\"lnum\">  64:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  65:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  66:</span> <span class=\"preproc\">#End Region</span></pre>\n\n    <pre><span class=\"lnum\">  67:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  68:</span>     <span class=\"kwrd\">Private</span> <span class=\"kwrd\">Sub</span> uxWitCustomControl_AfterUpdateDatasource(<span class=\"kwrd\">ByVal</span> sender <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span>, <span class=\"kwrd\">ByVal</span> e <span class=\"kwrd\">As</span> System.EventArgs) <span class=\"kwrd\">Handles</span> uxWitWpfCustomControl.AfterUpdateDatasource</pre>\n\n    <pre><span class=\"lnum\">  69:</span>         <span class=\"kwrd\">RaiseEvent</span> AfterUpdateDatasource(sender, e)</pre>\n\n    <pre><span class=\"lnum\">  70:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  71:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  72:</span>     <span class=\"kwrd\">Private</span> <span class=\"kwrd\">Sub</span> uxWitCustomControl_BeforeUpdateDatasource(<span class=\"kwrd\">ByVal</span> sender <span class=\"kwrd\">As</span> <span class=\"kwrd\">Object</span>, <span class=\"kwrd\">ByVal</span> e <span class=\"kwrd\">As</span> System.EventArgs) <span class=\"kwrd\">Handles</span> uxWitWpfCustomControl.BeforeUpdateDatasource</pre>\n\n    <pre><span class=\"lnum\">  73:</span>         <span class=\"kwrd\">RaiseEvent</span> BeforeUpdateDatasource(sender, e)</pre>\n\n    <pre><span class=\"lnum\">  74:</span>     <span class=\"kwrd\">End</span> <span class=\"kwrd\">Sub</span></pre>\n\n    <pre><span class=\"lnum\">  75:</span>\_ </pre>\n\n    <pre><span class=\"lnum\">  76:</span> <span class=\"kwrd\">End</span> Class</pre>\n  </div>\n</div>\n\n<p>This control implements the IWorkItemControl and it is the control that Work Item Tracking loads. Work Item Tracking form display module does not know anything about WPF and we are just faking up the interface to allow us to use the full functionality on WPF in place of Windows Forms. We can use the same method to implement the other features like IWorkItemUserAction.</p>\n\n<p>We then need a Work Item Custom Control (WICC) definition file.</p>\n\n<p>[<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/FileView.aspx?itemId=35596&amp;changeSetId=1459\">Get SignOffControl.wicc source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/DirectoryView.aspx?SourcePath=%24%2fTFSWitWpfControls&amp;changeSetId=1459\">Get full source</a>] [<a target=\"_blank\" href=\"http://www.codeplex.com/TFSWitWpfControls/SourceControl/ListDownloadableCommits.aspx\">Get latest full source</a>]</p>\n\n<div class=\"csharpcode-wrapper\">\n  <div class=\"csharpcode\">\n    <pre><span class=\"lnum\">   1:</span> <span class=\"kwrd\">&lt;?</span><span class=\"html\">xml</span> <span class=\"attr\">version</span><span class=\"kwrd\">=\"1.0\"</span>?<span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   2:</span> <span class=\"kwrd\">&lt;</span><span class=\"html\">CustomControl</span> <span class=\"attr\">xmlns:xsi</span><span class=\"kwrd\">=\"http://www.w3.org/2001/XMLSchema-instance\"</span> <span class=\"attr\">xmlns:xsd</span><span class=\"kwrd\">=\"http://www.w3.org/2001/XMLSchema\"</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   3:</span>  <span class=\"kwrd\">&lt;</span><span class=\"html\">Assembly</span><span class=\"kwrd\">&gt;</span>Hinshelwood.WitCustomControls.dll<span class=\"kwrd\">&lt;/</span><span class=\"html\">Assembly</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   4:</span>  <span class=\"kwrd\">&lt;</span><span class=\"html\">FullClassName</span><span class=\"kwrd\">&gt;</span>Hinshelwood.WitCustomControls.SignOff.SignOffHostControl<span class=\"kwrd\">&lt;/</span><span class=\"html\">FullClassName</span><span class=\"kwrd\">&gt;</span></pre>\n\n    <pre><span class=\"lnum\">   5:</span> <span class=\"kwrd\">&lt;/</span><span class=\"html\">CustomControl</span><span class=\"kwrd\">&gt;</span></pre>\n  </div>\n</div>\n\n<p>This is the file that tells Visual Studio what to do.</p>\n\n<p>This file and the .dll need to copied to the …Application DataMicrosoftTeam FoundationWork Item TrackingCustom Controls9.0 folder.</p>\n\n<p>We can now add this control to a work item by modifying the XML definition of a Work item. To test I have just replaced an existing control.</p>\n\n<p>You can add this using the Power Tools process template editor.</p>\n\n<p><a href=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_10.png\"><img style=\"border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px\" border=\"0\" alt=\"image\" src=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_thumb_4.png\" width=\"449\" height=\"484\" /></a> </p>\n\n<p>The result?</p>\n\n<p><a href=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_8.png\"><img style=\"border-right-width: 0px;border-top-width: 0px;border-bottom-width: 0px;border-left-width: 0px\" border=\"0\" alt=\"image\" src=\"http://blog.hinshelwood.com/files/2011/05/GWB-WindowsLiveWriter-CreatingaWPFWorkItemControl_914D-image_thumb_3.png\" width=\"437\" height=\"484\" /></a> </p>\n\n<p>You will notice that this control is marked as read-only, but not bad for a first pass…</p>\n\n<div style=\"padding-bottom: 0px;margin: 0px;padding-left: 0px;padding-right: 0px;float: none;padding-top: 0px\" class=\"wlWriterEditableSmartContent\">Technorati Tags: <a href=\"http://technorati.com/tags/ALM\" rel=\"tag\">ALM</a>\_<a href=\"http://technorati.com/tags/WPF\" rel=\"tag\">WPF</a>\_<a href=\"http://technorati.com/tags/CodeProject\" rel=\"tag\">CodeProject</a>\_<a href=\"http://technorati.com/tags/TFS\" rel=\"tag\">TFS</a>\_</div>"
  - ''
  post_id: '191'
  post_date: '2008-09-19 12:14:21'
  post_date_gmt: '2008-09-19 12:14:21'
  post_modified: '2008-09-19 12:14:21'
  post_modified_gmt: '2008-09-19 12:14:21'
  comment_status: open
  ping_status: open
  post_name: creating-a-wpf-work-item-control
  status: publish
  post_parent: '0'
  menu_order: '0'
  post_type: post
  post_password: ''
  is_sticky: '0'
  category: {}
  postmeta:
  - meta_key: authorsure_include_css
    meta_value: ''
  - meta_key: dsq_thread_id
    meta_value: '311602818'
  - meta_key: _flattr_post_language
    meta_value: ''
  - meta_key: _flattr_post_category
    meta_value: ''
  - meta_key: _flattr_post_hidden
    meta_value: ''
  - meta_key: _flattr_btn_disabled
    meta_value: ''
  - meta_key: _thumbnail_id
    meta_value: '8621'
  - meta_key: authorsure_include_css
    meta_value: ''
  - meta_key: _views_template
    meta_value: '0'
  - meta_key: _wpbitly
    meta_value: http://nkdalm.net/1aBQiLR
  - meta_key: _pl_karma
    meta_value: '0'
  - meta_key: _jetpack_related_posts_cache
    meta_value: >-
      a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1474511249;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:122;}i:1;a:1:{s:2:"id";i:179;}i:2;a:1:{s:2:"id";i:96;}}}}
  - meta_key: _wpghs_github_path
    meta_value: _posts/2008-09-19-creating-a-wpf-work-item-control.md
  - meta_key: _sha
    meta_value: ''
  - meta_key: _wpml_media_has_media
    meta_value: '1'
  - meta_key: _tribe_ticket_capacity
    meta_value: '0'
  - meta_key: _tribe_ticket_version
    meta_value: 4.12.1.2
  - meta_key: ekit_post_views_count
    meta_value: '622'
  comment:
  - comment_id: '404'
    comment_author: Matthijs ter Woord
    comment_author_email: ''
    comment_author_url: ''
    comment_author_IP: ''
    comment_date: '2008-11-24 20:56:35'
    comment_date_gmt: '2008-11-24 20:56:35'
    comment_content: >-
      Hi,<br /><br />I've been trying to use WPF for creating a(complex) work
      item control. The control is working, but the problem i'm having, is that
      i cannot use external types (custom namespaces) from within xaml. If i
      create the same type from the code-behind, everything works fine. Also, if
      i host the control (same build) in a WPF file, everything works fine. Got
      any clue? maybe you tried this situation and have some hint...<br /><br
      />I'm really clueless. the plans we have now are just dropping the work
      item viewer in VS and not use it, which would be a PITA to use for our DEV
      team...<br /><br /><br />Regards,<br /><br />Matthijs ter Woord
    comment_approved: '1'
    comment_type: comment
    comment_parent: '0'
    comment_user_id: '0'
    commentmeta:
    - meta_key: dsq_parent_post_id
      meta_value: ''
    - meta_key: dsq_post_id
      meta_value: '209970723'
  - comment_id: '405'
    comment_author: dangnb
    comment_author_email: ''
    comment_author_url: ''
    comment_author_IP: ''
    comment_date: '2009-03-30 15:44:30'
    comment_date_gmt: '2009-03-30 15:44:30'
    comment_content: ating a WPF Work Item Control
    comment_approved: '1'
    comment_type: comment
    comment_parent: '0'
    comment_user_id: '0'
    commentmeta:
    - meta_key: dsq_parent_post_id
      meta_value: ''
    - meta_key: dsq_post_id
      meta_value: '209970725'
