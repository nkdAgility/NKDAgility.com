post:
  title: >-
    Creating a WIT Adapter for the TFS Integration Platform for a source with no
    history
  link: >-
    https://nkdagility.com/blog/creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history/
  pubDate: Thu, 02 Jun 2011 11:25:32 +0000
  creator: MrHinsh
  guid:
    _: http://blog.hinshelwood.com/?p=3408
    $:
      isPermaLink: 'false'
  description: ''
  encoded:
  - >-
    <p><a href="http://blog.hinshelwood.com/files/2011/06/image.png"><img
    style="background-image: none; border-right-width: 0px; margin: 0px 20px
    20px 0px; padding-left: 0px; padding-right: 0px; display: inline; float:
    left; border-top-width: 0px; border-bottom-width: 0px; border-left-width:
    0px; padding-top: 0px" title="image" border="0" alt="image" align="left"
    src="http://blog.hinshelwood.com/files/2011/06/image_thumb.png" width="237"
    height="53" /></a>I have recently been working on a TFS Integration Platform
    Adapter for integrating with Test Track Pro. The problem with TTP is that it
    does not contain any history.</p>  <br clear="all" />  <ul>   <li>    
    <p><strong><em><font color="#ff0000">Update 2011-06-03</font></em></strong>
    – Found the problem with the “index” and I can now migrate new work items
    again.</p>   </li> </ul>  <hr />  <p>Although I have had my Test Track Pro
    Tip Adapter working for quite some time, the customer came back and asked if
    they could have a rolling migration. i.e. Shipping changes on a regular
    basis, but only the TIP each time.</p>  <pre class="brush: xml; ruler: true;
    collapse: true;" title="Sample TTP Migration Config file">&lt;?xml
    version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;

    &lt;Configuration
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
                   xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;
                   UniqueId=&quot;ADD2D39C-C44A-4046-93AC-03A4970B2312&quot;
                   FriendlyName=&quot;(3)Northwest Cadence Test Track Pro to TFS&quot;&gt;
      &lt;Providers&gt;
        &lt;Provider ReferenceName=&quot;c0e63c2b-e06c-48bb-8698-243a82bb950e&quot; FriendlyName=&quot;TestTrackPro TIP Adapter&quot; /&gt;
        &lt;Provider ReferenceName=&quot;04201d39-6e47-416f-98b2-07f0013f8455&quot; FriendlyName=&quot;TFS 2010 Migration WIT Provider&quot; /&gt;
      &lt;/Providers&gt;
      &lt;Addins&gt;
        &lt;Addin ReferenceName=&quot;cdde6b6b-72fc-43b6-bbd1-b8a89a788c6f&quot;
              FriendlyName=&quot;TFS Active Directory User Id Lookup Service Addin&quot; /&gt;
      &lt;/Addins&gt;
      &lt;SessionGroup CreationTime=&quot;2011-04-14T14:59:58.72-07:00&quot;
                    FriendlyName=&quot;(3)Northwest Cadence Test Track Pro to TFS&quot;
                    SessionGroupGUID=&quot;FECE4D93-8498-4ED4-87D2-22599336A07D&quot;
                    Creator=&quot;martinhinshelwood&quot;
                    SyncIntervalInSeconds=&quot;0&quot;
                    SyncDurationInMinutes=&quot;0&quot;&gt;
        &lt;MigrationSources&gt;
          &lt;MigrationSource InternalUniqueId=&quot;C513F930-2602-400D-A0BF-A2A3AB434DF5&quot;
                           FriendlyName=&quot;TestTrackPro source&quot;
                           ServerIdentifier=&quot;ttpDatabase@http://ttpserver.domain.com:80&quot;
                           ServerUrl=&quot;http://10.191.164.95:80&quot;
                           SourceIdentifier=&quot;ttpDatabase&quot;
                           ProviderReferenceName=&quot;c0e63c2b-e06c-48bb-8698-243a82bb950e&quot;&gt;
            &lt;Settings&gt;
              &lt;Addins /&gt;
              &lt;UserIdentityLookup&gt;

                &lt;LookupAddin Precedence=&quot;1&quot; ReferenceName=&quot;cdde6b6b-72fc-43b6-bbd1-b8a89a788c6f&quot; /&gt;

              &lt;/UserIdentityLookup&gt;

              &lt;DefaultUserIdProperty UserIdPropertyName=&quot;DisplayName&quot; /&gt;
            &lt;/Settings&gt;
            &lt;CustomSettings&gt;
              &lt;CustomSetting SettingKey=&quot;Username&quot; SettingValue=&quot;mhinshelwood&quot; /&gt;
              &lt;CustomSetting SettingKey=&quot;Password&quot; SettingValue=&quot;password&quot; /&gt;
              &lt;!--&lt;CustomSetting SettingKey=&quot;OverrideHWM&quot; SettingValue=&quot;2011-05-5T14:59:58.72-07:00&quot; /&gt;--&gt;
            &lt;/CustomSettings&gt;
            &lt;StoredCredential /&gt;
          &lt;/MigrationSource&gt;
          &lt;MigrationSource InternalUniqueId=&quot;6E3BDF70-F1AE-4CD5-8EE4-133C8AEE0857&quot;
                           FriendlyName=&quot;tfs01.nwcadence.com (WIT)&quot;
                           ServerIdentifier=&quot;346dd524-18b0-4eda-ba05-0f4d6b14e076&quot;
                           ServerUrl=&quot;http://tfs01.nwcadence.com:8080/tfs/defaultcollection&quot;
                           SourceIdentifier=&quot;ttpImportTest&quot;
                           ProviderReferenceName=&quot;04201d39-6e47-416f-98b2-07f0013f8455&quot;&gt;
            &lt;Settings&gt;
              &lt;Addins /&gt;
              &lt;UserIdentityLookup&gt;

                &lt;LookupAddin Precedence=&quot;1&quot; ReferenceName=&quot;cdde6b6b-72fc-43b6-bbd1-b8a89a788c6f&quot; /&gt;

              &lt;/UserIdentityLookup&gt;

              &lt;DefaultUserIdProperty UserIdPropertyName=&quot;DisplayName&quot; /&gt;
            &lt;/Settings&gt;
            &lt;CustomSettings&gt;
              &lt;CustomSetting SettingKey=&quot;EnableBypassRuleDataSubmission&quot; SettingValue=&quot;True&quot; /&gt;
              &lt;CustomSetting SettingKey=&quot;DisableAreaPathAutoCreation&quot; SettingValue=&quot;False&quot; /&gt;
              &lt;CustomSetting SettingKey=&quot;DisableIterationPathAutoCreation&quot; SettingValue=&quot;False&quot; /&gt;
            &lt;/CustomSettings&gt;
            &lt;StoredCredential /&gt;
          &lt;/MigrationSource&gt;
        &lt;/MigrationSources&gt;
        &lt;Sessions&gt;
          &lt;Session CreationTime=&quot;2011-04-14T14:59:58.703-07:00&quot;
                   SessionUniqueId=&quot;adea805d-51df-489a-b2fd-9717b4af3703&quot;
                   FriendlyName=&quot;Work Item Tracking Session&quot;
                   LeftMigrationSourceUniqueId=&quot;C513F930-2602-400D-A0BF-A2A3AB434DF5&quot;
                   RightMigrationSourceUniqueId=&quot;6E3BDF70-F1AE-4CD5-8EE4-133C8AEE0857&quot;
                   SessionType=&quot;WorkItemTracking&quot;&gt;
            &lt;EventSinks /&gt;
            &lt;CustomSettings&gt;
              &lt;SettingXml&gt;
                &lt;WITSessionCustomSetting&gt;
                  &lt;WorkItemTypes&gt;
                    &lt;WorkItemType LeftWorkItemTypeName=&quot;Defect&quot; RightWorkItemTypeName=&quot;Bug&quot; fieldMap=&quot;Defect2BugFieldMap&quot; /&gt;
                  &lt;/WorkItemTypes&gt;
                  &lt;FieldMaps&gt;
                    &lt;FieldMap name=&quot;Defect2BugFieldMap&quot;&gt;
                      &lt;MappedFields&gt;
                        &lt;MappedField LeftName=&quot;Summary&quot; RightName=&quot;System.Title&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;&quot; /&gt;
                        &lt;MappedField LeftName=&quot;Description&quot; RightName=&quot;System.Description&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;&quot; /&gt;
                        &lt;MappedField LeftName=&quot;Severity&quot; RightName=&quot;Microsoft.VSTS.Common.Severity&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;SeverityMapTTP2TFS&quot; /&gt;
                        &lt;MappedField LeftName=&quot;Status&quot; RightName=&quot;System.State&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;StatusMapTTP2TFS&quot; /&gt;
                        &lt;MappedField LeftName=&quot;Reason&quot; RightName=&quot;System.Reason&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;ReasonMapTTP2TFS&quot; /&gt;
                        &lt;MappedField LeftName=&quot;Priority&quot; RightName=&quot;Microsoft.VSTS.Common.Priority&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;PriorityMapTTP2TFS&quot; /&gt;
                        &lt;MappedField LeftName=&quot;Steps to Reproduce&quot; RightName=&quot;Microsoft.VSTS.TCM.ReproSteps&quot; MapFromSide=&quot;Left&quot; /&gt;
                        &lt;MappedField LeftName=&quot;History&quot; RightName=&quot;System.History&quot; MapFromSide=&quot;Left&quot; /&gt;
                        &lt;MappedField LeftName=&quot;Assigned To User&quot; RightName=&quot;System.AssignedTo&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;UserMapTTP2TFS&quot; /&gt;
                        &lt;MappedField LeftName=&quot;Date Created&quot; RightName=&quot;Microsoft.VSTS.Common.CreatedDate&quot; MapFromSide=&quot;Left&quot;  /&gt;
                        &lt;MappedField LeftName=&quot;Found by&quot; RightName=&quot;Microsoft.VSTS.Common.HowFoundCategory&quot; MapFromSide=&quot;Left&quot;  valueMap=&quot;HowFoundCategoryTFS&quot; /&gt;
                        &lt;!-- WORKAROUND using unused field: Manual Testing --&gt;
                        &lt;!--
                        &lt;MappedField LeftName=&quot;@@MISSINGFIELD@@&quot; RightName=&quot;Microsoft.VSTS.Common.Triage&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;TfsTriageMapping&quot; /&gt;
                        &lt;MappedField LeftName=&quot;@@MISSINGFIELD@@&quot; RightName=&quot;Microsoft.VSTS.Common.Regression&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;TfsRegressionMapping&quot; /&gt;
                        &lt;MappedField LeftName=&quot;@@MISSINGFIELD@@&quot; RightName=&quot;Microsoft.VSTS.Build.Changelist&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;TfsChangelistMapping&quot; /&gt;
                        --&gt;
                        &lt;MappedField LeftName=&quot;Date Modified&quot; RightName=&quot;System.ChangedDate&quot; MapFromSide=&quot;Left&quot; /&gt;
                        &lt;!--&lt;MappedField LeftName=&quot;Modified By&quot; RightName=&quot;System.ChangedBy&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;StatusMapTTP2TFS&quot; /--&gt;
                        &lt;MappedField LeftName=&quot;Verify Version&quot; RightName=&quot;Microsoft.VSTS.Build.FoundIn&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;VerifyVersionMapTTP2TFS&quot; /&gt;
                      &lt;/MappedFields&gt;
                      &lt;AggregatedFields&gt;
                        &lt;FieldsAggregationGroup   MapFromSide=&quot;Left&quot; TargetFieldName=&quot;System.AreaPath&quot; Format=&quot;TestTrackProImport{0}{1}&quot;&gt;
                          &lt;SourceField Index=&quot;0&quot; SourceFieldName=&quot;Component&quot; valueMap=&quot;ComponentMapTTP2TFS&quot; /&gt;
                          &lt;SourceField Index=&quot;1&quot; SourceFieldName=&quot;Functional Area&quot; valueMap=&quot;FunctionalAreaMapTTP2TFS&quot; /&gt;
                        &lt;/FieldsAggregationGroup&gt;
                        &lt;FieldsAggregationGroup   MapFromSide=&quot;Left&quot; TargetFieldName=&quot;System.IterationPath&quot; Format=&quot;TestTrackProImport{0}&quot;&gt;
                          &lt;SourceField Index=&quot;0&quot; SourceFieldName=&quot;Version Found&quot; valueMap=&quot;VerifyVersionMapTTP2TFS&quot;/&gt;
                        &lt;/FieldsAggregationGroup&gt;
                      &lt;/AggregatedFields&gt;
                      &lt;UserIdentityFields&gt;
                        &lt;LeftUserIdentityFields /&gt;
                        &lt;RightUserIdentityFields&gt;
                          &lt;UserIdField FieldReferenceName=&quot;System.AssignedTo&quot; UserIdPropertyName=&quot;DisplayName&quot; /&gt;
                        &lt;/RightUserIdentityFields&gt;
                      &lt;/UserIdentityFields&gt;
                    &lt;/FieldMap&gt;
                  &lt;/FieldMaps&gt;
                  &lt;ValueMaps&gt;
                    &lt;ValueMap name=&quot;HowFoundCategoryTFS&quot;&gt;
                      &lt;Value LeftValue=&quot;*&quot; RightValue=&quot;Manual Testing&quot;&gt;
                      &lt;/Value&gt;
                    &lt;/ValueMap&gt;
                    &lt;ValueMap name=&quot;SeverityMapTTP2TFS&quot;&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;2&quot; /&gt;
                      &lt;Value LeftValue=&quot;3-Usability&quot; RightValue=&quot;3&quot; /&gt;
                      &lt;Value LeftValue=&quot;4-Cosmetic&quot; RightValue=&quot;4&quot; /&gt;
                      &lt;Value LeftValue=&quot;2-Feature not functioning&quot; RightValue=&quot;2&quot; /&gt;
                      &lt;Value LeftValue=&quot;1-Critical, Crash&quot; RightValue=&quot;1&quot; /&gt;
                      &lt;Value LeftValue=&quot;5-Security&quot; RightValue=&quot;4&quot; /&gt;
                    &lt;/ValueMap&gt;
                     &lt;ValueMap name=&quot;TfsChangelistMapping&quot;&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Unknown&quot; /&gt;
                      &lt;Value LeftValue=&quot;*&quot; RightValue=&quot;*&quot; /&gt;
                    &lt;/ValueMap&gt;
                    &lt;ValueMap name=&quot;TfsTriageMapping&quot;&gt;
                      &lt;!-- Approved Rejected Submitted --&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Approved&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;Submitted&quot; /&gt;
                      &lt;/Value&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Rejected&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;Verify Failed&quot; /&gt;
                      &lt;/Value&gt;
                    &lt;/ValueMap&gt;
                    &lt;ValueMap name=&quot;TfsRegressionMapping&quot;&gt;
                      &lt;!-- No Yes --&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Yes&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;New (Re-Opened)&quot; /&gt;
                      &lt;/Value&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Yes&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;Verify Failed&quot; /&gt;
                      &lt;/Value&gt;
                    &lt;/ValueMap&gt;
                    &lt;ValueMap name=&quot;StatusMapTTP2TFS&quot;&gt;
                      &lt;!-- STRIP ALL AFTER THE &quot;,&quot; --&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Proposed&quot; /&gt;
                      &lt;Value LeftValue=&quot;*&quot; RightValue=&quot;Proposed&quot; /&gt;
                      &lt;Value LeftValue=&quot;Verified&quot; RightValue=&quot;Validated&quot; /&gt;
                      &lt;Value LeftValue=&quot;Closed&quot; RightValue=&quot;Closed&quot; /&gt;
                      &lt;Value LeftValue=&quot;Fixed&quot; RightValue=&quot;Resolved&quot; /&gt;
                      &lt;Value LeftValue=&quot;Release to Testing&quot; RightValue=&quot;Resolved&quot; /&gt;
                      &lt;Value LeftValue=&quot;Verify Failed&quot; RightValue=&quot;Resolved&quot; /&gt;
                      &lt;Value LeftValue=&quot;New (Re-Opened)&quot; RightValue=&quot;Proposed&quot; /&gt;
                      &lt;Value LeftValue=&quot;Deferred&quot; RightValue=&quot;Resolved&quot; /&gt;
                    &lt;/ValueMap&gt;
                    &lt;ValueMap name=&quot;ReasonMapTTP2TFS&quot;&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;New&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;New (Re-Opened)&quot; /&gt;
                      &lt;/Value&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Resolved&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;Release to Testing&quot; /&gt;
                      &lt;/Value&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Verification Rejected&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;Verify Failed&quot; /&gt;
                      &lt;/Value&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Resolved&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;Fixed&quot; /&gt;
                      &lt;/Value&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Verified&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;Validated&quot; /&gt;
                      &lt;/Value&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Cut&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;Deferred&quot; /&gt;
                      &lt;/Value&gt;
                      &lt;Value LeftValue=&quot;Duplicate&quot; RightValue=&quot;Duplicate&quot; /&gt;
                      &lt;Value LeftValue=&quot;Not a bug&quot; RightValue=&quot;Not a bug&quot; /&gt;
                      &lt;Value LeftValue=&quot;Not reproducible&quot; RightValue=&quot;Not reproducible&quot; /&gt;
                      &lt;Value LeftValue=&quot;Deprecated Functionality&quot; RightValue=&quot;Deprecated Functionality&quot; /&gt;
                      &lt;Value LeftValue=&quot;Functions as Designed&quot; RightValue=&quot;Functions as Designed&quot; /&gt;
                    &lt;/ValueMap&gt;
                    &lt;ValueMap name=&quot;ComponentMapTTP2TFS&quot;&gt;
                      &lt;Value LeftValue=&quot;*&quot; RightValue=&quot;*&quot; /&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;None&quot; /&gt;

                    &lt;/ValueMap&gt;
                    &lt;ValueMap name=&quot;FunctionalAreaMapTTP2TFS&quot;&gt;
                      &lt;Value LeftValue=&quot;*&quot; RightValue=&quot;*&quot; /&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;None&quot; /&gt;

                    &lt;/ValueMap&gt;
                    &lt;ValueMap name=&quot;VerifyVersionMapTTP2TFS&quot;&gt;
                      &lt;Value LeftValue=&quot;*&quot; RightValue=&quot;*&quot; /&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;None&quot; /&gt;

                    &lt;/ValueMap&gt;
                    &lt;ValueMap name=&quot;PriorityMapTTP2TFS&quot;&gt;
                      &lt;Value LeftValue=&quot;*&quot; RightValue=&quot;2&quot; /&gt;
                      &lt;Value LeftValue=&quot;4-Low&quot; RightValue=&quot;3&quot; /&gt;
                      &lt;Value LeftValue=&quot;3-Medium&quot; RightValue=&quot;3&quot; /&gt;
                      &lt;Value LeftValue=&quot;2-High&quot; RightValue=&quot;2&quot; /&gt;
                      &lt;Value LeftValue=&quot;1-Must Be Fixed&quot; RightValue=&quot;1&quot; /&gt;
                      &lt;Value LeftValue=&quot;Highest (QA)&quot; RightValue=&quot;0&quot; /&gt;
                    &lt;/ValueMap&gt;
                    &lt;ValueMap name=&quot;UserMapTTP2TFS&quot;&gt;
                      &lt;Value LeftValue=&quot;*&quot; RightValue=&quot;*&quot; /&gt;
                      &lt;Value LeftValue=&quot;&quot; RightValue=&quot;Triage&quot;&gt;
                        &lt;When ConditionalSrcFieldName=&quot;Status&quot; ConditionalSrcFieldValue=&quot;New&quot; /&gt;
                      &lt;/Value&gt;

                    &lt;/ValueMap&gt;

                    &lt;ValueMap name=&quot;TypeofCRMapTTP2TFS&quot;&gt;
                      &lt;Value LeftValue=&quot;*&quot; RightValue=&quot;*&quot; /&gt;
                    &lt;/ValueMap&gt;

                  &lt;/ValueMaps&gt;
                &lt;/WITSessionCustomSetting&gt;
              &lt;/SettingXml&gt;
              &lt;SettingXmlSchema /&gt;
            &lt;/CustomSettings&gt;
            &lt;Filters&gt;
              &lt;FilterPair Neglect=&quot;false&quot;&gt;
                &lt;FilterItem MigrationSourceUniqueId=&quot;C513F930-2602-400D-A0BF-A2A3AB434DF5&quot; FilterString=&quot;NWC_Test&quot; /&gt;
                &lt;FilterItem MigrationSourceUniqueId=&quot;6E3BDF70-F1AE-4CD5-8EE4-133C8AEE0857&quot; FilterString=&quot;[System.Id] = 0&quot; /&gt;
              &lt;/FilterPair&gt;
            &lt;/Filters&gt;
          &lt;/Session&gt;
        &lt;/Sessions&gt;
        &lt;Linking&gt;
          &lt;CustomSettings /&gt;
          &lt;LinkTypeMappings /&gt;
        &lt;/Linking&gt;
        &lt;WorkFlowType Frequency=&quot;ContinuousManual&quot; DirectionOfFlow=&quot;Unidirectional&quot; SyncContext=&quot;Disabled&quot; /&gt;
        &lt;CustomSettings /&gt;
        &lt;UserIdentityMappings EnableValidation=&quot;false&quot;&gt;
          &lt;UserIdentityLookupAddins /&gt;
        &lt;/UserIdentityMappings&gt;
        &lt;ErrorManagement&gt;
          &lt;ErrorRouters /&gt;
          &lt;ReportingSettings /&gt;
        &lt;/ErrorManagement&gt;
      &lt;/SessionGroup&gt;
    &lt;/Configuration&gt;</pre>


    <p>
      <br />The problem I ran into was that as all of the example Adapters are TIP adapters they do not take into account history at all. Here is the code for my first run through that was heavily based on <a href="http://www.sadev.co.za">Robert MacLean’s</a> code from <a title="http://www.sadev.co.za/content/how-create-adapter-tfs-integration-platform-series-index" href="http://www.sadev.co.za/content/how-create-adapter-tfs-integration-platform-series-index">How to create an adapter for the TFS Integration Platform</a>: 

      <br /></p>

    <pre class="brush: vb; ruler: true; collapse: true; highlight:
    [210,211,212];" title="View the full source for the TTP Analysis Provider
    v1">Imports Microsoft.TeamFoundation.Migration.Toolkit

    Imports System.ComponentModel.Design

    Imports System.Collections.ObjectModel

    Imports Microsoft.TeamFoundation.Migration.Toolkit.Services

    Imports Microsoft.TeamFoundation.Migration.BusinessModel

    Imports Microsoft.TeamFoundation.Migration.Toolkit.ErrorManagement

    Imports System.Globalization

    Imports System.Xml

    Imports Microsoft.TeamFoundation.Migration.Toolkit.SyncOrchestrator

    Imports System.Net

    Imports System.IO

    Imports System.ServiceModel

    Imports System.ServiceModel.Security

    Imports NorthwestCadence.TtpTipAdapter.TtpSoapSdk

    Imports NorthwestCadence.TtpTipAdapter.TtpSoapSdk.api


    Public Class TtpAnalysisProvider
        Inherits AnalysisProviderBase

        ' Fields
        Private _analysisServiceContainer As IServiceContainer
        Private _changeGroupService As ChangeGroupService
        Private _configurationService As ConfigurationService
        Private _conflictManagerService As ConflictManager
        Private _highWaterMarkDelta As HighWaterMark(Of DateTime)
        Private _highWaterMarkChangeSet As HighWaterMark(Of Integer)
        Private _supportedChangeActions As Dictionary(Of Guid, ChangeActionHandler)
        Private _supportedContentTypes As Collection(Of ContentType)
        Private _dataSourceConfig As TtpMigrationDataSource

        ' Properties
        Public Overrides ReadOnly Property SupportedChangeActions As Dictionary(Of Guid, ChangeActionHandler)
            Get
                Return Me._supportedChangeActions
            End Get
        End Property

        Public Overrides ReadOnly Property SupportedContentTypes As Collection(Of ContentType)
            Get
                Return Me._supportedContentTypes
            End Get
        End Property

        ' Methods
        Private Function CreateChangeGroup(ByVal changeset As Integer, ByVal executionOrder As Long) As ChangeGroup
            Dim group As ChangeGroup = Me._changeGroupService.CreateChangeGroupForDeltaTable(changeset.ToString(CultureInfo.CurrentCulture))
            group.Owner = Nothing
            group.Comment = String.Format(CultureInfo.CurrentCulture, &quot;Changeset {0}&quot;, New Object() {changeset})
            group.ChangeTimeUtc = DateTime.UtcNow
            group.Status = ChangeStatus.Delta
            group.ExecutionOrder = executionOrder
            Return group
        End Function

        Private Shared Function CreateFieldRevisionDescriptionDoc(row As TtpDefectMigrationItem) As XmlDocument
            Dim columns As New XElement(&quot;Columns&quot;, New Object() {New XElement(&quot;Column&quot;, New Object() {New XAttribute(&quot;DisplayName&quot;, &quot;Author&quot;), New XAttribute(&quot;ReferenceName&quot;, &quot;Author&quot;), New XAttribute(&quot;Type&quot;, &quot;String&quot;), New XElement(&quot;Value&quot;, row.AuthorId)}), New XElement(&quot;Column&quot;, New Object() {New XAttribute(&quot;DisplayName&quot;, &quot;DisplayName&quot;), New XAttribute(&quot;ReferenceName&quot;, &quot;DisplayName&quot;), New XAttribute(&quot;Type&quot;, &quot;String&quot;), New XElement(&quot;Value&quot;, row.DisplayName)}), New XElement(&quot;Column&quot;, New Object() {New XAttribute(&quot;DisplayName&quot;, &quot;Id&quot;), New XAttribute(&quot;ReferenceName&quot;, &quot;Id&quot;), New XAttribute(&quot;Type&quot;, &quot;String&quot;), New XElement(&quot;Value&quot;, row.Id.ToString)})})
            Dim column As KeyValuePair(Of String, Object)
            For Each column In row.Columns
                If Not String.IsNullOrEmpty(column.Value) Then
                    columns.Add(New XElement(&quot;Column&quot;, New Object() {New XAttribute(&quot;DisplayName&quot;, column.Key), New XAttribute(&quot;ReferenceName&quot;, column.Key), New XAttribute(&quot;Type&quot;, &quot;String&quot;), New XElement(&quot;Value&quot;, column.Value)}))
                End If
            Next
            Dim descriptionDoc As New XElement(&quot;WorkItemChanges&quot;, New Object() {New XAttribute(&quot;Revision&quot;, &quot;0&quot;), New XAttribute(&quot;WorkItemType&quot;, row.WorItemType), New XAttribute(&quot;Author&quot;, IIf(String.IsNullOrEmpty(row.AuthorId), &quot;&quot;, row.AuthorId)), New XAttribute(&quot;ChangeDate&quot;, row.ModifiedOn.ToString(CultureInfo.CurrentCulture)), New XAttribute(&quot;WorkItemID&quot;, row.Id.ToString), columns})
            Dim doc As New XmlDocument
            doc.LoadXml(descriptionDoc.ToString)
            Return doc
        End Function

        Public Overrides Sub GenerateDeltaTable()
            Dim viewName As String = Me._configurationService.Filters.Item(0).Path
            TraceManager.TraceInformation(&quot;TtpWIT:AP:GenerateDeltaTable:View - {0}&quot;, New Object() {viewName})
            Me._highWaterMarkDelta.Reload()
            Me.GetTtpUpdates(viewName)
            Me._highWaterMarkDelta.Update(DateTime.Now)
            Me._changeGroupService.PromoteDeltaToPending()
        End Sub

        Public Overrides Sub InitializeClient()
            TraceManager.TraceInformation(&quot;TtpWIT:AP:InitializeClient&quot;)
        End Sub

        Private Shared Function InitializeMigrationDataSource() As TtpMigrationDataSource
            Return New TtpMigrationDataSource
        End Function

        Public Overrides Sub InitializeServices(ByVal analysisService As IServiceContainer)
            TraceManager.TraceInformation(&quot;TtpWIT:AP:InitializeServices&quot;)
            If (analysisService Is Nothing) Then
                Throw New ArgumentNullException(&quot;analysisService&quot;)
            End If
            Me._analysisServiceContainer = analysisService
            Me._configurationService = DirectCast(analysisService.GetService(GetType(ConfigurationService)), ConfigurationService)
            Dim migrationSourceConfiguration As MigrationSource = Me._configurationService.MigrationSource
            _dataSourceConfig = TtpAnalysisProvider.InitializeMigrationDataSource
            Dim customSetting As CustomSetting
            Dim username As String = &quot;&quot;
            Dim password As String = &quot;&quot;
            For Each customSetting In Me._configurationService.MigrationSource.CustomSettings.CustomSetting
                If customSetting.SettingKey.Equals(&quot;Username&quot;, StringComparison.OrdinalIgnoreCase) Then
                    username = customSetting.SettingValue
                End If
                If customSetting.SettingKey.Equals(&quot;Password&quot;, StringComparison.OrdinalIgnoreCase) Then
                    password = customSetting.SettingValue
                End If
            Next

            _dataSourceConfig.Credentials = New NetworkCredential(username, password)
            _dataSourceConfig.DatabaseName = migrationSourceConfiguration.SourceIdentifier
            _dataSourceConfig.FilterName = IIf(migrationSourceConfiguration.ServerIdentifier = &quot;[enterFiltername]&quot;, &quot;&quot;, migrationSourceConfiguration.ServerIdentifier)
            _dataSourceConfig.Url = migrationSourceConfiguration.ServerUrl

            Me._supportedContentTypes = New Collection(Of ContentType)
            Me.SupportedContentTypes.Add(WellKnownContentType.WorkItem)

            Dim handler As New TtpChangeActionHandlers(Me)

            Me._supportedChangeActions = New Dictionary(Of Guid, ChangeActionHandler)
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Add, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Edit, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Delete, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me._highWaterMarkDelta = New HighWaterMark(Of DateTime)(&quot;HWMDelta&quot;)
            Me._highWaterMarkChangeSet = New HighWaterMark(Of Integer)(&quot;LastChangeSet&quot;)

            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkDelta)
            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkChangeSet)

            Me._changeGroupService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ChangeGroupService)), ChangeGroupService)

            Me._changeGroupService.RegisterDefaultSourceSerializer(New TtpDefectMigrationItemSerializer)
        End Sub

        Public Overrides Sub RegisterConflictTypes(ByVal conflictManager As ConflictManager)
            TraceManager.TraceInformation(&quot;TtpWIT:AP:RegisterConflictTypes&quot;)
            Me._conflictManagerService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ConflictManager)), ConflictManager)
            Me._conflictManagerService.RegisterConflictType(New GenericConflictType)
            Me._conflictManagerService.RegisterConflictType(New TtpGeneralConflictType, ConflictsSyncOrchOptions.Continue)
        End Sub

        Public Overrides Sub RegisterSupportedChangeActions(ByVal changeActionRegistrationService As ChangeActionRegistrationService)
            TraceManager.TraceInformation(&quot;TtpWIT:AP:RegisterSupportedChangeActions&quot;)
            changeActionRegistrationService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ChangeActionRegistrationService)), ChangeActionRegistrationService)
            Dim supportedChangeAction As KeyValuePair(Of Guid, ChangeActionHandler)
            For Each supportedChangeAction In Me.SupportedChangeActions
                Dim contentType As ContentType
                For Each contentType In Me.SupportedContentTypes
                    changeActionRegistrationService.RegisterChangeAction(supportedChangeAction.Key, contentType.ReferenceName, supportedChangeAction.Value)
                Next
            Next
        End Sub

        Public Overrides Sub RegisterSupportedContentTypes(contentTypeRegistrationService As Microsoft.TeamFoundation.Migration.Toolkit.Services.ContentTypeRegistrationService)

        End Sub

        Private Sub GetTtpUpdates(ByVal viewName As String)
            TraceManager.TraceInformation(&quot;TtpWIT:AP:GetTtpDefectUpdates&quot;)
            Dim TtpServer As Uri = New Uri(String.Format(&quot;{0}/scripts/ttsoapcgi.exe&quot;, _dataSourceConfig.Url))

            TraceManager.TraceInformation(ChrW(9) &amp; &quot;TtpWIT:AP:Loading Ttp  {0}&quot;, New Object() {TtpServer})
            Try

                Dim _ttpsoapclient = New TtpSoapSdkApi(TtpServer)
                Dim _sourceProject As CProject = Nothing
                TraceManager.TraceInformation(&quot;TTP:AP:GetTtpDefectsAsDeltaFromSource:GetProjectList&quot;)
                Dim projects() As CProject = _ttpsoapclient.getProjectList(_dataSourceConfig.Credentials.UserName, _dataSourceConfig.Credentials.Password)
                TraceManager.TraceInformation(&quot;TTP:AP:GetTtpDefectsAsDeltaFromSource:FindSourceProject&quot;)
                For Each project In projects
                    If project.database.name.ToLower = _dataSourceConfig.DatabaseName.ToLower Then
                        _sourceProject = project
                        TraceManager.TraceInformation(&quot;TTP:AP:GetTtpDefectsAsDeltaFromSource:SourceProjectFound&quot;)
                        Exit For
                    End If
                Next

                If _sourceProject Is Nothing Then
                    TraceManager.TraceInformation(&quot;TTP:AP:GetTtpDefectsAsDeltaFromSource:Project Not Found&quot;)
                    Exit Sub
                End If

                TraceManager.TraceInformation(&quot;TTP:AP:InitializeClient:GetSessionId&quot;)
                Dim _lSession = _ttpsoapclient.ProjectLogon(_sourceProject, _dataSourceConfig.Credentials.UserName, _dataSourceConfig.Credentials.Password)
                TraceManager.TraceInformation(&quot;TTP:AP:InitializeClient:Logged onto {0}&quot;, _sourceProject.database.name)
                Dim _deltaTableStartTime As DateTime = DateTime.Now

                ' Dim atc() As CTableColumn = {New CTableColumn With {.name = &quot;Number&quot;}, New CTableColumn With {.name = &quot;Date Modified&quot;}}
                Dim atc() As CTableColumn = _ttpsoapclient.getColumnsForTable(_lSession, &quot;Defect&quot;)
                Dim tstart As DateTime = Now
                TraceManager.TraceInformation(&quot;TTP:AP:InitializeClient:Atempting get on all data&quot;)
                Dim rows As CRecordListSoap = _ttpsoapclient.getRecordListForTable(_lSession, &quot;Defect&quot;, viewName, atc)
                TraceManager.TraceInformation(&quot;TTP:AP:InitializeClient:Found {0} records in {1} seconds&quot;, rows.records.Count, Now.Subtract(tstart).TotalSeconds)
                Dim currentRecord As Integer = 1
                Dim countRecords = rows.records.Count
                For Each record In rows.records
                    ' item has been modified since HWM &amp; before deltra table start time
                    Try
                        Dim DefectMI As TtpDefectMigrationItem = TtpDefectMigrationItem.ConvertCDefectToTtpDefectMigrationItem(atc, record)
                        ' Dim Modified As DateTime = DateTime.Parse(record.row(1).value)

                        If DefectMI.ModifiedOn.CompareTo(_highWaterMarkDelta.Value) &gt; 0 And DefectMI.ModifiedOn.CompareTo(_deltaTableStartTime) Then
                            ' Atempt to import additional data from objects
                            DefectMI.ImportDefectData(_ttpsoapclient, _lSession)

                            ' Create and add acction group
                            Dim actionGuid As Guid = WellKnownChangeActionId.Add
                            If ((Not _highWaterMarkDelta.Value = DateTime.MinValue) AndAlso (DefectMI.ModifiedOn.CompareTo(_highWaterMarkDelta.Value) &gt; 0)) Then
                                actionGuid = WellKnownChangeActionId.Edit
                            Else
                                actionGuid = WellKnownChangeActionId.Add
                            End If
                            Dim changeGroup As ChangeGroup = Me.CreateChangeGroup(_highWaterMarkChangeSet.Value, 0)
                            changeGroup.CreateAction(actionGuid, DefectMI, String.Empty, _dataSourceConfig.DatabaseName, String.Empty, String.Empty, WellKnownContentType.WorkItem.ReferenceName, TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(delta))
                            changeGroup.Save()
                            _highWaterMarkChangeSet.Update((_highWaterMarkChangeSet.Value + 1))
                            ' DONE
                            TraceManager.TraceInformation(&quot;  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds&quot;, currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, &quot;passed&quot;, Now.Subtract(tstart).TotalSeconds)
                        Else
                            TraceManager.TraceInformation(&quot;  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds&quot;, currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, &quot;skipped&quot;, Now.Subtract(tstart).TotalSeconds)
                        End If

                    Catch ex As Exception
                        TraceManager.TraceError(&quot;  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds&quot;, currentRecord, countRecords, &quot;unknown&quot;, &quot;unknown&quot;, &quot;failed&quot;, Now.Subtract(tstart).TotalSeconds)
                        TraceManager.TraceException(ex)
                    End Try
                    currentRecord = currentRecord + 1

                Next

            Catch ex As Exception
                TraceManager.TraceException(ex)
            End Try

        End Sub

    End Class</pre>


    <p><strong>Figure: Full source for the Analysis Provider v1</strong></p>


    <p>&#160;</p>


    <pre class="brush: vb; ruler: true;">Dim changeGroup As ChangeGroup =
    Me.CreateChangeGroup(_highWaterMarkChangeSet.Value, 0)

    changeGroup.CreateAction(actionGuid, DefectMI, String.Empty,
    _dataSourceConfig.DatabaseName, String.Empty, String.Empty,
    WellKnownContentType.WorkItem.ReferenceName,
    TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(delta))

    changeGroup.Save()</pre>


    <p><strong>Figure: Snipit of the Analysis Provider v1</strong></p>


    <p>The problem that I have encountered is that although it adds new Work
    Items that come into scope, it does not do any updates to those work item.
    Now, I can understand this if there had been any updates on the TFS side,
    but I can guarantee that there has not. So I sought help:</p>


    <blockquote>
      <ul>
        <li><strong>Action</strong> == <strong>Edit</strong> when pushing changes and == <strong>Add</strong> for a new one is correct. </li>

        <li><strong>Version</strong> … without debugging the consensus is that the lack of version information is causing the TIP type migration, rather than auctioning the history (edits). </li>

        <li><strong>Version Merge</strong> property … for VC only. </li>

        <li>Ideas for Version property: 
          <ul>
            <li><strong>Option 1</strong> - Create fake version numbers for the TTP side and using a single incrementing integer watermark across all of the TTP items. </li>

            <li><strong>Option 1</strong> - Create fake version numbers for the TTP side and just copy the ChangeAction’s ChangeActionId value for this. </li>
          </ul>
        </li>
      </ul>

      <p>-<strong><em>Willy-Peter Schaub</em></strong>, VSALM Ranger Mother</p>
    </blockquote>


    <p>So I changed my code so that when the create action occurred it passed in
    a version (work item revision) number. As my source system does not have
    revisions, and does not even keep track of edits I just have to make up the
    number as long as it is greater than the one before. I went for
    <strong>Option 1</strong> provided by Willy.</p>


    <pre class="brush: vb; ruler: true; collapse: true; highlight:
    [27,119,123,194,195,222,224,225,226,227];" title="View the full source for
    the TTP Analysis Provider v2">Imports
    Microsoft.TeamFoundation.Migration.Toolkit

    Imports System.ComponentModel.Design

    Imports System.Collections.ObjectModel

    Imports Microsoft.TeamFoundation.Migration.Toolkit.Services

    Imports Microsoft.TeamFoundation.Migration.BusinessModel

    Imports Microsoft.TeamFoundation.Migration.Toolkit.ErrorManagement

    Imports System.Globalization

    Imports System.Xml

    Imports Microsoft.TeamFoundation.Migration.Toolkit.SyncOrchestrator

    Imports System.Net

    Imports System.IO

    Imports System.ServiceModel

    Imports System.ServiceModel.Security

    Imports NorthwestCadence.TtpTipAdapter.TtpSoapSdk

    Imports NorthwestCadence.TtpTipAdapter.TtpSoapSdk.api


    Public Class TtpAnalysisProvider
        Inherits AnalysisProviderBase

        ' Fields
        Private _analysisServiceContainer As IServiceContainer
        Private _changeGroupService As ChangeGroupService
        Private _configurationService As ConfigurationService
        Private _conflictManagerService As ConflictManager
        Private _highWaterMarkDelta As HighWaterMark(Of DateTime)
        Private _highWaterMarkChangeSet As HighWaterMark(Of Integer)
        Private _highWaterMarkRevision As HighWaterMark(Of Integer)
        Private _supportedChangeActions As Dictionary(Of Guid, ChangeActionHandler)
        Private _supportedContentTypes As Collection(Of ContentType)
        Private _dataSourceConfig As TtpMigrationDataSource

        ' Properties
        Public Overrides ReadOnly Property SupportedChangeActions As Dictionary(Of Guid, ChangeActionHandler)
            Get
                Return Me._supportedChangeActions
            End Get
        End Property

        Public Overrides ReadOnly Property SupportedContentTypes As Collection(Of ContentType)
            Get
                Return Me._supportedContentTypes
            End Get
        End Property

        Private Shared Function CreateFieldRevisionDescriptionDoc(row As TtpDefectMigrationItem) As XmlDocument
            Dim columns As New XElement(&quot;Columns&quot;, New Object() {New XElement(&quot;Column&quot;, New Object() {New XAttribute(&quot;DisplayName&quot;, &quot;Author&quot;), New XAttribute(&quot;ReferenceName&quot;, &quot;Author&quot;), New XAttribute(&quot;Type&quot;, &quot;String&quot;), New XElement(&quot;Value&quot;, row.AuthorId)}), New XElement(&quot;Column&quot;, New Object() {New XAttribute(&quot;DisplayName&quot;, &quot;DisplayName&quot;), New XAttribute(&quot;ReferenceName&quot;, &quot;DisplayName&quot;), New XAttribute(&quot;Type&quot;, &quot;String&quot;), New XElement(&quot;Value&quot;, row.DisplayName)}), New XElement(&quot;Column&quot;, New Object() {New XAttribute(&quot;DisplayName&quot;, &quot;Id&quot;), New XAttribute(&quot;ReferenceName&quot;, &quot;Id&quot;), New XAttribute(&quot;Type&quot;, &quot;String&quot;), New XElement(&quot;Value&quot;, row.Id.ToString)})})
            Dim column As KeyValuePair(Of String, Object)
            For Each column In row.Columns
                If Not String.IsNullOrEmpty(column.Value) Then
                    columns.Add(New XElement(&quot;Column&quot;, New Object() {New XAttribute(&quot;DisplayName&quot;, column.Key), New XAttribute(&quot;ReferenceName&quot;, column.Key), New XAttribute(&quot;Type&quot;, &quot;String&quot;), New XElement(&quot;Value&quot;, column.Value)}))
                End If
            Next
            Dim descriptionDoc As New XElement(&quot;WorkItemChanges&quot;, New Object() {New XAttribute(&quot;Revision&quot;, row.Revision), New XAttribute(&quot;WorkItemType&quot;, row.WorItemType), New XAttribute(&quot;Author&quot;, IIf(String.IsNullOrEmpty(row.AuthorId), &quot;&quot;, row.AuthorId)), New XAttribute(&quot;ChangeDate&quot;, row.ModifiedOn.ToString(CultureInfo.CurrentCulture)), New XAttribute(&quot;WorkItemID&quot;, row.Id.ToString), columns})
            Dim doc As New XmlDocument
            doc.LoadXml(descriptionDoc.ToString)
            Return doc
        End Function

        Public Overrides Sub GenerateDeltaTable()
            Dim viewName As String = Me._configurationService.Filters.Item(0).Path
            TraceManager.TraceInformation(&quot;TtpWIT:AP:GenerateDeltaTable:View - {0}&quot;, New Object() {viewName})
            Me._highWaterMarkDelta.Reload()
            Me.GetTtpUpdates(viewName)
            Me._highWaterMarkDelta.Update(DateTime.Now)
            Me._changeGroupService.PromoteDeltaToPending()
        End Sub

        Public Overrides Sub InitializeClient()
            TraceManager.TraceInformation(&quot;TtpWIT:AP:InitializeClient&quot;)
        End Sub

        Private Shared Function InitializeMigrationDataSource() As TtpMigrationDataSource
            Return New TtpMigrationDataSource
        End Function

        Public Overrides Sub InitializeServices(ByVal analysisService As IServiceContainer)
            TraceManager.TraceInformation(&quot;TtpWIT:AP:InitializeServices&quot;)
            If (analysisService Is Nothing) Then
                Throw New ArgumentNullException(&quot;analysisService&quot;)
            End If
            Me._analysisServiceContainer = analysisService
            Me._configurationService = DirectCast(analysisService.GetService(GetType(ConfigurationService)), ConfigurationService)
            Dim migrationSourceConfiguration As MigrationSource = Me._configurationService.MigrationSource
            _dataSourceConfig = TtpAnalysisProvider.InitializeMigrationDataSource
            Dim customSetting As CustomSetting
            Dim username As String = &quot;&quot;
            Dim password As String = &quot;&quot;
            Dim hwmDateOveride As DateTime = DateTime.MinValue
            For Each customSetting In Me._configurationService.MigrationSource.CustomSettings.CustomSetting
                If customSetting.SettingKey.Equals(&quot;Username&quot;, StringComparison.OrdinalIgnoreCase) Then
                    username = customSetting.SettingValue
                End If
                If customSetting.SettingKey.Equals(&quot;Password&quot;, StringComparison.OrdinalIgnoreCase) Then
                    password = customSetting.SettingValue
                End If
                If customSetting.SettingKey.Equals(&quot;OverrideHWM&quot;, StringComparison.OrdinalIgnoreCase) Then
                    If Not DateTime.TryParse(customSetting.SettingValue, hwmDateOveride) Then
                        Throw New InvalidCastException(&quot;Date is not in the correct format: OverrideHWM&quot;)
                    End If
                End If
            Next

            _dataSourceConfig.Credentials = New NetworkCredential(username, password)
            _dataSourceConfig.DatabaseName = migrationSourceConfiguration.SourceIdentifier
            _dataSourceConfig.FilterName = IIf(migrationSourceConfiguration.ServerIdentifier = &quot;[enterFiltername]&quot;, &quot;&quot;, migrationSourceConfiguration.ServerIdentifier)
            _dataSourceConfig.Url = migrationSourceConfiguration.ServerUrl

            Me._supportedContentTypes = New Collection(Of ContentType)
            Me.SupportedContentTypes.Add(WellKnownContentType.WorkItem)

            Dim handler As New TtpChangeActionHandlers(Me)

            Me._supportedChangeActions = New Dictionary(Of Guid, ChangeActionHandler)
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Add, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Edit, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Delete, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me._highWaterMarkDelta = New HighWaterMark(Of DateTime)(&quot;HWMDelta&quot;)
            Me._highWaterMarkChangeSet = New HighWaterMark(Of Integer)(&quot;LastChangeSet&quot;)
            _highWaterMarkRevision = New HighWaterMark(Of Integer)(&quot;Revision&quot;)

            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkDelta)
            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkChangeSet)
            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkRevision)

            If hwmDateOveride &gt; DateTime.MinValue Then
                _highWaterMarkDelta.Update(hwmDateOveride)
            End If

            Me._changeGroupService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ChangeGroupService)), ChangeGroupService)

            Me._changeGroupService.RegisterDefaultSourceSerializer(New TtpDefectMigrationItemSerializer)
        End Sub

        Public Overrides Sub RegisterConflictTypes(ByVal conflictManager As ConflictManager)
            TraceManager.TraceInformation(&quot;TtpWIT:AP:RegisterConflictTypes&quot;)
            Me._conflictManagerService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ConflictManager)), ConflictManager)
            Me._conflictManagerService.RegisterConflictType(New GenericConflictType)
            Me._conflictManagerService.RegisterConflictType(New TtpGeneralConflictType, ConflictsSyncOrchOptions.Continue)
        End Sub

        Public Overrides Sub RegisterSupportedChangeActions(ByVal changeActionRegistrationService As ChangeActionRegistrationService)
            TraceManager.TraceInformation(&quot;TtpWIT:AP:RegisterSupportedChangeActions&quot;)
            changeActionRegistrationService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ChangeActionRegistrationService)), ChangeActionRegistrationService)
            Dim supportedChangeAction As KeyValuePair(Of Guid, ChangeActionHandler)
            For Each supportedChangeAction In Me.SupportedChangeActions
                Dim contentType As ContentType
                For Each contentType In Me.SupportedContentTypes
                    changeActionRegistrationService.RegisterChangeAction(supportedChangeAction.Key, contentType.ReferenceName, supportedChangeAction.Value)
                Next
            Next
        End Sub

        Public Overrides Sub RegisterSupportedContentTypes(contentTypeRegistrationService As Microsoft.TeamFoundation.Migration.Toolkit.Services.ContentTypeRegistrationService)

        End Sub

        Private Sub GetTtpUpdates(ByVal viewName As String)
            TraceManager.TraceInformation(&quot;TtpWIT:AP:GetTtpDefectUpdates&quot;)
            Dim TtpServer As Uri = New Uri(String.Format(&quot;{0}/scripts/ttsoapcgi.exe&quot;, _dataSourceConfig.Url))

            TraceManager.TraceInformation(ChrW(9) &amp; &quot;TtpWIT:AP:Loading Ttp  {0}&quot;, New Object() {TtpServer})
            Try

                Dim _ttpsoapclient = New TtpSoapSdkApi(TtpServer)
                Dim _sourceProject As CProject = Nothing
                TraceManager.TraceInformation(&quot;TTP:AP:GetTtpDefectsAsDeltaFromSource:GetProjectList&quot;)
                Dim projects() As CProject = _ttpsoapclient.getProjectList(_dataSourceConfig.Credentials.UserName, _dataSourceConfig.Credentials.Password)
                TraceManager.TraceInformation(&quot;TTP:AP:GetTtpDefectsAsDeltaFromSource:FindSourceProject&quot;)
                For Each project In projects
                    If project.database.name.ToLower = _dataSourceConfig.DatabaseName.ToLower Then
                        _sourceProject = project
                        TraceManager.TraceInformation(&quot;TTP:AP:GetTtpDefectsAsDeltaFromSource:SourceProjectFound&quot;)
                        Exit For
                    End If
                Next

                If _sourceProject Is Nothing Then
                    TraceManager.TraceInformation(&quot;TTP:AP:GetTtpDefectsAsDeltaFromSource:Project Not Found&quot;)
                    Exit Sub
                End If

                TraceManager.TraceInformation(&quot;TTP:AP:InitializeClient:GetSessionId&quot;)
                Dim _lSession = _ttpsoapclient.ProjectLogon(_sourceProject, _dataSourceConfig.Credentials.UserName, _dataSourceConfig.Credentials.Password)
                TraceManager.TraceInformation(&quot;TTP:AP:InitializeClient:Logged onto {0}&quot;, _sourceProject.database.name)
                Dim _deltaTableStartTime As DateTime = DateTime.Now

                ' Dim atc() As CTableColumn = {New CTableColumn With {.name = &quot;Number&quot;}, New CTableColumn With {.name = &quot;Date Modified&quot;}}
                Dim atc() As CTableColumn = _ttpsoapclient.getColumnsForTable(_lSession, &quot;Defect&quot;)
                Dim tstart As DateTime = Now
                TraceManager.TraceInformation(&quot;TTP:AP:InitializeClient:Atempting get on all data&quot;)
                Dim rows As CRecordListSoap = _ttpsoapclient.getRecordListForTable(_lSession, &quot;Defect&quot;, viewName, atc)
                TraceManager.TraceInformation(&quot;TTP:AP:InitializeClient:Found {0} records in {1} seconds&quot;, rows.records.Count, Now.Subtract(tstart).TotalSeconds)

                _highWaterMarkRevision.Reload()
                _highWaterMarkRevision.Update(_highWaterMarkRevision.Value + 1)

                Dim currentRecord As Integer = 1
                Dim countRecords = rows.records.Count
                For Each record In rows.records
                    ' item has been modified since HWM &amp; before deltra table start time
                    Try
                        Dim DefectMI As TtpDefectMigrationItem = TtpDefectMigrationItem.ConvertCDefectToTtpDefectMigrationItem(atc, record)
                        ' Dim Modified As DateTime = DateTime.Parse(record.row(1).value)

                        If DefectMI.ModifiedOn.CompareTo(_highWaterMarkDelta.Value) &gt; 0 And DefectMI.ModifiedOn.CompareTo(_deltaTableStartTime) Then
                            ' Atempt to import additional data from objects
                            DefectMI.ImportDefectData(_ttpsoapclient, _lSession)

                            ' Create and add acction group
                            Dim actionGuid As Guid = WellKnownChangeActionId.Add
                            If ((Not _highWaterMarkDelta.Value = DateTime.MinValue) AndAlso (DefectMI.CreatedOn.CompareTo(_highWaterMarkDelta.Value) &gt; 0)) Then
                                actionGuid = WellKnownChangeActionId.Add
                                TraceManager.TraceInformation(&quot;  {0} of {1} - '{2}' Number '{3}' has {4} processing revision {5} as add in {6} seconds&quot;, currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, &quot;passed&quot;, _highWaterMarkRevision.Value, Now.Subtract(tstart).TotalSeconds)
                            ElseIf ((Not _highWaterMarkDelta.Value = DateTime.MinValue) AndAlso (DefectMI.ModifiedOn.CompareTo(_highWaterMarkDelta.Value) &gt; 0)) Then
                                actionGuid = WellKnownChangeActionId.Edit
                                TraceManager.TraceInformation(&quot;  {0} of {1} - '{2}' Number '{3}' has {4} processing revision {5} as edit in {6} seconds&quot;, currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, &quot;passed&quot;, _highWaterMarkRevision.Value, Now.Subtract(tstart).TotalSeconds)
                            Else
                                TraceManager.TraceInformation(&quot;  {0} of {1} - '{2}' Number '{3}' has {4} processing revision {5} as edit in {6} seconds&quot;, currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, &quot;skipped&quot;, _highWaterMarkRevision.Value, Now.Subtract(tstart).TotalSeconds)
                            End If

                            ' Add revision to obejct
                            DefectMI.Revision = _highWaterMarkRevision.Value

                            Dim changeGroup As ChangeGroup = Me._changeGroupService.CreateChangeGroupForDeltaTable(String.Format(&quot;{0}:{1}&quot;, DefectMI.Id, DefectMI.Revision))
                            changeGroup.CreateAction(actionGuid, DefectMI, DefectMI.Id, &quot;&quot;, _highWaterMarkRevision.Value, &quot;&quot;, WellKnownContentType.WorkItem.ReferenceName, TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(DefectMI))
                            TraceManager.TraceInformation(&quot;  {0} of {1} - '{2}' Number '{3}' CreateAction: action={4};sourceItem={5};fromPath={5};version={6};mergeVersionTo=;itemTypeRefName={7};actionDetails=[xml]&quot;, currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, actionGuid, DefectMI.Id, _highWaterMarkRevision.Value, WellKnownContentType.WorkItem.ReferenceName)
                            changeGroup.Save()

                            _highWaterMarkChangeSet.Update((_highWaterMarkChangeSet.Value + 1))
                            ' DONE

                        Else
                            TraceManager.TraceInformation(&quot;  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds&quot;, currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, &quot;skipped&quot;, Now.Subtract(tstart).TotalSeconds)
                        End If

                    Catch ex As Exception
                        TraceManager.TraceError(&quot;  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds&quot;, currentRecord, countRecords, &quot;unknown&quot;, &quot;unknown&quot;, &quot;failed&quot;, Now.Subtract(tstart).TotalSeconds)
                        TraceManager.TraceException(ex)
                    End Try
                    currentRecord = currentRecord + 1

                Next

            Catch ex As Exception
                TraceManager.TraceException(ex)
            End Try

        End Sub

    End Class</pre>


    <p>
      <br /><strong>Figure: Full source code for new Analysis Provider v2</strong> 

      <br /></p>

    <pre class="brush: vb; ruler: true;">Dim changeGroup As ChangeGroup =
    Me._changeGroupService.CreateChangeGroupForDeltaTable(String.Format(&quot;{0}:{1}&quot;,
    DefectMI.Id, DefectMI.Revision))

    changeGroup.CreateAction(actionGuid, DefectMI, DefectMI.Id, &quot;&quot;,
    _highWaterMarkRevision.Value, &quot;&quot;,
    WellKnownContentType.WorkItem.ReferenceName,
    TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(DefectMI))

    TraceManager.TraceInformation(&quot;  {0} of {1} - '{2}' Number '{3}'
    CreateAction:
    action={4};sourceItem={5};fromPath={5};version={6};mergeVersionTo=;itemTypeRefName={7};actionDetails=[xml]&quot;,
    currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, actionGuid,
    DefectMI.Id, _highWaterMarkRevision.Value,
    WellKnownContentType.WorkItem.ReferenceName)

    changeGroup.Save()</pre>


    <p><strong>Figure: Snipit of the Analysis Provider v2</strong></p>


    <p>You can see in the full source for v2 of the Analysis Provider that I
    have added a new high watermark for the revision that should stay in sync
    with the number of runs of the migration there have been. This way, all of
    the edit’s&#160; that happen on the third run will have a revision number of
    3.</p>


    <p><a href="http://blog.hinshelwood.com/files/2011/06/image1.png"><img
    style="background-image: none; border-right-width: 0px; padding-left: 0px;
    padding-right: 0px; display: inline; border-top-width: 0px;
    border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px"
    title="image" border="0" alt="image"
    src="http://blog.hinshelwood.com/files/2011/06/image_thumb1.png" width="640"
    height="350" /></a></p>


    <p><strong>Figure: None of the originally imported data has a
    revision.</strong></p>


    <p>The problem now is that no matter how many times I run the import in my
    test environment I can’t get it to perform an edit. I am hoping that someone
    will be able to spot a silly mistake on my code that will solve this
    problem. it is one of those “stare at it for hours hoping it will just work”
    problems.</p>


    <p>And it gets worse, now when I try to run the code I get an “Index was out
    of range” exception for the TFS server that I just can’t track down. I have
    even backed all my code back to a known working version and I still get the
    error. I have even gone so far as to restart the Target TFS server and try
    another one. Here is the log I keep getting:</p>


    <pre class="brush: ps; ruler: true; collapse: true;highlight:
    [112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136];"
    title="Logginng - Index was out of range. Must be non-negative and less than
    the size of the collection">[02/06/2011 18:14:15] MigrationConsole
    started...

    [02/06/2011 18:14:29] MigrationConsole.exe Information: 0 :
    ConfigurationChangeTracker did not detect any non-transient changes. No
    cached data will be deleted for session group
    '00000000-0000-0000-0000-000000000000'

    [02/06/2011 18:14:29] MigrationConsole.exe Information: 0 : :
    StartSessionGroup: Enter with sessionGroupUniqueId:
    a69d4175-24ad-4f12-8fb5-4edd33f40ada

    [02/06/2011 18:14:29] MigrationConsole.exe Information: 0 : :
    StartSessionGroup: Creating new SyncOrchestrator

    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider
    ChangeGroup Label AnalysisAddin Provider
    a4f53905-25b6-4311-ac0c-637da6688f2b is available

    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider
    ClearQuest Adapter d9637401-7385-4643-9c64-31585d77ed16 is available

    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider
    Northwest Cadence CSV Adapter 06a2457f-ebba-4979-bc5f-0f5006b8b4e6 is
    available

    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider TFS
    2008 User Identity Lookup Add-In Provider
    eecc0227-8006-45f0-888d-10ab03019ad5 is available

    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider
    Semaphore File Analysis Addin Provider e8cec3c5-5848-4b83-904f-4324094c3f78
    is available

    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider TFS
    2010 Migration VC Provider febc091f-82a2-449e-aed8-133e5896c47a is available

    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : Provider TFS
    2010 Migration WIT Provider 04201d39-6e47-416f-98b2-07f0013f8455 is
    available

    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : Provider
    TestTrackPro TIP Adapter c0e63c2b-e06c-48bb-8698-243a82bb950e is available

    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : :
    CsvAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAddin

    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : Provider TFS
    2010 Migration WIT Provider 04201d39-6e47-416f-98b2-07f0013f8455 is loaded

    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAddin

    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService - Cant find--

    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : Provider
    TestTrackPro TIP Adapter c0e63c2b-e06c-48bb-8698-243a82bb950e is loaded

    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : 2 Adapter
    instance(s) loaded

    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : 5 Add-Ins
    loaded

    [02/06/2011 18:14:35] MigrationConsole.exe Information: 0 : : Active
    Directory lookup will be used for this end point.

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService -
    Microsoft.TeamFoundation.Migration.Toolkit.IAnalysisProvider

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService Creating - TtpAnalysisProvider

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService Returning -
    NorthwestCadence.TtpTipAdapter.TtpAnalysisProvider

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpWIT:AP:InitializeServices

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpWIT:AP:RegisterSupportedChangeActions

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpWIT:AP:RegisterConflictTypes

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService -
    Microsoft.TeamFoundation.Migration.Toolkit.Services.IServerPathTranslationService

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService - Cant find--

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService -
    Microsoft.TeamFoundation.Migration.Toolkit.IMigrationProvider

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService Creating - TtpMigrationProvider

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService Returning -
    NorthwestCadence.TtpTipAdapter.TtpAnalysisProvider

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpWIT:AP:RegisterConflictTypes

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService -
    Microsoft.TeamFoundation.Migration.Toolkit.ILinkProvider

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : :
    TtpAdapter:GetService - Cant find--

    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : Connecting to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:41] MigrationConsole.exe Information: 0 : : Connected to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:42] MigrationConsole.exe Information: 0 : : Connecting to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:42] MigrationConsole.exe Information: 0 : : Connected to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:42] MigrationConsole.exe Information: 0 : :
    TtpWIT:AP:InitializeClient

    [02/06/2011 18:14:42] MigrationConsole.exe Information: 0 : : Connecting to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:42] MigrationConsole.exe Information: 0 : : Connected to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:43] MigrationConsole.exe Information: 0 : : Connecting to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:43] MigrationConsole.exe Information: 0 : : Connected to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 : :
    StartSessionGroup: Starting SyncOrchestrator; now 0 running sessions

    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Session worker thread [WorkItemTracking] started

    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Pipeline flow from bcf2ef19-dbaf-48a3-bbd1-82424ef9d7f2 to
    90acdef5-e512-4df5-a680-cb2f386b08fd

    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Generating delta tables for the migration source
    bcf2ef19-dbaf-48a3-bbd1-82424ef9d7f2

    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpWIT:AP:GenerateDeltaTable:View - NWC_Test

    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpWIT:AP:GetTtpDefectUpdates

    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 :
    WorkItemTracking:     TtpWIT:AP:Loading Ttp 
    http://ttp01.nwcadence.com/scripts/ttsoapcgi.exe

    [02/06/2011 18:14:45] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TTP:AP:GetTtpDefectsAsDeltaFromSource:GetProjectList

    [02/06/2011 18:14:47] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TTP:AP:GetTtpDefectsAsDeltaFromSource:FindSourceProject

    [02/06/2011 18:14:47] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TTP:AP:GetTtpDefectsAsDeltaFromSource:SourceProjectFound

    [02/06/2011 18:14:47] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TTP:AP:InitializeClient:GetSessionId

    [02/06/2011 18:14:48] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TTP:AP:InitializeClient:Logged onto expreSSO_Vergence

    [02/06/2011 18:14:49] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TTP:AP:InitializeClient:Atempting get on all data

    [02/06/2011 18:14:51] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TTP:AP:InitializeClient:Found 3 records in 1.9663932
    seconds

    [02/06/2011 18:14:52] MigrationConsole.exe Information: 0 :
    WorkItemTracking:   1 of 3 - 'Defect' Number '3284' has skipped processing
    revision 1 as edit in 3.2796558 seconds

    [02/06/2011 18:14:52] MigrationConsole.exe Information: 0 :
    WorkItemTracking:   1 of 3 - 'Defect' Number '3284' CreateAction:
    action=cb71d043-bede-4092-aa87-cf0f14586625;sourceItem=3284;fromPath=3284;version=0;mergeVersionTo=;itemTypeRefName=Microsoft.TeamFoundation.Migration.Toolkit.WorkItem;actionDetails=[xml]

    [02/06/2011 18:14:54] MigrationConsole.exe Information: 0 :
    WorkItemTracking:   2 of 3 - 'Defect' Number '3285' has skipped processing
    revision 1 as edit in 4.8739746 seconds

    [02/06/2011 18:14:54] MigrationConsole.exe Information: 0 :
    WorkItemTracking:   2 of 3 - 'Defect' Number '3285' CreateAction:
    action=cb71d043-bede-4092-aa87-cf0f14586625;sourceItem=3285;fromPath=3285;version=0;mergeVersionTo=;itemTypeRefName=Microsoft.TeamFoundation.Migration.Toolkit.WorkItem;actionDetails=[xml]

    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 :
    WorkItemTracking:   3 of 3 - 'Defect' Number '3243' has skipped processing
    revision 1 as edit in 6.1952388 seconds

    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 :
    WorkItemTracking:   3 of 3 - 'Defect' Number '3243' CreateAction:
    action=cb71d043-bede-4092-aa87-cf0f14586625;sourceItem=3243;fromPath=3243;version=0;mergeVersionTo=;itemTypeRefName=Microsoft.TeamFoundation.Migration.Toolkit.WorkItem;actionDetails=[xml]

    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Generating linking delta for the migration source
    bcf2ef19-dbaf-48a3-bbd1-82424ef9d7f2

    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Generating delta tables for the migration source
    90acdef5-e512-4df5-a680-cb2f386b08fd

    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Getting modified items from
    '90acdef5-e512-4df5-a680-cb2f386b08fd!http://tfs01.nwcadence.com:8080/tfs/sandbox
    (TestTrackPro)'

    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Connecting to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Connected to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TFS Query: SELECT [System.Id], [System.Rev] FROM WorkItems
    WHERE ([System.TeamProject]=@project AND ([System.Id] = 0)) ORDER BY
    [System.Id]

    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TFS Query: returned 0 item(s)

    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Received modified items from
    '90acdef5-e512-4df5-a680-cb2f386b08fd!http://tfs01.nwcadence.com:8080/tfs/sandbox
    (TestTrackPro)'

    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Persisted WIT HWM: HWMDeltaWit

    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Updated high watermark to '06/02/2011 22:14:55'

    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Generating migration instructions for the migration source
    90acdef5-e512-4df5-a680-cb2f386b08fd

    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem

    [02/06/2011 18:14:57] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem

    [02/06/2011 18:14:57] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem

    [02/06/2011 18:14:57] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Generating migration instruction for ChangeGroup 4382

    [02/06/2011 18:14:57] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Generating migration instruction for ChangeGroup 4383

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Generating migration instruction for ChangeGroup 4384

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Starting basic conflict detection

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Finishing basic conflict detection

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Loading 50 ChangeGroup(s)

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup
    #4385

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup
    #4386

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup
    #4387

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Post-processing delta table entries from the migration
    source 90acdef5-e512-4df5-a680-cb2f386b08fd

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Marking as 'DeltaComplete' the target-side delta table for
    uni-directional session

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Migrating to the migration source
    90acdef5-e512-4df5-a680-cb2f386b08fd

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Loading 50 ChangeGroup(s)

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Processing ChangeGroup #4385, change 3284:0

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Connecting to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Connected to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:14:59] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Area 'TestTrackProTestTrackProImportAdministrators
    DesktopInstallation' does not exist in the TFS work item store
    'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)' or access is
    denied.

    [02/06/2011 18:15:00] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Wake up from 100 millisec sleep for polling CSS node Id

    [02/06/2011 18:15:01] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Wake up from 500 millisec sleep for polling CSS node Id

    [02/06/2011 18:15:01] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Created path 'TestTrackProTestTrackProImportAdministrators
    DesktopInstallation'(Id: 605) in the TFS Work Item store
    'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)'

    [02/06/2011 18:15:01] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Iteration 'TestTrackProTestTrackProImportexpreSSO 2.5 SP3
    CD5' does not exist in the TFS work item store
    'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)' or access is
    denied.

    [02/06/2011 18:15:02] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Wake up from 100 millisec sleep for polling CSS node Id

    [02/06/2011 18:15:03] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Wake up from 500 millisec sleep for polling CSS node Id

    [02/06/2011 18:15:03] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Wake up from 500 millisec sleep for polling CSS node Id

    [02/06/2011 18:15:04] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Created path 'TestTrackProTestTrackProImportexpreSSO 2.5
    SP3 CD5'(Id: 607) in the TFS Work Item store
    'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)'

    [02/06/2011 18:15:04] MigrationConsole.exe Information: 0 :
    WorkItemTracking: WorkItem type 'Bug' does not contain field
    'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be
    skipped.

    [02/06/2011 18:15:04] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Connecting to
    'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:15:04] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Connected to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'

    [02/06/2011 18:15:04] MigrationConsole.exe Error: 0 : WorkItemTracking:
    System.Web.Services.Protocols.SoapException: Index was out of range. Must be
    non-negative and less than the size of the collection.

    [02/06/2011 18:15:04] Parameter name: index ---&gt; Index was out of range.
    Must be non-negative and less than the size of the collection.

    [02/06/2011 18:15:04] Parameter name: index

    [02/06/2011 18:15:04]    at
    Microsoft.TeamFoundation.WorkItemTracking.Proxy.RetryHandler.HandleSoapException(SoapException
    se)

    [02/06/2011 18:15:04]    at
    Microsoft.TeamFoundation.WorkItemTracking.Proxy.WorkItemServer.Update(String
    requestId, XmlElement package, XmlElement&amp; result,
    MetadataTableHaveEntry[] metadataHave, String&amp; dbStamp,
    IMetadataRowSets&amp; metadata)

    [02/06/2011 18:15:04]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.Tfs2010WorkItemServer.Update(String
    requestId, XmlElement package, XmlElement&amp; result,
    MetadataTableHaveEntry[] metadataHave, String&amp; dbStamp,
    IMetadataRowSets&amp; metadata)

    [02/06/2011 18:15:04]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsBatchUpdateHelper.Submit(Int32
    firstItem, Int32 lastItem)

    [02/06/2011 18:15:05] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Unresolved conflict:

    [02/06/2011 18:15:05]   Session: 1c1faa2a-0d43-4381-b877-2df1d232694c

    [02/06/2011 18:15:05]   Source: 90acdef5-e512-4df5-a680-cb2f386b08fd

    [02/06/2011 18:15:05]   Message: Cannot find applicable resolution rule.

    [02/06/2011 18:15:05]   Conflict Type: TFS WIT invalid submission conflict
    type

    [02/06/2011 18:15:05]   Conflict Type Reference Name:
    c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374

    [02/06/2011 18:15:05]   Conflict Details: &lt;?xml
    version=&quot;1.0&quot;?&gt;

    [02/06/2011 18:15:05] &lt;InvalidSubmissionConflictDetails
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;

    [02/06/2011 18:15:05]  
    &lt;ExceptionType&gt;System.Web.Services.Protocols.SoapException&lt;/ExceptionType&gt;

    [02/06/2011 18:15:05]   &lt;ExceptionMessage&gt;Index was out of range. Must
    be non-negative and less than the size of the collection.

    [02/06/2011 18:15:05] Parameter name: index ---&amp;gt; Index was out of
    range. Must be non-negative and less than the size of the collection.

    [02/06/2011 18:15:05] Parameter name: index&lt;/ExceptionMessage&gt;

    [02/06/2011 18:15:05]   &lt;InnerExceptionType /&gt;

    [02/06/2011 18:15:05]   &lt;InnerExceptionMessage /&gt;

    [02/06/2011 18:15:05]   &lt;ActionData /&gt;

    [02/06/2011 18:15:05]   &lt;SourceItemId&gt;3284&lt;/SourceItemId&gt;

    [02/06/2011 18:15:05]  
    &lt;SourceItemRevision&gt;0&lt;/SourceItemRevision&gt;

    [02/06/2011 18:15:05] &lt;/InvalidSubmissionConflictDetails&gt;

    [02/06/2011 18:15:05]

    [02/06/2011 18:15:05]

    [02/06/2011 18:15:05] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Processing ChangeGroup #4386, change 3285:0

    [02/06/2011 18:15:05] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Area 'TestTrackProTestTrackProImportAdministrators
    DesktopBridges' does not exist in the TFS work item store
    'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)' or access is
    denied.

    [02/06/2011 18:15:06] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Wake up from 100 millisec sleep for polling CSS node Id

    [02/06/2011 18:15:06] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Wake up from 500 millisec sleep for polling CSS node Id

    [02/06/2011 18:15:07] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Created path 'TestTrackProTestTrackProImportAdministrators
    DesktopBridges'(Id: 608) in the TFS Work Item store
    'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)'

    [02/06/2011 18:15:07] MigrationConsole.exe Information: 0 :
    WorkItemTracking: WorkItem type 'Bug' does not contain field
    'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be
    skipped.

    [02/06/2011 18:15:07] MigrationConsole.exe Error: 0 : WorkItemTracking:
    System.Web.Services.Protocols.SoapException: Index was out of range. Must be
    non-negative and less than the size of the collection.

    [02/06/2011 18:15:07] Parameter name: index ---&gt; Index was out of range.
    Must be non-negative and less than the size of the collection.

    [02/06/2011 18:15:07] Parameter name: index

    [02/06/2011 18:15:07]    at
    Microsoft.TeamFoundation.WorkItemTracking.Proxy.RetryHandler.HandleSoapException(SoapException
    se)

    [02/06/2011 18:15:07]    at
    Microsoft.TeamFoundation.WorkItemTracking.Proxy.WorkItemServer.Update(String
    requestId, XmlElement package, XmlElement&amp; result,
    MetadataTableHaveEntry[] metadataHave, String&amp; dbStamp,
    IMetadataRowSets&amp; metadata)

    [02/06/2011 18:15:07]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.Tfs2010WorkItemServer.Update(String
    requestId, XmlElement package, XmlElement&amp; result,
    MetadataTableHaveEntry[] metadataHave, String&amp; dbStamp,
    IMetadataRowSets&amp; metadata)

    [02/06/2011 18:15:07]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsBatchUpdateHelper.Submit(Int32
    firstItem, Int32 lastItem)

    [02/06/2011 18:15:07] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Unresolved conflict:

    [02/06/2011 18:15:07]   Session: 1c1faa2a-0d43-4381-b877-2df1d232694c

    [02/06/2011 18:15:07]   Source: 90acdef5-e512-4df5-a680-cb2f386b08fd

    [02/06/2011 18:15:07]   Message: Cannot find applicable resolution rule.

    [02/06/2011 18:15:07]   Conflict Type: TFS WIT invalid submission conflict
    type

    [02/06/2011 18:15:07]   Conflict Type Reference Name:
    c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374

    [02/06/2011 18:15:07]   Conflict Details: &lt;?xml
    version=&quot;1.0&quot;?&gt;

    [02/06/2011 18:15:07] &lt;InvalidSubmissionConflictDetails
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;

    [02/06/2011 18:15:07]  
    &lt;ExceptionType&gt;System.Web.Services.Protocols.SoapException&lt;/ExceptionType&gt;

    [02/06/2011 18:15:07]   &lt;ExceptionMessage&gt;Index was out of range. Must
    be non-negative and less than the size of the collection.

    [02/06/2011 18:15:07] Parameter name: index ---&amp;gt; Index was out of
    range. Must be non-negative and less than the size of the collection.

    [02/06/2011 18:15:07] Parameter name: index&lt;/ExceptionMessage&gt;

    [02/06/2011 18:15:07]   &lt;InnerExceptionType /&gt;

    [02/06/2011 18:15:07]   &lt;InnerExceptionMessage /&gt;

    [02/06/2011 18:15:07]   &lt;ActionData /&gt;

    [02/06/2011 18:15:07]   &lt;SourceItemId&gt;3285&lt;/SourceItemId&gt;

    [02/06/2011 18:15:07]  
    &lt;SourceItemRevision&gt;0&lt;/SourceItemRevision&gt;

    [02/06/2011 18:15:07] &lt;/InvalidSubmissionConflictDetails&gt;

    [02/06/2011 18:15:07]

    [02/06/2011 18:15:07]

    [02/06/2011 18:15:07] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Processing ChangeGroup #4387, change 3243:0

    [02/06/2011 18:15:07] MigrationConsole.exe Error: 0 : WorkItemTracking:
    System.FormatException: String was not recognized as a valid DateTime.

    [02/06/2011 18:15:07]    at System.DateTimeParse.Parse(String s,
    DateTimeFormatInfo dtfi, DateTimeStyles styles)

    [02/06/2011 18:15:07]    at System.DateTime.Parse(String s, IFormatProvider
    provider)

    [02/06/2011 18:15:07]    at System.Convert.ToDateTime(String value)

    [02/06/2011 18:15:07]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsUpdateDocument.AddColumn(XmlElement
    cs, String workItemType, String fieldName, String fieldReferenceName, String
    stringVal)

    [02/06/2011 18:15:07]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsUpdateDocument.AddFields(IMigrationAction
    action, String workItemType, String author, String changedTime, Boolean
    insertWorkItem)

    [02/06/2011 18:15:07]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.CreateNewWorkItemOperation(IMigrationAction
    action, ConflictManager conflictMgrService)

    [02/06/2011 18:15:07]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.CreateUpdateOperationDoc(IMigrationAction
    action)

    [02/06/2011 18:15:07]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.SubmitChangesWithUpdateDoc(ChangeGroup
    changeGroup, ConversionResult changeResult, Guid sourceSideSourceId)

    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Unresolved conflict:

    [02/06/2011 18:15:08]   Session: 1c1faa2a-0d43-4381-b877-2df1d232694c

    [02/06/2011 18:15:08]   Source: 90acdef5-e512-4df5-a680-cb2f386b08fd

    [02/06/2011 18:15:08]   Message: Cannot find applicable resolution rule.

    [02/06/2011 18:15:08]   Conflict Type: TFS WIT invalid submission conflict
    type

    [02/06/2011 18:15:08]   Conflict Type Reference Name:
    c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374

    [02/06/2011 18:15:08]   Conflict Details: &lt;?xml
    version=&quot;1.0&quot;?&gt;

    [02/06/2011 18:15:08] &lt;InvalidSubmissionConflictDetails
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;

    [02/06/2011 18:15:08]  
    &lt;ExceptionType&gt;System.FormatException&lt;/ExceptionType&gt;

    [02/06/2011 18:15:08]   &lt;ExceptionMessage&gt;String was not recognized as
    a valid DateTime.&lt;/ExceptionMessage&gt;

    [02/06/2011 18:15:08]   &lt;InnerExceptionType /&gt;

    [02/06/2011 18:15:08]   &lt;InnerExceptionMessage /&gt;

    [02/06/2011 18:15:08]   &lt;ActionData /&gt;

    [02/06/2011 18:15:08]   &lt;SourceItemId&gt;3243&lt;/SourceItemId&gt;

    [02/06/2011 18:15:08]  
    &lt;SourceItemRevision&gt;0&lt;/SourceItemRevision&gt;

    [02/06/2011 18:15:08] &lt;/InvalidSubmissionConflictDetails&gt;

    [02/06/2011 18:15:08]

    [02/06/2011 18:15:08]

    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Processing linking delta

    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Migrating links to the migration source
    90acdef5-e512-4df5-a680-cb2f386b08fd

    [02/06/2011 18:15:08] MigrationConsole.exe Warning: 0 : WorkItemTracking:
    Unable to record sync point for migration source
    bcf2ef19-dbaf-48a3-bbd1-82424ef9d7f2 of session
    1c1faa2a-0d43-4381-b877-2df1d232694c because lastMigratedTargetItem.ItemId
    is null or empty

    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 :
    WorkItemTracking:

    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 :
    WorkItemTracking: WorkItemTracking: Migration is done!

    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Session worker thread [WorkItemTracking] completed</pre>


    <p><strong>Figure: Index was out of range. Must be non-negative and less
    than the size of the collection</strong></p>


    <p>My last and only hope is that in all the development and debugging the I
    broke the TFS Integration Platform install, so I am going to:</p>


    <ol>
      <li>Uninstall TFS Integration Platform </li>

      <li>Clean “C:Program Files (x86)Microsoft Team Foundation Server Integration Tools” of all files </li>

      <li>Check all locations where files are stored after the craziness that is getting the source for the TFS Integration Platform to build </li>
    </ol>


    <p>&#160;</p>


    <p><a
    href="http://blog.hinshelwood.com/files/2011/06/SNAGHTML219c74f.png"><img
    style="background-image: none; border-right-width: 0px; padding-left: 0px;
    padding-right: 0px; display: inline; border-top-width: 0px;
    border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px"
    title="SNAGHTML219c74f" border="0" alt="SNAGHTML219c74f"
    src="http://blog.hinshelwood.com/files/2011/06/SNAGHTML219c74f_thumb.png"
    width="499" height="388" /></a></p>


    <p><strong>Figure: Reinstalling the TFS Integration Platform is thankfully
    quick</strong></p>


    <p>So, that did not help and I am now getting two error messages for the
    data that I am parsing. Both of which are coming from TFS and are realy
    confusing me. The first is a “Index was out of range” error, which is just
    beyond me as I am not even passing any arrays.</p>


    <pre class="brush: ps; ruler: true;">[02/06/2011 21:47:22]
    MigrationConsole.exe Information: 0 : WorkItemTracking: Processing
    ChangeGroup #511, change 3270:1

    [02/06/2011 21:47:22] MigrationConsole.exe Information: 0 :
    WorkItemTracking: WorkItem type 'Bug' does not contain field
    'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be
    skipped.

    [02/06/2011 21:47:22] MigrationConsole.exe Error: 0 : WorkItemTracking:
    System.Web.Services.Protocols.SoapException: Index was out of range. Must be
    non-negative and less than the size of the collection.

    [02/06/2011 21:47:22] Parameter name: index ---&gt; Index was out of range.
    Must be non-negative and less than the size of the collection.

    [02/06/2011 21:47:22] Parameter name: index

    [02/06/2011 21:47:22]    at
    Microsoft.TeamFoundation.WorkItemTracking.Proxy.RetryHandler.HandleSoapException(SoapException
    se)

    [02/06/2011 21:47:22]    at
    Microsoft.TeamFoundation.WorkItemTracking.Proxy.WorkItemServer.Update(String
    requestId, XmlElement package, XmlElement&amp; result,
    MetadataTableHaveEntry[] metadataHave, String&amp; dbStamp,
    IMetadataRowSets&amp; metadata)

    [02/06/2011 21:47:22]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.Tfs2010WorkItemServer.Update(String
    requestId, XmlElement package, XmlElement&amp; result,
    MetadataTableHaveEntry[] metadataHave, String&amp; dbStamp,
    IMetadataRowSets&amp; metadata)

    [02/06/2011 21:47:22]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsBatchUpdateHelper.Submit(Int32
    firstItem, Int32 lastItem)

    [02/06/2011 21:47:23] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Unresolved conflict:

    [02/06/2011 21:47:23]   Session: 583c945a-b2b8-4de3-8090-4a3126506984

    [02/06/2011 21:47:23]   Source: 3e1cfab9-910a-4a92-8c7a-25ff05ac5f48

    [02/06/2011 21:47:23]   Message: Cannot find applicable resolution rule.

    [02/06/2011 21:47:23]   Conflict Type: TFS WIT invalid submission conflict
    type

    [02/06/2011 21:47:23]   Conflict Type Reference Name:
    c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374

    [02/06/2011 21:47:23]   Conflict Details: &lt;?xml
    version=&quot;1.0&quot;?&gt;

    [02/06/2011 21:47:23] &lt;InvalidSubmissionConflictDetails
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;

    [02/06/2011 21:47:23]  
    &lt;ExceptionType&gt;System.Web.Services.Protocols.SoapException&lt;/ExceptionType&gt;

    [02/06/2011 21:47:23]   &lt;ExceptionMessage&gt;Index was out of range. Must
    be non-negative and less than the size of the collection.

    [02/06/2011 21:47:23] Parameter name: index ---&amp;gt; Index was out of
    range. Must be non-negative and less than the size of the collection.

    [02/06/2011 21:47:23] Parameter name: index&lt;/ExceptionMessage&gt;

    [02/06/2011 21:47:23]   &lt;InnerExceptionType /&gt;

    [02/06/2011 21:47:23]   &lt;InnerExceptionMessage /&gt;

    [02/06/2011 21:47:23]   &lt;ActionData /&gt;

    [02/06/2011 21:47:23]   &lt;SourceItemId&gt;3270&lt;/SourceItemId&gt;

    [02/06/2011 21:47:23]  
    &lt;SourceItemRevision&gt;1&lt;/SourceItemRevision&gt;

    [02/06/2011 21:47:23] &lt;/InvalidSubmissionConflictDetails&gt;</pre>


    <p><strong>Figure: Index was out of range. Must be non-negative and less
    than the size of the collection</strong></p>


    <p>The second is a date format exception that I would have thought should be
    taken care of by the Integration Platform and not wait until it gets to
    TFS.</p>


    <pre class="brush: ps; ruler: true;">[02/06/2011 21:47:23]
    MigrationConsole.exe Information: 0 : WorkItemTracking: Processing
    ChangeGroup #512, change 3173:1

    [02/06/2011 21:47:23] MigrationConsole.exe Error: 0 : WorkItemTracking:
    System.FormatException: String was not recognized as a valid DateTime.

    [02/06/2011 21:47:23]    at System.DateTimeParse.Parse(String s,
    DateTimeFormatInfo dtfi, DateTimeStyles styles)

    [02/06/2011 21:47:23]    at System.DateTime.Parse(String s, IFormatProvider
    provider)

    [02/06/2011 21:47:23]    at System.Convert.ToDateTime(String value)

    [02/06/2011 21:47:23]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsUpdateDocument.AddColumn(XmlElement
    cs, String workItemType, String fieldName, String fieldReferenceName, String
    stringVal)

    [02/06/2011 21:47:23]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsUpdateDocument.AddFields(IMigrationAction
    action, String workItemType, String author, String changedTime, Boolean
    insertWorkItem)

    [02/06/2011 21:47:23]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.CreateNewWorkItemOperation(IMigrationAction
    action, ConflictManager conflictMgrService)

    [02/06/2011 21:47:23]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.CreateUpdateOperationDoc(IMigrationAction
    action)

    [02/06/2011 21:47:23]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.SubmitChangesWithUpdateDoc(ChangeGroup
    changeGroup, ConversionResult changeResult, Guid sourceSideSourceId)

    [02/06/2011 21:47:23] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Unresolved conflict:

    [02/06/2011 21:47:23]   Session: 583c945a-b2b8-4de3-8090-4a3126506984

    [02/06/2011 21:47:23]   Source: 3e1cfab9-910a-4a92-8c7a-25ff05ac5f48

    [02/06/2011 21:47:23]   Message: Cannot find applicable resolution rule.

    [02/06/2011 21:47:23]   Conflict Type: TFS WIT invalid submission conflict
    type

    [02/06/2011 21:47:23]   Conflict Type Reference Name:
    c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374

    [02/06/2011 21:47:23]   Conflict Details: &lt;?xml
    version=&quot;1.0&quot;?&gt;

    [02/06/2011 21:47:23] &lt;InvalidSubmissionConflictDetails
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;

    [02/06/2011 21:47:23]  
    &lt;ExceptionType&gt;System.FormatException&lt;/ExceptionType&gt;

    [02/06/2011 21:47:23]   &lt;ExceptionMessage&gt;String was not recognized as
    a valid DateTime.&lt;/ExceptionMessage&gt;

    [02/06/2011 21:47:23]   &lt;InnerExceptionType /&gt;

    [02/06/2011 21:47:23]   &lt;InnerExceptionMessage /&gt;

    [02/06/2011 21:47:23]   &lt;ActionData /&gt;

    [02/06/2011 21:47:23]   &lt;SourceItemId&gt;3173&lt;/SourceItemId&gt;

    [02/06/2011 21:47:23]  
    &lt;SourceItemRevision&gt;1&lt;/SourceItemRevision&gt;

    [02/06/2011 21:47:23] &lt;/InvalidSubmissionConflictDetails&gt;</pre>


    <p><strong>Figure: String was not recognized as a valid
    DateTime</strong></p>


    <p>I have even checked the output that is sent to the TFS web service and I
    can’t see anything that jumps out as a problem…</p>


    <pre class="brush: ps; ruler: true;">&lt;?xml version=&quot;1.0&quot;
    encoding=&quot;utf-8&quot;?&gt;

    &lt;InsertWorkItem ObjectType=&quot;WorkItem&quot;
    BypassRules=&quot;1&quot;&gt;
      &lt;Columns&gt;
        &lt;Column Column=&quot;System.Title&quot;&gt;
          &lt;Value&gt;There is a typing mistake in Product Diagnostic logging status messge&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;Microsoft.VSTS.Common.Priority&quot; Type=&quot;Number&quot;&gt;
          &lt;Value&gt;3&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;System.State&quot;&gt;
          &lt;Value&gt;Proposed&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;Microsoft.VSTS.Common.HowFoundCategory&quot;&gt;
          &lt;Value&gt;Manual Testing&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;Microsoft.VSTS.Common.Severity&quot;&gt;
          &lt;Value&gt;4&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;System.ChangedDate&quot; Type=&quot;DateTime&quot;&gt;
          &lt;Value&gt;2011-02-06T20:34:00&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;Microsoft.VSTS.Common.CreatedDate&quot; Type=&quot;DateTime&quot;&gt;
          &lt;Value&gt;2011-02-06T20:34:00&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;System.AssignedTo&quot;&gt;
          &lt;Value&gt;Hinshelwood, Martin; Borg, Steven&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;System.AreaId&quot; Type=&quot;Number&quot;&gt;
          &lt;Value&gt;108&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;System.IterationId&quot; Type=&quot;Number&quot;&gt;
          &lt;Value&gt;212&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;System.WorkItemType&quot;&gt;
          &lt;Value&gt;Bug&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;System.CreatedDate&quot; Type=&quot;ServerDateTime&quot;&gt;
          &lt;Value&gt;&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;System.CreatedBy&quot;&gt;
          &lt;Value&gt;Hinshelwood, Martin&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;System.ChangedBy&quot;&gt;
          &lt;Value&gt;Hinshelwood, Martin&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column Column=&quot;System.Reason&quot;&gt;
          &lt;Value&gt;Unknown&lt;/Value&gt;
        &lt;/Column&gt;
      &lt;/Columns&gt;
      &lt;InsertText FieldName=&quot;System.Description&quot; FieldDisplayName=&quot;Description&quot;&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam at massa sem. Sed elementum, nisl sed bibendum consequat, justo libero sodales elit, a vehicula orci lorem et dui. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum sit amet metus orci. Aenean vulputate condimentum lectus, vel vulputate sem aliquam quis.‏&lt;/InsertText&gt;
      &lt;InsertText FieldName=&quot;Microsoft.VSTS.TCM.ReproSteps&quot; FieldDisplayName=&quot;Repro Steps&quot;&gt;Nullam in risus sed diam tincidunt fermentum sit amet non enim. Vestibulum tempus nibh eget nulla viverra iaculis. In a dolor ligula. Sed eget sem tellus, in tempor nisi. Maecenas venenatis cursus eros id rutrum. Nulla tristique, lectus a imperdiet vehicula, metus sapien mattis urna, a bibendum ligula nunc et nibh. Curabitur adipiscing hendrerit odio vel ornare.‏&lt;/InsertText&gt;
      &lt;InsertText FieldName=&quot;System.History&quot; FieldDisplayName=&quot;History&quot;&gt;
        &amp;lt;p&amp;gt;This is a dump of the original TTP data&amp;lt;/p&amp;gt;
        &amp;lt;p&amp;gt;Imported by http://nwcadence.com&amp;lt;/p&amp;gt;

        &amp;lt;p&amp;gt;(TFS Integration from 'TestTrackPro source' Id: 3280 (rev 1);)&amp;lt;/p&amp;gt;
      &lt;/InsertText&gt;
    &lt;/InsertWorkItem&gt;</pre>


    <p>
      <br />In order to find out what is happening with the data (ChangeGroups) you can run the following query against your tfs_IntegrationPlatform database: 

      <br /></p>

    <pre class="brush: sql; ruler: true;">SELECT grp.Name
        ,grp.Status
        ,[ChangeActionId]
        ,[ActionId]
        ,[SourceItem]
        ,[FromPath]
        ,[Version]
        ,[ActionData]
        ,[Backlogged]
    FROM [Tfs_IntegrationPlatform].[dbo].[RUNTIME_CHANGE_ACTION] as act

    JOIN [Tfs_IntegrationPlatform].[dbo].[RUNTIME_CHANGE_GROUPS] as grp on
    act.ChangeGroupId = grp.Id

    WHERE grp.Id = '3251' or grp.Id = '3255'</pre>


    <p>&#160;</p>


    <p>This will show you the actual data that is stored in the middle tier and
    allow you to maybe debug it. The result?</p>


    <pre class="brush: xml; ruler: true;">&lt;WorkItemChanges
    Revision=&quot;1&quot; WorkItemType=&quot;Bug&quot;
    Author=&quot;Hinshelwood, Martin&quot; ChangeDate=&quot;02/06/2011
    13:03:00&quot; WorkItemID=&quot;3268&quot;&gt;
      &lt;Columns&gt;
        &lt;Column DisplayName=&quot;Summary&quot; ReferenceName=&quot;System.Title&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;Some long text&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column DisplayName=&quot;Priority&quot; ReferenceName=&quot;Microsoft.VSTS.Common.Priority&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;1&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column DisplayName=&quot;Status&quot; ReferenceName=&quot;System.State&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;Proposed&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column DisplayName=&quot;Found by&quot; ReferenceName=&quot;Microsoft.VSTS.Common.HowFoundCategory&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;Manual Testing&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column DisplayName=&quot;Severity&quot; ReferenceName=&quot;Microsoft.VSTS.Common.Severity&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;1&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column DisplayName=&quot;Date Modified&quot; ReferenceName=&quot;System.ChangedDate&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;6/2/2011 1:03 PM&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column DisplayName=&quot;Date Created&quot; ReferenceName=&quot;Microsoft.VSTS.Common.CreatedDate&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;6/1/2011 11:38 AM&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column DisplayName=&quot;Description&quot; ReferenceName=&quot;System.Description&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;Some long text&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column DisplayName=&quot;Steps to Reproduce&quot; ReferenceName=&quot;Microsoft.VSTS.TCM.ReproSteps&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;Some long text&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column DisplayName=&quot;Assigned To User&quot; ReferenceName=&quot;System.AssignedTo&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;Dann, Ron&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column DisplayName=&quot;History&quot; ReferenceName=&quot;System.History&quot; Type=&quot;String&quot;&gt;
          &lt;Value&gt;Long histry that has been trunkated...
    &lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column ReferenceName=&quot;System.AreaPath&quot; Type=&quot;&quot; DisplayName=&quot;&quot;&gt;
          &lt;Value&gt;TestTrackProImportGlobalizationReporting&lt;/Value&gt;
        &lt;/Column&gt;
        &lt;Column ReferenceName=&quot;System.IterationPath&quot; Type=&quot;&quot; DisplayName=&quot;&quot;&gt;
          &lt;Value&gt;TestTrackProImportProduct 2.5&lt;/Value&gt;
        &lt;/Column&gt;
      &lt;/Columns&gt;
    &lt;/WorkItemChanges&gt;</pre>


    <p>&#160;</p>


    <p>This data is what is actually produced as a change to be saved to TFS. I
    am a little concerned that the dates are in a variety of formats, but it was
    one of the ones that resulted in the “index” error:</p>


    <pre class="brush: ps; ruler: true;">[02/06/2011 21:47:22]
    MigrationConsole.exe Error: 0 : WorkItemTracking:
    System.Web.Services.Protocols.SoapException: Index was out of range. Must be
    non-negative and less than the size of the collection.

    [02/06/2011 21:47:22] Parameter name: index ---&gt; Index was out of range.
    Must be non-negative and less than the size of the collection.

    [02/06/2011 21:47:22] Parameter name: index

    [02/06/2011 21:47:22]    at
    Microsoft.TeamFoundation.WorkItemTracking.Proxy.RetryHandler.HandleSoapException(SoapException
    se)

    [02/06/2011 21:47:22]    at
    Microsoft.TeamFoundation.WorkItemTracking.Proxy.WorkItemServer.Update(String
    requestId, XmlElement package, XmlElement&amp; result,
    MetadataTableHaveEntry[] metadataHave, String&amp; dbStamp,
    IMetadataRowSets&amp; metadata)

    [02/06/2011 21:47:22]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.Tfs2010WorkItemServer.Update(String
    requestId, XmlElement package, XmlElement&amp; result,
    MetadataTableHaveEntry[] metadataHave, String&amp; dbStamp,
    IMetadataRowSets&amp; metadata)

    [02/06/2011 21:47:22]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsBatchUpdateHelper.Submit(Int32
    firstItem, Int32 lastItem)

    [02/06/2011 21:47:22] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Unresolved conflict:

    [02/06/2011 21:47:22]   Session: 583c945a-b2b8-4de3-8090-4a3126506984

    [02/06/2011 21:47:22]   Source: 3e1cfab9-910a-4a92-8c7a-25ff05ac5f48

    [02/06/2011 21:47:22]   Message: Cannot find applicable resolution rule.

    [02/06/2011 21:47:22]   Conflict Type: TFS WIT invalid submission conflict
    type

    [02/06/2011 21:47:22]   Conflict Type Reference Name:
    c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374

    [02/06/2011 21:47:22]   Conflict Details: &lt;?xml
    version=&quot;1.0&quot;?&gt;

    [02/06/2011 21:47:22] &lt;InvalidSubmissionConflictDetails
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;

    [02/06/2011 21:47:22]  
    &lt;ExceptionType&gt;System.Web.Services.Protocols.SoapException&lt;/ExceptionType&gt;

    [02/06/2011 21:47:22]   &lt;ExceptionMessage&gt;Index was out of range. Must
    be non-negative and less than the size of the collection.

    [02/06/2011 21:47:22] Parameter name: index ---&amp;gt; Index was out of
    range. Must be non-negative and less than the size of the collection.

    [02/06/2011 21:47:22] Parameter name: index&lt;/ExceptionMessage&gt;

    [02/06/2011 21:47:22]   &lt;InnerExceptionType /&gt;

    [02/06/2011 21:47:22]   &lt;InnerExceptionMessage /&gt;

    [02/06/2011 21:47:22]   &lt;ActionData /&gt;

    [02/06/2011 21:47:22]   &lt;SourceItemId&gt;3268&lt;/SourceItemId&gt;

    [02/06/2011 21:47:22]  
    &lt;SourceItemRevision&gt;1&lt;/SourceItemRevision&gt;

    [02/06/2011 21:47:22] &lt;/InvalidSubmissionConflictDetails&gt;</pre>


    <p>
      <br />Hopefully someone on the team will be able to help me out, but so far I have not been able to get this running…</p>

    <p>On an whim I decided that the Dates might be&#160; the problem all along
    and that the “Index was out of range” issue was a red hearing. So I
    commented out all of the date fields in the configuration file and what do
    you know… the “Index was out of range” errors went way…</p>


    <p>So I dutifully check all of the date input and redo it so that everything
    is in the correct time zone and that </p>


    <p>&#160;</p>


    <pre class="brush: vb; ruler: true;">Dim d As Date

    If DateTime.TryParseExact(record.row(i).value, &quot;g&quot;, dateProvider,
    DateTimeStyles.None, d) Then

    ' TODO: Timezone should not be hard coded

    d = TimeZoneInfo.ConvertTimeToUtc(d,
    TimeZoneInfo.FindSystemTimeZoneById(&quot;Eastern Standard Time&quot;))

    ' This is a date but lets get some specific values

    Select Case atc(i).name
        Case &quot;Date Modified&quot;
            newMigIt.ModifiedOn = d
        Case &quot;Date Created&quot;
            newMigIt.CreatedOn = d
    End Select

    ' Then add it to columns

    newMigIt.Columns.Add(atc(i).name, d.ToString(&quot;o&quot;)) ' TODO: Output
    format needs to be good</pre>


    <p><strong>Figure: Refactored code to process the dates to the correct
    timezone</strong></p>


    <p>This did nothing! What I eventually had to do was to remove that mapping
    from the file. So no dates…</p>


    <pre class="brush: vb; ruler: true;">&lt;MappedFields&gt;
      &lt;MappedField LeftName=&quot;Summary&quot; RightName=&quot;System.Title&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;&quot; /&gt;
      &lt;MappedField LeftName=&quot;Description&quot; RightName=&quot;System.Description&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;&quot; /&gt;
      &lt;MappedField LeftName=&quot;Severity&quot; RightName=&quot;Microsoft.VSTS.Common.Severity&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;SeverityMapTTP2TFS&quot; /&gt;
      &lt;MappedField LeftName=&quot;Status&quot; RightName=&quot;System.State&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;StatusMapTTP2TFS&quot; /&gt;
      &lt;MappedField LeftName=&quot;Reason&quot; RightName=&quot;System.Reason&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;ReasonMapTTP2TFS&quot; /&gt;
      &lt;MappedField LeftName=&quot;Priority&quot; RightName=&quot;Microsoft.VSTS.Common.Priority&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;PriorityMapTTP2TFS&quot; /&gt;
      &lt;MappedField LeftName=&quot;Steps to Reproduce&quot; RightName=&quot;Microsoft.VSTS.TCM.ReproSteps&quot; MapFromSide=&quot;Left&quot; /&gt;
      &lt;MappedField LeftName=&quot;History&quot; RightName=&quot;System.History&quot; MapFromSide=&quot;Left&quot; /&gt;
      &lt;MappedField LeftName=&quot;Assigned To User&quot; RightName=&quot;System.AssignedTo&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;UserMapTTP2TFS&quot; /&gt;
      &lt;MappedField LeftName=&quot;Verify Version&quot; RightName=&quot;Microsoft.VSTS.Build.FoundIn&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;VerifyVersionMapTTP2TFS&quot; /&gt;
      &lt;MappedField LeftName=&quot;Closed By&quot; RightName=&quot;System.ClosedBy&quot; MapFromSide=&quot;Left&quot; /&gt;
      &lt;MappedField LeftName=&quot;Found by&quot; RightName=&quot;Microsoft.VSTS.Common.HowFoundCategory&quot; MapFromSide=&quot;Left&quot;  valueMap=&quot;HowFoundCategoryTFS&quot; /&gt;
      &lt;!--&lt;MappedField LeftName=&quot;Date Modified&quot; RightName=&quot;System.ChangedDate&quot; MapFromSide=&quot;Left&quot; /&gt;--&gt;
      &lt;!--&lt;MappedField LeftName=&quot;Date Created&quot; RightName=&quot;Microsoft.VSTS.Common.CreatedDate&quot; MapFromSide=&quot;Left&quot;  /&gt;--&gt;
      &lt;!--&lt;MappedField LeftName=&quot;Closed Date&quot; RightName=&quot;System.ClosedDate&quot; MapFromSide=&quot;Left&quot; /&gt;--&gt;
      &lt;!-- WORKAROUND using unused field: Manual Testing --&gt;
      &lt;!--
      &lt;MappedField LeftName=&quot;@@MISSINGFIELD@@&quot; RightName=&quot;Microsoft.VSTS.Common.Triage&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;TfsTriageMapping&quot; /&gt;
      &lt;MappedField LeftName=&quot;@@MISSINGFIELD@@&quot; RightName=&quot;Microsoft.VSTS.Common.Regression&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;TfsRegressionMapping&quot; /&gt;
      &lt;MappedField LeftName=&quot;@@MISSINGFIELD@@&quot; RightName=&quot;Microsoft.VSTS.Build.Changelist&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;TfsChangelistMapping&quot; /&gt;
      &lt;MappedField LeftName=&quot;Modified By&quot; RightName=&quot;System.ChangedBy&quot; MapFromSide=&quot;Left&quot; /&gt;
      &lt;MappedField LeftName=&quot;Created By&quot; RightName=&quot;System.CreatedBy&quot; MapFromSide=&quot;Left&quot; valueMap=&quot;&quot; /&gt;
      --&gt;
    &lt;/MappedFields&gt;</pre>


    <p><strong>Figure: New mapping for Bugs</strong></p>


    <p>There are a number of things to note on the new mapping. After removing
    all of the Date fields I found that due to coning changes in the Adapter to
    achieve the “on behalf of” capability I have to remove both the “Modified
    By” and the “Created By” fields from the mapping otherwise I get a TF223001
    error during the mapping.</p>


    <p><a href="http://blog.hinshelwood.com/files/2011/06/image2.png"><img
    style="background-image: none; border-right-width: 0px; margin: 0px;
    padding-left: 0px; padding-right: 0px; display: inline; border-top-width:
    0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px"
    title="image" border="0" alt="image"
    src="http://blog.hinshelwood.com/files/2011/06/image_thumb2.png" width="380"
    height="218" /></a> 

      <br /><strong>Figure: Editing on behalf of</strong></p>

    <p>During the production run the “Created by [account]” will be the service
    account that Team Foundation Server runs under so it will be a little
    cleaner than having my name plastered all over it. Although it is OK to have
    the company name there <img style="border-bottom-style: none;
    border-left-style: none; border-top-style: none; border-right-style: none"
    class="wlEmoticon wlEmoticon-winkingsmile" alt="Winking smile"
    src="http://blog.hinshelwood.com/files/2011/06/wlEmoticon-winkingsmile.png"
    /></p>


    <pre class="brush: vb; ruler: true;">[03/06/2011 16:57:12]
    MigrationConsole.exe Information: 0 : WorkItemTracking: Processing
    ChangeGroup #1003, change 3206:1 

    [03/06/2011 16:57:13] MigrationConsole.exe Information: 0 :
    WorkItemTracking: WorkItem type 'Bug' does not contain field
    'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be
    skipped. 

    [03/06/2011 16:57:13] MigrationConsole.exe Error: 0 : WorkItemTracking:
    System.Web.Services.Protocols.SoapException: TF223001: The update package
    contains more than one entry that sets the value of field System.ChangedBy
    for work item 1391. ---&gt; TF223001: The update package contains more than
    one entry that sets the value of field System.ChangedBy for work item 1391. 

    [03/06/2011 16:57:13]    at
    Microsoft.TeamFoundation.WorkItemTracking.Proxy.RetryHandler.HandleSoapException(SoapException
    se) 

    [03/06/2011 16:57:13]    at
    Microsoft.TeamFoundation.WorkItemTracking.Proxy.WorkItemServer.Update(String
    requestId, XmlElement package, XmlElement&amp; result,
    MetadataTableHaveEntry[] metadataHave, String&amp; dbStamp,
    IMetadataRowSets&amp; metadata) 

    [03/06/2011 16:57:13]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.Tfs2010WorkItemServer.Update(String
    requestId, XmlElement package, XmlElement&amp; result,
    MetadataTableHaveEntry[] metadataHave, String&amp; dbStamp,
    IMetadataRowSets&amp; metadata) 

    [03/06/2011 16:57:13]    at
    Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsBatchUpdateHelper.Submit(Int32
    firstItem, Int32 lastItem) 

    [03/06/2011 16:57:13] MigrationConsole.exe Information: 0 :
    WorkItemTracking: Unresolved conflict:  

    [03/06/2011 16:57:13]   Session: adea805d-51df-489a-b2fd-9717b4af3703 

    [03/06/2011 16:57:13]   Source: 6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857 

    [03/06/2011 16:57:13]   Message: Cannot find applicable resolution rule. 

    [03/06/2011 16:57:13]   Conflict Type: TFS WIT invalid submission conflict
    type 

    [03/06/2011 16:57:13]   Conflict Type Reference Name:
    c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374 

    [03/06/2011 16:57:13]   Conflict Details: &lt;?xml
    version=&quot;1.0&quot;?&gt; 

    [03/06/2011 16:57:13] &lt;InvalidSubmissionConflictDetails
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt; 

    [03/06/2011 16:57:13]  
    &lt;ExceptionType&gt;System.Web.Services.Protocols.SoapException&lt;/ExceptionType&gt; 

    [03/06/2011 16:57:13]   &lt;ExceptionMessage&gt;TF223001: The update package
    contains more than one entry that sets the value of field System.ChangedBy
    for work item 1391. ---&amp;gt; TF223001: The update package contains more
    than one entry that sets the value of field System.ChangedBy for work item
    1391.&lt;/ExceptionMessage&gt; 

    [03/06/2011 16:57:13]   &lt;InnerExceptionType /&gt; 

    [03/06/2011 16:57:13]   &lt;InnerExceptionMessage /&gt; 

    [03/06/2011 16:57:13]   &lt;ActionData /&gt; 

    [03/06/2011 16:57:13]   &lt;SourceItemId&gt;3206&lt;/SourceItemId&gt; 

    [03/06/2011 16:57:13]  
    &lt;SourceItemRevision&gt;1&lt;/SourceItemRevision&gt; 

    [03/06/2011 16:57:13] &lt;/InvalidSubmissionConflictDetails&gt; </pre>


    <p><strong>Figure: When there are duplicate entries you get a
    TF223001</strong></p>


    <p>Once I got rid of the duplicate mappings I started getting data through
    and I can now get back to the route problem of “Edit” now that “Add” is
    working again.</p>


    <p>Woot…</p>
  - ''
  post_id: '3408'
  post_date: '2011-06-02 04:25:32'
  post_date_gmt: '2011-06-02 11:25:32'
  post_modified: '2011-06-02 04:25:32'
  post_modified_gmt: '2011-06-02 11:25:32'
  comment_status: open
  ping_status: open
  post_name: >-
    creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history
  status: publish
  post_parent: '0'
  menu_order: '0'
  post_type: post
  post_password: ''
  is_sticky: '0'
  category: {}
  postmeta:
  - meta_key: authorsure_include_css
    meta_value: ''
  - meta_key: _edit_last
    meta_value: '3'
  - meta_key: dsq_thread_id
    meta_value: '320923002'
  - meta_key: robotsmeta
    meta_value: index,follow
  - meta_key: _flattr_post_language
    meta_value: ''
  - meta_key: _flattr_post_category
    meta_value: ''
  - meta_key: _flattr_post_hidden
    meta_value: ''
  - meta_key: _flattr_btn_disabled
    meta_value: ''
  - meta_key: _thumbnail_id
    meta_value: '8621'
  - meta_key: _wpbitly
    meta_value: http://nkdalm.net/1dL7VaD
  - meta_key: _jetpack_related_posts_cache
    meta_value: >-
      a:1:{s:32:"8f6677c9d6b0f903e98ad32ec61f8deb";a:2:{s:7:"expires";i:1474729300;s:7:"payload";a:3:{i:0;a:1:{s:2:"id";i:3460;}i:1;a:1:{s:2:"id";i:3606;}i:2;a:1:{s:2:"id";i:6202;}}}}
  - meta_key: _wpghs_github_path
    meta_value: >-
      _posts/2011-06-02-creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history.md
  - meta_key: _sha
    meta_value: ''
  - meta_key: _wpml_media_has_media
    meta_value: '1'
  - meta_key: _tribe_ticket_capacity
    meta_value: '0'
  - meta_key: _tribe_ticket_version
    meta_value: 4.12.1.2
  - meta_key: ekit_post_views_count
    meta_value: '926'
  comment:
  - comment_id: '1006'
    comment_author: >-
      What do you do with a Work Item History Not Found Conflict Type Details |
      Visual Studio ALM
    comment_author_email: ''
    comment_author_url: >-
      http://blog.hinshelwood.com/what-do-you-do-with-a-work-item-history-not-found-conflict-type-details/
    comment_author_IP: 184.168.230.128
    comment_date: '2011-06-03 17:51:08'
    comment_date_gmt: '2011-06-04 00:51:08'
    comment_content: >-
      [...] About      &laquo; Creating a WIT Adapter for the TFS Integration
      Platform for a source with no history [...]
    comment_approved: '1'
    comment_type: pingback
    comment_parent: '0'
    comment_user_id: '0'
    commentmeta:
    - meta_key: akismet_result
      meta_value: 'false'
    - meta_key: akismet_history
      meta_value: >-
        a:4:{s:4:"time";s:15:"1307148668.3189";s:7:"message";s:28:"Akismet
        cleared this comment";s:5:"event";s:9:"check-ham";s:4:"user";s:0:"";}
    - meta_key: akismet_history
      meta_value: >-
        a:4:{s:4:"time";s:14:"1307151491.595";s:7:"message";s:46:"MrHinsh
        changed the comment status to
        approved";s:5:"event";s:15:"status-approved";s:4:"user";s:7:"MrHinsh";}
  - comment_id: '1007'
    comment_author: >-
      A working Test Track Pro Adapter for the TFS Integration Platform | Visual
      Studio ALM
    comment_author_email: ''
    comment_author_url: >-
      http://blog.hinshelwood.com/a-working-test-track-pro-adapter-for-the-tfs-integration-platform/
    comment_author_IP: 184.168.230.128
    comment_date: '2011-06-06 07:24:23'
    comment_date_gmt: '2011-06-06 14:24:23'
    comment_content: >-
      [...] it has been a long road from misery to hope with a little disbelief
      thrown in for good measure, but I finally have a working Adapter [...]
    comment_approved: '1'
    comment_type: pingback
    comment_parent: '0'
    comment_user_id: '0'
    commentmeta:
    - meta_key: akismet_result
      meta_value: 'false'
    - meta_key: akismet_history
      meta_value: >-
        a:4:{s:4:"time";s:15:"1307370263.7251";s:7:"message";s:28:"Akismet
        cleared this comment";s:5:"event";s:9:"check-ham";s:4:"user";s:0:"";}
    - meta_key: akismet_history
      meta_value: >-
        a:4:{s:4:"time";s:15:"1307371463.1343";s:7:"message";s:46:"MrHinsh
        changed the comment status to
        approved";s:5:"event";s:15:"status-approved";s:4:"user";s:7:"MrHinsh";}
  - comment_id: '1008'
    comment_author: 'TOC: TFS Integration Tools - Willy&#039;s Cave - Site Home - MSDN Blogs'
    comment_author_email: ''
    comment_author_url: >-
      http://blogs.msdn.com/b/willy-peter_schaub/archive/2011/06/06/toc-tfs-integration-tools.aspx
    comment_author_IP: 65.52.96.176
    comment_date: '2011-06-06 14:14:06'
    comment_date_gmt: '2011-06-06 21:14:06'
    comment_content: >-
      [...] Creating a WIT Adapter for the TFS Integration Platform for a source
      with no history [...]
    comment_approved: '1'
    comment_type: pingback
    comment_parent: '0'
    comment_user_id: '0'
    commentmeta:
      meta_key: akismet_history
      meta_value: >-
        a:4:{s:4:"time";s:15:"1307394885.7686";s:7:"message";s:46:"MrHinsh
        changed the comment status to
        approved";s:5:"event";s:15:"status-approved";s:4:"user";s:7:"MrHinsh";}
  - comment_id: '1009'
    comment_author: >-
      TOC: TFS Integration Tools Blog Posts and Reference Sites - Willy&#039;s
      Cave - Site Home - MSDN Blogs
    comment_author_email: ''
    comment_author_url: >-
      http://blogs.msdn.com/b/willy-peter_schaub/archive/2011/06/06/toc-tfs-integration-tools-blog-posts-and-reference-sites.aspx
    comment_author_IP: 65.55.59.10
    comment_date: '2012-03-19 17:32:28'
    comment_date_gmt: '2012-03-20 00:32:28'
    comment_content: >-
      [...] Creating a WIT Adapter for the TFS Integration Platform for a source
      with no history [...]
    comment_approved: '1'
    comment_type: pingback
    comment_parent: '0'
    comment_user_id: '0'
    commentmeta:
      meta_key: akismet_history
      meta_value: >-
        a:4:{s:4:"time";s:13:"1332271206.45";s:7:"message";s:46:"MrHinsh changed
        the comment status to
        approved";s:5:"event";s:15:"status-approved";s:4:"user";s:7:"MrHinsh";}
  - comment_id: '1010'
    comment_author: >-
      TFS Integration Tools - Issue: TFS WIT invalid submission conflict type -
      Visual Studio ALM from Martin Hinshelwood
    comment_author_email: ''
    comment_author_url: >-
      http://blog.hinshelwood.com/tfs-integration-tools-issue-tfs-wit-invalid-submission-conflict-type/
    comment_author_IP: 96.126.104.162
    comment_date: '2012-09-18 09:41:24'
    comment_date_gmt: '2012-09-18 16:41:24'
    comment_content: >-
      [...] this immediately looks like a problem with the configuration and can
      indeed be related to a configuration or date conversation issue if you
      have just installed the TFS Integration Tools there may be a simpler [...]
    comment_approved: '1'
    comment_type: pingback
    comment_parent: '0'
    comment_user_id: '0'
    commentmeta:
    - meta_key: akismet_result
      meta_value: 'false'
    - meta_key: akismet_history
      meta_value: >-
        a:4:{s:4:"time";s:13:"1347986484.21";s:7:"message";s:28:"Akismet cleared
        this comment";s:5:"event";s:9:"check-ham";s:4:"user";s:0:"";}
    - meta_key: akismet_history
      meta_value: >-
        a:4:{s:4:"time";s:12:"1347987325.1";s:7:"message";s:46:"MrHinsh changed
        the comment status to
        approved";s:5:"event";s:15:"status-approved";s:4:"user";s:7:"MrHinsh";}
  - comment_id: '1011'
    comment_author: >-
      TOC: TFS Integration Tools Blog Posts and Reference Sites - Willy&#039;s
      Reflections - Site Home - MSDN Blogs
    comment_author_email: ''
    comment_author_url: >-
      http://blogs.msdn.com/b/willy-peter_schaub/archive/2012/03/20/toc-tfs-integration-tools-blog-posts-and-reference-sites.aspx
    comment_author_IP: 65.55.57.72
    comment_date: '2012-11-07 11:08:09'
    comment_date_gmt: '2012-11-07 19:08:09'
    comment_content: >-
      [...] Creating a WIT Adapter for the TFS Integration Platform for a source
      with no history [...]
    comment_approved: '1'
    comment_type: pingback
    comment_parent: '0'
    comment_user_id: '0'
    commentmeta:
      meta_key: akismet_history
      meta_value: >-
        a:4:{s:4:"time";s:13:"1352419311.88";s:7:"message";s:46:"MrHinsh changed
        the comment status to
        approved";s:5:"event";s:15:"status-approved";s:4:"user";s:7:"MrHinsh";}
  - comment_id: '3189'
    comment_author: Paul Abrams
    comment_author_email: john.paul.abrams@gmail.com
    comment_author_url: ''
    comment_author_IP: 99.240.210.106
    comment_date: '2014-08-13 17:23:00'
    comment_date_gmt: '2014-08-13 16:23:00'
    comment_content: Huh?
    comment_approved: '1'
    comment_type: comment
    comment_parent: '0'
    comment_user_id: '0'
    commentmeta:
    - meta_key: dsq_parent_post_id
      meta_value: ''
    - meta_key: dsq_post_id
      meta_value: '1540926101'
