post:
  title: TFS Event Handler prototype Configuration Demystified
  link: >-
    https://nkdagility.com/blog/tfs-event-handler-prototype-configuration-demystified/
  pubDate: Mon, 18 Jun 2007 14:05:37 +0000
  creator: MrHinsh
  guid:
    _: >-
      http://geekswithblogs.net/hinshelm/archive/2007/06/18/tfs-event-handler-prototype-configuration-demystified.aspx
    $:
      isPermaLink: 'false'
  description: ''
  encoded:
  - "There are a number of config options for the <a rel=\"tag\" href=\"http://www.codeplex.com/TFSEventHandler/Release/ProjectReleases.aspx?ReleaseId=5057\" target=\"_blank\">TFS Event Handler Prototype</a>. I will describe all of them in depth here. The first step is to set the <a title=\"Windows Communication Foundation\" href=\"http://wcf.netfx3.com\" target=\"_blank\">Windows Communication Foundation</a> service options, which really only requires you to change one value.\n<pre class=\"code\"><span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #a31515;\">system.serviceModel</span><span style=\"color: #0000ff;\">&gt;         &lt;</span><span style=\"color: #a31515;\">services</span><span style=\"color: #0000ff;\">&gt;             &lt;</span><span style=\"color: #a31515;\">service</span><span style=\"color: #0000ff;\"> </span><span style=\"color: #ff0000;\">name</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\"><a title=\"RDdotNet - Reality Dysfunction .NET\" href=\"http://www.rddotnet.com\" target=\"_blank\">RDdotNet</a>.TeamFoundation.NotificationService</span>\"<span style=\"color: #0000ff;\">&gt;                 &lt;</span><span style=\"color: #a31515;\">endpoint</span><span style=\"color: #0000ff;\"> </span><span style=\"color: #ff0000;\">address</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">http://[LocalMacheneName]:8677</span>\"<span style=\"color: #0000ff;\"> </span><span style=\"color: #ff0000;\">binding</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">basicHttpBinding</span>\"\n<span style=\"color: #0000ff;\">                    </span><span style=\"color: #ff0000;\">bindingConfiguration</span><span style=\"color: #0000ff;\">=</span>\"\"<span style=\"color: #0000ff;\"> </span><span style=\"color: #ff0000;\">contract</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\"><a title=\"RDdotNet - Reality Dysfunction .NET\" href=\"http://www.rddotnet.com\" target=\"_blank\">RDdotNet</a>.TeamFoundation.INotificationService</span>\"<span style=\"color: #0000ff;\"> /&gt;             &lt;/</span><span style=\"color: #a31515;\">service</span><span style=\"color: #0000ff;\">&gt;         &lt;/</span><span style=\"color: #a31515;\">services</span><span style=\"color: #0000ff;\">&gt;     &lt;/</span><span style=\"color: #a31515;\">system.serviceModel</span><span style=\"color: #0000ff;\">&gt;</span></pre>\n&nbsp;\n\nThe important one is the\_[LocalMacheneName] variable, which should be set to the local machine name, or the domain name that points to your computer if you have a crazy proxy.\n\nThe next step is to set the real options for this software. This starts with the\_<span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #a31515;\"><a title=\"RDdotNet - Reality Dysfunction .NET\" href=\"http://www.rddotnet.com\" target=\"_blank\">RDdotNet</a>.TeamFoundation</span><span style=\"color: #0000ff;\">&gt;</span> options and requires you to set a number of things.\n<pre class=\"code\"><span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #a31515;\">BaseAddress</span><span style=\"color: #0000ff;\"> </span><span style=\"color: #ff0000;\">url</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">http://[LocalMacheneName]:3624/</span>\"<span style=\"color: #0000ff;\"> /&gt;</span></pre>\nAgain you need to set the machine name, but make sure that the port is different.\n<pre class=\"code\"><span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #a31515;\">TeamServers</span><span style=\"color: #0000ff;\">&gt;             &lt;</span><span style=\"color: #a31515;\">TeamServer</span><span style=\"color: #0000ff;\"> </span><span style=\"color: #ff0000;\">name</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">[TFS Server Name]</span>\"\n<span style=\"color: #0000ff;\">                        </span><span style=\"color: #ff0000;\">url</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">http://[TFS Server Name]:8080/</span>\"\n<span style=\"color: #0000ff;\">                        </span><span style=\"color: #ff0000;\">subscriber</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">[Subscriber AD Account]</span>\"\n<span style=\"color: #0000ff;\">                        </span><span style=\"color: #ff0000;\">mailAddressFrom</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">[From Email Address]</span>\"\n<span style=\"color: #0000ff;\">                        </span><span style=\"color: #ff0000;\">mailFromName</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">[Form name]</span>\"\n<span style=\"color: #0000ff;\">                        </span><span style=\"color: #ff0000;\">mailServer</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">[email relay server]</span>\"\n<span style=\"color: #0000ff;\">                        </span><span style=\"color: #ff0000;\">logEvents</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">True</span>\"\n<span style=\"color: #0000ff;\">                        </span><span style=\"color: #ff0000;\">testMode</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">True</span>\"\n<span style=\"color: #0000ff;\">                        </span><span style=\"color: #ff0000;\">testEmail</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">[email to send testes to]</span>\"\n<span style=\"color: #0000ff;\">                        </span><span style=\"color: #ff0000;\">eventLogPath</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">C:tempTFSEventHandler</span>\"<span style=\"color: #0000ff;\">&gt;             &lt;/</span><span style=\"color: #a31515;\">TeamServer</span><span style=\"color: #0000ff;\">&gt;         &lt;/</span><span style=\"color: #a31515;\">TeamServers</span><span style=\"color: #0000ff;\">&gt;</span></pre>\n&nbsp;\n\nIn the Team Servers section you need to list all of the team servers that you are going to be handling events for. The system will automatically add the event subscriptions for all team servers added here, but I have only tested with two and I now always run the service on the <a title=\"Team Foundation Server\" href=\"http://msdn2.microsoft.com/en-us/teamsystem/aa718934.aspx\" target=\"_blank\">TFS</a> server.\n\n<span style=\"color: #a31515;\">TeamServer</span><span style=\"color: #0000ff;\"> </span>Options\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"2\" width=\"577\">\n<tbody>\n<tr>\n<td width=\"138\" valign=\"top\"><strong>Name</strong></td>\n<td width=\"144\" valign=\"top\"><strong>Type</strong></td>\n<td width=\"293\" valign=\"top\"><strong>Description</strong></td>\n</tr>\n<tr>\n<td width=\"141\" valign=\"top\">name</td>\n<td width=\"145\" valign=\"top\">System.String</td>\n<td width=\"291\" valign=\"top\">This should be a friendly name for the team foundation server</td>\n</tr>\n<tr>\n<td width=\"142\" valign=\"top\">url</td>\n<td width=\"145\" valign=\"top\">System.Uri</td>\n<td width=\"290\" valign=\"top\">The URI for the TFS server you wish to connect to including protocol and port.</td>\n</tr>\n<tr>\n<td width=\"144\" valign=\"top\">mailFromAddress</td>\n<td width=\"145\" valign=\"top\">System.String</td>\n<td width=\"289\" valign=\"top\">The address from which you want all emails sent by the system to say that they are sent.</td>\n</tr>\n<tr>\n<td width=\"145\" valign=\"top\">mailFromName</td>\n<td width=\"145\" valign=\"top\">System.String</td>\n<td width=\"288\" valign=\"top\">The display name of the from\_email address</td>\n</tr>\n<tr>\n<td width=\"146\" valign=\"top\">mailServer</td>\n<td width=\"145\" valign=\"top\">System.String</td>\n<td width=\"287\" valign=\"top\">The mail server that you have permission for to send emails</td>\n</tr>\n<tr>\n<td width=\"147\" valign=\"top\">logEvents</td>\n<td width=\"145\" valign=\"top\">System.Boolean</td>\n<td width=\"287\" valign=\"top\">A true or false value that enables logging of all events within that system. Excellent for debugging...</td>\n</tr>\n<tr>\n<td width=\"147\" valign=\"top\">testMode</td>\n<td width=\"145\" valign=\"top\">System.Boolean</td>\n<td width=\"287\" valign=\"top\">When in test mode all emails sent by the system will only be sent to email address defined by testEmail. Set to false for production.</td>\n</tr>\n<tr>\n<td width=\"147\" valign=\"top\">testEmail</td>\n<td width=\"145\" valign=\"top\">System.String</td>\n<td width=\"287\" valign=\"top\">The email address that, when testMode is enabled will receive all emails sent from the system.</td>\n</tr>\n<tr>\n<td width=\"147\" valign=\"top\">eventLogPath</td>\n<td width=\"145\" valign=\"top\">System.String</td>\n<td width=\"287\" valign=\"top\">the location that the event logs will be written to. All events received get assigned a System.Guid and all logs pertaining to that event get saved in the corresponding folder.</td>\n</tr>\n<tr>\n<td width=\"147\" valign=\"top\">subscriber</td>\n<td width=\"145\" valign=\"top\">System.String</td>\n<td width=\"287\" valign=\"top\">The AD account name of the account that is writing the events. Set to the name of your TFSSetup or TFSService accounts.</td>\n</tr>\n</tbody>\n</table>\n&nbsp;\n\nNow you are ready to set the event handlers. These are defined within the \"Events\" section:\n<blockquote><span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #a31515;\">Events</span><span style=\"color: #0000ff;\">&gt;\n\n&lt;!--</span><span style=\"color: #008000;\">\n\nUse one of the following events:\n\nAclChangedEven\n\nBranchmovedevent\n\nBuildCompletionEvent\n\nBuildStatusChangeEvent\n\nCommonStructureChangedEvent\n\nDataChangedEvent\n\nIdentityChangedEvent\n\nIdentityCreatedEvent\n\nIdentityDeletedEvent\n\nMembershipChangedEvent\n\nWorkItemChangedEvent)\n\nThen you need to add handlers for the events.\n\n\n\nExample:\n\n&lt;Event eventType=\"WorkItemChangedEvent\"&gt;\n\n&lt;Handlers&gt;\n\n&lt;Handler type=\"RDdotNet.TeamFoundation.WorkItemTracking.AssignedToHandler\"\n\nassemblyFileName=\"RDdotNet.TeamFoundation.WorkItemTracking.AssignedTo.dll\"\n\nassemblyFileLocation=\"~EventHandlersWorkItemTracking\"&gt;\n\n&lt;/Handler&gt;\n\n&lt;/Handlers&gt;\n\n&lt;/Event&gt;\n\n</span><span style=\"color: #0000ff;\">--&gt;\n\n&lt;</span><span style=\"color: #a31515;\">Event</span><span style=\"color: #0000ff;\"> </span><span style=\"color: #ff0000;\">eventType</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">WorkItemChangedEvent</span>\"<span style=\"color: #0000ff;\">&gt;\n\n&lt;</span><span style=\"color: #a31515;\">Handlers</span><span style=\"color: #0000ff;\">&gt;\n\n&lt;</span><span style=\"color: #a31515;\">Handler</span><span style=\"color: #0000ff;\"> </span><span style=\"color: #ff0000;\">type</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\"><a title=\"RDdotNet - Reality Dysfunction .NET\" href=\"http://www.rddotnet.com\" target=\"_blank\">RDdotNet</a>.TeamFoundation.WorkItemTracking.AssignedToHandler</span>\"\n\n<span style=\"color: #0000ff;\"> </span><span style=\"color: #ff0000;\">assemblyFileName</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\"><a title=\"RDdotNet - Reality Dysfunction .NET\" href=\"http://www.rddotnet.com\" target=\"_blank\">RDdotNet</a>.TeamFoundation.WorkItemTracking.AssignedTo.dll</span>\"\n\n<span style=\"color: #0000ff;\"> </span><span style=\"color: #ff0000;\">assemblyFileLocation</span><span style=\"color: #0000ff;\">=</span>\"<span style=\"color: #0000ff;\">~EventHandlersWorkItemTracking</span>\"<span style=\"color: #0000ff;\">&gt;\n\n&lt;/</span><span style=\"color: #a31515;\">Handler</span><span style=\"color: #0000ff;\">&gt;\n\n&lt;/</span><span style=\"color: #a31515;\">Handlers</span><span style=\"color: #0000ff;\">&gt;\n\n&lt;/</span><span style=\"color: #a31515;\">Event</span><span style=\"color: #0000ff;\">&gt;\n\n&lt;/</span><span style=\"color: #a31515;\">Events</span><span style=\"color: #0000ff;\">&gt;</span></blockquote>\nAs you can see you are theoretically allows to us any events. Please keep in mind that only the WorkItemChangedEvent and the\_CheckInEvent\_have been tested. When you add the \"Event\" tag with the corresponding eventType (which is an enumerator) this tells the system which specific events to subscribe to.\n\nYou can then add handlers to an event. These handlers are fired whenever these events are received.\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"2\" width=\"571\">\n<tbody>\n<tr>\n<td width=\"90\" valign=\"top\"><strong>Name</strong></td>\n<td width=\"277\" valign=\"top\"><strong>Type</strong></td>\n<td width=\"202\" valign=\"top\"><strong>Description</strong></td>\n</tr>\n<tr>\n<td width=\"93\" valign=\"top\">eventType</td>\n<td width=\"279\" valign=\"top\"><a title=\"RDdotNet - Reality Dysfunction .NET\" href=\"http://www.rddotnet.com\" target=\"_blank\">RDdotNet</a>.TeamFoundation.EventTypes</td>\n<td width=\"199\" valign=\"top\">Enumerator that\_ defines the list of possible events.</td>\n</tr>\n<tr>\n<td width=\"95\" valign=\"top\">type</td>\n<td width=\"281\" valign=\"top\">System.Type</td>\n<td width=\"197\" valign=\"top\">This must be a valid type in the assembly listed in assemblyFileName</td>\n</tr>\n<tr>\n<td width=\"96\" valign=\"top\">assemblyFileName</td>\n<td width=\"282\" valign=\"top\">System.String</td>\n<td width=\"196\" valign=\"top\">This must be a valid assembly found in the assemblyFileLocation</td>\n</tr>\n<tr>\n<td width=\"96\" valign=\"top\">assemblyFileLocation</td>\n<td width=\"282\" valign=\"top\">System.String</td>\n<td width=\"196\" valign=\"top\">A location within the servers file system that holds this assembly. ~ denotes the applications root.</td>\n</tr>\n</tbody>\n</table>\nIf you are using\_friendly server names or TeamPlain the you can change the \_TFS server links to be TeamPlain ones using the UrlReplacements config element:\n<blockquote>\n<pre class=\"code\"><span style=\"color: #0000ff;\">&lt;</span><span style=\"color: #a31515;\">UrlReplacements</span><span style=\"color: #0000ff;\">&gt;             &lt;!--</span><span style=\"color: #008000;\"> The Url Replaces change the url listed in the event to valid public items             Examples:                 This item changes the TFS url to a TeamPlain v1 url                 &lt;Replace eventType=\"WorkItemChangedEvent\" old=\":8080/WorkItemTracking/WorkItem.aspx?artifactMoniker=\" new=\"/workitem.aspx?id=\" /&gt;                                              These items change the server location to a public host header:                 &lt;Replace eventType=\"WorkItemChangedEvent\" old=\"[ServerProductionEnviromentName]\" new=\"[PublicProductionEnviromentUri]\" /&gt;                 &lt;Replace eventType=\"WorkItemChangedEvent\" old=\"[ServerDevelopmentEnviromentName]\" new=\"[PublicDevelopmentEnviromentUri]\" /&gt;             </span><span style=\"color: #0000ff;\">--&gt;</span></pre>\n<pre class=\"code\"><span style=\"color: #0000ff;\">&lt;/</span><span style=\"color: #a31515;\">UrlReplacements</span><span style=\"color: #0000ff;\">&gt;</span></pre>\n</blockquote>\nThis works by replacing values within the URL in the events. You specify the event type, what to look for and what to replace it by. This allows grater control and the integration of TeamPlain into your world. If a task is assigned to someone outside of your departmental sphere who you have given permission to TFS but who know nothing about it, they will still get an email that will link them through to TeamPlain.\n\nAnd that is you all set. if you have installed the service and set the account that is used to run the service you should get no errors when starting. No guarantees though :)"
  - ''
  post_id: '379'
  post_date: '2007-06-18 14:05:37'
  post_date_gmt: '2007-06-18 14:05:37'
  post_modified: '2007-06-18 14:05:37'
  post_modified_gmt: '2007-06-18 14:05:37'
  comment_status: open
  ping_status: open
  post_name: tfs-event-handler-prototype-configuration-demystified
  status: publish
  post_parent: '0'
  menu_order: '0'
  post_type: post
  post_password: ''
  is_sticky: '0'
  category: {}
  postmeta:
  - meta_key: authorsure_include_css
    meta_value: ''
  - meta_key: dsq_thread_id
    meta_value: '317408359'
  - meta_key: _edit_last
    meta_value: '3'
  - meta_key: robotsmeta
    meta_value: index,follow
  - meta_key: _thumbnail_id
    meta_value: '7080'
  - meta_key: authorsure_include_css
    meta_value: ''
  - meta_key: _views_template
    meta_value: '0'
  - meta_key: _wpbitly
    meta_value: http://nkdalm.net/1bY8j3v
  - meta_key: _wpghs_github_path
    meta_value: _posts/2007-06-18-tfs-event-handler-prototype-configuration-demystified.md
  - meta_key: _sha
    meta_value: ''
  - meta_key: _wpml_media_has_media
    meta_value: '1'
  - meta_key: _tribe_ticket_capacity
    meta_value: '0'
  - meta_key: _tribe_ticket_version
    meta_value: 4.12.1
  - meta_key: ekit_post_views_count
    meta_value: '320'
