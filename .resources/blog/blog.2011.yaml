- FrontMatter:
    title: SSRS vs SCVMM - The Kerberos token dispute
    description: Explore the Kerberos token challenges in SSRS and SCVMM setups. Learn key solutions to enhance your TFS and Lab Management configurations effectively.
    ResourceId: o4bErdW-aL2
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 4104
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-12-29
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: ssrs-vs-scvmm-the-kerberos-token-dispute
    aliases:
    - /resources/o4bErdW-aL2
    aliasesArchive:
    - /blog/ssrs-vs-scvmm-the-kerberos-token-dispute
    - /ssrs-vs-scvmm-the-kerberos-token-dispute
    - /ssrs-vs-scvmm---the-kerberos-token-dispute
    - /blog/ssrs-vs-scvmm---the-kerberos-token-dispute
    - /resources/blog/ssrs-vs-scvmm-the-kerberos-token-dispute
    tags:
    - Troubleshooting
    - System Configuration
    - Install and Configuration
    - Windows
    categories:
    - Uncategorized
  BodyContent: |
    I have been  working with one of my colleagues, Bryon, over the holidays in order to install both TFS and Lab management at a customer. Now that customer has some awesome hardware, but insisted on a physical TFS server. The DL320 with 18 cores, 42GB RAM and 2TB of storage make a pretty fast TFS server, but we did run into a couple of problems. The solution to the first problem caused the second problem.

    > **Conclusion: Never put the SCVMM Server on the same box as RS if you are using Domain Accounts**

    We initially configured TFS in a single server configuration as well as the two Lab Management servers for Hyper-V. The Hyper-V boxes were so big (2\* 24 cores, 98GB RAM and 6TB) that we stole a little from the first one to run 5 extra computers.

    - Tfs Build Agents – 2 servers running TFB configured to run two agents each
    - Tfs Build Controller – Single server configured as a Build Controller only
    - Tfs Test Controller  - Single server configured as a Test Controller and joined to TFS
    - Tfs Client – Single client running VS2010 Ultimate for config and testing

    [![image](images/image_thumb-1-1.png "image")](http://blog.hinshelwood.com/files/2011/12/image.png) **Figure: What is installed where**
    { .post-img }

    We had the SVCVMM server installed on the TFS box a this was thought to be a good place to stick it as out TFS server is enormously over muscled. So we have the SCVMM Server on the TFS server and a single host configured and all is well. We dutifully follow the instructions to configure Lab Management and have it talk to our single Host and we had everything up and running.

    ### The First Problem - Reporting Services Authentication Issues

    If you have ever setup RS you will know that the best way to run it is either under Network Service, or (as in our case) if security concerns dictate then under Active Directory credentials. There is however a requirement for those AD credentials to have certain abilities that are documented in the [How to: Register a Service Principal Name (SPN) for a Report Server](http://msdn.microsoft.com/en-us/library/cc281382.aspx) document and a quick read usually gets your service account endowed with Domain Admin as very few small Infrastructure teams have the skills necessary to really grok the subtle nuances of Active Directory.

    In this case, the TFSService account that we are using was not allowed to be Domain Admin (unsurprisingly as this a little bit of a dumb idea), but it was chosen over the defined SQL Server Service Account as, rightly, the organisation did not want to give us the password: Now, if you are installing TFS you will know that it is important for you to install SQL according to the documentation for TFS as 90% of failed installs are due to SQL configuration, however I have never been given the SQL password on any network and always have relied on an over-the-shoulder-typer to enter it. I digress, but the result is that both SSDE, SSAS and SSRS all run under the TFSService account. This being the case we ran into the aforementioned age old "Reporting Services needs an SPN" error.

    This error manifests as users always being asked for credentials when logging in from a server other than the local RS box, and no matter how slowly they type them in or what privileges they have on the Server or RS they always get a denied. This is due to that pesky "SPN" part, and I often hear "What the hell is that SPN thing anyway?".

    SPN's are an integral part of Active Directory and allows things to be authenticated by Kerberos. Kerberos is AD's secure token exchange protocol that is the bedrock of secure networks. They a re kind of like "allowed permissions" for communication. You have to say that a server is allows to respond securely on a particular URLprotocal.

    > HTTP/tfs01.domain.com tfs01# HTTP/tfs01 tfs01#

    **Figure: SPN for Reporting Services under Network Service**

    So if you use "Network Service" or "Local Service" then an SPN must be added with the name of the computer to its own domain account (yes, computers have domain accounts too) and this is set up by default so that a serve can authenticate under its own account. If you have a SQL service account with the proper permission in AD then SQL Server will add its owe SPN's automatically as part of the installation and you don't need to worry about it. However if you are running under for example "domaintfsservice" that does not have this permission then you will need to add custom SPN's manually.

    > setspn -a HTTP/tfs01.domain.com domaintfsservice setspn -a HTTP/tfs01 domaintfsservice

    **Figure: SPN for Reporting Services under Domain Account**

    Now you have this added (and yes, you have to do this if you are running on a custom domain as well)  your users will almost be able to authenticate :)

    They will still need to follow "[Always prompted for credentials in TFS 2010?](http://blog.hinshelwood.com/always-prompted-for-credentials-in-tfs-2010/)" to make sure that your users can get their kerberos ticket now that the server will allow them.

    ### The Second Problem - System Centre Virtual Machine Manager stops working

    Then, after solving the SSRS issue we went to add the second Hyper-V host to SCVMM and the Job erred out. I looked at the error and as usual it was no help, so after a few tries I rebooted all of the servers and tried again. This time I got a nasty Kerberos error that there were duplicate entries competing for tokens.

    > The Kerberos client received a KRB_AP_ERR_MODIFIED error from the server tfs01. The target name used was HTTP/tfs01. This indicates that the target server failed to decrypt the ticket provided by the client. This can occur when the target server principal name (SPN) is registered on an account other than the account the target service is using. Please ensure that the target SPN is registered on, and only registered on, the account used by the server. This error can also happen when the target service is using a different password for the target service account than what the Kerberos Key Distribution Center (KDC) has for the target service account. Please ensure that the service on the server and the KDC are both updated to use the current password. If the server name is not fully qualified, and the target domain (DOMAIN.COM) is different from the client domain (DOMAIN.COM), check if there are identically named server accounts in these two domains, or use the fully-qualified name to identify the server.

    Figure: [http://support.microsoft.com/kb/970923](http://support.microsoft.com/kb/970923)

    When you have duplicated Kerberos effectively throws in the towel until it is resolved to prevent security breaches and, more specifically to prevent consultants keeping their hair.

    I ran the [spnquery.vbs tool](http://technet.microsoft.com/en-us/library/ee176972.aspx) to output the tokens for both the TFS Server and the TFS Service Account and could not find any duplicates. After quite some amount of frustration and hair pulling I realised that SCVMM was trying to communicate with itself (the TFS Server) with an http connection. So I investigated all of the services and the accounts that they were running under in order to identify the issue.  While the Reporting Services service was running under TFSService the Virtual Machine Manager Service was running under the TFSHyperVManager (don't ask)  service account.

    **Did your light bulb go on?**

    Let me explain.

    - **SCVMM**: The SCVMM was trying to communicate with itself and its hosts were trying to communicate with it using the http protocol to a service running within the TFSHyperVManager security context.
    - **SSRS**: The users were trying to communicate with the RS server using the http protocol to a service running with the TFSService security context
    - **AD SPN**: We have an SPN set for the http protocol to the server name with the TFSService security context

    **KO** for SSRS! Kerberos flakes out and will not decrypt tokens for SCVMM where it would before because the TFSHyperVManager had permission to set SPN's. Sigh... I hate infrastructure work.

    There is NO way that you can have SCVMM and RS running under AD Credentials to coexist unless they are running under the same account and this was explicitly denied by the installer as the TFSService is used as part of the VM setups for Lab Management.

    As my mother used to do with my brother and I: i separated them.

    Simples!
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-12-29-ssrs-vs-scvmm-the-kerberos-token-dispute\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-12-29-ssrs-vs-scvmm-the-kerberos-token-dispute
- FrontMatter:
    title: The Sprint is a container for Planning and not necessarily for Delivery
    description: Explore how Scrum can enhance planning without strict delivery schedules. Learn to embrace Continuous Delivery for better software development practices.
    ResourceId: 6USQKO75YgH
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 4092
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-11-29
    weight: 230
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: the-sprint-is-a-container-for-planning-and-not-necessarily-for-delivery
    aliases:
    - /resources/6USQKO75YgH
    aliasesArchive:
    - /blog/the-sprint-is-a-container-for-planning-and-not-necessarily-for-delivery
    - /the-sprint-is-a-container-for-planning-and-not-necessarily-for-delivery
    - /resources/blog/the-sprint-is-a-container-for-planning-and-not-necessarily-for-delivery
    tags:
    - Continuous Delivery
    - Product Delivery
    - Software Development
    - Pragmatic Thinking
    - Technical Excellence
    - Working Software
    - Frequent Releases
    - Deployment Frequency
    - Engineering Practices
    - Operational Practices
    - Technical Mastery
    categories:
    - Engineering Excellence
    preview: nakedalm-logo-128-link-2-2.png
  BodyContent: |
    I have been told time and again in the office that Scrum is an inflexible platform for developing software as it is way too prescriptive. This is far from reality and represents an invalid interpretation in the rules of the game. This fault lies not with those that have been turned away from the light, but with the fanatics that have brandished the burning torch and pitchfork at your door chanting "that is not Scrum because...".

    [![Image(1)](images/Image1_thumb-1-1.png "Image(1)")](http://blog.hinshelwood.com/files/2011/11/Image1.png)  
    { .post-img }
    **Figure: Please ignore these guys**

    Many of us in the community have a vision of making Scrum more accessible to all and to that end, one of the goals of the entire Scrum community should be to help the misguided back to the light and re-educate the Scrum Coaches ( read Inquisitors here ) that have corrupted them.

    Let me ask you a question;

    > **If the Scrum Guide is the rules by which the game of Scrum is played, then where is it written that your delivery schedule must match up with your planning schedule?**

    It does say that you should be meeting your definition of done for each PBI and at least each Sprint. As your definition of done is the quality bar set by the Development Team and negotiated with the Product Owner, what is to stop you having the following DoD:

    - Acceptance Tests have been turned into Test Cases
    - Functional Tests have been turned into Test Cases
    - Code coverage percentage is the same or better than the last build
    - All Tests Cases pass
    - All Test Cases have been turned into Coded UI Tests
    - Deployed to QA and full automated test suit run
    - **Deployed to Production**

    If you are deploying to production every Sprint and even for every PBI then you are one step away from doing it for every build, which is Continuous Deployment. Does Scrum say that you can't do this? Hell no, it encourages it without mandating it. As long as you meet a [simple measurable checklist](http://blog.hinshelwood.com/are-you-doing-scrum-really/), you can say that you are doing Scrum.

    > "Businesses rely on getting valuable new software into the hands of users as fast as possible, while making sure that they keep their production environments stable. Continuous Delivery is a revolutionary and scalable agile methodology that enables any team, including teams within enterprise IT organizations, to achieve rapid, reliable releases through better collaboration between developers, testers, DBAs and operations, and automation of the build, deploy, test and release process."  
    > \-Jez Humble

    Even if you are not practicing Continuous Delivery, I would encourage you to deploy more regularly than just once a Sprint. I am not saying that it is easy, because it is not.

    You can't do this with immature software either. I see customers fail time and again with institutional technical debt and software teams that are highly tuned to create it. In order to achieve Continuous Delivery your organisation must be committed to minimizing technical debt and to maximizing the value delivered to your business. Apart from technical debt there are a quandary of things that need to be in place in order to achieve Continuous Delivery. Think about the ability to have different versions of the same code running in production at the same time while maintaining the contracts and separation of concerns that go to make that possible.

    There are only a few organisations that have mastered Continuous Delivery, but the benefit that they achieve in being able to get features into production almost as fast as the business can think of it.

    But if you do want to get there, or at least take a journey down that road and see how far you want to go then there are things that must happen. There are waypoints along the road and provide a simple guide to your maturity in this area:

    - Automated Build
    - Build Verification Tests
    - Automated Acceptance Tests
    - Automated Functional Tests
    - Automated Unit Tests
    - Automated Deployment

    Only once you have all of these thing should you then be thinking of what more do you need for your software in your environment to be able to successfully deploy your software to production and be happy that you have met the correct quality level to achieve this.

    I never tell teams that you MUST do a thing but instead encourage them to do the right thing for their organisation in a journey to build better software.

    Now, that is something that we can all aspire to.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-29-the-sprint-is-a-container-for-planning-and-not-necessarily-for-delivery\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-29-the-sprint-is-a-container-for-planning-and-not-necessarily-for-delivery
- FrontMatter:
    title: Can you really commit to delivering work?
    description: Explore the shift from commitment to forecasting in Scrum. Discover how this change fosters transparency and trust within your development team.
    ResourceId: uvzKTaweOnW
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 4089
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-11-26
    weight: 750
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: can-you-really-commit-to-delivering-work
    aliases:
    - /resources/uvzKTaweOnW
    aliasesArchive:
    - /blog/can-you-really-commit-to-delivering-work
    - /can-you-really-commit-to-delivering-work
    - /can-you-really-commit-to-delivering-work-
    - /blog/can-you-really-commit-to-delivering-work-
    - /resources/blog/can-you-really-commit-to-delivering-work
    tags:
    - Software Development
    - Professional Scrum
    - Forecasting
    - Pragmatic Thinking
    categories:
    - Scrum
    preview: nakedalm-experts-professional-scrum-5-5.png
  BodyContent: |
    [![PST Logo 2](images/PST-Logo-2_thumb-8-8.png "PST Logo 2")](http://blog.hinshelwood.com/files/2011/11/PST-Logo-2.png) There has been a subtle but targeted change in the wording used as part of Scrum. There has bee a move away from commitment towards forecasting what will be completed. Why is this happening and what does it mean to my team?
    { .post-img }

    ---

    There has long been a subtle lack of transparency between the Product Owner and the Development Team that has largely gone unnoticed. In the empirical world that is Software Development it is **not possible to commit to delivering anything**! This is reminiscence of the institutional fiction that we can indeed give someone a guaranteed delivery date for something that exists in the complex world and thus is impossible for us to estimate. We have been doing it for years and we are still doing it even in Agile. The only saving grace is that our commitment has been for such a small amount of work that we are routinely forgiven and indeed any good Product Owner quickly learns that **Commitment** is really a **guess** and can often be a **WAG (Wild Assed Guess)** at best.

    [![image](images/image_thumb7-2-2.png "image")](http://blog.hinshelwood.com/files/2011/11/image14.png)  
    { .post-img }
    **Figure: The meaning of commitment**

    Where are these points in Scrum where **commitment** has been applied:

    - **Daily Scrum**
      During the daily Scrum the Development Team get together to review each others previous days commitment and then commit to each other to completing work.
    - **Sprint Planning**
      During Sprint Planning the Development Team commit to delivering work to the Product Owner at the end of the Sprint.

    There are also a number of other commitment points that are implied in Scrum. The Product Owner is probably committing to delivering functionality to the Stakeholders (The Business) and often the Business will then commit to delivering functionality to their Customer.

    And this is where the major problem lies as there are escalating cycles of impact at all levels.

    - An Individual fails in their commitment to the Development Team
    - A Development Team fails in its commitment to the Product Owner
    - A Product Owner fails in their commitment to the Business
    - The Business fails in its commitment to its Customers

    If you have "commitment" then others will read that as something that can be relied on and potentiality take a dependency on the timely completion of that work. Once a dependency is taken then it can be a BIG problem if things go south. What if your Sales teams have made commitments to old customers to get them to say and to new customers to get them to change to you?

    This is the result of **_committing_** to delivering work, so I say again:

    ### Can you really commit to delivering work?

    The word "Commitment" smacks too much of the **Prescriptive** world and not enough of the **Predictive**. Can we stop diluting a perfectly prescriptive word? Is there a better choice that lives in the Predictive world?

    [![image](images/image_thumb8-3-3.png "image")](http://blog.hinshelwood.com/files/2011/11/image15.png)  
    { .post-img }
    **Figure: Would you hold a weather presenter to a 10 day forecast?**

    The new Scrum Guide talks about **Forecast** instead of the **Commitment**. This is a subtle and carefully chosen contrast that is intended to result in a more positive open and transparent communication between the key actors in the pantomime that has been Software Development.

    [![image](images/image_thumb9-4-4.png "image")](http://blog.hinshelwood.com/files/2011/11/image16.png)  
    { .post-img }
    **[![o_Error-icon](images/o_Error-icon_thumb1-6-6.png "o_Error-icon")](http://blog.hinshelwood.com/files/2011/11/o_Error-icon2.png)Figure: Bad example, "Commitment" implies that we know for sure**
    { .post-img }

    [![image](images/image_thumb10-1-1.png "image")](http://blog.hinshelwood.com/files/2011/11/image17.png)  
    { .post-img }
    [![o_Tick-icon](images/o_Tick-icon_thumb1-7-7.png "o_Tick-icon")](http://blog.hinshelwood.com/files/2011/11/o_Tick-icon1.png)**Figure: Good example, "Forecast" implies that we don't know for sure**
    { .post-img }

    The result should be higher levels of trust between all parties that should result in less (or at least more well known and specific) dependencies that are of much lower risk. If we make that change we really start thinking in the Agile / Predictive space and some of the old ways will drop by the wayside. Those old ways are the things that get in the way of an Agile adoption, that make us want to drop back into our old comfortable bad habits of Waterfall.

    **Are you going to make the change from Commitment to Forecast?**

    If not, let me know why this will not make sense in your organisation!
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-26-can-you-really-commit-to-delivering-work\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-26-can-you-really-commit-to-delivering-work
- FrontMatter:
    title: Always prompted for credentials in TFS 2010?
    description: Struggling with constant credential prompts in TFS 2010? Discover effective solutions and tips to streamline your authentication process effortlessly!
    ResourceId: fESk_RDaaIB
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 4071
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-11-22
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: always-prompted-for-credentials-in-tfs-2010
    aliases:
    - /resources/fESk_RDaaIB
    aliasesArchive:
    - /blog/always-prompted-for-credentials-in-tfs-2010
    - /always-prompted-for-credentials-in-tfs-2010
    - /always-prompted-for-credentials-in-tfs-2010-
    - /blog/always-prompted-for-credentials-in-tfs-2010-
    - /resources/blog/always-prompted-for-credentials-in-tfs-2010
    tags:
    - Troubleshooting
    - Install and Configuration
    - Windows
    preview: metro-visual-studio-2005-128-link-6-6.png
    categories:
    - Uncategorized
  BodyContent: |
    [![VisualStudioALMLogo](images/VisualStudioALMLogo_thumb-10-10.png "VisualStudioALMLogo")](http://blog.hinshelwood.com/files/2011/11/VisualStudioALMLogo.png)
    { .post-img }

    Sometimes when you setup TFS you find that your users, or just some of them, are being prompted for credentials. While manageable this is annoying and is not really related to TFS. This is an Active Directory thing and yes, there is a workaround…

    ---

    The best way to fix this is to have your Active Directory administrator add your OWN domain to the list detected as internal and thus intranet. By default using just the server NETBIOS name will work anyway, but in this world of domain names [http://tfs.company.com](http://tfs.company.com) looks a lot better and is easier to remember than [http://tfs](http://tfs). Its a brain thing… and it is a Kerberos thing, but don’t worry about that.

    So, first, why is this happening?

    [![SNAGHTML154bd5c](images/SNAGHTML154bd5c_thumb-9-9.png "SNAGHTML154bd5c")](http://blog.hinshelwood.com/files/2011/11/SNAGHTML154bd5c.png) **Figure: User Authentication on the Internet / Intranet**
    { .post-img }

    Its the default and it should be this way!

    If you accidentally change this to allow authentication in all zones you may be exposing your username and password beyond the bounds of your internal network. This is not good.

    So, if you want to fix this send this email to your Active Directory administrator or support desk:

    > Dear Admin,
    >
    > Can you please make it so that all things that I access thorough the network as “\*.mydomain.com” are classed as “intranet” so that I can authenticate correctly without having to enter my username and password every time. Can you also make sure that everyone i work with has the same setting applied automatically.
    >
    > [![image](images/image_thumb2-1-1.png "image")](http://blog.hinshelwood.com/files/2011/11/image9.png) **[![o_Error-icon](images/o_Error-icon_thumb-7-7.png "o_Error-icon")](http://blog.hinshelwood.com/files/2011/11/o_Error-icon1.png)\*\***Figure: Bad example, I should not have to do this locally\*\*
    > { .post-img }
    >
    > Hint: you can do this by adding “\*.mydomain.com” to the list of websites that are automatically in Internet Explorers “Intranet” list
    >
    > [![image](images/image_thumb3-2-2.png "image")](http://blog.hinshelwood.com/files/2011/11/image10.png) [**![o_Tick-icon](images/o_Tick-icon_thumb-8-8.png "o_Tick-icon")**](http://blog.hinshelwood.com/files/2011/11/o_Tick-icon.png)**Figure: Good example, now i can authenticate**
    > { .post-img }
    >
    > - **Please can you change the domain policy to add this automatically to Internet Explorer**
    >
    > Thanks,
    >
    > Frustrated local user

    But, sometimes you get a less than prompt response. How can I solve this in the mean time, knowing that my Support team is working hard of fixing it permanently?

    \[screencast url="http://www.screencast.com/t/PAx7VWfa3jn" width="640" height="360"\] **Screencast: Administering TFS 2010 - Always prompted for credentials?**

    ### But I just want the simple steps!

    1. Open IE
    2. Click "**Tools | Internet Option...**"[![image](images/image_thumb4-3-3.png "image")](http://blog.hinshelwood.com/files/2011/11/image11.png) **Figure: Internet Options is well hidden**
       { .post-img }
    3. Go to "**Security**" tab.[![image](images/image_thumb5-4-4.png "image")](http://blog.hinshelwood.com/files/2011/11/image12.png) **Figure: These settings apply to all internet access, not just IE**
       { .post-img }
    4. Select "**Local Intranet | Sites | Advanced**"[![image](images/image_thumb6-5-5.png "image")](http://blog.hinshelwood.com/files/2011/11/image13.png) **Figure: All useful options are hidden away**
       { .post-img }
    5. Confirm that “**\*.mydomain.com**” is in the list and add it if it is not.
    6. Close all instances of Internet Explorer

    Now when you open IE and go to any address that contains your company domain it will automatically pass through your Active Directory identity.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-22-always-prompted-for-credentials-in-tfs-2010\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-22-always-prompted-for-credentials-in-tfs-2010
- FrontMatter:
    title: Are you doing Scrum? Really?
    description: Explore the evolving landscape of Scrum and discover a simple checklist to ensure you're truly practicing it. Embrace adaptability for better results!
    ResourceId: X1Hm4PJt0CV
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 4049
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-11-19
    weight: 530
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: are-you-doing-scrum-really
    aliases:
    - /resources/X1Hm4PJt0CV
    aliasesArchive:
    - /blog/are-you-doing-scrum-really
    - /are-you-doing-scrum-really
    - /are-you-doing-scrum--really-
    - /blog/are-you-doing-scrum--really-
    - /resources/blog/are-you-doing-scrum-really
    tags:
    - Agile Frameworks
    - Software Development
    - Professional Scrum
    categories:
    - Scrum
    preview: nakedalm-experts-professional-scrum-3-3.png
  BodyContent: |
    [![PSM Front Logo 1](images/Scrum.org-Logo_500x118_thumb-4-4.png "PSM Front Logo 1")](http://blog.hinshelwood.com/files/2011/11/Scrum.org-Logo_500x118.png)This week I was at the ALM Summit in Redmond. There was a very interesting talk from David Starr of Scrum.org going over the recent changes in Scrum. These changes are, I think, designed to battle the things that have made Scrum unpalatable to many people.
    { .post-img }

    ---

    The reality is that many people and organisation are failing at and being turned away from Scrum by the fanaticism that surrounds it. Scrum.org is taking these issues and tackling them head on.

    At Northwest Cadence we worked with one team whose Scrum Coach told them that they were not doing Scrum. Why? Well, the Development Team had a disabled person who was unable to stand and they decided, as a team,  not to stand up during the Daily Scrum. Shocked? Well you should be, we are in the era of intolerance and fanaticism and we all need a kick up the ass for that. Scrum.org is doing its part of that kicking and thus there are changes to the body of knowledge that is Scrum to make it more tolerant, adaptable and palatable for a wider group of people while not changing its core tenants.

    The first change we saw was the publication of the new [Scrum Guide by Ken and Jeff](http://www.scrum.org/scrumguides/) that saw the removal of all of those things that are not part of core Scrum. If you were to buy "Scrum the Board Game" you would not expect the getting started guide to include all of the strategies for playing the game, but instead it would contain the "rules" of how to play.

    [![image](images/image_thumb-1-1.png "image")](http://blog.hinshelwood.com/files/2011/11/image7.png)
    { .post-img }

    **Figure: The rules of the game, not the strategy of how to play**

    The [Scrum Guide](http://www.scrum.org/scrumguides/) is just such a distillation of the core principals upon which the Scrum Framework is based. Once you have these core principals under your belt you can move forward with instituted all of those "practices" that will help you do Scrum well. There are many books, blogs and forums to help formulate Strategy and many consultants that will help you with adopting Scrum effectively. (Hint: [http://nwcadence.com](http://nwcadence.com))

    [![image](images/image_thumb1-2-2.png "image")](http://blog.hinshelwood.com/files/2011/11/image8.png)
    { .post-img }

    **Figure: You are here!**

    So if there is this line between “not Scrum” and “Scrum” I want to know definitively if I am at this line. To do that I need a **simple measurable checklist** that lets me know that I am there. A minimal "Definition of Doing" or "Scrum Fitness test", if you will, that tells us that we are at the first milestone and can then start to look at more advanced concepts to improve our performance.

    > A simple measurable checklist:
    >
    > 1. … an ordered Product Backlog
    > 2. … Development Teams of 6+-3
    > 3. … have a Product Owner who owns the backlog
    > 4. … a Scrum Master who is responsible for process
    > 5. … have Sprints of 1 month or less
    > 6. … Sprints are of a fixed length
    > 7. … a Sprint Backlog that shows Remaining Work
    > 8. … a Sprint Backlog created at Sprint Planning
    > 9. … Review & Retrospective at the end of each sprint
    > 10. … working software each Sprint
    > 11. … stakeholders who inspect the software increment

    **Figure: A simple measurable checklist of Scrum**

    If you can say yes to each of these things then you are doing Scrum. Are you doing good Scrum? Well, probably not… but you are doing it.

    Then what else do you need?

    Well, you will find it hard to continue to deliver working software each sprint (#10) without things like Automated Testing and Automated Build. You will also find it hard to start climbing that hill towards High Performing Scrum without visualising your work (Kanban), limiting work in progress, and concentrating on optimising Flow both at the micro (inside of the Sprint) and at the macro (wrapping Scrum).

    There are many more things that will help and many of them will become Scrum Extensions on Scrum.org as they are submitted and approved. This results in the replacement of the phrase "I am doing Scrum but...<shame>" with "I am doing Scrum and...<happiness>" and hopefully a wider and more positive adoption profile for Scrum.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-19-are-you-doing-scrum-really\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-19-are-you-doing-scrum-really
- FrontMatter:
    title: Creating a backup in Team Foundation Server 2010 using the Power Tools
    description: Learn how to effectively back up Team Foundation Server 2010 using Power Tools. Discover essential tips and troubleshooting for a smooth backup process.
    ResourceId: 9fVxqpOPzX8
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 4025
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-11-04
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: creating-a-backup-in-team-foundation-server-2010-using-the-power-tools
    aliases:
    - /resources/9fVxqpOPzX8
    aliasesArchive:
    - /blog/creating-a-backup-in-team-foundation-server-2010-using-the-power-tools
    - /creating-a-backup-in-team-foundation-server-2010-using-the-power-tools
    - /resources/blog/creating-a-backup-in-team-foundation-server-2010-using-the-power-tools
    tags:
    - Troubleshooting
    - System Configuration
    - Install and Configuration
    - Windows
    - Software Development
    categories:
    - Uncategorized
  BodyContent: |
    Over the last few years the product team has been putting their finishing touches on a backup module for the Team Foundation Server Administration Console. Why you might ask do you need another way to backup? Surely you can just backup the bits?

    Well, you could, but as TFS has a lot of moving parts it can get very complicated to [creating a backup](http://msdn.microsoft.com/en-us/library/ms253070.aspx).

    > 1. Required Permissions
    > 2. [Identify Databases](http://msdn.microsoft.com/en-us/library/ms253070.aspx#TableDB)
    > 3. [Create Tables in Databases](http://msdn.microsoft.com/en-us/library/ms253070.aspx#CreateTbl)
    > 4. [Create a Stored Procedure for Marking Tables](http://msdn.microsoft.com/en-us/library/ms253070.aspx#MarkTbl)
    > 5. [Create a Stored Procedure for Marking All Tables At Once](http://msdn.microsoft.com/en-us/library/ms253070.aspx#MarkAll)
    > 6. [Create a Stored Procedure to Automatically Mark Tables](http://msdn.microsoft.com/en-us/library/ms253070.aspx#RunMark)
    > 7. [Create a Scheduled Job to Run the Table-Marking Procedure](http://msdn.microsoft.com/en-us/library/ms253070.aspx#ScheduleMark)
    > 8. [Create a Maintenance Plan For Full Backups](http://msdn.microsoft.com/en-us/library/ms253070.aspx#CreateMPFull)
    > 9. [Create a Maintenance Plan For Differential Backups](http://msdn.microsoft.com/en-us/library/ms253070.aspx#CreateMPDiff)
    > 10. [Create a Maintenance Plan For Transaction Backups](http://msdn.microsoft.com/en-us/library/ms253070.aspx#CreateMP)
    > 11. [Back Up Additional Lab Management Components](http://msdn.microsoft.com/en-us/library/ms253070.aspx#LabComponents)
    >
    > **\-From "Back Up Team Foundation Server" on MSDN**

    There are a heck of a lot of databases that, depending on your environment, might be spread over your entire network.

    ![Example: complex distribution of databases](images/IC372332.png "Example: complex distribution of databases") **Figure: Deployment Topologies (Where is my data?) from MSDN**
    { .post-img }

    So, how is this problem solved. Well the TFS team have create a tool to create all of the backups and all of the job as well as managing the backup location for you. This sounds fantastic, but how about in practice.

    \[screencast url="http://www.screencast.com/t/PaBBcWZXn" width="640" height="360"\]

    **Screencast: Administering TFS 2010: Team Foundation Backup**

    Was it really that easy? Well….not really…here is the extra stuff I found out:

    - **Your account must OWN the share** Owning the folder does not cut it (see Error #1- TF254027).
    - **SQL Must be running under a domain account or Network Service** SQL must also have permission to the share, and the validation will get confused if you use “LocalSystem” instead of Network Service or a Domain Account (See Error #2- TF254027)
    - **The account running SQL must have permission to create SPN’s** The account that is used for SQL must be able to both see and create Service Principal Names in active directory (see Error #3: Terminating your TFS server).

    Once you learn how to Google without keywords and read your servers mind you will have a nice backup system going…

    ### Error #1- TF254027

    I initially got an error because the accounts did not really have full control over the target location. This is a problem with the share. Although I have full permission for [fileserver1ShareTFSBackups](file://fileserver1ShareTFSBackups) it is just a folder under the [fileserver1Share](file://fileserver1folder" data-mce-href=) location and I DO NOT have permission to change the sharing settings there.

    ![image](images/image1-1-1.png "image") **Figure: TF254027 is caused by permission issues**
    { .post-img }

    ```
    [Info   @16:36:34.342] Granting account ROOT_COMPANYtfssqlbox$ permission on folder <a href="file://fileserver1folderTFSBackups[Info">fileserver1ShareTFSBackups [Info</a>   @16:36:34.348] System.UnauthorizedAccessException: Attempted to perform an unauthorized operation.
       at System.Security.AccessControl.Win32.SetSecurityInfo(ResourceType type, String name, SafeHandle handle, SecurityInfos securityInformation, SecurityIdentifier owner, SecurityIdentifier group, GenericAcl sacl, GenericAcl dacl)
       at System.Security.AccessControl.NativeObjectSecurity.Persist(String name, SafeHandle handle, AccessControlSections includeSections, Object exceptionContext)
       at System.Security.AccessControl.FileSystemSecurity.Persist(String fullPath)
       at Microsoft.TeamFoundation.PowerTools.Admin.Helpers.FileHelper.GrantFolderPermission(String account, String path)
    [Info   @16:36:34.350] Granting account ROOT_COMPANYtfs.services permission on folder <a href="file://fileserver1TFSBackups[Info">fileserver1ShareTFSBackups [Info</a>   @16:36:34.352] System.UnauthorizedAccessException: Attempted to perform an unauthorized operation.
       at System.Security.AccessControl.Win32.SetSecurityInfo(ResourceType type, String name, SafeHandle handle, SecurityInfos securityInformation, SecurityIdentifier owner, SecurityIdentifier group, GenericAcl sacl, GenericAcl dacl)
       at System.Security.AccessControl.NativeObjectSecurity.Persist(String name, SafeHandle handle, AccessControlSections includeSections, Object exceptionContext)
       at System.Security.AccessControl.FileSystemSecurity.Persist(String fullPath)
       at Microsoft.TeamFoundation.PowerTools.Admin.Helpers.FileHelper.GrantFolderPermission(String account, String path)
    [Error  @16:36:34.352] Granting permission to account ROOT_COMPANYtfssqlbox$ on path <a href="file://fileserver1folderTFSBackups">fileserver1ShareTFSBackups</a> failed
    ```

    **Figure: The log files get to the root of the problem, but not the reason**

    After much messing around I have found that you can’t use a sub-folder of a share that you do not have permission for. You require permission to the Share itself to apply permissions.

    ### Error #2- TF254027

    Lets try this again with a share that we control. I will create a backup share on the TFS server and at least then I control then permissions.

    ![image](images/image2-2-2.png "image") **Figure: The next Error looks the same, but it is subtly different**
    { .post-img }

    ```
    [Info   @18:12:05.813] "Verify: Grant Backup Plan PermissionsRootVerifyBackupPathPermissionsGrantedSuccessfully(VerifyBackupPathPermissionsGrantedSuccessfully): Exiting Verification with state Completed and result Success"
    [Info   @18:12:05.813] Verify: Grant Backup Plan PermissionsRootVerifyDummyBackupCreation(VerifyTestBackupCreatedSuccessfully): Starting Verification
    [Info   @18:12:05.813] Verify Test Backup Created Successfully
    [Info   @18:12:05.813] Starting creating backup test validation
    [Error  @18:12:06.132] Microsoft.SqlServer.Management.Smo.FailedOperationException: Backup failed for Server 'sqlserver1'.  ---&gt; Microsoft.SqlServer.Management.Common.ExecutionFailureException: An exception occurred while executing a Transact-SQL statement or batch. ---&gt; System.Data.SqlClient.SqlException: Cannot open backup device 'tfsserver1TFSBackuptemp_20111104111205.bak'. Operating system error 5(Access is denied.).
    BACKUP DATABASE is terminating abnormally.
    at Microsoft.SqlServer.Management.Common.ConnectionManager.ExecuteTSql(ExecuteTSqlAction action, Object execObject, DataSet fillDataSet, Boolean catchException)
    at Microsoft.SqlServer.Management.Common.ServerConnection.ExecuteNonQuery(String sqlCommand, ExecutionTypes executionType)
    --- End of inner exception stack trace ---
    at Microsoft.SqlServer.Management.Common.ServerConnection.ExecuteNonQuery(String sqlCommand, ExecutionTypes executionType)
    at Microsoft.SqlServer.Management.Common.ServerConnection.ExecuteNonQuery(StringCollection sqlCommands, ExecutionTypes executionType)
    at Microsoft.SqlServer.Management.Smo.ExecutionManager.ExecuteNonQuery(StringCollection queries)
    at Microsoft.SqlServer.Management.Smo.BackupRestoreBase.ExecuteSql(Server server, StringCollection queries)
    at Microsoft.SqlServer.Management.Smo.Backup.SqlBackup(Server srv)
    --- End of inner exception stack trace ---
    at Microsoft.SqlServer.Management.Smo.Backup.SqlBackup(Server srv)
    at Microsoft.TeamFoundation.PowerTools.Admin.Helpers.BackupFactory.TestBackupCreation(String path)
    [Error  @18:12:06.184] !Verify Error!: Account ROOT_COMAPNYmartin.hinshelwood failed to create backups using path <a href="file://tfsserver1TFSBackup[Info">tfsserver1TFSBackup [Info</a>   @18:12:06.184] "Verify: Grant Backup Plan PermissionsRootVerifyDummyBackupCreation(VerifyTestBackupCreatedSuccessfully): Exiting Verification with state Completed and result Error"
    [Info   @18:12:06.184] !Verify Result!: 5 Completed, 0 Skipped: 4 Success, 1 Errors, 0 Warnings
    [Info   @18:12:06.197] Verify: Backup Tasks Verifications(VCONTAINER): Starting Verification
    [Info   @18:12:06.197] A generic container node that does not contribute to results
    [Info   @18:12:06.197] "Verify: Backup Tasks Verifications(VCONTAINER): Exiting Verification with state Ignore and result Ignore"
    [Info   @18:12:06.197] Verify: Backup Tasks VerificationsRoot(VCONTAINER): Starting Verification
    [Info   @18:12:06.197] A generic container node that does not contribute to results
    [Info   @18:12:06.197] "Verify: Backup Tasks VerificationsRoot(VCONTAINER): Exiting Verification with state Ignore and result Ignore"
    [Info   @18:12:06.197] Verify: Backup Tasks VerificationsRootVerifyDummyBackupCreation(VerifyTestBackupCreatedSuccessfully): Starting Verification
    [Info   @18:12:06.197] Verify Test Backup Created Successfully
    [Info   @18:12:06.197] Starting creating backup test validation
    [Error  @18:12:06.389] Microsoft.SqlServer.Management.Smo.FailedOperationException: Backup failed for Server sqlserver1'.  ---&gt; Microsoft.SqlServer.Management.Common.ExecutionFailureException: An exception occurred while executing a Transact-SQL statement or batch. ---&gt; System.Data.SqlClient.SqlException: Cannot open backup device 'tfsserver1TFSBackuptemp_20111104111206.bak'. Operating system error 5(Access is denied.).
    BACKUP DATABASE is terminating abnormally.
    at Microsoft.SqlServer.Management.Common.ConnectionManager.ExecuteTSql(ExecuteTSqlAction action, Object execObject, DataSet fillDataSet, Boolean catchException)
    at Microsoft.SqlServer.Management.Common.ServerConnection.ExecuteNonQuery(String sqlCommand, ExecutionTypes executionType)
    --- End of inner exception stack trace ---
    at Microsoft.SqlServer.Management.Common.ServerConnection.ExecuteNonQuery(String sqlCommand, ExecutionTypes executionType)
    at Microsoft.SqlServer.Management.Common.ServerConnection.ExecuteNonQuery(StringCollection sqlCommands, ExecutionTypes executionType)
    at Microsoft.SqlServer.Management.Smo.ExecutionManager.ExecuteNonQuery(StringCollection queries)
    at Microsoft.SqlServer.Management.Smo.BackupRestoreBase.ExecuteSql(Server server, StringCollection queries)
    at Microsoft.SqlServer.Management.Smo.Backup.SqlBackup(Server srv)
    --- End of inner exception stack trace ---
    at Microsoft.SqlServer.Management.Smo.Backup.SqlBackup(Server srv)
    at Microsoft.TeamFoundation.PowerTools.Admin.Helpers.BackupFactory.TestBackupCreation(String path)
    ```

    **Figure: This time the error is lying and is from SQL not locally as it implies**

    It looks like the problem is that SQL Server can’t write to that folder, but I can and the machine account can. Lets try this from the SQL Server itself, and with a native backup.

    ![image](images/image3-3-3.png "image") **Figure: SQL Server can’t write to that location**
    { .post-img }

    Dam… So even a native SQL backup can’t write to this location.

    ```
    TITLE: Microsoft SQL Server Management Studio
    ------------------------------

    Backup failed for Server 'sqlserver1'.  (Microsoft.SqlServer.SmoExtended)

    For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=10.50.2500.0+((KJ_PCU_Main).110617-0038+)&EvtSrc=Microsoft.SqlServer.Management.Smo.ExceptionTemplates.FailedOperationExceptionText&EvtID=Backup+Server&LinkId=20476

    ------------------------------
    ADDITIONAL INFORMATION:

    System.Data.SqlClient.SqlError: Cannot open backup device 'tfsserver1TFSBackupmoo.bak'. Operating system error 5(Access is denied.). (Microsoft.SqlServer.Smo)

    For help, click: http://go.microsoft.com/fwlink?ProdName=Microsoft+SQL+Server&ProdVer=10.50.2500.0+((KJ_PCU_Main).110617-0038+)&LinkId=20476

    ------------------------------
    BUTTONS:

    OK
    ------------------------------
    ```

    **Figure: SQL Server errors suck even more**

    As it turns out, SQL Server is running under “LocalSerivce” which is not authenticating against our share. So we need to change the service that TFS runs under.

    ### Error #3: Terminating your TFS server

    As we should always use the SQL Server Configuration Manager to change these things I fired it up and since i already have a Domain account for running TFS under I decided to use that one.

    ![image](images/image4-4-4.png "image") **Figure: This is easy**
    { .post-img }

    When you apply it will ask you to restart SQL, but it should be all complete. Lets check TFS and make sure that everything is running…

    ![image](images/image5-5-5.png "image") **Figure: OMG! What just happened!**
    { .post-img }

    Oh Shit: I think I just broke TFS. Why can’t TFS connect? Lets try the SQL Management Studio and see.

    ![image](images/image6-6-6.png "image") **Figure: What is a SSPI?**
    { .post-img }

    This does not look good…

    After I have hastily changed the service account back to the original value and made use that his fixed TFS I wanted to also figure out why it broke. Usually I would just ask Shad (one of my extremely technical colleagues) but alas he is on his honeymoon. Some googling turned up an SPN issue. The account that SQL runs under MUST be able to both read and write Service Principal names for itself in Active Directory. This can be set, but only be a domain admin.

    - [Dynamically Set SPN's for SQL Service Accounts](http://clintboessen.blogspot.com/2010/02/dynamically-set-spns-for-sql-service.html)

    So lets go with Network Service instead. If we change the account that SQL Server runs under to “Network Service” then I can add permission for “root_companysqlserver1$” to my share and get it working. Yes, servers have AD accounts as well.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-04-creating-a-backup-in-team-foundation-server-2010-using-the-power-tools\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-04-creating-a-backup-in-team-foundation-server-2010-using-the-power-tools
- FrontMatter:
    title: Enabling Google Plus Profiles for Google Apps users in under 2 minutes
    description: Learn how to enable Google+ profiles for Google Apps users in just 2 minutes. Follow our simple steps to unlock new features and enhance your experience!
    ResourceId: iTuGd858pI6
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 4016
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-11-03
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: enabling-google-plus-profiles-for-google-apps-users-in-under-2-minutes
    aliases:
    - /resources/iTuGd858pI6
    aliasesArchive:
    - /blog/enabling-google-plus-profiles-for-google-apps-users-in-under-2-minutes
    - /enabling-google-plus-profiles-for-google-apps-users-in-under-2-minutes
    - /resources/blog/enabling-google-plus-profiles-for-google-apps-users-in-under-2-minutes
    tags:
    - Install and Configuration
    categories:
    - Uncategorized
    preview: nakedalm-logo-128-link-2-2.png
  BodyContent: |
    It is finally here… just a short time ago Google enabled the ability to have Google Profiles and by extension Google+ on your customer Google Apps domain. However, you first need to enable it before you can use it.

    Google in its infinite wisdom had not yet implemented Google Profiles for Google Apps users. This is an oversight that has been harassing them for quite some time as many power users, their core audience for new things, could not use any of the services that depended on Profiles. Well they listened, and spent a monumental effort to get this working… phew…

    It is actually pretty easy to enable this and other Google features that are not enabled by default..

    \[wpvideo N2s3jARD w=640\]

    **Figure: A demonstration of how to enable Google+ on Google Apps**

    Here are the same steps that I show in the video in more detail.

    1.  Go to the [Google Apps for Business](http://www.google.com/apps/intl/en/business/)site and Sign in.![SNAGHTMLe98856](images/SNAGHTMLe98856-3-3.png "SNAGHTMLe98856") Figure: The Google Apps for Business site gives you access to a bunch of areas easily
        { .post-img }
    2.  You will be asked to enter your domain and what you want to do. You should select “Domain management” to take you to the administration site for your Google Apps domain.![image](images/image-1-1.png "image") **Figure: Its not really “sign in”, its where do you want to “sign in”**
        { .post-img }
    3.  You will then be directed to sign in with your Google Account and be directed to the Dashboard for your Google Apps domain. Don’t get distracted by all of the bells and whistles… Go directly to the “Organisation & users” tab so we can enable the Google+ service.![SNAGHTMLecc6bc](images/SNAGHTMLecc6bc-4-4.png "SNAGHTMLecc6bc") **Figure: There is actually a lot of features here**
        { .post-img }
    4.  You will see a list of all of your users which you can then select the “Services” tab and enable other services. Look down the list until you find “Google+” and flip the toggle from “off” to “on”. You may need to do this for all of the Sub-organisations that you have as well, but I imagine that if you turn it on at the top level that those settings are inherited by the sub organisations.![SNAGHTMLf94fe8](images/SNAGHTMLf94fe8-5-5.png "SNAGHTMLf94fe8") **Figure: Flip the toggle to enable the service**
        { .post-img }
        _note: As this is a family account I just enable everything and let my users decide what services to be a part of._
    5.  Go to [Google+](http://plus.google.com)and sign in. If you follow the sign in process you will be prompted to log into your Google Account again and create your profile.![SNAGHTMLfdb3e8](images/SNAGHTMLfdb3e8-6-6.png "SNAGHTMLfdb3e8") **Figure: Woot: you, and all of your users can now sign up for a Google Profile and Google+**
        { .post-img }

    Go fourth and circle your friends, and remember that [Dustin Hoffman first posited the idea of circles](http://www.youtube.com/watch?v=Kznd0zrSJ2c).

    http://www.youtube.com/watch?v=Kznd0zrSJ2c
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-03-enabling-google-plus-profiles-for-google-apps-users-in-under-2-minutes\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-11-03-enabling-google-plus-profiles-for-google-apps-users-in-under-2-minutes
- FrontMatter:
    title: Scrum with Visual Studio 11 - Creating a new Team Project
    description: Learn how to effortlessly create a Team Project in the cloud with Visual Studio 11. Join Martin Hinshelwood for a quick and easy guide to agile project setup!
    ResourceId: 04eLjqdYkiX
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3976
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-10-25
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: scrum-with-dev11-creating-a-new-team-project
    aliases:
    - /resources/04eLjqdYkiX
    aliasesArchive:
    - /blog/scrum-with-dev11-creating-a-new-team-project
    - /scrum-with-dev11-creating-a-new-team-project
    - /scrum-with-visual-studio-11---creating-a-new-team-project
    - /blog/scrum-with-visual-studio-11---creating-a-new-team-project
    - /resources/blog/scrum-with-dev11-creating-a-new-team-project
    tags: []
    categories:
    - Uncategorized
  BodyContent: |
    Creating a Team Project in the cloud could be daunting, but it is very simple. Just fire up your web browser and you can be up an running asynchronously in no time.

    \[wpvideo 7j9ZdEQ8\]

    **Video: Scrum with dev11 - Creating a new Team Project**
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-10-25-scrum-with-dev11-creating-a-new-team-project\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-10-25-scrum-with-dev11-creating-a-new-team-project
- FrontMatter:
    title: 'Scrum with Visual Studio 11: Creating a Scrum team identity'
    description: Discover how to create a Scrum team identity with Visual Studio 11. Enhance your workflow and collaboration in this insightful guide by Martin Hinshelwood.
    ResourceId: lcqmvIZfw-_
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3831
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-10-25
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: scrum-with-dev11-creating-a-scrum-team-identity
    aliases:
    - /resources/lcqmvIZfw-_
    aliasesArchive:
    - /blog/scrum-with-dev11-creating-a-scrum-team-identity
    - /scrum-with-dev11-creating-a-scrum-team-identity
    - /scrum-with-visual-studio-11--creating-a-scrum-team-identity
    - /blog/scrum-with-visual-studio-11--creating-a-scrum-team-identity
    - /resources/blog/scrum-with-dev11-creating-a-scrum-team-identity
    tags: []
    categories:
    - Uncategorized
    preview: nakedalm-experts-visual-studio-alm-1-1.png
  BodyContent: |
    I have been getting to grips with dev11 recently and I want to share a couple of thing that I like. The first of which is the ability to create teams and to automatically slice your work by that team.

    \[wpvideo UEI5H16i\]

    **Video: Scrum with dev11: Creating a Scrum team identity**

    dev 11 is due out sometime next year and looks to be a major revamp of the TFS and Visual Studio ALM UI.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-10-25-scrum-with-dev11-creating-a-scrum-team-identity\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-10-25-scrum-with-dev11-creating-a-scrum-team-identity
- FrontMatter:
    title: 'Process Template Upgrade #3 - Destroy all Work Items and Import new ones'
    description: Learn how to upgrade your process template by removing old work items and importing new ones in TFS. Follow our step-by-step guide for a smooth transition!
    ResourceId: Lt6VAvnEOjb
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3951
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-10-21
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: process-template-upgrade-3-destroy-all-work-items-and-import-new-ones
    aliases:
    - /resources/Lt6VAvnEOjb
    aliasesArchive:
    - /blog/process-template-upgrade-3-destroy-all-work-items-and-import-new-ones
    - /process-template-upgrade-3-destroy-all-work-items-and-import-new-ones
    - /process-template-upgrade--3---destroy-all-work-items-and-import-new-ones
    - /blog/process-template-upgrade--3---destroy-all-work-items-and-import-new-ones
    - /resources/blog/process-template-upgrade-3-destroy-all-work-items-and-import-new-ones
    tags:
    - Software Development
    - Azure DevOps
    - Install and Configuration
    - System Configuration
    preview: metro-visual-studio-2005-128-link-5-5.png
    categories:
    - Uncategorized
  BodyContent: |
    ![VisualStudioALMLogo](images/VisualStudioALMLogo-6-6.png "VisualStudioALMLogo")
    { .post-img }

    A little while ago I was looking into the best options for [upgrading a process template but still keep your data intact](http://blog.hinshelwood.com/do-you-know-how-to-upgrade-a-process-template-but-still-keep-your-data-intact/), but there is still a little bit of ambiguity on how that is achieved.  Lets look at the #3 option from that set in a little more detail.

    ---

    This solution assumes that you do not care about any of the work items that you currently have. We are effectively going to clean out the old process template along with all of the data and import a new one.

    **WARNING: You will loose all of the Work Items that you currently have in your Team Project if you follow this process (See [Do you know how to upgrade a process template but still keep your data intact?](http://blog.hinshelwood.com/do-you-know-how-to-upgrade-a-process-template-but-still-keep-your-data-intact/) for more options)**

    We have a couple of things to do, and yes, the order does matter:

    1. Fix Queries
    2. Fix Reports
    3. Tare down old Process Template
    4. Build up new Process Template

    This will allow you to move from one process template to another, but there are other things that might be of importance. Maybe you want to upgrade your SharePoint site as well. That however if outside the scope of this post.

    1.  #### **Fix Queries**

            Because we want to keep the old queries around, and you can do nothing but delete them once you delete the Work item Types we need to move them before we do anything to the Team Project. it may be that some of the teams spent a long time getting their queries “just right” and we don’t just want to delete that hard work.

            1. ##### **Create a folder called “\_2008Archive”**

                TFS 2010 added the ability to have Query folders. Here is hoping that we get them on Builds as well in the future.

                [![image](images/image_thumb6-1-1.png "image")](http://blog.hinshelwood.com/files/2011/05/image8.png)

        { .post-img }
        **Figure: The folder will store all of the old queries**

            2. ##### **Move all of the existing Queries into this folder**

                Luckily we can drag and drop Queries within the same Team Project.

                [![image](images/image_thumb7-2-2.png "image")](http://blog.hinshelwood.com/files/2011/05/image9.png)

        { .post-img }
        **Figure: All of your queries are now saved**

            3. ##### **Copy all of the new queries into the team project**

                We have at least one Team Project that was created with the new template (TfsCustomisations), and even more luckily we can drag and drop Queries between Team Projects.

                [![image](images/image_thumb8-3-3.png "image")](http://blog.hinshelwood.com/files/2011/05/image11.png)

        { .post-img }
        **Figure: Shiny new Queries are now waiting for the team**

    2.  #### **Fix Reports**

            You will need to add the new reports to TFS, but unfortunately while there is drag and drop support for moving reports within a Team Project there is no way to drag them _into_ a Team Project, but there his a command line tool to support this. However, prior to running it you should again create a “\_2008Archive” folder to load all of the existing reports into. Again there may be a bunch of custom reports in there that the team does not want to loose. Once you have done that you can call the command line option to install the new templates

            ![image](images/image1-4-4.png "image")

        { .post-img }
        **Figure: Put all existing reports under “\_2008Archive”**

            ```
            tfpt addprojectreports /collection:%tpc% /teamproject:%tp% /processtemplate:"Scrum for Team System v3.0.3784.03" /force
            ```

            **Figure: Command to add all of the Reports for a Process Template to TFS

            **

            note: You will need to have permission to add reports to Reporting Services. Make sure that you are in the Team Foundation Content Manger” role.

    3.  #### **Tare down old Process Template**

        This is where the demolition expert in you gets to have a little fun. It is very complicated to build things, and not so much to destroy them. Now that we have all of our data exported and transformed we can go ahead and destroy all of the Work Item Type Definitions (WITD) that are in that Team Project.

        Because I am running a whole lot of command against multiple Team Projects and I do not want to have to change out the Team Project Collection every time, here is a little hint for the command line.

        ```
        set tpc=http://tfsServerName:8080/tfs/teamProjectCollectionName
        ```

        **Figure: Set a variable so you don't have to add things to every command**

        ```
        witadmin listwitd /collection:%tpc% /p:"[Team Project Name]"
        ```

        **Figure: Get a list of all the Work Item Types**

        This will give you a list of all of the Work Item Type’s that are used in your Team Project. You will need to “destroy” each one using the “destroywitd” command that is part of “witadmin”. In this case the current project is the “Scrum for Team System v2” template so the below command would remove them.

        ```
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Bug" /noprompt
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Product Backlog Item" /noprompt
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Sprint Backlog Item" /noprompt
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Impediment" /noprompt
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Sprint Retrospective" /noprompt
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Sprint" /noprompt
        ```

        **Figure: Delete the default Work Items, but don’t forget any custom ones**

        _note: Because this was a Team Project that was upgraded from TFS 2008 there are no links or categories to update. You will also need to make sure that you do something with all of the custom fields and Work Item Types that have been added._

        **Build up new Process Template**

    4.  Building up the Work Item Types is not quite as much fun as tearing them down, but it does give you more of a sense of achievement. In order to “install” the SfTSv3 Process Template you need to:

        1. ##### **Install the SfTSv3 Work Item Type Definitions**

           These new work item types can be easily added to make it look as if the Project always had this process template. There are still more things that we will need to do later to make this a workable solution.

           ```
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsAcceptanceTest.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsBug.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsImpediment.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsProductBacklogItem.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsRelease.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsSharedStep.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsSprint.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsSprintBacklogTask.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsSprintRetrospective.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsTeamSprint.xml"
           ```

           \*\*Figure: Add the Work Items that you put under version control in the TfsCustomisations Team Project

           \*\*

           _note: You may also get a TF212018 error if you are doing this on an upgraded Team Project Collection. This is because one of the fields in the Work Item Type Definition Xml is different than the one on the server. There are a number of fields that will require the spaces to be removed from their names in order to import the work item. This is just fine and if you make the changes you will be able to import._

           > TF212018: Work item tracking schema validation error: TF26177: The field System.AreaId cannot be renamed from “AreaID” to “Area ID”. If you remove the spaces you will be able to import it.

           **Figure: This is an example message**

        2. ##### **Install the Categories**

           Categories as new in TFS 2010 and all reports to load Categories rather that be hard coded to particular Work Item Types. The only stipulation / limitation is that a Work Item can only be in one Category.

           ```
           witadmin importcategories /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingcategories.xml"
           ```

           **Figure: Add categories to enable some of the TFS 2010 functionality**

        3. ##### **Install the Link Types**

           Link Types enable one of the core features of TFS 2010. The ability to have nested work items. It is worth noting that there are some built in Link Types that are not listed here that will support MS Project and other tools. These will already have been added by the upgrade process.

           ```
           witadmin importLinktype /collection:%tpc% /f:".WorkItemTrackingLinkTypesFailedBy.xml"
           witadmin importLinktype /collection:%tpc% /f:".WorkItemTrackingLinkTypesImpededBy.xml"
           witadmin importLinktype /collection:%tpc% /f:".WorkItemTrackingLinkTypesImplementedBy.xml"
           witadmin importLinktype /collection:%tpc% /f:".WorkItemTrackingLinkTypesSharedStep.xml"
           witadmin importLinktype /collection:%tpc% /f:".WorkItemTrackingLinkTypesTestedBy.xml"
           ```

           **Figure: Link Types only need to be added once**

    And you are done.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-10-21-process-template-upgrade-3-destroy-all-work-items-and-import-new-ones\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-10-21-process-template-upgrade-3-destroy-all-work-items-and-import-new-ones
- FrontMatter:
    title: Product Owners are not a myth
    description: Discover the vital role of Product Owners in Scrum. Learn how they maximize value and manage backlogs effectively for successful agile development.
    ResourceId: pgJ89XqQPZe
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3909
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-10-18
    weight: 690
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: product-owners-are-not-a-myth-2
    aliases:
    - /resources/pgJ89XqQPZe
    aliasesArchive:
    - /blog/product-owners-are-not-a-myth-2
    - /product-owners-are-not-a-myth-2
    - /product-owners-are-not-a-myth
    - /blog/product-owners-are-not-a-myth
    - /resources/blog/product-owners-are-not-a-myth-2
    tags:
    - Software Development
    - Agile Product Management
    - Product Owner
    - Professional Scrum
    - Product Backlog
    - Scrum Team
    categories:
    - Scrum
    - Product Management
    preview: nakedalm-experts-professional-scrum-1-1.png
  BodyContent: |
    ![PST Logo 2](images/PST-Logo-2-4-4.png "PST Logo 2")[Steven Borg](http://blog.nwcadence.com/author/stevenborg/) brought "[5 Reasons Why a Product Owner Team Might Be a Good Idea](http://blog.scrumphony.com/2011/10/5-reasons-why-a-product-owner-team-might-be-a-good-idea/)" to my attention which in turn lead me to read "[Is Scrum a –ism that doesn’t work for real?](http://www.marcusoft.net/2011/10/is-scrum-dead-is-scrum-aism.html)", and for me there seams to be a certain amount of “missing the point” and I wanted to try to find it.
    { .post-img }

    ---

    Lets start with a definition of “Product Owner” from the Scrum Guide:

    > ### The Product Owner
    >
    > The Product Owner is responsible for maximizing the value of the product and the work of the Development Team. **_How this is done may vary widely across organizations, Scrum Teams, and individuals._** The Product Owner is the sole person responsible for managing the Product Backlog. Product Backlog management includes:
    >
    > - Clearly expressing Product Backlog items;
    > - Ordering the items in the Product Backlog to best achieve goals and missions;
    > - Ensuring the value of the work the Development Team performs;
    > - Ensuring that the Product Backlog is visible, transparent, and clear to all, and shows what the Scrum Team will work on next; and,
    > - Ensuring the Development Team understands items in the Product Backlog to the level needed.
    >
    > **_The Product Owner may do the above work, or have the Development Team do it. However, the Product Owner remains accountable._**
    >
    > **_The Product Owner is one person, not a committee. The Product Owner may represent the desires of a committee in the Product Backlog, but those wanting to change a backlog item’s priority must convince the Product Owner._** For the Product Owner to succeed, the entire organization must respect his or her decisions. The Product Owner’s decisions are visible in the content and ordering of the Product Backlog. No one is allowed to tell the Development Team to work from a different set of requirements, and the Development Team isn’t allowed to act on what anyone else says.
    >
    > \-[The Scrum Guide](http://www.scrum.org/scrumguides)

    Being a Product Owner is a management role that does not involve managing people, they are instead managing the “what” that the Development Team are building. They don’t actually have to physically maintain the backlog, or even order it. They are however completely responsible for the backlogs content, order and understanding.

    ### Why is everyone finding this so difficult to find?

    When I am working with organisation on Scrum Adoptions I find it very easy to identify who the Product Owner **_should_** be with more difficulty involved in getting that person to accept that responsibility. I usually let the company lead themselves to the correct understanding of how that should happen as they are the ones that are best placed to figure it out.

    > We do Scrum but we use a Proxy Product Owner from IT because the Product Owner does not have time to be available for the team so the Proxy makes the decisions for the Product Owner and only gets their input when it is a big decision. ![o_Error-icon](images/o_Error-icon-2-2.png "o_Error-icon") **Bad ScrumBut – Proxy PO’s never work out**
    > { .post-img }

    I occasionally end up with a **Proxy Product Owner** and while this is defiantly a “ScrumBut” that results in the businesses order not being reflected in the backlog it is all too common. While, like all “ScrumBut” this has a negative result, as long as everyone understands the negative result and accepts it transparently then at least we can move on. The organisation will figure out evenly why it is not recommended but sometimes things need to learned rather than told.

    ### Why would you not have a Product Owner team?

    I don’t think that any part of Scrum negates the possibility of having a team of people who work for the Product Owner, in fact it positively encourages it. Just because the Scrum Guide does not explicitly say that something is true does not make it false. This is one of the reasons that many non-prescribed things have been stripped out of the Scrum Guide 2011 in the first place.

    I can think of many circumstances where you may have both Project Managers and Business Analysts that work for the product Owner and provide some of the extra capacity that they may need because their backlog is too big.

    > We do Scrum but our Product Owner can’t understand and order the entire backlog because it contains over 900 items so the Product Owner has a team of Business Analysts to help him bring the important ones to surface **![o_Tick-icon](images/o_Tick-icon-3-3.png "o_Tick-icon") Good ScrumBut - Although 900 items is too much overhead**
    > { .post-img }

    My current customer has one product with over 900 items in their backlog. This would be impossible for a Product Owner to fully understand by themselves. They would need minions that can analyse that list and surface the most relevant items for the Product Owners consideration and ordering at the top of the backlog. Does this sound slightly like a Business Analyst roll to anyone else?

    Although the Product Owner has accountability and responsibility for the “what” that the team is  creating they will often need help. This help can come in many forms. It may be the Development Team that helps the Product Owner in small organisations, or a more formal dedicated team that helps them at the enterprise level.

    **How does your Product Owner organise their time?**
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-10-18-product-owners-are-not-a-myth-2\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-10-18-product-owners-are-not-a-myth-2
- FrontMatter:
    title: Allow user to change the region for Windows Live ID billing
    description: Discover how to navigate the challenges of changing your Windows Live ID billing region. Learn from real experiences and advocate for better solutions!
    ResourceId: v_DNTz1r6-H
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3830
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-10-01
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: allow-user-to-change-the-region-for-windows-live-id-billing
    aliases:
    - /resources/v_DNTz1r6-H
    aliasesArchive:
    - /blog/allow-user-to-change-the-region-for-windows-live-id-billing
    - /allow-user-to-change-the-region-for-windows-live-id-billing
    - /resources/blog/allow-user-to-change-the-region-for-windows-live-id-billing
    tags: []
    categories:
    - Uncategorized
    preview: metro-xbox-360-link-2-2.png
  BodyContent: |
    ![img_33742_microsoft-windows-live-logo_450x360](images/img_33742_microsoft-windows-live-logo_450x360-1-1.jpg "img_33742_microsoft-windows-live-logo_450x360")Recently I was burned rather heavily be Microsoft Billing due to their inability to change the region (country) of an account. Yes, you heard me right, there is NO way to change your billing region and the ONLY solution Microsoft can offer is to create a new account.
    { .post-img }

    - **Update 2013-01-16 - Microsoft opens international barriers to Xbox Live account migration.**  
       "Microsoft's throwing open the doors on Xbox Live account migration worldwide for its Xbox 360 consoles, today announcing that XBL accounts are now transferable from region-to-region. That includes everything in your Gold level account"  
       \-[Engadget](http://www.engadget.com/2013/01/16/xbox-live-region-locking-unlocked/)
    - **Update 2012-10-14 - Microsoft has experimental region changing capability.**  
       "At Microsoft, we understand our customers move from one country to another and we continue to evaluate region migration solutions to help Xbox LIVE members access content from their current country location. We have been piloting an account migration process, but it can take several weeks and some content is confined by location due to licensing restrictions and cannot be transferred. We strongly encourage members who do not have an immediate need for account migration to hold tight while we continue to work on an automated tool, or create a new account in the new country location.  
       \-Microsoft Support"
    - **Update 2012-10-11** **- Looks like there might be a huge and profound breakthrough on this topic. Check out [Migrating account Chile to Usa](http://forums.xbox.com/xbox_forums/xbox_support/f/9/p/353657/1834363.aspx#1834363)**
    - **Update 2012-01-06** - One of the folks from the product team looked me up at the last bash and they are aware of the issue as it would relate to TFS Service. To that end they will not be using Live billing.

    ---

    This would not be so bad if it was not for the plethora of services that have recently started using Live ID and I brought this issue up at the last MVP summit. My primary live id will always be the one I have had for ~10 years, but I now have to have another live id for every country I end up living in.

    ![uservoice-logo](images/uservoice-logo-3-3.png "uservoice-logo")If you are already sold then you can vote on either of these user voice sites, but make sure that your opinion of this is heard:
    { .post-img }

    - **User Voice (Visual Studio):** [**Allow user to change the region for Windows Live ID billing**](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2289385-allow-user-to-change-the-region-for-windows-live-i)
    - **User Voice (Windows Phone):** [**Allow changing your windows id location**](http://windowsphone.uservoice.com/forums/101801-feature-suggestions/suggestions/2280332-allow-changing-your-windows-id-location-and-no "http://windowsphone.uservoice.com/forums/101801-feature-suggestions/suggestions/2280332-allow-changing-your-windows-id-location-and-no")

    Still not sure how this will affect you? Read on…

    ### First Burn – Xbox

    ![xbox-live-logo](images/xbox-live-logo-6-6.png "xbox-live-logo")Anyone that knows me would have heard me rant on this one. If you spend 7 years using Xbox Live building up 15000+ gamer score and spending £2000+ (~$3000) on content and subscriptions only to loose EVERYTHING because I took a job in another country!
    { .post-img }

    The result is that I (any this affects my family of 4) have two Live ID’s to manage. Both with content and neither with the full story.

    For more you can read detailed Xbox shenanigans both on  [Xbox Live Accounts – Great But Don’t Move to Another Country!](http://tf.erzz.com/2007/03/14/xbox-live-accounts-great-but-dont-move-to-another-country/) and [Letter to Major Nelson](http://tf.erzz.com/2009/02/18/letter-to-major-nelson/).

    ### Second Burn – Windows Phone 7

    ![windows_phone_logo300x300](images/windows_phone_logo300x300-4-4.jpg "windows_phone_logo300x300")
    { .post-img }

    You would think for the Windows Phone launch that they would have solved this problem, at least for it. But after logging into my brand new T-Mobile US HD7 I was encouraged to download the “Tesco” application and I could only use my UK Credit cards!

    This is not good… it is not a good experience, and I had to figure out how to hard reset my phone on the first day that I had it in order to change out the Live ID from [martin@hins\*\*\*ood.com](mailto:martin@hins***ood.com) to my new xbox [martin-us@hins\*\*\*\*ood.com](mailto:martin-us@hins****ood.com) address.

    What if I go back to the UK and take my phone with me. Granted some of the apps are US specific, like a Walmart app, but most of the ones that I have bought would not have a problem. And what about the crap excuse of “tax” legal issues. What a load of tripe…. My Google phone and apps do not have this problem! I was barely off the plane when I saw US apps in $ and could buy them with either my US credit card or my UK one.

    Not only that, but my phone is tightly integrated to Windows Live… SkyDrive, Facebook, Twitter among other things… it is just a pity that it is using the wrong Live ID.

    What the heak Microsoft! Why are you driving me away!

    ### Future Burn – Holy mother of….

    Do you even realise what you loose when you create a new live ID? Can you name all of the services that use Live Billing that you will loose continuity on when you change country?

    Here is the small list that affects me:

    - **Xbox Live** – Achievements, Gamer Score, Content (thousands of dollars worth), Membership
    - **SkyDrive Storage** – Photos, Files
    - **Zune** – I have some movies bought in the UK and some in the US
    - **Office 360** – Documents
    - **Windows Phone** – Integration
    - **MSDN Subscriptions**
    - **Azure Services** – Online services, Servers, etc..
    - **TFS Azure** – Source Control, Work Item Tracking … etc.  
       _**NOTE:** One of the folks from the product team looked me up at the last bash and they are aware of the issue as it would relate to TFS Service. To that end they will not be using Live billing._
    - **Windows 8 Login** – Settings, Wallpapers and Tight integration on all levels

    With Xbox, Windows Phone and Windows 8 all using your Live ID for login into the system the problem hits ALL of Microsoft's services.

    - You cant use your new countries payment methods
    - You can’t access any features that are country specific

    ![windows-live](images/windows-live-5-5.jpg "windows-live")  
    { .post-img }
    **Figure: I am trying to decide if this is a joke**

    Yes, our online world comes together a long as you stay in the one country for the rest of your life!

    ### Bottom Line

    Like me, are screwed! For now…

    The only possible solution that MUST be in place for Hosted Services & Windows 8 requires two things:

    - The ability to change your billing region
    - The ability for exiting screwed users to merge all of there content, data, services and profile data into a single profile

    **_What do you think is going to be the response from Enterprise when their employees start having issues with signing into their laptops, desktops and phones!_**

    > _“I am sorry, you may have bought that app from the US store and then moved to the US, but you can no longer buy it let alone use it. And that is just tough!”  
    > \-Fictitious Live Rep._

    ### What can I do?

    The only way to even attempt to fix this is to make sure that Microsoft realises how big this problem is now, and how it will affect users in the future.

    - **User Voice (Visual Studio):** [**Allow user to change the region for Windows Live ID billing**](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2289385-allow-user-to-change-the-region-for-windows-live-i)
    - **User Voice (Windows Phone):** [**Allow changing your windows id location**](http://windowsphone.uservoice.com/forums/101801-feature-suggestions/suggestions/2280332-allow-changing-your-windows-id-location-and-no "http://windowsphone.uservoice.com/forums/101801-feature-suggestions/suggestions/2280332-allow-changing-your-windows-id-location-and-no")

    While your vote here, or rants on your own blog may not help, it is the best we can do….
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-10-01-allow-user-to-change-the-region-for-windows-live-id-billing\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-10-01-allow-user-to-change-the-region-for-windows-live-id-billing
- FrontMatter:
    title: Are Scrum Masters agents for change?
    description: Explore how Scrum Masters drive change in organizations. Learn the importance of effective Scrum implementation and the value of Professional Scrum Master training.
    ResourceId: d3jujAd6f6r
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3823
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-09-30
    weight: 690
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: are-scrum-masters-agents-for-change
    aliases:
    - /resources/d3jujAd6f6r
    aliasesArchive:
    - /blog/are-scrum-masters-agents-for-change
    - /are-scrum-masters-agents-for-change
    - /are-scrum-masters-agents-for-change-
    - /blog/are-scrum-masters-agents-for-change-
    - /resources/blog/are-scrum-masters-agents-for-change
    tags:
    - Software Development
    - Scrum Master
    categories:
    - Scrum
    preview: nakedalm-experts-professional-scrum-6-6.png
  BodyContent: |
    ![nwc_logo_tagline](images/nwc_logo_tagline3-7-7.png "nwc_logo_tagline")![PSM Logo 2](images/PSM-Logo-2.png "PSM Logo 2")If you are interested in finding out more about Scrum and how to implement it you might be interested in the Professional Scrum Master certification. Think of it not as becoming a “Master” of anything, but just making sure that you are not going to be a danger to those around you.
    { .post-img }

    ---

    Do you remember way back in the mists of time when I learned to be a [Professional Scrum Developer Trainer](http://blog.hinshelwood.com/professional-scrum-developer-net-training-in-london/)? Well, now I have added the fantastic Professional Scrum Master Training to my capabilities, and I am happy to announce that I have even taught it [right here in Seattle](http://courses.scrum.org/classes/show/451) last week. Not a public course, but my customer was very happy with the result…

    The Scrum Master track is a little like your driving test. it does not tell you that you can drive, but that you have met a minimum bar and are less likely to kill someone. The [Professional Scrum Master I assessment](http://www.scrum.org/scrummaster/) is like that, with the [Professional Scrum Master II assessment](http://www.scrum.org/scrummaster/) being a LOT harder. You really need to know your stuff and how it is applied in the real world to even attempt this exam, but most do not need to attain this level.

    The Scrum Master is the person that would be evangelising Scrum to the rest of your organisation so, kind of like the Retrospective meeting, is core to your organisations ability to adopt Scrum.

    ![evangelistboy](images/evangelistboy-2-2.jpg "evangelistboy") **Figure: No, not that kind of Evangelist… kind of.**
    { .post-img }

    So, why would you want to sit through a 2 day course. Well, there are a number of reasons, first of which is that you will need a certain number of people with a firm understanding of what you are about. Even if that is just to allow them to tell you that [Scrum is hard to adopt and disruptive to your organisation](http://blog.hinshelwood.com/scrum-is-hard-to-adopt-and-disruptive-to-your-organisation/). If that is all that you learn then it will be a valuable lesson.

    If you can change slowly you should probably look at a more sedate change method like Kanban that can incrementally improve your current process. If you MUST have the benefits NOW. Then Scrum is a way to get them NOW. Be prepared…

    You need to build up knowledge in your “change agents” or create them if you do not already have them in order to help them understand how they will implement Scrum. It is not good enough to take the folks that are new to your organisation, send them on the PSM and have them implement the change. This will lead to failure. Although these new individuals will tend to be those with the most availability, they are not going to understand how the new technics are going to be applied in YOUR organisation. Nor will they have the experience to understand where many of the challenges will be…

    ![2928830920_f694a21200](images/2928830920_f694a21200-1-1.jpg "2928830920_f694a21200") **Figure: The old warriors really do know best**
    { .post-img }

    Instead take your longest serving, battle hardened folks and send them. Once they understand the ability that Scrum provides to change quickly and get results it will be difficult to hold them back. if you can’t teach an old dog new tricks then you are just not trying hard enough. Its about learning new approaches and applying them to the same old problems. If you don’t know what the same old problems are then it can be difficult to avoid them.

    Ultimately the Professional Scrum Master course is primarily targeted at those responsible for the successful use and/or rollout of Scrum in a project or enterprise. In short, they do tend to be the old dogs.

    If you are still interested then check out the syllabus for the course and see if it is right for you…

    <table border="0" cellspacing="0" cellpadding="2"><tbody><tr><td valign="top" width="200"><strong>Date</strong></td><td valign="top" width="200"><strong>Location</strong></td><td valign="top" width="200"><strong>Title</strong></td><td valign="top" width="210"></td></tr><tr><td valign="top">29th November 2011</td><td valign="top">Minneapolis, United States</td><td valign="top">Professional Scrum Master</td><td valign="top"><a href="http://courses.scrum.org/classes/show/449" target="_blank"><img style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" src="images/image1-3-3.png" alt="image" width="79" height="25" border="0"></a></td></tr><tr><td valign="top">1st December 2011</td><td valign="top">Minneapolis, United States</td><td valign="top">Professional Scrum Master</td><td valign="top"><a href="http://courses.scrum.org/classes/show/450" target="_blank"><img style="background-image: none; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" src="images/image2-4-4.png" alt="image" width="79" height="25" border="0"></a></td></tr><tr><td valign="top">6th December 2011</td><td valign="top">Kirkland, United States</td><td valign="top">Professional Scrum Master</td><td valign="top"><a href="http://courses.scrum.org/classes/show/434" target="_blank"><img style="background-image: none; padding-left: 0px; padding-right: 0px; display: inline; padding-top: 0px; border: 0px;" title="image" src="images/image3-5-5.png" alt="image" width="79" height="25" border="0"></a></td></tr></tbody></table>
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-30-are-scrum-masters-agents-for-change\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-30-are-scrum-masters-agents-for-change
- FrontMatter:
    title: Caffeinating Your Development Lifecycle in Bellevue on October 13th
    description: Join us in Bellevue on October 13th for Coffee Talks! Energize your development with live demos, Agile discussions, and fresh coffee. Register now!
    ResourceId: uPqvuZorGO-
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3796
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-09-26
    weight: 715
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: caffeinating-your-development-lifecycle-in-bellevue-on-october-13th
    aliases:
    - /resources/uPqvuZorGO-
    aliasesArchive:
    - /blog/caffeinating-your-development-lifecycle-in-bellevue-on-october-13th
    - /caffeinating-your-development-lifecycle-in-bellevue-on-october-13th
    - /resources/blog/caffeinating-your-development-lifecycle-in-bellevue-on-october-13th
    tags: []
    categories:
    - Uncategorized
    preview: metro-nwc-128-link-3-3.png
  BodyContent: |
    ![clip_image001](images/clip_image001-1-1.jpg "clip_image001")Northwest Cadence has decided that while online events are good, nothing beats in-person. If you’re in the area and available, we would love to have you attend our inaugural event at the Microsoft Store in Bellevue in a few weeks!
    { .post-img }

    ---

    [Cheryl](http://blog.bsktcase.com/) noticed that MSFT has a presentation room at its Bellevue Store, and we decided to make use of it for our Coffee Talks. Because of the success of the Test Tools in-person that we did only a few months ago we have been talking internally about two things:

    - **Attending more User Groups**  
       This is a little more difficult as it will require us to have knowledge of all of the UG’s available wherever our consultant happen to be.
    - **Coffee talks In-Person**  
       In-person events have far more impact than remote, and it is a lot easier to illicit the in session interaction that coffee talks warrant.

    We are starting with the Coffee Talks, and did I say… they are early! You can come and still make it to work before 9am ![Smile](images/wlEmoticon-smile2-4-4.png)
    { .post-img }

    > ![clip_image002](images/clip_image002-2-2.jpg "clip_image002")
    > { .post-img }
    >
    > What are Coffee Talks, you ask? As the name suggests, these are morning ALM discussions that are sure to wake you up and get your day off to a great start! For our LIVE Coffee Talk events, hosted at The Microsoft Store, we will serve coffee (and some tasty coffee cakes!) and provide live demonstrations of Visual Studio features on the theatre’s big screen. We will have special giveaways and door prizes to make it even more fun! When we’re finished, you will have plenty of time to get to the office – or stay a little longer and play in the Store before it opens!
    >
    > **Join Northwest Cadence for fresh brewed coffee, a variety of specialty coffee cakes, and some morning** **ALM discussions that are sure to wake you up and get your day off to a great start!**
    >
    > **Caffeinate Your Development Lifecycle**
    >
    > In this kick-off session, we’ll get everybody wired with live demos of Microsoft Visual Studio 2010, hearty conversation about Agile, and practical advice you can start using today.
    >
    > Focus your processes and energize your teams with help from Northwest Cadence and the latest Microsoft tools.  Learn how robust Application Lifecycle Management practices support your entire organization, from CEO to UAT.  Accelerate delivery and process improvement with a full-bodied blend of agility, transparency and quality.

    **You will need to [register](http://nwccoffeetalk20111013.eventbrite.com/) for** **$10.00 (just to make sure you go) and there are only 50 places, so get your skates on. It is an early session so that you can still make it to work and it starts at 7am.**

    > **When: Thursday morning, October 13th, 2011**
    >
    > 7:00 AM Welcome
    >
    > **7:30 AM Event Start Time**
    >
    > 8:30 AM Event End Time
    >
    > **Where**: The Microsoft Store Bellevue Square
    >
    > 116 Bellevue Square, Bellevue, WA, 98004
    >
    > [See it on Bing Maps!](http://www.bing.com/maps/?ss=ypid.YN925x182844282&vm=BingMapsTeam-BellevueSquare&i=1)
    >
    > **To Register\*\***:\*\* Register online at [http://nwccoffeetalk20111013.eventbrite.com/](http://nwccoffeetalk20111013.eventbrite.com/)
    >
    > **Questions\*\***?\*\* Email [Amanda.Jaworski@nwcadence.com](mailto:Amanda.Jaworski@nwcadence.com)

    I look forward to helping _Caffeinate Your Development Lifecycle_ on October 13th! I am hoping to actually be there myself along with [Cheryl Hammond](http://blog.bsktcase.com/) & [Steven Borg](http://blog.nwcadence.com/author/stevenborg/) who will actually be presenting.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-26-caffeinating-your-development-lifecycle-in-bellevue-on-october-13th\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-26-caffeinating-your-development-lifecycle-in-bellevue-on-october-13th
- FrontMatter:
    title: Scrum is hard to adopt and disruptive to your organisation
    description: Discover the challenges of adopting Scrum in your organization. Learn why commitment and training are essential for successful Agile transformation.
    ResourceId: TRgmAScsBJs
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3789
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-09-22
    weight: 640
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: scrum-is-hard-to-adopt-and-disruptive-to-your-organisation
    aliases:
    - /resources/TRgmAScsBJs
    aliasesArchive:
    - /blog/scrum-is-hard-to-adopt-and-disruptive-to-your-organisation
    - /scrum-is-hard-to-adopt-and-disruptive-to-your-organisation
    - /resources/blog/scrum-is-hard-to-adopt-and-disruptive-to-your-organisation
    tags:
    - Software Development
    - Agile Transformation
    - Pragmatic Thinking
    - Agile Frameworks
    - Product Delivery
    categories:
    - Scrum
    - Product Management
    preview: nakedalm-experts-professional-scrum-4-4.png
  BodyContent: |
    Before the "[Professional Scrum Foundations](http://www.scrum.org/professionalscrumfoundations/)" course ever existed I was tasked with delivering a practical Scrum foundation course for our customers. I came up with a 2 day “Scrum Foundation” course that included lots of practical exercises and leveraged the existing [Scrum Open](http://www.scrum.org/scrumopen/) exam. But why would you want it and is that all you need?

    ---

    It is hard to adopt Scrum. You just have to read Ken’s “Scrum is hard and Disruptive” to understand just how hard!

    ## But is that bad?

    The reason that more organisations start looking hard at Agile and Scrum adoption is that we, as an industry, have lost the trust of business. The reason that we have lost the trust of business is that we (the IT industry) have proven time and again that we are:

    - unable to deliver on time
    - unable to deliver on budget
    - unable to deliver what the business need

    Is it any wonder that business does not trust us?

    > 1. Scrum is a framework for iterative, incremental development using cross-functional, self-managing teams. It is built on industry best practices, lean thinking, and empirical process control.
    > 2. Scrum is optimized for high yield product management and product development. Scrum is particularly appropriate for high risk, complex, large projects and can be used when other parts of the endeavour are hardware or even waterfall development.
    > 3. If waterfall suits current needs, continue using it.
    > 4. An enterprise can use Scrum as a tool to become the best product development and management organization in its market. Scrum will highlight every deficiency and impediment that the enterprise has so the enterprise can fix them and change into such an organization.
    > 5. Whenever an enterprise modifies or only partially implements Scrum, it is hiding or  
    >    obscuring one or more dysfunctionalities that restrict its competence in product  
    >    development and management.
    > 6. The iterative, incremental nature of Scrum puts stress on the product development organization to improve its engineering skills and on the product management organization to optimize the return on investment of every release and project. The phrase, “That can’t be done here” really means that it will be very difficult to do so. The gap between current practices and target practices is a measure of incompetence and  
    >    competitive risk.
    > 7. The use of Scrum to become an optimized product development and management organization is a change process that must be led from the top and requires change by everyone within the enterprise. Change is extremely difficult and fraught with conflict, and may take many years of sustained effort. Turnover of staff and management can be expected.
    > 8. The most serious impediments to using Scrum are habits of waterfall, predictive thinking over the last twenty to thirty years; these have pawned command and control management, belief that demanding something will make it happen, and the willingness of development to cut quality to meet dates. These are inbred habits that we aren’t even aware of anymore.
    > 9. The focus of using Scrum is the change from old habits to new ways of doing business. Scrum is not implemented or rolled-out as a process; it is used to foment change.
    > 10. Scrum is not a methodology that needs enhancing. That is how we got into trouble in the first place, thinking that the problem was not having a perfect methodology. Effort centres on the changes in the enterprise that is needed.
    > 11. Iterative, incremental development is much harder than waterfall development; everything that was hard in waterfall engineering practices now has to be done every iteration, and this is incredibly hard. It is not impossible, but has to be worked toward over time.
    > 12. Managing a release or project to deliver only the highest value functionality and not deliver the rest optimizes value \[and\] is the job of product management and customers.
    > 13. Self-managing teams are extremely productive. When they work closely with the customer to derive the best solution to a need, they and the customer are even more productive.
    > 14. A team consists of people under pressure to do their best. Conflict is natural and the team needs to know how to deal with the conflict and have resources to draw on when needed.
    > 15. The role of an enterprises management changes from telling people what to do to leading and helping everyone do their best to achieve goals. People aren’t resources and managers aren’t bosses
    >
    > \-Scrum is Hard and Disruptive, [Ken Schwaber](http://kenschwaber.wordpress.com/), 2006.

    An interesting point to note is #3. If what you are doing works, then keep doing it, but usually if you are reading something like this, or thinking of any sort of Agile training then everything is not going well with Waterfall ![Smile](images/wlEmoticon-smile1-6-6.png)
    { .post-img }

    In order to help a Development Team adopt Scrum there are three things that they will need:

    ## Training

    Wither this is formal training or in-house adoptive training it is crucial that everyone attain the same level of understanding of the target operating model and they can then understand what it means to them.

    This is the reason that I created the Scrum Foundation course. It is a level setting course that is designed to put the team on the right track from the start.

    ![MCXWQYK0ILHYVUPXXYHRWZERXMGCY3RMJQTZC23CHG53N0AM](images/MCXWQYK0ILHYVUPXXYHRWZERXMGCY3RMJQTZC23CHG53N0AM-3-3.jpg "MCXWQYK0ILHYVUPXXYHRWZERXMGCY3RMJQTZC23CHG53N0AM")  
    { .post-img }
    **Figure: My First Team (BI) in Chicago this week**

    ## Mentoring

    Once a team starts implementing Scrum they need a little extra help. While teams that have no on-going Scrum Mentoring do succeed at Scrum, more often they fail, or take a really long time to adopt. With a Mentor that is able to answer questions and attend the Sprint Review and Retrospective team are more easily able to adapt. This mentor does not need to be full time, but available to answer questions when the team has them.

    ![TWQEIN2FV04YY24FLFKCCHR3XKRZJ51DNFUPLNRWKZTLF1DJ](images/TWQEIN2FV04YY24FLFKCCHR3XKRZJ51DNFUPLNRWKZTLF1DJ-5-5.jpg "TWQEIN2FV04YY24FLFKCCHR3XKRZJ51DNFUPLNRWKZTLF1DJ")  
    { .post-img }
    **Figure: My Second Team (ASP.NET) getting stuck into one of my activities**

    ## Dedication

    As Ken has said, Scrum is hard to adopt and disruptive to your organisation. It will shake things up and you need the dedication and commitment to follow through. Things will get harder before they get better and it will be hard for the organisation to change on many levels.

    - There will be clashes between the business and IT as the Business asserts control over what is built and when. This is a critical process and as the Development Team builds trust with the Business the rest of the IT hierarchy will feel more and more isolated until it adapts and gets stuck into the process as well.
    - Individuals will worry about their job security as things change around them until they begin to understand the niches available and which ones fit them.
    - Individuals will be challenged and upset by the mixed messages they get as the understanding of the scope of change takes place within an organisation.
    - Metrics will change as trust is built up between Business, IT and the Team. Certain metrics, measures and gates will start to change and often disappear as the reason that they existed (distrust) starts to be eroded.

    ![image](images/image-2-2.png "image")  
    { .post-img }
    **Figure: Not all early sprints will be successful**

    During a Scrum adoption **expect to fail early and often**. No, its more than that. I WANT to fail early and often as it is far less costly than the Waterfall (and and long iterative approach) where the risk is at the end and you **fail late**.

    - **Would you rather fail 4 agile projects at Sprint 4 or would you rather fail one waterfall in its 3rd year?**  
       note: one is circa 20 times more expensive than the other… can you guess which?

    ![grafx-agile-risk-value-cycle](images/grafx-agile-risk-value-cycle-1-1.jpg "grafx-agile-risk-value-cycle")  
    { .post-img }
    **Figure: Agile risk is all up front**

    Remember it is HARD to do Scrum, your teams are not used to this process and your business is only beginning to understand the benefits. This is usually when IT management get cold feet and try to pull out. Remember that it is the Business that pays the bills and that they are usually on-board by now. The team may not have had a successful sprint but they will have been able to show "something" and the Product Owner will have been able to give feedback.

    - **How do you think the business will react if you suddenly take that feedback loop away from them?**
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-22-scrum-is-hard-to-adopt-and-disruptive-to-your-organisation\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-22-scrum-is-hard-to-adopt-and-disruptive-to-your-organisation
- FrontMatter:
    title: Not just happy, but ecstatic
    description: Discover how a consultant transformed a challenging deployment process into a streamlined success with TFS 2010, enhancing efficiency and collaboration.
    ResourceId: C7FpzXTFpU_
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3783
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-09-16
    weight: 690
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: not-just-happy-but-ecstatic
    aliases:
    - /resources/C7FpzXTFpU_
    aliasesArchive:
    - /blog/not-just-happy-but-ecstatic
    - /not-just-happy-but-ecstatic
    - /not-just-happy,-but-ecstatic
    - /blog/not-just-happy,-but-ecstatic
    - /not-just-happy--but-ecstatic
    - /blog/not-just-happy--but-ecstatic
    - /resources/blog/not-just-happy-but-ecstatic
    tags: []
    categories:
    - Uncategorized
  BodyContent: |
    ![VS2008Upgraded_4](images/VS2008Upgraded_4-1-1.png "VS2008Upgraded_4")As a consultant I have customers. Unfortunately being a **consultant** rather than a **contractor** has the down side that I hardly ever here from my customers after my engagement ends.
    { .post-img }

    ---

    I just noticed an email from one of my more challenging engagements in the UK for a company that specialises in deploying solutions in Microsoft Dynamics. They had problems with many divergent versions of their application as well as a complicated, manual and error prone deployment model.

    I worked with them on a **Tools** and **Practices** engagement for only around 10 days spread over a couple of months an this was the result:

    > Just a quick email to say thanks for your help on moving us forward on TFS 2010. My vision for having an installed website as a product is now complete and Ahmed has been fully trained up with the **rolled up newspaper**.
    >
    > We now have a build process that creates a custom MSI file (for both the test and live sites) for each customer or any customer we choose to put in a build parameter. The MSI, all built in lovely WIX, installs the product and runs the datadude process to synch the database. Job done!
    >
    > I had an opportunity to demo this to another company last month, whilst I was in Vegas. They have a similar issue with code going out of synch from the DB and managing too many branches. I created an empty db added an entry to my hosts file for the site name and ran the installer. Instant website, all the defaults populated. They couldn’t believe it as they have over 40 branches to manage.
    >
    > I’m now looking at the QA process with MTM, which looks fantastic, so fingers crossed!
    >
    > Anyway, thanks again. It’s been a life changer here!  
    > \- [Paul Martin](http://twitter.com/#!/paul_martin22)

    I really enjoyed working with this team and that brings me back to the other things that I did when I was reading this email. I looked up the cost of flights. And I was really surprised.

    I can fly to the UK from Seattle for $733 (£464.00) return! That is cheaper than most of the flights for client engagements here. Yes, it may cost a little more in hotel costs, and I would be less flexible in flights, but it is potentially doable.

    Not saying I am going to, but I am a little more inclined to seek clients in Europe as well.

    p.s. The metaphorical **Rolled Up Newspaper** approach works very well for developers.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-16-not-just-happy-but-ecstatic\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-16-not-just-happy-but-ecstatic
- FrontMatter:
    title: You are doing Scrum but the Scrum Master tells the team what to do!
    description: Discover why a Scrum Master shouldn't dictate tasks to the team. Empower self-organization and enhance accountability for better project outcomes.
    ResourceId: 5WdN6qGylV8
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3778
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-09-13
    weight: 280
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: you-are-doing-scrum-but-the-scrum-master-tells-the-team-what-to-do
    aliases:
    - /resources/5WdN6qGylV8
    aliasesArchive:
    - /blog/you-are-doing-scrum-but-the-scrum-master-tells-the-team-what-to-do
    - /you-are-doing-scrum-but-the-scrum-master-tells-the-team-what-to-do
    - /you-are-doing-scrum-but-the-scrum-master-tells-the-team-what-to-do-
    - /blog/you-are-doing-scrum-but-the-scrum-master-tells-the-team-what-to-do-
    - /resources/blog/you-are-doing-scrum-but-the-scrum-master-tells-the-team-what-to-do
    tags:
    - Self Organisation
    - Social Technologies
    - Team Collaboration
    - Agile Frameworks
    - Scrum Team
    - Software Development
    - Professional Scrum
    - Scrum Master
    - Team Performance
    - Agile Product Management
    - Agile Transformation
    - Agile Leadership
    - Coaching
    - Pragmatic Thinking
    categories:
    - Scrum
    - Technical Leadership
    preview: nakedalm-experts-professional-scrum-1-1.png
  BodyContent: |
    If you are doing Scrum but the Scrum Master tells the team what to do then you may be missing the point.

    Ultimately the Scrum Master should never tell the Development Team what to do and they should make sure that the Development Team has both the knowledge and the skills to work things out for themselves. This is critical to the teams ability to self organise going forward because we all learn by the mistakes we make.

    ---

    A Scrum Master does NOT equal Project Manager. In Scrum, project management is the responsibility of the entire Scrum Team (Scrum Master, Product Owner and Development Team) and is distributed as such, with the Scrum Master keeping an eye on the mechanics of Scrum to make sure it is working. The top-down management model traditionally used for project execution is rejected in favour of self-organization and shared accountability. While this is alien to many organisations it has been proven time and time again to increase the accountability, efficiency and quality of the software delivered by the Scrum Team.

    In Scrum the responsibilities between the Scrum Master and the Development Team are very explicit. The Scrum Master is there to serve the Development Team, not to manage them.

    - **Scrum Master**
      - Scrum Mechanics
      - Individual & Team Training
      - etc.
    - **Development Team**
      - Conflict Resolution
      - Engineering Practices
      - Grooming the Backlog (with Product Owner)
      - etc.

    All implementation, whither centred around working together, working to build software or working on the backlog, is the purview of the Development Team. This, however, does not mean that the Development Team are left to flounder. I mentioned that the Scrum Master is responsible for making sure that the Development Team has the Knowledge and Skills necessary to allow that Development Team to resolve things themselves.

    In order to allow the Scrum Master to provide the knowledge necessary to resolve conflicts they could ask questions of the team to illicit knowledge and learning.

    > The term **[Socratic questioning](http://en.wikipedia.org/wiki/Socratic_questioning)** is used to describe a kind of questioning in which an original question is responded to as though it were an answer. This in turn forces the first questioner to reformulate a new question in light of the progress of the discourse.  
    > \-[Socratic method](http://en.wikipedia.org/wiki/Socratic_method)

    Using this method a Scrum Master can “guide” a Development Team through the muddy waters of finding solutions to problems without enforcing their views or restricting the creativity of the Development Team.

    > Groups that defer to a person of higher status will miss many good ideas, and fail to tap and develop the talents of the entire group.  
    > [\-Esther Derby: Why Group Dynamics and Interpersonal Skills Matter](http://www.estherderby.com/weblog/2009/07/why-group-dynamics-and-interpersonal.html)

    In addition the Scrum Master should never provide the team with options, unless they are specifically asked by the team for their opinion or their assistance. This removes the responsibility of the Development Team to make decisions and may limit the options that the Development Team creates. If they are provided with options they are unlikely to try to formulate their own and if that option fails they can claim it is the responsibility of the person who provided that option and not of the Development Team.

    > You will have to have, learn, or improve requirements gathering and presentation techniques; quality techniques; refactoring; customer engagement; collaboration; teaming; conflict resolution techniques; and other practices, as well. But the Scrum framework will help you by providing continual feedback on your progress and success.  
    > \-[Ken Schwaber: Scrum As A Framework](http://kenschwaber.wordpress.com/2010/09/08/scrum-as-a-framework/)

    The Development Team must be empowered to come up with resolutions to the problems that they have without interference.

    ### References

    - [Scrum Guide 2011](http://www.scrum.org/scrumguides)
    - [Why Group Dynamics and Interpersonal Skills Matter](http://www.estherderby.com/weblog/2009/07/why-group-dynamics-and-interpersonal.html)
    - [Scrum As A Framework](http://kenschwaber.wordpress.com/2010/09/08/scrum-as-a-framework/)
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-13-you-are-doing-scrum-but-the-scrum-master-tells-the-team-what-to-do\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-13-you-are-doing-scrum-but-the-scrum-master-tells-the-team-what-to-do
- FrontMatter:
    title: Testing with Test Professional 2010 and Visual Studio 2010 Ultimate
    description: Join our Testing with Test Professional 2010 course to enhance your skills in Visual Studio ALM. Limited seats available for this remote training!
    ResourceId: SPcXGSE8VUI
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3776
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-09-07
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: testing-with-test-professional-2010-and-visual-studio-2010-ultimate
    aliases:
    - /resources/SPcXGSE8VUI
    aliasesArchive:
    - /blog/testing-with-test-professional-2010-and-visual-studio-2010-ultimate
    - /testing-with-test-professional-2010-and-visual-studio-2010-ultimate
    - /resources/blog/testing-with-test-professional-2010-and-visual-studio-2010-ultimate
    tags: []
    categories:
    - Uncategorized
  BodyContent: |
    ![NWC tagline logo_transparent](images/NWC-tagline-logo_transparent-1-1.png "NWC tagline logo_transparent")On Monday 24th October one of our consultants, Dan Wood, is presenting our course on Testing with Visual Studio ALM. The course is running on **Monday 24th October** and I managed to get NWC to provide 10 additional seats for you guys at the discounted rate.
    { .post-img }

    ---

    If you are in Europe then it is a little later in the day, but it is at least not in the middle of the night ![Smile](images/wlEmoticon-smile-2-2.png). I think however that you will enjoy it anyway.
    { .post-img }

    [![Register for Hands on Lab: 
    Testing with Test Professional 2010 and Visual Studio 2010 Ultimate
    Remote Course Offering in Remote Course Offering  on Eventbrite](http://www.eventbrite.com/registerbutton?eid=1210319097)](http://nwcadencetestcourse201110.eventbrite.com?ref=MrHinshBlog&discount=MrHinsh)

    > ### Target Audience: Testers, Test Managers and Development Managers
    >
    > ### By the end of the course, testers should be able to:
    >
    > Start testing software with Microsoft Test Manager and TFS. Test Managers will have enough knowledge to manage testing activities with MTM and TFS. All participants should understand the workflow between developers and testers and understand the benefits of MTM and TFS. In addition, all participants will understand the reports generated by TFS relating to quality and be able to report on application quality on the Cube.
    >
    > ### Course Overview:
    >
    > - End to End discussion of the application lifecycle using Visual Studio, Team Foundation Server and Microsoft Test Manager
    > - Features of the 2010 release with a focus on how these apply to testers
    > - Including Work Item Tracking and an Introduction to Automated Builds
    > - Creating & Managing Test Plans
    > - Creating & Managing Test Cases
    > - Executing manual tests
    > - Filing Bugs
    > - Exploratory Testing
    > - Verifying bugs
    > - Automating manual tests
    > - Executing automated tests
    >
    > _Course**:**_ **Testing with Test Professional 2010 and Visual Studio 2010 Ultimate**
    >
    > _Location**:**_ **Remote**
    >
    > _Dates**:**_ **October 24 -27, 2011**
    >
    > _Time:_ **8:30AM-12:30PM PST daily | 16:30 - 20:30 GMT** **daily**
    >
    > _Price**:**_ **$1,200 (~£750) per student**

    [![Register for Hands on Lab: 
    Testing with Test Professional 2010 and Visual Studio 2010 Ultimate
    Remote Course Offering in Remote Course Offering  on Eventbrite](http://www.eventbrite.com/registerbutton?eid=1210319097)](http://nwcadencetestcourse201110.eventbrite.com?ref=MrHinshBlog&discount=MrHinsh)

    This is a really worth while course that will help you get the most out of Test Professional. Dan is a fantastic teacher and will be giving energising sessions.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-07-testing-with-test-professional-2010-and-visual-studio-2010-ultimate\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-09-07-testing-with-test-professional-2010-and-visual-studio-2010-ultimate
- FrontMatter:
    title: 'Subversion to TFS 2010: The migration engine is unable to resolve a conflict where two changes have the same target item'
    description: Navigate the challenges of migrating from Subversion to TFS 2010. Discover solutions for resolving conflicts and ensure a smooth transition for your projects.
    ResourceId: z1EKAHhrUI7
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3769
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-08-26
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: subversion-to-tfs-2010-the-migration-engine-is-unable-to-resolve-a-conflict-where-two-changes-have-the-same-target-item
    aliases:
    - /resources/z1EKAHhrUI7
    aliasesArchive:
    - /blog/subversion-to-tfs-2010-the-migration-engine-is-unable-to-resolve-a-conflict-where-two-changes-have-the-same-target-item
    - /subversion-to-tfs-2010-the-migration-engine-is-unable-to-resolve-a-conflict-where-two-changes-have-the-same-target-item
    - /subversion-to-tfs-2010--the-migration-engine-is-unable-to-resolve-a-conflict-where-two-changes-have-the-same-target-item
    - /blog/subversion-to-tfs-2010--the-migration-engine-is-unable-to-resolve-a-conflict-where-two-changes-have-the-same-target-item
    - /resources/blog/subversion-to-tfs-2010-the-migration-engine-is-unable-to-resolve-a-conflict-where-two-changes-have-the-same-target-item
    tags:
    - Troubleshooting
    - Software Development
    preview: image-1.png
    categories:
    - Uncategorized
  BodyContent: |
    [![subversion](images/subversion_thumb-17-17.png "subversion")](http://blog.hinshelwood.com/files/2011/08/subversion1.png)
    { .post-img }

    [![image](images/image_thumb-1-1.png "image")](http://blog.hinshelwood.com/files/2011/08/image4.png)Running into problems when migrating a Subversion Repository to Team Foundation Server is what to so with conflicts resulting from SVN being Case Sensitive and TFS not.
    { .post-img }

    note: Case Sensitivity is mostly a bad idea for files, url’s and code.

    ---

    On of the problems with Subversion is that it treats “/trunk/a.txt” and “/trunk/A.txt” as two different files. This can cause conflicts during the migration that need to be resolved.

    [![image](images/image_thumb1-2-2.png "image")](http://blog.hinshelwood.com/files/2011/08/image5.png) **Figure: The migration runs smoothly for a while.**
    { .post-img }

    For the smaller sets that I migrated to test this tool it worked just fine, but the larger the data set, the more likely you are to encounter errors. The first set was 1700+ changes, but this one is 24000+ which mean that it is more than 10 times more likely to encounter a conflict.

    [![image](images/image_thumb2-6-6.png "image")](http://blog.hinshelwood.com/files/2011/08/image6.png) **Figure: Unable to resolve conflict where two changes have the same target item**
    { .post-img }

    Dam, but conflicts suck. This particular conflict is due to two changes from Subversion are being applied to the same file in a single changes. We need to be able to resolve this as you will not be able to make changes to what is migrated and then rerun that portion.

    ```
    LogicalOperationStack=Migrate, Main
    DateTime=2011-08-26T16:21:57.8098771Z
    [8, 4532, 8/26/2011 9:21:57 AM, Migrate] Stopping (overall: 00:00:01.1687929)
    MigrationConsole.exe Warning: 0 : The migration engine is unable to resolve a conflict where two changes have the same target item:
    LogicalOperationStack=Main
    DateTime=2011-08-26T16:21:57.8108537Z
    MigrationConsole.exe Information: 0 : Microsoft.TeamFoundation.Migration.Toolkit.UnresolvableConflictException: The migration engine is unable to resolve a conflict where two changes have the same target item:
       at Microsoft.TeamFoundation.Migration.Toolkit.ChangeOptimizer.detectConflicts()
       at Microsoft.TeamFoundation.Migration.Toolkit.ChangeOptimizer.Resolve()
       at Microsoft.TeamFoundation.Migration.Toolkit.BatchingContext.Flush()
       at Microsoft.TeamFoundation.Migration.Toolkit.VC.SourceToTfsMigrationEngine.Flush(BatchingContext context)
       at rlEDq7v0Ex0lXcB8eF.3RBgRNXCby0G0kR3Z1.Flush(BatchingContext context)
       at Microsoft.TeamFoundation.Migration.Toolkit.VC.SourceToTfsMigrationEngine.ProcessChangeGroup(ChangeGrouping group)
       at rlEDq7v0Ex0lXcB8eF.3RBgRNXCby0G0kR3Z1.ProcessChangeGroup(ChangeGrouping )
       at kKnILa3qW3UW4h2H4L.f8pB0cQoQnxV42wuir.ProcessChangeGroup(ChangeGrouping )
       at Microsoft.TeamFoundation.Migration.Toolkit.VC.VCMigrationEngine.MigrateEach()
       at Microsoft.TeamFoundation.Migration.Toolkit.VC.VCMigrationEngine.Run()
       at Microsoft.TeamFoundation.Migration.Toolkit.VC.SourceToTfsMigrationEngine.Run()
       at rlEDq7v0Ex0lXcB8eF.3RBgRNXCby0G0kR3Z1.Run()
       at OjkZA5fW18B01Gf9op.bKFnHGSRxN5AAInIof.vonZTPjT0()
    LogicalOperationStack=Main
    DateTime=2011-08-26T16:21:57.8118303Z
    MigrationConsole.exe Information: 0 : Svn2TFS_cgx: The migration engine is unable to resolve a conflict where two changes have the same target item:
    LogicalOperationStack=Main
    DateTime=2011-08-26T16:21:57.8118303Z
    MigrationConsole.exe Warning: 0 : Thread was being aborted.
    LogicalOperationStack=Main
    DateTime=2011-08-26T16:21:57.8235495Z
    MigrationConsole.exe Information: 0 : System.Threading.ThreadAbortException: Thread was being aborted.
       at System.Threading.Thread.AbortInternal()
       at System.Threading.Thread.Abort()
       at OjkZA5fW18B01Gf9op.bKFnHGSRxN5AAInIof.eY3TcUpOH(Thread )
    LogicalOperationStack=Main
    DateTime=2011-08-26T16:21:57.8264793Z
    ```

    **Figure: Well, this is going to be fun**

    Luckily Timely Migration have a little Support tools to help us. Fire up “Migration Support”, which is in the install folder, and have a bunch of tools to make things easier.

    [**![image](images/image_thumb3-7-7.png "image")**](http://blog.hinshelwood.com/files/2011/08/image7.png)
    { .post-img }

    **Figure: Which support tool would you like to use**

    Most migration tools forget about this bit and I have only really seen it in Timely and in the Integration Platform. What I need to be able to do is open the Session Analysis and make a couple of changes to fix the issue. Luckily there is a “Session Viewer” which will open the TfsTimelyMigration database that you created as part of your configuration.

    [![image](images/image_thumb4-8-8.png "image")](http://blog.hinshelwood.com/files/2011/08/image8.png)
    { .post-img }

    **Figure: There are a bunch of features to edit the “Session” data**

    The first thing we need to do is find out where we are. Clicking the “Get Pending Change Group” will load up that pesky 17018 item that is causing the block.

    [![image](images/image_thumb5-9-9.png "image")](http://blog.hinshelwood.com/files/2011/08/image9.png)
    { .post-img }

    **Figure: You can edit the change group to bypass the problem**

    It is now a case of figuring out what the problem actually is. There are no “Rename”’s so it is not a case of a Rename causing a conflict, but what is the problem…

    I could not figure it out from just scrolling through this list so I though to use the “Save Actions As”, but the output from that provided to be NASTY. Real nasty:

    [![image](images/image_thumb6-10-10.png "image")](http://blog.hinshelwood.com/files/2011/08/image10.png)
    { .post-img }

    **Figure: What the heck use is this!**

    So what I decided to do was install the Snagit 10 trial and use the “Capture Text” function.

    [![image](images/image_thumb7-11-11.png "image")](http://blog.hinshelwood.com/files/2011/08/image11.png)
    { .post-img }

    **Figure: Snagit Capture text function gives you grab the entire vertical area in one go**

    [![image](images/image_thumb8-12-12.png "image")](http://blog.hinshelwood.com/files/2011/08/image12.png)
    { .post-img }

    **Figure: Now I have it as a kind of notepad format**

    Taking this output, pasting it into Excel, creating the data as a table and ordering by “TFS Source” produces an interesting result.

    [![image](images/image_thumb9-13-13.png "image")](http://blog.hinshelwood.com/files/2011/08/image13.png)
    { .post-img }

    **Figure: You can see the dups**

    Where you might ask, did these come from. Well, in the settings file there was an option for “ItemExistshandler” that for most cases can be set to “ChangeTpEdit”, the only problem is if the file is already an “Add” then you are going to get a conflict like this one.

    [![image](images/image_thumb10-3-3.png "image")](http://blog.hinshelwood.com/files/2011/08/image14.png)
    { .post-img }

    **Figure: Item Exists Handler default to Change to Edit**

    While this is indeed desired behaviour, it can case this sort of issue when there are files that have slightly different casing when they are added.

    - \*\*Change the option to “Ignore”
      \*\*

    While this would remove the conflicts, it would poise the real risk of loosing data.

    [![image](images/image_thumb11-4-4.png "image")](http://blog.hinshelwood.com/files/2011/08/image15.png)
    { .post-img }

    **![o_Error-icon](images/o_Error-icon-15-15.png "o_Error-icon")Figure: Risky option, change setting to ignore Existing Items**
    { .post-img }

    - **Remove each conflict (Recommended)**

    For each item in the list, determine which one is in conflict and remove it manually. This is likely to happen ever time a large number of changes is checked in or reorgs of code happen.

    [![image](images/image_thumb12-5-5.png "image")](http://blog.hinshelwood.com/files/2011/08/image16.png)
    { .post-img }

    **![o_Tick-icon](images/o_Tick-icon-16-16.png "o_Tick-icon")Figure: Safe option, remove each bad change**
    { .post-img }

    It would be really nice if Timely could add the ability to view the conflicts only and be able to bulk apply the resolution as I am looking at 300+ conflicts in a single check-in. At least we are 68% of the way through this particular migration and the chances are (fingers crossed) that there will only be a few conflicts.

    **Let me know how you get on with your own migrations!**
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-08-26-subversion-to-tfs-2010-the-migration-engine-is-unable-to-resolve-a-conflict-where-two-changes-have-the-same-target-item\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-08-26-subversion-to-tfs-2010-the-migration-engine-is-unable-to-resolve-a-conflict-where-two-changes-have-the-same-target-item
- FrontMatter:
    title: 'Subversion to TFS 2010: Dealing with invalid Subversion SSL certificates and migrations'
    description: Learn how to tackle invalid Subversion SSL certificates during your migration to TFS 2010. Overcome common errors and streamline your version control process!
    ResourceId: OqcEk7HmSwT
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3736
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-08-25
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: dealing-with-invalid-subversion-ssl-certificates-and-migrations
    aliases:
    - /resources/OqcEk7HmSwT
    aliasesArchive:
    - /blog/dealing-with-invalid-subversion-ssl-certificates-and-migrations
    - /dealing-with-invalid-subversion-ssl-certificates-and-migrations
    - /subversion-to-tfs-2010--dealing-with-invalid-subversion-ssl-certificates-and-migrations
    - /blog/subversion-to-tfs-2010--dealing-with-invalid-subversion-ssl-certificates-and-migrations
    - /resources/blog/dealing-with-invalid-subversion-ssl-certificates-and-migrations
    tags:
    - Troubleshooting
    categories:
    - Uncategorized
  BodyContent: |
    ![subversion](images/subversion-7-7.png "subversion")
    { .post-img }

    Migrating data from SVN to TFS can be both a timely and a costly business. I was trying out the two tools [TFS Integration Platform](http://tfsintegration.codeplex.com/) & [Timely Migration](http://www.timelymigration.com/) but I ran into what looked like the same problem in both if them.

    - Acknowledgement: Thorsten Dralle - Thorsten helped me figure out what the heck was going on when I could not connect

    ---

    Although I do have permission I can’t get the tools to talk and load from Subversion with the following effect / error messages:

    - **TFS Integration Platform  
       **  
       ![image](images/image1-4-4.png "image")  
      { .post-img }
      **Figure: Unable to validate the URL  
       **
    - **Timely Migration  
       **  
       And I am now very confused as I have tried Timely Migrations tool as well and it has an error that is similar enough to not be coincidence.
      ![clip_image004](images/clip_image004-1-1.jpg "clip_image004")
      { .post-img }
      **Figure: Also unable to validate the repository URL  
       **
    - **Internet Explorer  
       **  
       I will go back to the admins and make sure that everything is correct, but I am not sure if they are going to have any other advice.  
       ![image](images/image3-6-6.png "image")  
      { .post-img }
      **Figure: Unable to validate the certificate. (From an internal server)  
       **  
       I have even looked at making sure that the url is correct and putting it into the browser results in a list of the folders which looks right to me.
      ![clip_image006](images/clip_image006-2-2.jpg "clip_image006")
      { .post-img }
      **Figure: This is expected  
       **
    - **SmartSVN**
      This is very odd and I am having some trouble figuring it out. I can access SVN through SmartSVN.

          ![clip_image007](images/clip_image007-3-3.jpg "clip_image007")

      { .post-img }
      **Figure: SmartSVN worked just fine after I accepted the fingerprint**

    So, what is the problem?

    Well, Thorsten figured it out that the invalid digital certificate used for Subversion is blocking the ability for the tool to access it and throwing up very misleading error messages. If you run the standard SVN tool against that repository and try to access any of the files you will be asked what to do about the problem:

    ```
    svn.exe co https://host/PathToYourRepo c:somethinglocalfolder
    ```

    This command will download the latest sources locally if you let it run but it will also, If there is a certificate mismatch / error the command line tool will ask you what to do.

    ![image](images/image2-5-5.png "image")
    { .post-img }

    **Figure: Options for accepting certificate**

    Typically you have three options:

    - Accept Temporarily

    - **Accept forever**

    - Reject

    If you select “**_(p)ermenantly_**” you will then be able to run the migration tools successfully. You will need to do this for every Subversion Repository you want to migrate from. Or, you can fix the certificate or just remove it.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-08-25-dealing-with-invalid-subversion-ssl-certificates-and-migrations\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-08-25-dealing-with-invalid-subversion-ssl-certificates-and-migrations
- FrontMatter:
    title: 'Coffee Talk: Introduction to Scrum - webcast event this Friday!'
    description: Join us this Friday for a free webcast on Scrum! Discover key roles, processes, and tips to enhance your agile practices and boost team performance.
    ResourceId: ThIUwJr1ff_
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3728
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-08-16
    weight: 790
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: coffee-talk-introduction-to-scrum-webcast-event-this-friday
    aliases:
    - /resources/ThIUwJr1ff_
    aliasesArchive:
    - /blog/coffee-talk-introduction-to-scrum-webcast-event-this-friday
    - /coffee-talk-introduction-to-scrum-webcast-event-this-friday
    - /coffee-talk--introduction-to-scrum---webcast-event-this-friday-
    - /blog/coffee-talk--introduction-to-scrum---webcast-event-this-friday-
    - /resources/blog/coffee-talk-introduction-to-scrum-webcast-event-this-friday
    tags:
    - Software Development
    - Professional Scrum
    - Agile Frameworks
    categories:
    - Scrum
    preview: metro-event-128-link-2-2.png
  BodyContent: |
    ![NWC tagline logo_transparent](images/NWC-tagline-logo_transparent-3-3.png "NWC tagline logo_transparent")
    { .post-img }

    If you attended [Coffee Talk: Scrum versus Kanban (re-match) … Thursday at High Noon!](http://blog.hinshelwood.com/coffee-talk-scrum-versus-kanban-re-match-thursday-at-high-noon/) where I trumped Steven Borg's Kantban or even Steven’s session on [Coffee Talk: Introduction to Kanban](http://introtokanban-eorg.eventbrite.com/) then you should also attend this…

    ---

    I will be delving into more detail on Scrum with an in depth look into the roles of Scrum and a practical look at the Framework itself.

    > “Scrum is the most adopted agile methodology. Time and again, it has transformed low performing development teams into powerful creators of business value. Scrum does particularly well in environments where requirements shift or change unpredictably and in areas with substantial uncertainty.
    >
    > **During this event, we will introduce the three Scrum roles, dive into the basic Scrum processes, and explore the reasons behind Scrum’s power. Although this event is an introduction to Scrum, we will provide several tips and tricks to assist in Scrum adoption.”  
    > \-** [Coffee Talk: Introduction to Scrum](http://introtoscrum.eventbrite.com/)

    ![image](images/image-1-1.png "image")  
    { .post-img }
    **Figure:** [**Coffee Talk: Introduction to Scrum**](http://introtoscrum.eventbrite.com/)

    I am hoping that we can we can have some serious discussion on the agile practices and the process that has captivated a generation of developers.

    - [**Join Northwest Cadence for this Free Webcast Event**](http://introtoscrum.eventbrite.com/)

    I don't know how many people have already signed up as I have been onsite for two weeks. My current customer is giving me a little time on Friday to talk to you folks about Scrum.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-08-16-coffee-talk-introduction-to-scrum-webcast-event-this-friday\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-08-16-coffee-talk-introduction-to-scrum-webcast-event-this-friday
- FrontMatter:
    title: Upgrading your Process Template in Team Foundation Server
    description: Master the art of upgrading your Team Foundation Server process templates with expert tips and strategies to retain data and enhance your workflow.
    ResourceId: o6VvFIPoyTU
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3717
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-07-28
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: do-you-know-how-to-upgrade-a-process-template-but-still-keep-your-data-intact
    aliases:
    - /resources/o6VvFIPoyTU
    aliasesArchive:
    - /blog/do-you-know-how-to-upgrade-a-process-template-but-still-keep-your-data-intact
    - /do-you-know-how-to-upgrade-a-process-template-but-still-keep-your-data-intact
    - /upgrading-your-process-template-in-team-foundation-server
    - /blog/upgrading-your-process-template-in-team-foundation-server
    - /resources/blog/do-you-know-how-to-upgrade-a-process-template-but-still-keep-your-data-intact
    tags:
    - Software Development
    - Install and Configuration
    categories:
    - Uncategorized
    preview: nakedalm-experts-visual-studio-alm-4-4.png
  BodyContent: |
    Upgrading your Process Template in Team Foundation Server regardless of the version is pretty hard to achieve. Think of it like changing your mind on the blueprints of a building after you have finished construction. If you are making a small change, like adding a field, then this will be easy. But if you want to fundamentally change the structure of your work items and their workflow then you are looking at a bigger and much more complicated solution.

    - Update 2012-05 - Added #7 to the list
    - Update 2012-12 – Fixed layout and omissions noted by [Jesse Houwing](http://blog.jessehouwing.nl)
    - Update 2012-12 - Updated for TFS 2012

    ---

    Here are the 6 7 8 ways to change the Process Template that I have used and all of their pros and cons. Some are easy to implement but may not fit your needs while others have a massive time penalty that you may not be willing to accept. Take my advice and try to implement the simplest solution that you can. Most failed Process Template changes are due to the complexity of the restrictions put in place by folks that don't actually understand what they are asking for. I will often use the above construction metaphor to help customers understand what we are talking about in lue of a solution from the product team that is currently Under Review: [Allow for updating project templates on existing projects in TFS](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/2105201-allow-for-updating-project-templates-on-existing-p) (add your vote if you have any left)

    The complexity of the change will depend on the scale and scope of the changes that you have made to your process template and the instance that is used in the Team Project. I would always recommend consolidating your organisation to a single process template as the two evils of maintaining TFS are; Wildly divergent process instances regardless of the original template; what I like to call frankin-templates. Work Items that have been so heavily customised as to be practically unusable by those they are meant for.

    There are specific changes, namely worflow and state changes, that will limit your choices severely and you should be aware of all of the ramifications before you make any changes. I would go so far as to say that if you are going to make changes other than just adding some simple fields that you create a set of CodedUI tests for all of your Users paths through the workflow and run a bank of those tests every time you make a change to make sure that you have not broken a necessary activity that folks already use.

    If you are making incremental changes to the process that you are already using you can likely upgrade with no issues nor data loss by simply overwriting the new work item types over the old ones. However, if you are making large fundamental changes to the way that the template works (e.g. SfTSv2 to MSF Agile 5.0) then you need another approach:

    ## #1 Do nothing (0 hours)

    ![Lazy the Smurph](images/lazy-3-3.jpg "Lazy")
    { .post-img }

    Sticking with same template is not a good option as everyone wants to take advantage of the new features.

    - Pro Little or no work to achieve
    - Con You have to use the old template
      Note this is not a con unless there is some feature that people want

    ## #1.1 Enable new features only (5 minutes)

    In this scenario you keep the same process template but you "inject" the new platform features. This was done in TFS 2010 with a batch file and in 2012 the Product Team built in a basic capability to the web UI for those that have not modified their process templates much.

    - Pro Little or no work to achieve
    - Con Same old process in new clothing

    Note Does not work if you have made modifications to the workflow

    ## #2 Create a new Team Project (.5 hours)

    ![Ripped scroll](images/SNAGHTMLaea788_thumb-5-5.png "Broken history")
    { .post-img }

    This is tantamount to doing nothing, but you are using the new process template. You just have to be willing to leave all of your data behind. The real problem here is that with TFS 2010 a “move” or “rename” of files actually results in a “branch” and then a “delete” action that breaks the history chain for folders. The history is still intact, but it only exists on the old Team Project and is deleted or if the permissions are changed then the history is lost.

    - Pro Minimal commitment
    - Pro Retain access to historical reporting
    - Con You are leaving your history behind on the old project
      Note reports may be different anyway so this may not be such a bad idea for WI
    - Con You have to do a move (“Branch” + “Delete”) operation and disconnect you history
      Note This really sucks for version control

    ## #3 Destroy all Work Items and Import new ones (2-3 hours)

    ![Explosion](images/kaboom_256-2-2.jpg "Kaboom")
    { .post-img }

    In this scenario you loose all existing Work Item data, but you have not moved your source code, so no nasty history chain.

    How-To [Process Template Upgrade #3 - Destroy all Work Items and Import new ones](http://blog.hinshelwood.com/process-template-upgrade-3-destroy-all-work-items-and-import-new-ones/)

    - Pro New template with clean data
    - Pro no disconnect of version control history
    - Con No history on work items (all existing data is lost)

    ## #4 Use the TFS Integration Platform to move Source and Work Item history to a new team project (1-2 days)

    ![a distorted clock](images/time-dilation-7-7.jpg "Time-Dilation")
    { .post-img }

    This is an ideal solution, but it does result in “time dilation” on your source control. There is no way to fake a check-in date so all dates will be when the actual check-in happens. As the TFS Integration Platform does all of the check-ins concurrently it stores the original date in the comment.

    - Pro Keeps all history for both Work Items and Version Control
    - Con Time dilation effect, rather like traveling to Alpha Centauri at Light speed; this affects both Work Item and Version Control
      Note there are ways to fix this for work items and reporting
      Note If you care about this for Version Control you are likely doing something wrong!

    ## #5 Do an in place manual migration (1-¥ days)

    ![One way sign with a double ended arrow](images/image4-1-1.png "Confusion")
    { .post-img }

    This is just plane nasty and take a lot of time. It can take over 8 hours to complete the migration once it has been planned out, and that time depends on the process template you are moving from, the one you are moving to, and the customisations you have made along the way. If all of your Team Projects have different customisations, then this is probably a non-starter.

    - Pro Keeps all of your data intact with renames of fields and work item types
    - Con Takes a really, really long time
      Note There are many circumstance where this is not possible  
       note: Even our most technical TFS Consultant takes 1-2 days to do this (I have never done this)

    ## #6 Do an in-place _export_ migration.

    ![One arrow going up and another going down](images/sync-6-6.png "Export & Import")
    { .post-img }

    This gives us the best of both worlds, with an export of Work Item data to another location, destroying all the existing work item types along with all of the data, then install the new Work Item Types and reload the data. This is still a horrible process, but it keeps the Source Code history intact, and allows for the process template to be completely upgraded.

    - Pro Keeps all of your data intact will a small modification to fix time dilation on work items
    - Con Takes a really, really long time
      Note There are many circumstance where this is not possible
      Note Even our most technical TFS Consultant takes 1-2 days to do this (I have never done this)

    ## #7 Rename Work Items and Import new ones (4-5 hours) (Recommended)

    ![trophy](images/trophy-8-8.jpg "trophy")In this scenario you get to keep all of the history in tact and also get to start afresh with new work item types. It is almost the best of both worlds as you don’t need to move Source Control nor do you end up with new Work Item ID’s.
    { .post-img }

    How-To [Process Template Upgrade #7 – Overwrite retaining history with limited migration](http://blog.hinshelwood.com/process-template-upgrade-7-overwrite-retaining-history-with-limited-migration/)

    - Pro New template with clean data
    - Pro No disconnect of version control history
    - Pro History on work items (all existing data accessible through history tab)
    - Con leaves old legacy fields in the template

    ## Conclusion

    For me options #7 is the most appropriate for most circumstances and is part of my default arsenal. The rest I only use if I have to, but if a customer is happy with #1, #2 or #3 then I am unlikely to argue as they are easy to implement.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-07-28-do-you-know-how-to-upgrade-a-process-template-but-still-keep-your-data-intact\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-07-28-do-you-know-how-to-upgrade-a-process-template-but-still-keep-your-data-intact
- FrontMatter:
    title: 'Coffee Talk: Scrum versus Kanban (re-match) ... Thursday at High Noon!'
    description: Join the rematch of Scrum vs Kanban as experts debate their merits! Discover insights and strategies to enhance your agile processes. Don't miss out!
    ResourceId: KtZxhtX0v9O
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3692
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-07-22
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: coffee-talk-scrum-versus-kanban-re-match-thursday-at-high-noon
    aliases:
    - /resources/KtZxhtX0v9O
    - /resources/blog/coffee-talk-scrum-versus-kanban-re-match-...-thursday-at-high-noon
    aliasesArchive:
    - /blog/coffee-talk-scrum-versus-kanban-re-match-thursday-at-high-noon
    - /coffee-talk-scrum-versus-kanban-re-match-thursday-at-high-noon
    - /coffee-talk--scrum-versus-kanban-(re-match)-----thursday-at-high-noon-
    - /blog/coffee-talk--scrum-versus-kanban-(re-match)-----thursday-at-high-noon-
    - /resources/blog/coffee-talk-scrum-versus-kanban-re-match-thursday-at-high-noon
    - /resources/blog/coffee-talk-scrum-versus-kanban-re-match-...-thursday-at-high-noon
    tags: []
    categories:
    - Uncategorized
    preview: metro-nwc-128-link-2-2.png
  BodyContent: |
    ![Chaparral%2BHigh[1]](images/Chaparral2BHigh12-1-1.jpg "Chaparral%2BHigh[1]")
    { .post-img }

    Because of the phenomenal success of the [Scrum versus Kanban](http://scrumvskanbanrematch.eventbrite.com/) session that Steven Borg an I did today, we plan on having a rematch to see if Kanban can make a comeback.

    Hopefully [Steve1](http://blog.nwcadence.com/author/stevenborg/) can do a better job for Kanban this time…

    ![NWC tagline logo_transparent](images/NWC-tagline-logo_transparent1-3-3.png "NWC tagline logo_transparent")
    { .post-img }

    **Updates**

    - **2011-07-29 – The Recording** -  For those that attended the recording will be made available to you now through Northwest Cadence, I am working on making it available here as well.
    - **2011-10-27 – The Recording** - I have added the recording

    ---

    If you missed todays bout then you are in for a treat as Steve Borg and I go head to head again for a second round of [Scrum vs Kanban](http://scrumvskanbanrematch.eventbrite.com/) … here is what one of the attendees said about the first session:

    > The methodology, process and SDLC sessions are often delivered by evangelists who are very prescriptive and critical. Steven and Martin, however, delivered an interactive and thoughtful comparison of the two processes, sharing useful insights into the pros and cons of either and most importantly highlighting the importance of having the freedom of adapting either or both to suit your needs and environment. - [Willy-P](http://blogs.msdn.com/b/willy-peter_schaub/archive/2011/07/22/coffee-talk-scrum-versus-kanban.aspx)

    Am I willing to make a prediction?

    [![ScrumvsKanbanResult](images/ScrumvsKanbanResult_thumb-4-4.jpg "ScrumvsKanbanResult")](http://blog.hinshelwood.com/files/2011/07/ScrumvsKanbanResult.jpg) **Figure: Predicted outcome!**
    { .post-img }

    If however you have had your fill of one process battering lumps out of the other and you have chosen you path, or even if you are still on the fence, you can come and see the rest of the sessions:

    - [**Coffee Talk: Scrum vs Kanban (re-match)**](http://scrumvskanbanrematch.eventbrite.com/) - 2011-7-28 (high noon– 12PM PST) - [**Join NOW**](https://www103.livemeeting.com/cc/nwcadence/join?id=CoffeeTalk72811&pw=NWCadence) Scrum versus Kanban   Scrum is a process model that promotes highly iterative, value driven development and has been successfully..
      \[wpvideo Wbd7WBd2\]
      **Figure: Coffee talk: Scrum vs Kanban**
    - [**Coffee Talk: Introduction to Kanban**](http://introtokanban-eorg.eventbrite.com/) \- 2011-8-5  (9AM – 10AM PST) Introduction to Kanban Kanban is a Lean-inspired approach to software development.  Although the rules of Kanban are simple, they...
    - [**Coffee Talk: Introduction to Scrum**](http://introtoscrum-eorg.eventbrite.com/)  **-** 2011-8-19 (9AM – 10AM PST) Introduction to Scrum   Scrum is the most adopted agile methodology.  Time and again, it has transformed low performing development teams...
    - [**Coffee Talk: Visualize Work – The Power of Big Visible Displays**](http://visualizework-eorg.eventbrite.com/)  **-** 2011-09-09 (9AM – 10AM PST) Visualize Work: The Power of Big Visible Displays Visible work has a profound impact on a team.  By making work visible, teams can...
    - [**Coffee Talk: Limit Work in Process (WIP)**](http://limitwip-eorg.eventbrite.com/) \- 2011-09-23 (9AM – 10A  PST) Limit Work in Process (WIP)  Overloaded individuals and teams suffer from bad multitasking. they are also cursed with long lead times,...
    - [**Coffee Talk: Scrum-damentals**](http://scrumdamentals-eorg.eventbrite.com/) – 2011-10-07 (9AM – 10AM PST) Scrum-damentals Scrum is the most adopted and recognized agile methodology. However, there are still challenges to Scrum adoption.  This...
    - [**Coffee Talk: Visualize Work – The Power of Big Visible Displays**](http://visualizework2-eorg.eventbrite.com/) – 2011-10-21 (9AM – 10AM  PST) Visualize Work: The Power of Big Visible Displays Visible work has a profound impact on a team.  By making work visible, teams can...
    - [**Coffee Talk: Limit Work in Process (WIP) –**](http://limitwip2-eorg.eventbrite.com/) 2011-11-04 (9AM – 10AM PST) Limit Work in Process (WIP)  Overloaded individuals and teams suffer from bad multitasking. they are also cursed with long lead times,...

    The sessions are deliberately split so you can see Scrum, Kanban and some of the practices that benefit both separately.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-07-22-coffee-talk-scrum-versus-kanban-re-match-thursday-at-high-noon\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-07-22-coffee-talk-scrum-versus-kanban-re-match-thursday-at-high-noon
- FrontMatter:
    title: 'Coffee Talk: Scrum versus Kanban'
    description: Join Martin Hinshelwood and Steven Borg in a free webcast to explore the key differences between Scrum and Kanban for effective software development.
    ResourceId: 1VmIrtnFKy7
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3688
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-07-19
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: coffee-talk-scrum-versus-kanban
    aliases:
    - /resources/1VmIrtnFKy7
    aliasesArchive:
    - /blog/coffee-talk-scrum-versus-kanban
    - /coffee-talk-scrum-versus-kanban
    - /coffee-talk--scrum-versus-kanban
    - /blog/coffee-talk--scrum-versus-kanban
    - /resources/blog/coffee-talk-scrum-versus-kanban
    tags:
    - Software Development
    categories:
    - Uncategorized
    preview: metro-event-128-link-1-1.png
  BodyContent: |
    ![Coffee Talk: Scrum versus Kanban ](images/1475243493-2.png)
    { .post-img }

    I am doing a free session this Friday with Steven Borg to help folks understand the differences between Scrum and Kanban and where each fit. This will be an introductory session and future sessions will be split with Steven Box doing the Kanban and me doing the Scrum sessions.

    **[Join me for this Free Webcast Event](http://scrumvskanban.eventbrite.com/)**  
    **Updates**

    - **The Recording** - I have added the recording below

    ---

    Scrum is a process model that promotes highly iterative, value driven development and has been successfully adopted by agile teams world-wide. Kanban, meaning “signboard”, is a concept relation to Lean and focuses on the reduction of work in progress and visual signals to indicate that new work should be started. \[wpvideo Wbd7WBd2\]

    **Figure: Coffee talk: Scrum vs Kanban**

    Both models have proven track records, and **in this session [Martin Hinshelwood](http://blog.hinshelwood.com/) (ALM MVP and Scrum proponent) and [Steven Borg](http://blog.nwcadence.com/) (ALM MVP and Kanban fan) will go head to head to discuss their similarities, their differences, and which you should** **choose for your software development.**

    - **[Join Northwest Cadence for this Free Webcast Event](http://scrumvskanban.eventbrite.com/)**

    I think that we have around 50 folks already signed up, but the more the merrier…
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-07-19-coffee-talk-scrum-versus-kanban\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-07-19-coffee-talk-scrum-versus-kanban
- FrontMatter:
    title: Disqus & Chrome with non-support
    description: Struggling with Disqus comments not loading in Chrome? Discover troubleshooting tips and share your experiences in this engaging blog post by Martin Hinshelwood.
    ResourceId: 1XIDHtEDmeQ
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3686
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-07-05
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: disqus-chrome-with-non-support
    aliases:
    - /resources/1XIDHtEDmeQ
    - /resources/blog/disqus-chrome-with-non-support
    aliasesArchive:
    - /blog/disqus-chrome-with-non-support
    - /disqus-chrome-with-non-support
    - /disqus-&-chrome-with-non-support
    - /blog/disqus-&-chrome-with-non-support
    - /resources/blog/disqus-chrome-with-non-support
    tags: []
    categories:
    - Uncategorized
    preview: nakedalm-logo-128-link-7-7.png
  BodyContent: |
    ![](images/disqus-logo-3-3.png)
    { .post-img }

    I am having a problem on my blog with comments. Namely that you cant see any! This is the downside of relying on a third party tool, but do the problems out weight the benefits?

    - [Comments not loading](http://getsatisfaction.com/disqus/topics/comments_not_loading_on_wordpress)

    ---

    I am having problems with Disqus on Wordpress in Chrome; My comments don't load, and they do not load the first time in the admin system either. In the Admin system a reload of the page fixes the issue, but on the site, nada.

    [![image](images/image_thumb-4-4.png "image")](http://blog.hinshelwood.com/files/2011/07/image.png)  
    { .post-img }
    **Figure: Even on short posts there are no comments**

    [![image](images/image_thumb1-5-5.png "image")](http://blog.hinshelwood.com/files/2011/07/image1.png)  
    { .post-img }
    **Figure: No comment in admin until a reload**  
    [http://blog.hinshelwood.com](http://blog.hinshelwood.com/)

    - **What could be the problem?**
    - **How do I fix it?**

    **_<RANT>_**

    Above s the exact information that I put in an email to help@disqus.com,  and do you know the response I got!

    > _Hi Martin,  
    > Sorry to hear you're having trouble. To help us get to the bottom of this, kindly forward us the following information:  
    > \- a link to a page experiencing this issue;  
    > \- a step-by-step process to reproduce the issue on our end;  
    > \- screenshots of any errors or irregularities in this process -- for more information on how to take a screenshot, visit_ [_http://take-a-screenshot.org/_](http://take-a-screenshot.org/)  
    > _\- web browser and version being used, e.g. Internet Explorer 9 or Firefox 4 -- to determine this information, visit_ [_http://www.whatbrowseramiusing.co/_](http://www.whatbrowseramiusing.co/)
    >
    > _Kind Regards,  
    > Ryan_

    Now I do not know who Ryan is or even if he exists, but all of those questions are already answered by looking at the original email.

    - Why is it that they never read that first email?

    Come on guys, you can do better!

    **_<RANT>_**

    _So I still need to reply:_

    _**<RESPONCE>**_

    ##### Ryan,

    If you had taken a movement to read my first email, you would have seen all of the answers that you requested. In the future I will remember to send you a blank email with only a subject first so you can provide the reply you did without looking foolish. Anyhoo, here is the information that you requested extracted from the email you already have:

    > _\>>a link to a page experiencing this issue;_

    All pages as describes. Go to any single blog post page, but the one depicted in the screenshot would be you best bet ([_http://blog.hinshelwood.com/ahaaaa/_](http://blog.hinshelwood.com/ahaaaa/)) its an old post, but short so loads quickly.

    > _\>>a step-by-step process to reproduce the issue on our end;_

    1.  Go to individual post page on site
        _e.g._ [_http://blog.hinshelwood.com/ahaaaa/_](http://blog.hinshelwood.com/ahaaaa/) _(as depicted in the screenshot)_
    2.  See problem that is demonstrated in this screenshot
        [![image](images/image_thumb2-6-6.png "image")](http://blog.hinshelwood.com/files/2011/07/image2.png)
        { .post-img }
        **Figure: Same problem exists in this screenshot**

    > _\>>screenshots of any errors or irregularities in this process -- for more information on how to take a screenshot, visit [http://take-a-screenshot.org/](http://take-a-screenshot.org/)_

    Original email bellow contained screenshots. See “Figure: Even on short posts there are no comments” and “Figure: No comment in admin until a reload” below (\*note your email tool has stripped them out but you can clearly see where they were provided). I have provided them here again as well as a link to a blog posts with all of the information available.

    > \>>web browser and version being used, e.g. Internet Explorer 9 or Firefox 4 -- to determine this information, visit [http://www.whatbrowseramiusing.co/](http://www.whatbrowseramiusing.co/)

    As you can see from the screenshots provided I am using Chrome. The problem does not resent itself in IE9.

    [![clip_image001](images/clip_image001_thumb-1-1.png "clip_image001")](http://blog.hinshelwood.com/files/2011/07/clip_image001.png)  
    { .post-img }
    **Figure: The version of Chrome I currently use**

    [![clip_image002](images/clip_image002_thumb-2-2.png "clip_image002")](http://blog.hinshelwood.com/files/2011/07/clip_image002.png)  
    { .post-img }
    **Figure: The version of IE that I use**

    Please do not hesitate to contact me if you have any further problems extracting information from an email or even new ones that are not answered here.

    **<RESPONCE>**

    Let see if I get any help… I can’t think I am the only one who's blog does not work with Chrome.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-07-05-disqus-chrome-with-non-support\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-07-05-disqus-chrome-with-non-support
- FrontMatter:
    title: Upgrading from TFS 2008 and WSS v3.0 with SfTSv2 to TFS 2010 and SF 2010 with SfTSv3
    description: Upgrade your TFS 2008 and WSS v3.0 to TFS 2010 and SF 2010 with our detailed guide. Streamline your process and enhance your team's productivity today!
    ResourceId: KlJGJX3qXCS
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3279
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-06-30
    weight: 690
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: upgrading-from-tfs-2008-and-wss-v3-0-with-sftsv2-to-tfs-2010-and-sf-2010-with-sftsv3
    aliases:
    - /resources/KlJGJX3qXCS
    - /resources/blog/upgrading-from-tfs-2008-and-wss-v3.0-with-sftsv2-to-tfs-2010-and-sf-2010-with-sftsv3
    aliasesArchive:
    - /blog/upgrading-from-tfs-2008-and-wss-v3-0-with-sftsv2-to-tfs-2010-and-sf-2010-with-sftsv3
    - /upgrading-from-tfs-2008-and-wss-v3-0-with-sftsv2-to-tfs-2010-and-sf-2010-with-sftsv3
    - /resources/blog/upgrading-from-tfs-2008-and-wss-v3-0-with-sftsv2-to-tfs-2010-and-sf-2010-with-sftsv3
    - /resources/blog/upgrading-from-tfs-2008-and-wss-v3.0-with-sftsv2-to-tfs-2010-and-sf-2010-with-sftsv3
    tags:
    - Install and Configuration
    - Software Development
    - System Configuration
    - Troubleshooting
    - Windows
    - Azure DevOps
    - Technical Mastery
    - Operational Practices
    - Pragmatic Thinking
    categories:
    - Scrum
    preview: metro-visual-studio-2005-128-link-33-33.png
  BodyContent: |
    [![VS2008Upgrade](images/VS2008Upgrade_thumb-36-36.gif "VS2008Upgrade")](http://blog.hinshelwood.com/files/2011/05/VS2008Upgrade.gif)
    { .post-img }

    I have been working with a rather large customer that have over 150GB in Team Foundation Server with over 10GB in SharePoint. They are also using the Scrum for Team System v2 (SfTSv2) Process template that is not supported under TFS 2010 so I need to upgrade those process templates to Scrum for Team System v3 (SfTSv3).

    #### Acknowledgements

    - Jullian Fitzgibbons - Jullian managed to figure out the SharePoint authentication issues that we were having

    ---

    I will be breaking this upgrade process into two parts:

    - Upgrading the Applications
      1. **Windows SharePoint Services 2007** upgrade to **SharePoint Foundation 2010**
      2. **Team Foundation Server 2008** upgrade to **Visual Studio 2010 Team Foundation Server**
    - Upgrading the Team Projects
      1. **Scrum for Team System v2** upgrade to **Scrum for Team System v3**

    The Server upgrade only happens once, but we need to run the Team Project for each of the the Team Projects that we want to move to a new Process Template. Although EMC has stated that SfTSv3 will be the last version that they will build it is the easiest migration route. When we do get to the stage of upgrading Team Foundation Server to the v.Next there will undoubtedly be many people needing to move from SfTSv3 to another supported Process Template. I am confident that at that time there will be a path from SfTSv3 to one of the other templates, most likely the Visual Studio Scrum v1.

    ## Upgrading the Server (13 hours)

    This common section represents all the work that relates

    1.  ### Migrate Data (~4 hours)

        This would be the least painful part of the migration if it were not for the large size of the databases.

        1. Backup Team Foundation server 2008 and Windows SharePoint Services 2007 Databases (1 hour)
        2. Copy Team Foundation server 2008 and Windows SharePoint Services 2007 Databases to new server (3 hours)

    2.  ### Upgrade Windows SharePoint Services 2007 to SharePoint Foundation 2010 (~2 hours)

            Although I approach any SharePoint upgrade or even tweak with not just trepidation but outright fear everything could  not have gone better. With the exception of needing to quickly get downtime to install Service Pack 2 for SharePoint 2007 there was very few issues.

            _Note: Make sure you have Service Pack 2 installed for SharePoint 2007_

            1. **Upgrade SharePoint 2007 –> 2010 (2 hours)**

                ```
                Mount-SPContentDatabase -Name Tfs2_WSS_Content -DatabaseServer [servername] -WebApplication http://[servername] -Updateuserexperience
                ```

                **Figure: Code to run from the SharePoint Foundation 2010 PowerShell prompt**

                [![SNAGHTML5e35b1](images/SNAGHTML5e35b1_thumb-35-35.png "SNAGHTML5e35b1")](http://blog.hinshelwood.com/files/2011/05/SNAGHTML5e35b1.png)

        { .post-img }

                **Figure: Completed with errors**

                ```
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:12 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [ERROR] [5/6/2011 9:55:12 AM]: Found 14 web(s) using missing web template 11254 (lcid: 1033) in ContentDatabase Tfs_WSS_Content.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:12 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [ERROR] [5/6/2011 9:55:12 AM]: The site definitions with Id 11254 is referenced in the database [Tfs_WSS_Content], but is not installed on the current farm. The missing site definition may cause upgrade to fail. Please install any solution which contains the site definition and restart upgrade if necessary.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:12 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [ERROR] [5/6/2011 9:55:12 AM]: Found a missing feature Id = [367b94a9-4a15-42ba-b4a2-32420363e018]
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:12 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [ERROR] [5/6/2011 9:55:12 AM]: The feature with Id 367b94a9-4a15-42ba-b4a2-32420363e018 is referenced in the database [Tfs_WSS_Content], but is not installed on the current farm. The missing feature may cause upgrade to fail. Please install any solution which contains the feature and restart upgrade if necessary.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:13 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [ERROR] [5/6/2011 9:55:13 AM]: Found a missing feature Id = [afce6e61-333a-475e-bc1f-b25a64dbc026]
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:13 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [ERROR] [5/6/2011 9:55:13 AM]: The feature with Id afce6e61-333a-475e-bc1f-b25a64dbc026 is referenced in the database [Tfs_WSS_Content], but is not installed on the current farm. The missing feature may cause upgrade to fail. Please install any solution which contains the feature and restart upgrade if necessary.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:21 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:21 AM]: File [SiteTemplatesSCRUMlistManager.aspx] is referenced [14] times in the database [Tfs_WSS_Content], but is not installed on the current farm. Please install any feature/solution which contains this file.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:21 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:21 AM]: One or more setup files are referenced in the database [Tfs_WSS_Content], but are not installed on the current farm. Please install any feature or solution which contains these files.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:39 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:39 AM]: WebPart class [44a6ed85-4b0d-5a64-dd04-daa9862c8293] is referenced [27] times in the database [Tfs_WSS_Content], but is not installed on the current farm. Please install any feature/solution which contains this web part.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:39 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:39 AM]: One or more web parts are referenced in the database [Tfs_WSS_Content], but are not installed on the current farm. Please install any feature or solution which contains these web parts.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:39 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:39 AM]: WebPart class [0b1269b1-e24e-690d-9a4f-1a6423a31303] is referenced [32] times in the database [Tfs_WSS_Content], but is not installed on the current farm. Please install any feature/solution which contains this web part.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:39 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:39 AM]: One or more web parts are referenced in the database [Tfs_WSS_Content], but are not installed on the current farm. Please install any feature or solution which contains these web parts.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:39 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:39 AM]: WebPart class [597af50c-a8a2-3001-353d-f1dbe7f37f95] is referenced [22] times in the database [Tfs_WSS_Content], but is not installed on the current farm. Please install any feature/solution which contains this web part.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:39 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:39 AM]: One or more web parts are referenced in the database [Tfs_WSS_Content], but are not installed on the current farm. Please install any feature or solution which contains these web parts.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:39 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:39 AM]: WebPart class [7e287d59-ae87-2432-e52a-6420e81ddc91] is referenced [3] times in the database [Tfs_WSS_Content], but is not installed on the current farm. Please install any feature/solution which contains this web part.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:39 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:39 AM]: One or more web parts are referenced in the database [Tfs_WSS_Content], but are not installed on the current farm. Please install any feature or solution which contains these web parts.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:39 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:39 AM]: WebPart class [530cf774-77de-679d-f9a3-de8e74999ba8] is referenced [11] times in the database [Tfs_WSS_Content], but is not installed on the current farm. Please install any feature/solution which contains this web part.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 9:55:39 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 9:55:39 AM]: One or more web parts are referenced in the database [Tfs_WSS_Content], but are not installed on the current farm. Please install any feature or solution which contains these web parts.
                [powershell] [SPContentDatabaseSequence] [INFO] [5/6/2011 10:22:08 AM]: SPContentDatabase Name=Tfs_WSS_Content
                [powershell] [SPContentDatabaseSequence] [WARNING] [5/6/2011 10:22:08 AM]: WebTemplate ID 11254 (lcid: 1033), provisioned in ContentDatabase Tfs_WSS_Content, is missing.
                [powershell] [SPSiteWssSequence2] [INFO] [5/6/2011 10:22:24 AM]: SPSite Url=http://[servername]/Sites/[sitename]
                [powershell] [SPSiteWssSequence2] [WARNING] [5/6/2011 10:22:24 AM]: Feature could not be upgraded. Exception: Feature definition id 'afce6e61-333a-475e-bc1f-b25a64dbc026' could not be found.
                [powershell] [SPSiteWssSequence2] [INFO] [5/6/2011 10:23:24 AM]: SPSite Url=http://[servername]
                [powershell] [SPSiteWssSequence2] [WARNING] [5/6/2011 10:23:24 AM]: Feature could not be upgraded. Exception: Feature definition id '367b94a9-4a15-42ba-b4a2-32420363e018' could not be found.
                ```

                **Figure: The errors from SharePoint are immaterial**

                Although there were a lot of errors they are due to the TFS 2008 and SfTSv2 templates and components not being available. This is OK and we will be resetting all of the sites and removing all of the dead components.


            3. **Reset all imported sites to their site definitions**

                Note: refer to [Upgrade Team Foundation Server 2008 to TFS 2010 (and SharePoint Server 2010)](http://blogs.msdn.com/b/jjameson/archive/2010/05/04/upgrade-team-foundation-server-2008-to-tfs-2010-and-sharepoint-server-2010.aspx) for all your upgrade needs


            5. **Change SharePoint Foundation 2010 from Kerberos (Default) to NTLM**

                I was able to access the TFS / SharePoint sites from the server but not from another workstation. When I tried to access a SharePoint site I would get prompted for my credentials. After providing my credentials, I would get prompted again. Adding the server name to the intranet or trusted zones did not change the behaviour. It looks like by default SharePoint 2010 is set to use Kerberos authentication instead of NTLM. Changing to NTLM resolved the issue.

                #### Steps to Resolve

                1. Open SharePoint 2010 Central Administration > Security > Specify Authentication Providers > Default (zone).

                3. IIS Authentication Settings> Integrated Windows Authentication is checked > Select: NTLM .

                5. Reboot server.

            7. DONE - Upgrade Windows SharePoint Services 2007 to SharePoint Foundation 2010

    3.  ### Try to install the SfTSv3 Solution

            You need to completely disregard any hope of being able to use the SharePoint site template that is provided for the SfTSv3 template. It does not and most likely will never support SharePoint 2010 so you are on your own. But if you do want to give it a go:

            1. #### **Install the Solution**

                ```
                stsadm –o addsolution –filename ScrumForteamSystem.SharePoint.Dashboards.wsp
                ```

                **Figure:  The command to install the custom site template**


            3. #### **Deploy the Solution**

                Because this solution is not designed for SharePoint 2010 it is not deployed by default and you need to do that manually.

                1. ##### **Select the solution that you want to deploy**

                    [![image](images/image13_thumb-21-21.png "image")](http://blog.hinshelwood.com/files/2011/05/image13.png)

        { .post-img }

                    **Figure: Once you get it in there it does not deploy by default**


                3. ##### **Click “Deploy Solution” to choose how it is deployed**

                    [![image](images/image7_thumb-31-31.png "image")](http://blog.hinshelwood.com/files/2011/05/image7.png)

        { .post-img }

                    **Figure: You can manually deploy the solution**


                5. ##### **Choose the deployment options**

                    I always choose to deploy it now, but I am rarely using a server that is actively in production.

                    [![image](images/image101_thumb-20-20.png "image")](http://blog.hinshelwood.com/files/2011/05/image101.png)

        { .post-img }

                    **Figure: Select a time to deploy it**


            5. #### **Give up and delete the site**

                On you create a site using this template you will see that things do not really work correctly. The layout of the site is broken and it makes it difficult to navigate.

                [![SNAGHTML4da989](images/SNAGHTML4da989_thumb-34-34.png "SNAGHTML4da989")](http://blog.hinshelwood.com/files/2011/05/SNAGHTML4da989.png)

        { .post-img }

                **Figure: The Site Template for SfTSv3 is just plain nasty**


            7. #### **Create a site using the TFS 2010 Agile definition**

                Luckily you can just delete this site and create a new site using the “TFS 2010 Agile Dashboard” instead of the “SCRUM” site template.

                [![image](images/image71_thumb-32-32.png "image")](http://blog.hinshelwood.com/files/2011/05/image71.png)

        { .post-img }

                **Figure: Creating new blank sites is easy**

                _Note: Remember to configure the Team Project to point to this new SharePoint site_


            9. #### **Change the Team Project to reference the new Portal correctly**

                [![image](images/image10_thumb-19-19.png "image")](http://blog.hinshelwood.com/files/2011/05/image10.png)

        { .post-img }

                **Figure: Change the portal that the Team Project points to**


            11. #### **Verify that you have a pretty portal**

                [![image](images/image4_thumb-29-29.png "image")](http://blog.hinshelwood.com/files/2011/05/image4.png)

        { .post-img }

                **Figure: Creating a portal with the default process is much preferable**


            13. DONE **\- Try to install the SfTSv3 Solution**

    4.  ### Upgrade Team Foundation Server 2008 to Visual Studio 2010 Team Foundation Server (~6 hours)

            1. #### **Upgrade TFS 2008->2010 (7 hours for 150GB+)**

                ```
                tfsconfig import /sqlinstance:. /collectionName:MyNewCollection /confirmed
                ```

                **Figure: Importing the TFS 2008 databases is a simple command**

                [![coffee-cup](images/coffee-cup_thumb-1-1.jpg "coffee-cup")](http://blog.hinshelwood.com/files/2011/06/coffee-cup.jpg)This command takes a while to run. So get some sleep or just a coffee.

        { .post-img }

            3. #### **Enable SharePoint integration**

                Although SharePoint was automatically configured for use with the TFS server, there will be no integration configured for the newly created Team Project Collection.

                _Note: Follow [Integrate SharePoint 2010 with Team Foundation Server 2010](http://blog.hinshelwood.com/archive/2010/05/03/integrate-sharepoint-2010-with-team-foundation-server-2010.aspx) for full details_

                [![image](images/image131_thumb-22-22.png "image")](http://blog.hinshelwood.com/files/2011/05/image131.png)

        { .post-img }

                **Figure: SharePoint has already been configure for the server**

                [![image](images/image16_thumb-23-23.png "image")](http://blog.hinshelwood.com/files/2011/05/image16.png)

        { .post-img }

                **Figure: There is no SharePoint location configured for the imported Team Project Collection**

                [![image](images/image22_thumb-24-24.png "image")](http://blog.hinshelwood.com/files/2011/05/image22.png)

        { .post-img }

                **Figure: Set the location and then click OK**

                You will be asked if you want to have a site created at this level and you should agree. This will create a new SharePoint site to hold all of the Team Project Portals that are created from now on. All of your old Portals will still be in the same location.


            5. #### **Enable Reporting Services Integration**

                Enabling Reporting Services is very similar to enabling SharePoint. Just follow the configuration options.

                [![image](images/image25_thumb-25-25.png "image")](http://blog.hinshelwood.com/files/2011/05/image25.png)

        { .post-img }

                **Figure: Configure the default reporting services location**


            7. #### **Fix and relink SharePoint sites (~30 minutes)**

                Because we are also upgrading WSS 3.0 to SharePoint Foundation 2010 and we ran the command line import we need to relink all of the Team Project to their respective upgraded projects. Although it would be ideal to create NEW portals with the 2010 functionality and migrate the existing SharePoint data across this is not being done at this time as the customer does not have time. That said, there is you are just using documents then there is not really a lot to a migration. Create a new site, copy the document library's using UNC paths and Windows Explorer, then repoint your Team Project to the new site.

                Note: I will be leaving it up to each team to upgrade as they like as while this is easy, it can be disruptive.

                [![image](images/image31_thumb-27-27.png "image")](http://blog.hinshelwood.com/files/2011/05/image31.png)

        { .post-img }

                **Figure: Change the portal that the Team Project points to**

                [![image](images/image34_thumb-28-28.png "image")](http://blog.hinshelwood.com/files/2011/05/image34.png)

        { .post-img }

                **Figure: Changing the connected portal is as easy as setting a new relative path**


            9. DONE - Upgrade Team Foundation Server 2008 to Visual Studio 2010 Team Foundation Server

    5.  ### **House keeping**

            1. #### Tfs Customisations (1 hour)

                I always tend to create a team Project to hold all of the

                1. Create new team project using SfTS called “TfsCustomisations”

                3. Create folder “ScrumforTeamSystem/MAIN/Source/\*”

                5. Drop Process Template to folder and checkin

                7. Modify to support upgraded template and checkin

                [![image](images/image28_thumb-26-26.png "image")](http://blog.hinshelwood.com/files/2011/05/image28.png)

        { .post-img }
        **Figure: TfsCustomisations has all of the Scripts and Process Template customisation for the upgrade and beyond**

            3. #### Clean unused customisations

                Before we begin with the upgrade of individual Team Projects there needs to be some clean up of the TFS server itself. You need to identify:

                1. ##### **Which Team Projects can be delete**

                    You should be able to have the customer identify which Team Projects can immediately be deleted.

                    ```
                    TfsDeleteProject /q /excludewss /force /collection:%tpc%  "Team Project Name"
                    ```

                    **Figure: Command to delete a Team Project from TFS**

                    _Warning: This process is not reversible_


                3. ##### **Which Work Item Type Definitions can be deleted**

                    This is a little more difficult, but if you provide the customer with a list of Work Item Types for each Team Project along with the number of instances of each Work Item Type there is they should be able to make that call as well.

                    ```
                    witadmin destroywitd /collection:%tpc% /p:"e;Team Project Name"e; /n:"e;Sprint Backlog Item"e; /noprompt
                    ```

                    **Figure: Command to remove a Work Item Type from the TFS server**

                    _Warning: This process is not reversible_

                    There is not really any point in keeping a Work Item Type around if it is not going to be used. Remove any that you don't need.


                5. ##### **Which Work Item Fields can be deleted**

                    This is even more difficult due to the quantity. We can immediately remove any that are unused:

                    ```
                    witadmin listfields /collection:%tpc% /unused
                    ```

                    **Figure: Find unused Fields**

                    However figuring out which fields that you are going to migrate and which you are not is a very difficult task. Make sure that they customer understands the implications of not migrating a Field. i.,e. All the data will be lost.

                    ```
                    witadmin deletefield /collection:%tpc% /n:NorthwestCadence.CustomFieldName  /noprompt
                    ```

                    **Figure: You can only delete fields that are not in use**

    ## Upgrade each Team Project (~4 hours)

    The Upgrade of the Team Projects is arguably the most difficult area of TFS. It is not only tedious, but it is also not supported out of the box. Once you have chosen your Process Template you are stuck with it for life. There are a number of options here for doing the upgrade:

    1. **Stick with same template Not good as everyone wants to take advantage of the new features of TFS 2010.**

    2. **Use the SfTSv3 Upgrade tool to move to a new Team Project.**This really sucks as you can never delete the old project. When you do a “move” of source code it actually does a “branch & delete” under the covers, thus your “history” is actually stored where is always was and never moves. If you delete the old team project you will loose the history.

       _Note: If you remove permissions to view the project you will also loose the history_

    3. **Use the TFS Integration Platform to move Source and Work Item history to a new team project**This is an ideal solution, but it does result in “time dilation” on your source control. There is no way to fake a check-in date so all dates will be when the actual check-in happens. As the TFS Integration Platform does all of the check-ins concurrently it stores the original date in the comments. This was not possible with this customer as they use that date often in their internal tools and processes.

    4. **Do an in place manual migration This is just plane nasty and take a lot of time. It can take over 8 hours to complete the migration once it has been planned out, and that time depends on the process template you are moving from, the one you are moving to, and the customisations you have made along the way. If all of your Team Projects have different customisations, then this is probably a non starter.**

    5. **Do an in-place _export_ migration.** This gives us the best of both worlds, with an export of Work Item data to another location, destroying all the existing work item types along with all of the data, then install the new Work Item Types and reload the data. This is still a horrible process, but it keeps the Source Code history in tact, and allows for the process template to be completely upgraded.

    My customer has to go with #5 and we should be able to use the SfTSv3 Migration tool that comes from EMC. It does an export to XML and then transforms the data from SfTSv2 to SfTSv3 before you import it back in. The tool was designed to work by migrating from one Team Project to another, but I am going to use it to achieve the in-place export migration I described above.

    ### SfTSv3 In-Place Export Migration (~4 hours per team project)

    As the Export Migration is the chosen route of least friction we need to follow a lot of steps to get there. I would note that for a large project, one of mine was over 400MB of XML data to import, can take a really long time. My longest was 8 hours, and yes you have to babysit the process.

    1.  #### **Export TeamProjectX to XML (20 minutes)**

            Exporting is probably the easiest part of this process but that will depend on the amount of data. If the project has been around for along time then you could end up with a rather large XML file. One of the Team Projects here produced a file larger than 500mb for under 20k of Work Items. It is really the revisions that detail the amount of data and time it will take.

            [![image](images/image_thumb-2-2.png "image")](http://blog.hinshelwood.com/files/2011/05/image.png)

        { .post-img }

            **Figure: Exporting is easy**

            This is actually a process that i would contemplate using long term. Outputting all of the Work Item history behind your Team Project to an XML file is very desirable for a variety of migration scenarios. Although, if I was writing the import it would use the TFS Integration Platform which would give me the best of both worlds. In this case I do not have time to create an XML Adapter for it.

    2.  #### **Transform TeamProjectX (Started 10:45) (3 hours 15 minutes for 19550 work item)**

            For the transform to work you must specify a “Rules” file that has all of the mapping in it. This file is a bit of a black box with sparse documentation, but I did manage to add the ~15  custom fields that are being kept. I also had to add a bunch of mappings to “fold” some custom Work Item Types into

            [![image](images/image_thumb1-3-3.png "image")](http://blog.hinshelwood.com/files/2011/05/image1.png)

        { .post-img }

            **Figure: Transforming can take some time if there are a lot of revisions**

            This is where I find the deficiencies come into the process and they have not tested the process with enough edge cases. Why do I say this? Well, lets take a look at the next step shall we…

    3.  #### **Fix data before import**

            For a production ready tool the SfTSv3 Migration Tools leaves a lot to be desired. There are number of things that you need to do as part of a data validation and clean-up before you progress with the import

            1. ##### **Replace invalid characters**

                The tool completely fails to take into account that you can have characters in the old “Team” drop down that are no valid in the Iteration Path that the data has been moved to. In this case it is ‘<’ and ‘>’

                [![image](images/image41_thumb-30-30.png "image")](http://blog.hinshelwood.com/files/2011/05/image41.png)

        { .post-img }

                **Figure: It does not handle the ‘<’ or ‘>’**

                **[![image](images/image_thumb2-11-11.png "image")](http://blog.hinshelwood.com/files/2011/05/image2.png)**

        { .post-img }

                Figure: I just don’t understand why the tool does not fix tis itself.

                [![image](images/image_thumb3-12-12.png "image")](http://blog.hinshelwood.com/files/2011/05/image3.png)

        { .post-img }

                **Figure: Although valid XML this is still not good output**

            3. ##### **Remove users that have been deleted from Active Directory**

                If you do not remove these account you will spend hours trying to change the inline. In one project with only ~2000 work items there were over 300 invalid user instances specified. The best thing here is to do a search for “domain” and then replace “surname, forename (domainusername)” with a selected user. In this case I found an account that was in the system aptly called “**_\_GhostService_**” so I used that.

                [![image](images/image_thumb4-13-13.png "image")](http://blog.hinshelwood.com/files/2011/05/image5.png)

        { .post-img }

                **Figure: All deleted users need to be fixed**

                **[![image](images/image_thumb5-14-14.png "image")](http://blog.hinshelwood.com/files/2011/05/image6.png)** **Figure: Visual Studio is pretty good at replacing in big files (100MB+)**

        { .post-img }

                It sucks very much that this is the case as the TFS Integration Platform will take care of this for you by inserting the user anyway. Thus preserving the history.


            5. ##### **Add in missing Area Paths**

                There are so many missing paths that it is impossible to manually add them so I have written some VB code to parse the output XML and build the correct list of nodes:

                ```
                Dim xmlDocument As New Xml.XmlDocument()
                xmlDocument.Load("TransformedXML.xml")

                Dim foundIP As New List(Of String)
                Dim nodes As XmlNodeList
                ' Find all used nodes
                nodes = xmlDocument.SelectNodes("//*[local-name()='Field']")
                For Each node As XmlNode In nodes
                    If node.Attributes("name").Value = "System.IterationPath" And Not String.IsNullOrEmpty(node.InnerText) Then
                        foundIP.Add(node.InnerText)
                    End If
                Next
                ' Find all specified nodes
                nodes = xmlDocument.SelectNodes("//*[local-name()='IterationPaths']/*[local-name()='string']")
                For Each node As XmlNode In nodes
                    foundIP.Add(node.InnerText)
                Next
                ' Create Distinct list of nodes
                Dim iterations As New System.Text.StringBuilder
                iterations.AppendLine("<IterationPaths>")
                For Each ip In foundIP.Distinct
                    iterations.AppendLine(String.Format("   <string>{0}</string>", ip))
                Next
                iterations.AppendLine("</IterationPaths>")
                Console.Write(iterations.ToString)
                Console.ReadLine
                ```

                **Figure: The SfTSv3 Migration tool needs a little help**

                I really should not have to do this and I can only think that it is some bug in the SfTSv3 Migration tool that is stopping it creating these for me.

    4.  #### **Fix Queries**

            Because we want to keep the old queries around, and you can do nothing but delete them once you delete the Work item Types we need to move them before we do anything to the Team Project. it may be that some of the teams spent a long time getting their queries “just right” and we don’t just want to delete that hard work.

            1. ##### **Create a folder called “\_2008Archive”**

                TFS 2010 added the ability to have Query folders. Here is hoping that we get them on Builds as well in the future.

                [![image](images/image_thumb6-15-15.png "image")](http://blog.hinshelwood.com/files/2011/05/image8.png)

        { .post-img }

                **Figure: The folder will store all of the old queries**


            3. ##### **Move all of the existing Queries into this folder**

                Luckily we can drag and drop Queries within the same Team Project.

                [![image](images/image_thumb7-16-16.png "image")](http://blog.hinshelwood.com/files/2011/05/image9.png)

        { .post-img }

                **Figure: All of your queries are now saved**


            5. ##### **Copy all of the new queries into the team project**

                We have at least one Team Project that was created with the new template (TfsCustomisations), and even more luckily we can drag and drop Queries between Team Projects.

                [![image](images/image_thumb8-17-17.png "image")](http://blog.hinshelwood.com/files/2011/05/image11.png)

        { .post-img }

                **Figure: Shiny new Queries are now waiting for the team**

    5.  #### **Fix Reports**

            You will need to add the new reports to TFS, but unfortunately while there is drag and drop support for moving reports within a Team Project there is no way to drag them _into_ a Team Project, but there his a command line tool to support this. However, prior to running it you should again create a “\_2008Archive” folder to load all of the existing reports into. Again there may be a bunch of custom reports in there that the team does not want to loose. Once you have done that you can call the command line option to install the new templates

            [![image](images/image_thumb9-18-18.png "image")](http://blog.hinshelwood.com/files/2011/05/image12.png)

        { .post-img }

            **Figure: Put all existing reports under “\_2008Archive”**

            ```
            tfpt addprojectreports /collection:%tpc% /teamproject:%tp% /processtemplate:"Scrum for Team System v3.0.3784.03" /force
            ```

            **Figure: Command to add all of the Reports for a Process Template to TFS**

    6.  #### **Tare down old SfTSv2 Process Template**

        This is where the demolition expert in you gets to have a little fun. It is very complicated to build things, and not so much to destroy them. Now that we have all of our data exported and transformed we can go ahead and destroy all of the Work Item Type Definitions (WITD) that are in that Team Project.

        Because I am running a whole lot of command against multiple Team Projects and I do not want to have to change out the Team Project Collection every time, here is a little hint for the command line.

        ```
        set tpc=http://tfsServerName:8080/tfs/teamProjectCollectionName
        ```

        **Figure: Set a variable so you don't have to add things to every command**

        ```
        witadmin listwitd /collection:%tpc% /p:"[Team Project Name]"
        ```

        **Figure: Get a list of all the Work Item Types**

        ```
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Bug" /noprompt
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Product Backlog Item" /noprompt
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Sprint Backlog Item" /noprompt
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Impediment" /noprompt
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Sprint Retrospective" /noprompt
        witadmin destroywitd /collection:%tpc% /p:"[Team Project Name]" /n:"Sprint" /noprompt
        ```

        **Figure: Delete the default Work Items, but don’t forget any custom ones**

        _note: Because this was a Team Project that was upgraded from TFS 2008 there are no links or categories to update. You will also need to make sure that you do something with all of the custom fields and Work Item Types that have been added._

    7.  #### **Build up new SfTSv3 Process Template**

        Building up the Work Item Types is not quite as much fun as tearing them down, but it does give you more of a sense of achievement. In order to “install” the SfTSv3 Process Template you need to:

        1. ##### **Install the SfTSv3 Work Item Type Definitions**

           These new work item types can be easily added to make it look as if the Project always had this process template. There are still more things that we will need to do later to make this a workable solution.

           ```
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsAcceptanceTest.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsBug.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsImpediment.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsProductBacklogItem.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsRelease.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsSharedStep.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsSprint.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsSprintBacklogTask.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsSprintRetrospective.xml"
           witadmin importwitd /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingTypeDefinitionsTeamSprint.xml"
           ```

           **Figure: Add the Work Items that you put under version control in the TfsCustomisations Team Project**

        2. ##### **Install the SfTSv3 Categories**

           Categories as new in TFS 2010 and all reports to load Categories rather that be hard coded to particular Work Item Types. The only stipulation / limitation is that a Work Item can only be in one Category.

           ```
           witadmin importcategories /collection:%tpc% /p:"[Team Project Name]" /f:".WorkItemTrackingcategories.xml"
           ```

           **Figure: Add categories to enable some of the TFS 2010 functionality**

        3. ##### **Install the SfTSv3 Link Types**

           Link Types enable one of the core features of TFS 2010. The ability to have nested work items. It is worth noting that there are some built in Link Types that are not listed here that will support MS Project and other tools. These will already have been added by the upgrade process.

           ```
           witadmin importLinktype /collection:%tpc% /f:".WorkItemTrackingLinkTypesFailedBy.xml"
           witadmin importLinktype /collection:%tpc% /f:".WorkItemTrackingLinkTypesImpededBy.xml"
           witadmin importLinktype /collection:%tpc% /f:".WorkItemTrackingLinkTypesImplementedBy.xml"
           witadmin importLinktype /collection:%tpc% /f:".WorkItemTrackingLinkTypesSharedStep.xml"
           witadmin importLinktype /collection:%tpc% /f:".WorkItemTrackingLinkTypesTestedBy.xml"
           ```

           **Figure: Link Types only need to be added once**

    8.  #### **Import Data back into new SfTSv3 Work Items**

            1. ##### **Stop the SfTS Process Template Services**

                So that you do not get duplicate items or any rollup going on prior to the upgrade completing you need to “Retract” the deployment from the Team Project Collection that you will be importing the data to.

                [![image](images/image_thumb10-4-4.png "image")](http://blog.hinshelwood.com/files/2011/05/image14.png)

        { .post-img }

                **Figure: You MUST stop the service from running**

                [![image](images/image_thumb11-5-5.png "image")](http://blog.hinshelwood.com/files/2011/05/image15.png)

        { .post-img }

                **Figure: Retract before import**


            3. ##### **Run the import**

                This can take quite a long time, but in my experience does not take quite as long as the transformation process.

                [![image](images/image_thumb12-6-6.png "image")](http://blog.hinshelwood.com/files/2011/05/image17.png)

        { .post-img }

                **Figure: The import runs one change at a time**


            5. ##### **Fix any errors that crop up**

                During the process there will be errors. I can guarantee this. Although I have done my very best to make sure that there are as few as possible, I still end up having to babysit the process to completion.

                [![image](images/image_thumb13-7-7.png "image")](http://blog.hinshelwood.com/files/2011/05/image18.png)

        { .post-img }

            7. ##### **Start the SfTS Processes**

                [![image](images/image_thumb14-8-8.png "image")](http://blog.hinshelwood.com/files/2011/05/image19.png)

        { .post-img }

                **Figure: Redeploy the processes**


            9. ##### **Implement Release dates rollup fix**

                ```
                UPDATE [Tfs_SageCre20110505].[dbo].[tbl_EventSubscription]
                SET [Expression] =
                    REPLACE
                    (
                        [Expression],
                        '|Product Backlog Item|Sprint Backlog Task|',
                        '|Product Backlog Item|Sprint|Sprint Backlog Task|'
                    )
                WHERE
                [Expression] LIKE '%|Product Backlog Item|Sprint Backlog Task|%'
                ```

                Figure: You need to fix the data after


            11. ##### **Run all calculations**

                [![image](images/image_thumb15-9-9.png "image")](http://blog.hinshelwood.com/files/2011/05/image20.png)

        { .post-img }

                **Figure: You need to run a recalculation on all of the work items**

    9.  #### **Rebuild the Warehouse**

            [![image](images/image_thumb16-10-10.png "image")](http://blog.hinshelwood.com/files/2011/05/image21.png)

        { .post-img }

            **Figure: You can rebuild the warehouse through the TFS Admin Console**

    10. #### **DONE**

        Now that we have completed the upgrade of one Team Project we can complete the process on everyone

        How did your upgrade go?

    ## REFERNECES

    - [Upgrade Team Foundation Server 2008 to TFS 2010 (and SharePoint Server 2010) - Random Musings of Jeremy Jameson - Site Home - MSDN Blogs](http://blogs.msdn.com/b/jjameson/archive/2010/05/04/upgrade-team-foundation-server-2008-to-tfs-2010-and-sharepoint-server-2010.aspx)

    - [How do I build a 3.5 solution with MSBuild 4.0?](http://stackoverflow.com/questions/1687420/how-do-i-build-a-3-5-solution-with-msbuild-4-0)

    - [New in FinalBuilder 7](http://www.finalbuilder.com/new-in-finalbuilder-7.aspx)

    - [Breaking Change in VS 2010 SP1: using key file for signing C++/CLR assemblies](http://connect.microsoft.com/VisualStudio/feedback/details/652991/breaking-change-in-vs-2010-sp1-using-key-file-for-signing-c-clr-assemblies)

    - [List Fields That Are Not Being Used](<http://msdn.microsoft.com/en-us/library/ms404864(v=VS.100).aspx>)

    - [TFS 2010 Compatibility with Older Clients - bharry's WebLog - Site Home - MSDN Blogs](http://www.google.co.uk/search?sourceid=chrome&ie=UTF-8&q=compatability+tfs+2010+vs2008#hl=en&safe=off&sa=X&ei=J7DJTfCAC861twfnoOzbBw&ved=0CBcQBSgA&q=compatibility+tfs+2010+vs+2008&spell=1&fp=edc1e8e99e75b7df&biw=1321&bih=850)

    - [Download details: Visual Studio Team System 2008 Service Pack 1 Forward Compatibility Update for Team Foundation Server 2010 (Installer)](http://www.microsoft.com/downloads/en/details.aspx?FamilyID=cf13ea45-d17b-4edc-8e6c-6c5b208ec54d)

    - [Compatibility Matrix for 2010 Beta 2 Team Foundation Server to Team Explorer 2008 and 2005 - Teams WIT Tools - Site Home - MSDN Blogs](http://blogs.msdn.com/b/teams_wit_tools/archive/2009/10/19/compatibility-matrix-for-2010-beta-2-team-foundation-server-to-team-explorer-2008-and-2005.aspx)

    - [Report Services Automation With PowerShell « Code Assassin](http://blog.codeassassin.com/2007/10/14/report-services-automation-with-powershell/)

    - [PsTFS - Cmdlet for Team Foundation Server – Home](http://pstfs.codeplex.com/)

    - [Delete / Remove TFS Work Item Type](http://geekswithblogs.net/juang/archive/2008/09/03/delete--remove-tfs-work-item-type.aspx)

    - [FAQ #5: How do I destroy work items or work item types? - Teams WIT Tools - Site Home - MSDN Blogs](http://blogs.msdn.com/b/teams_wit_tools/archive/2008/02/06/faq-5-how-do-i-destroy-work-items-or-work-item-types.aspx)

    - [Scrum for Team System v3 – Release dates rollup fix](http://consultingblogs.emc.com/crispinparker/archive/2010/09/07/scrum-for-team-system-v3-release-dates-rollup-fix.aspx "http://consultingblogs.emc.com/crispinparker/archive/2010/09/07/scrum-for-team-system-v3-release-dates-rollup-fix.aspx")

    - [XPath + Namespace Driving me crazy](http://stackoverflow.com/questions/536441/xpath-namespace-driving-me-crazy)

    - [XPath Examples](https://www.w3schools.com/xml/xpath_examples.asp)
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-30-upgrading-from-tfs-2008-and-wss-v3-0-with-sftsv2-to-tfs-2010-and-sf-2010-with-sftsv3\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-30-upgrading-from-tfs-2008-and-wss-v3-0-with-sftsv2-to-tfs-2010-and-sf-2010-with-sftsv3
- FrontMatter:
    title: Configuring a PowerShell Adapter for the TFS Integration Platform
    description: Learn to configure a PowerShell adapter for TFS Integration Platform, enabling seamless source code transfer to Perforce. Enhance your workflow today!
    ResourceId: gzuPSzbixBn
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3652
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-06-23
    weight: 790
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: configuring-a-powershell-adapter-for-the-tfs-integration-platform
    aliases:
    - /resources/gzuPSzbixBn
    aliasesArchive:
    - /blog/configuring-a-powershell-adapter-for-the-tfs-integration-platform
    - /configuring-a-powershell-adapter-for-the-tfs-integration-platform
    - /resources/blog/configuring-a-powershell-adapter-for-the-tfs-integration-platform
    tags:
    - Install and Configuration
    - Software Development
    - System Configuration
    categories:
    - Uncategorized
  BodyContent: |
    ![](images/image_thumb-1-1.png)
    { .post-img }

    We have a customer who really, really want to ship source code from Team Foundation Server (TFS) to Perforce. Why you might ask… Well for many companies they can’t just migrate, they either need some sort of safety net, or have an external requirement that they MUST use a particular system as a matter of record.

    But they really want to use TFS.

    - **Perforce** - [Sync offline changes to a workspace into Perforce](http://stackoverflow.com/questions/6458927/sync-offline-changes-to-a-workspace-into-perforce) (StackOverflow.com)

    Updates

    - **2011-06-27** – I have added two new operating modes to increase the versatility (_RuleThemAll_ | _ForEachAction_). These new modes do not run any .NET code at all and you have to do everything in PowerShell. I expect that PowerShell user will love RuleThemAll as all you need is one PowerShell per ChangeSet.

    ---

    We have to have some way of getting each of the check-ins out of TFS in order and writing them to the other system on a regular basis without having to write an Adapter for each new system. This will obviously not be a perfect scenario as it will not be tailored directly for the other system, but it should suffice for 90% of cases that I will encounter.

    ## The Theory

    The TFS Integration Platform Adapter I have written is really simple, and focuses on adaptability not perfection. What is the best tool for this… well PowerShell of course ![Smile](images/wlEmoticon-smile1-10-10.png), and with the Team Foundation Adapters already written and provided in the box, we only have to worry about the other side.
    { .post-img }

    In the integration platform if you want to do the _writing_, rather than the _reading_ I recently [did for Test Track Pro](http://blog.hinshelwood.com/a-working-test-track-pro-adapter-for-the-tfs-integration-platform/), then you concentrate on the IMigrationProvider interface which allows you to implement the ProcessChangeGroup method.

    ```
    Public Overrides Function ProcessChangeGroup(changeGroup As Microsoft.TeamFoundation.Migration.Toolkit.ChangeGroup) As Microsoft.TeamFoundation.Migration.Toolkit.ConversionResult
        Dim conversionResult As New ConversionResult(_configurationService.MigrationPeer, _configurationService.SourceId)
        conversionResult.ChangeId = changeGroup.ChangeGroupId
        Dim OutDirectory As String = Me._configurationService.MigrationSource.SourceIdentifier
        Dim SourceRoot As String = Me._configurationService.Filters(0).Path
        TraceManager.TraceInformation(String.Format("Processing {0} actions - {1}", changeGroup.Actions.Count, changeGroup.Comment))
        If Not RunPowershell("ImportChangeGroup_Initial", changeGroup, conversionResult, OutDirectory) Then
            conversionResult.ChangeId = String.Empty
        End If
        For Each action As MigrationAction In changeGroup.Actions
            Dim path As String = ConvertPath(OutDirectory, SourceRoot, action.Path)
            If BuildLocalCache(changeGroup, conversionResult, SourceRoot, OutDirectory, path, action) Then
                conversionResult.ItemConversionHistory.Add(New ItemConversionHistory(changeGroup.Name, action.Version, path, String.Empty))
            End If
        Next
        If Not RunPowershell("ImportChangeGroup_Final", changeGroup, conversionResult, OutDirectory) Then
            conversionResult.ChangeId = String.Empty
        End If
        Return conversionResult
    End Function
    ```

    For each change group that is found in TFS the Integration Platform calls this method. The Platform is going to keep track of which you have already done and what types of changes need to be done in what order. All we have to do is do something with them and pass back a ConversionResult object that details a ItemConversionHistory object for each of the Actions that were part of the change group.

    You can see from the code above that I am calling a PowerShell script at both the beginning and end of the process. You can’t see it here, but a PowerShell is also called for each of the actions. During this process we build up a record of what we have done and pass back the completed ConversionResult to the TFS Integration Platform so it can check all of the items that we have processed off the list.

    In order to add some amount of flexibility to the system I am allowing a different PowerShell to be called for each ContentType and ChangeAction combination:

    <table border="0" cellspacing="0" cellpadding="2" width="457"><tbody><tr><td valign="top" width="277"><strong>Content Type</strong></td><td valign="top" width="140"><strong>Action</strong></td><td valign="top" width="137">&nbsp;</td></tr><tr><td valign="top" width="296">Version Controlled Folder</td><td valign="top" width="147">Add</td><td valign="top" width="142">&nbsp;</td></tr><tr><td valign="top" width="300">Version Controlled Folder</td><td valign="top" width="151">Edit</td><td valign="top" width="144">&nbsp;</td></tr><tr><td valign="top" width="299">Version Controlled Folder</td><td valign="top" width="153">Delete</td><td valign="top" width="145">&nbsp;</td></tr><tr><td valign="top" width="298">Version Controlled Folder</td><td valign="top" width="155">Rename</td><td valign="top" width="145">&nbsp;</td></tr><tr><td valign="top" width="297">Version Controlled File</td><td valign="top" width="156">Add</td><td valign="top" width="145">&nbsp;</td></tr><tr><td valign="top" width="296">Version Controlled File</td><td valign="top" width="157">Edit</td><td valign="top" width="144">&nbsp;</td></tr><tr><td valign="top" width="296">Version Controlled File</td><td valign="top" width="158">Delete</td><td valign="top" width="144">&nbsp;</td></tr><tr><td valign="top" width="295">Version Controlled File</td><td valign="top" width="159">Rename</td><td valign="top" width="144">&nbsp;</td></tr></tbody></table>

    **Figure: Supported Actions**

    In the configuration for the Adapter I have added a bunch of keys that translate to each of the entries above that will allow you to configure which scripts you want to use. You can use them all if you want or only use one.

    ```
    <CustomSettings>
      <!--
        Powershell Arguments

        $IpChangeGroup = Microsoft.TeamFoundation.Migration.Toolkit.ChangeGroup
        $IpConversionResult = Microsoft.TeamFoundation.Migration.Toolkit.ConversionResult
        $IpMigrationAction = Microsoft.TeamFoundation.Migration.Toolkit.MigrationAction
        $IpNewPath = c:TempOutputFolderImportRun1{localpath}
        $IpLocalRoot = c:TempOutputFolderImportRun1

        PowerShell Execution Mode:

        RuleThemAll = Lets just have a single PowerShell that does everything. Don't forget to update the IpConversionResult with all of the results.
        ForEachAction = Calls a PowerShell script for each action as below
        WithLocalCache = Original mode that maintains a local copy of the files and calls powershell for each Action

      -->
      <CustomSetting SettingKey="PowerShellExecutionMove" SettingValue="WithLocalCache" />
      <CustomSetting SettingKey="ImportChangeGroup" SettingValue="" />
      <CustomSetting SettingKey="ImportChangeGroup_Initial" SettingValue="" />
      <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFolder_Add" SettingValue="" />
      <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFolder_Edit" SettingValue="" />
      <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFolder_Delete" SettingValue="" />
      <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFolder_Rename" SettingValue="" />
      <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFile_Add" SettingValue="" />
      <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFile_Edit" SettingValue="" />
      <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFile_Rename" SettingValue="" />
      <CustomSetting SettingKey="ImportChangeGroup_Final" SettingValue="" />
    </CustomSettings>
    ```

    **Figure: Custom settings for configuring PowerShell files**

    As might be eluded to by the list of arguments above I am passing a bunch of them into PowerShell that should be of use to the person configuring the options. One of the really nice things about using PowerShell is that you can pass in a complicated object graph and have it available for the PowerShell user. You can also get objects back out again, but in this case I only need in.

    ```
    Public Function ExecutePowershell(powerShellKey As String, changeGroup As ChangeGroup, conversionResult As ConversionResult, localRoot As String, Optional action As MigrationAction = Nothing, Optional newPath As String = "") As List(Of PSObject)
        _pipeline = _runspace.CreatePipeline()
        Dim psFile As String = GetPowerShellFile(powerShellKey)
        Dim results As New List(Of PSObject)
        If File.Exists(psFile) Then
            Dim command As New Command(psFile)
            command.Parameters.Add(New CommandParameter("IpChangeGroup", changeGroup))
            command.Parameters.Add(New CommandParameter("IpConversionResult", conversionResult))
            If Not action Is Nothing Then
                command.Parameters.Add(New CommandParameter("IpMigrationAction", action))
                command.Parameters.Add(New CommandParameter("IpNewPath", action))
            End If
            command.Parameters.Add(New CommandParameter("IpLocalRoot", localRoot))
            command.MergeMyResults(PipelineResultTypes.Error, PipelineResultTypes.Output)
            _pipeline.Commands.Add(command)
            Dim dt As DateTime = Now
            results.AddRange(_pipeline.Invoke())
        Else
            TraceManager.TraceWarning(String.Format("PowerShell: DOES NOT EXIST for custom setting '{0}'", powerShellKey))
        End If
        Return results
    End Function
    ```

    **Figure: Calling PowerShell from VB.NET with Parameters**

    This means that you can access things like the Comment from the original change group in TFS as well as the person that did the check-in.

    ```
    p4 commit -d $IpChangeGroup.Comment
    ```

    **Figure: PowerShell to check-in all outstanding files with the original comment**

    ## The Practice

    In order to run this adapter you are going to need somewhere to install and run the [TFS Integration Platform](http://tfsintegration.codeplex.com/). I would suggest the the TFS server itself, but if you have a problem with that then find another server.

    The [TFS Integration Platform](http://tfsintegration.codeplex.com/) can run with a UI so we will be using that to configure it, but it can also run off the command line. If you are going to want this tool to run in more than “One-Time” mode then you are going to want to install the service. This will run the sync even if no one is logged on.

    [![SNAGHTMLca8aa6](images/SNAGHTMLca8aa6_thumb-3-3.png "SNAGHTMLca8aa6")](http://blog.hinshelwood.com/files/2011/06/SNAGHTMLca8aa6.png)
    { .post-img }

    **Figure: Install the Service if you will be syncing**

    Once you have it installed you will need a configuration file as a template. This file can be pretty loose, or it can be really strict in what you can select. Depending on the Adapters that you install out of the box will depend on the templates that you get. You can have Work Item Tracking only, Version Control only or a combination.

    In this case we will be using my magic config file:

    ```
    <?xml version="1.0" encoding="utf-16"?>
    <Configuration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                   UniqueId="8ecc79e4-b97c-4e78-a0c8-f20062ebdaa9" FriendlyName="NWC - TFS to Powershell">
      <Providers>
        <Provider ReferenceName="febc091f-82a2-449e-aed8-133e5896c47a" FriendlyName="TFS 2010 Migration VC Provider" />
        <Provider ReferenceName="566c001e-e476-4a07-8447-b2284c55a20e" FriendlyName="Powershell Adapter" />
      </Providers>
      <Addins>
        <Addin ReferenceName="cdde6b6b-72fc-43b6-bbd1-b8a89a788c6f" FriendlyName="TFS Active Directory User Id Lookup Service Addin">
          <CustomSettings />
        </Addin>
      </Addins>
      <SessionGroup CreationTime="2011-06-23T21:29:10.9738265Z" FriendlyName="NWC - TFS to Powershell"
                    SessionGroupGUID="571b708d-c683-4540-adf9-f5843dea20f9" Creator="MrHinsh" SyncIntervalInSeconds="160" SyncDurationInMinutes="0">
        <MigrationSources>
          <MigrationSource InternalUniqueId="4199bde3-c26c-4b6d-86bb-8328e221e499" FriendlyName="mytfs.company.com(VC)" ServerIdentifier="40a26de8-a27e-4bef-9c9b-87cc64ad6cbc" ServerUrl="http://mytfs.company.com:8080/tfs/DefaultCollection" SourceIdentifier="TeamProject1" ProviderReferenceName="febc091f-82a2-449e-aed8-133e5896c47a" EndpointSystemName="TFS">
            <Settings>
              <Addins />
              <UserIdentityLookup>
                <LookupAddin Precedence="1" ReferenceName="cdde6b6b-72fc-43b6-bbd1-b8a89a788c6f" />
              </UserIdentityLookup>
              <DefaultUserIdProperty UserIdPropertyName="DisplayName" />
            </Settings>
            <CustomSettings>
              <CustomSetting SettingKey="EnableBypassRuleDataSubmission" SettingValue="True" />
              <CustomSetting SettingKey="DisableAreaPathAutoCreation" SettingValue="False" />
              <CustomSetting SettingKey="DisableIterationPathAutoCreation" SettingValue="False" />
            </CustomSettings>
            <StoredCredential />
          </MigrationSource>
          <MigrationSource InternalUniqueId="9163311f-9312-47e6-a635-cae1817a2488" FriendlyName="Powershell (vc)" ServerIdentifier="40d0185d-e576-409b-ad5f-9fae3ac3d73e" ServerUrl="fieldnotused" SourceIdentifier="C:tempTestRun1" ProviderReferenceName="566c001e-e476-4a07-8447-b2284c55a20e">
            <Settings>
              <Addins />
              <UserIdentityLookup>
                <LookupAddin Precedence="1" ReferenceName="cdde6b6b-72fc-43b6-bbd1-b8a89a788c6f" />
              </UserIdentityLookup>
              <DefaultUserIdProperty UserIdPropertyName="DisplayName" />
            </Settings>
            <CustomSettings>
              <CustomSetting SettingKey="PowerShellExecutionMove" SettingValue="WithLocalCache" />
              <CustomSetting SettingKey="ImportChangeGroup_Initial" SettingValue="C:Program Files (x86)Microsoft Team Foundation Server Integration ToolsConfigurationPowerShellSamplesPerforcePerforceInitilise.ps1" />
              <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFolder_Add" SettingValue="" />
              <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFolder_Edit" SettingValue="" />
              <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFolder_Delete" SettingValue="" />
              <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFolder_Rename" SettingValue="" />
              <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFile_Add" SettingValue="C:Program Files (x86)Microsoft Team Foundation Server Integration ToolsConfigurationPowerShellSamplesPerforcePerforceFileAdd.ps1" />
              <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFile_Edit" SettingValue="C:Program Files (x86)Microsoft Team Foundation Server Integration ToolsConfigurationPowerShellSamplesPerforcePerforceFileEdit.ps1" />
              <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFile_Delete" SettingValue="" />
              <CustomSetting SettingKey="ImportChangeGroupAction_VersionControlledFile_Rename" SettingValue="" />
              <CustomSetting SettingKey="ImportChangeGroup_Final" SettingValue="C:Program Files (x86)Microsoft Team Foundation Server Integration ToolsConfigurationPowerShellSamplesPerforcePerforceCommit.ps1" />
            </CustomSettings>
            <StoredCredential />
          </MigrationSource>
        </MigrationSources>
        <Sessions>
          <Session CreationTime="2011-06-23T21:29:10.9188265Z" SessionUniqueId="548bb392-34f2-4fa4-8fe9-e824380f651f" FriendlyName="Version Control Session" LeftMigrationSourceUniqueId="4199bde3-c26c-4b6d-86bb-8328e221e499" RightMigrationSourceUniqueId="9163311f-9312-47e6-a635-cae1817a2488" SessionType="VersionControl">
            <EventSinks />
            <CustomSettings>
              <SettingXml />
              <SettingXmlSchema />
            </CustomSettings>
            <Filters>
              <FilterPair Neglect="false">
                <FilterItem MigrationSourceUniqueId="4199bde3-c26c-4b6d-86bb-8328e221e499" FilterString="$/TeamProject1/Folder1" />
                <FilterItem MigrationSourceUniqueId="9163311f-9312-47e6-a635-cae1817a2488" FilterString="$/TeamProject1/Folder1" />
              </FilterPair>
            </Filters>
          </Session>
        </Sessions>
        <Linking>
          <CustomSettings />
          <LinkTypeMappings />
        </Linking>
        <WorkFlowType Frequency="ContinuousAutomatic" DirectionOfFlow="Unidirectional" SyncContext="Disabled" />
        <CustomSettings />
        <UserIdentityMappings EnableValidation="false">
          <UserIdentityLookupAddins />
        </UserIdentityMappings>
        <ErrorManagement>
          <ErrorRouters />
          <ReportingSettings />
        </ErrorManagement>
      </SessionGroup>
    </Configuration>
    ```

    ```
    Figure: Configuration for the Powershell Adapter
    ```

    I have highlighted the important parts above and we have already described some of the important bits above, but there are only really three important things to configure:

    - **Tfs Source folder** \- (e.g. $/TeamProject1/Folder1)

      The TFS Source Folder defines where in TFS you want to get the data. The Adapter does not currently support branches so it would be best to pick a folder that does not contain any.

    - **Local Output Folder** - (e.g. c:Enlistment1995Depot)

      This is the folder where the system will write out the files and folders before calling PowerShell. This would usually be the actual Workspace folder for the other system, or could be anywhere.

    - **Power Shell File** - (e.g. c:Enlistment1995SyncPerforceEditsWithDepot.ps1)
      The PowerShell files are easily configured as described. Remember that for every change “Add”, “Edit” or “Delete” a respective PowerShell can be configured to be called.  
       note: You can call a single PowerShell or have it call the individuals, but not manage the file space.

    Now that you are able to configure the config file, it is time to setup the run.

    [![SNAGHTMLe3e86f](images/SNAGHTMLe3e86f_thumb-4-4.png "SNAGHTMLe3e86f")](http://blog.hinshelwood.com/files/2011/06/SNAGHTMLe3e86f.png)
    { .post-img }

    **Figure: Creating a new Configuration for the TFS Integration Platform**

    We need to create a new configuration and select the config file template that we built. Don’t worry, we can change the individual settings later.

    [![SNAGHTMLe5b54e](images/SNAGHTMLe5b54e_thumb-5-5.png "SNAGHTMLe5b54e")](http://blog.hinshelwood.com/files/2011/06/SNAGHTMLe5b54e.png)
    { .post-img }

    **Figure: Using the Sample PowerShell Configuration**

    [![SNAGHTMLe83fa3](images/SNAGHTMLe83fa3_thumb-6-6.png "SNAGHTMLe83fa3")](http://blog.hinshelwood.com/files/2011/06/SNAGHTMLe83fa3.png)
    { .post-img }

    **Figure: You can reconfigure the TFS side to point at a valid TFS server and Project.**

    [![SNAGHTMLe8d29e](images/SNAGHTMLe8d29e_thumb-7-7.png "SNAGHTMLe8d29e")](http://blog.hinshelwood.com/files/2011/06/SNAGHTMLe8d29e.png)
    { .post-img }

    **Figure: Make sure that your folder does not “contain” a branch**

    For a very strange reason that probably spells from my laziness, you need to set both the left and the right hand side of the Paths to be the same thing. I am sure that this is just a temporary work around, _but you know how they are!_

    [![image](images/image_thumb17-2-2.png "image")](http://blog.hinshelwood.com/files/2011/06/image17.png)
    { .post-img }

    **Figure: Paths must be the same**

    You can now “Save to Database” the configuration and click the “Start” button on the left to start the first run on the Adapter.

    [![SNAGHTMLed1f28](images/SNAGHTMLed1f28_thumb-8-8.png "SNAGHTMLed1f28")](http://blog.hinshelwood.com/files/2011/06/SNAGHTMLed1f28.png)
    { .post-img }

    **Figure: The Adapter then starts it run**

    There is not much more to see, the files are populated by change set in the folder that was selected and the PowerShell scripts that were configured run.

    [![SNAGHTMLefcfb1](images/SNAGHTMLefcfb1_thumb-9-9.png "SNAGHTMLefcfb1")](http://blog.hinshelwood.com/files/2011/06/SNAGHTMLefcfb1.png)
    { .post-img }

    **Figure: Some Changesets are bigger than others**

    Once and a while there are some really big Changesets processed. This one is actually pretty small and only had 1846 change actions.

    ## Conclusion

    Although this process can take a while, the fact that you can configure the PowerShell any way you like on the fly makes it a very versatile adapter. Although the down side is that you have to write in PowerShell ![Smile](images/wlEmoticon-smile1-10-10.png)
    { .post-img }

    If you need a copy of your TFS Version Control data somewhere other than TFS for posterity, or you need a migration from [Test Track Pro to TFS](http://blog.hinshelwood.com/a-working-test-track-pro-adapter-for-the-tfs-integration-platform/), then just ping me and see how we can help.

    [Request for Services](http://nwcadence.com/#)
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-23-configuring-a-powershell-adapter-for-the-tfs-integration-platform\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-23-configuring-a-powershell-adapter-for-the-tfs-integration-platform
- FrontMatter:
    title: Constructing a framework for the TFS Automation Platform
    description: Explore the framework for the TFS Automation Platform, designed to guide developers in building efficient tools and automations. Start your journey today!
    ResourceId: w6AaB_5-1gr
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3641
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-06-12
    weight: 330
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: constructing-a-framework-for-the-tfs-automation-platform
    aliases:
    - /resources/w6AaB_5-1gr
    aliasesArchive:
    - /blog/constructing-a-framework-for-the-tfs-automation-platform
    - /constructing-a-framework-for-the-tfs-automation-platform
    - /resources/blog/constructing-a-framework-for-the-tfs-automation-platform
    tags:
    - Software Development
    - Platform Engineering
    - Internal Developer Platform
    categories:
    - Uncategorized
  BodyContent: |
    ![ALMRangersLogo_Small](images/ALMRangersLogo_Small-1-1.png "ALMRangersLogo_Small")As Lead developer for the TFS Iteration Automation my goal this weekend is to provide a framework for the developers to give both architectural and development guidance for the tools and methods we are going to be using to construct the Platform.
    { .post-img }

    ---

    I have been working on a framework that will allow the developers to get started building for the TFS Automation Platform and specifically to meet the goals for Release 1. I should note that I am not writing any code at this time I am putting together the jigsaw and selecting some technologies.

    I have gone with two solutions. One to constrain all of the platform bits and another for the Automation that we will be building. The main reason for this is to dogfood the developer experience as we really want folks to start building Automations in the wild. If it is hard in any way then they will not.

    This method also allows us to both version and release the Automations separately from the platform and reduces our dependency on code changes in the core. The idea is that, just as everyone else will be doing, we build the Automations against the latest “released” bits. In our case, that will mean the latest “alfa” at the start, but needs must.

    ## TfsAutomationPlatform

    While I intend to keep the Automation Platform as simple as possible, that does not mean that it actually is simple. There are really three parts to the Platform that need to be installed separately, but Mike’s help we should be able to have a unified installer.

    [![image](images/image_thumb12-2-2.png "image")](http://blog.hinshelwood.com/files/2011/06/image12.png)  
    { .post-img }
    **Figure: The Platform needs to be very structured**

    If you are eagle eyed you will see that we are going to be using WIX, Silverlight and the new Architectural tooling in Visual Studio 2010 Ultimate.

    ### Store

    The Store is like a big database of assets. In this case the assets are the Plugins that are available for TFS Administrators to install on their servers. This will be written in Silverlight 5 and can be hosted in IIS or Azure. Hopefully we will be providing a hosted version on Azure, but those with extreme security concerns may install it locally in IIS.

    [![image](images/image_thumb13-3-3.png "image")](http://blog.hinshelwood.com/files/2011/06/image13.png)  
    { .post-img }
    **Figure: A simple model**

    Hopefully as we move forward with new versions we can implement more to provide a culture and ecosystem around the store, but our initial goal is to deliver something that works. Lets worry about gold plating later.

    ### Admin

    This handles all of the grunt work of downloading, installing, Deploying, retracting and configuring plugins. Must be installed on the Application Tier.

    [![image](images/image_thumb14-4-4.png "image")](http://blog.hinshelwood.com/files/2011/06/image14.png)  
    { .post-img }
    **Figure: Very Similar to the Store for now**

    The Admin section handles all of the magic of configuring and auctioning all of the Plugins.

    ### **Client**

    A hook to provide deep Visual Studio integration. Is optional, but lets you quickly link thorough to the Admin application. Will also provide dynamic Check-In Policies in the future. I am not really thinking a lot around this as it will probably not make R1.

    ## TfsAutomationPlugins

    As we will be building a number of OOB (Out Of the Box) Automations it makes sense for us to build them as part of a single solution. This is just for ease of development and if we do have a separation of teams then we may end up with separate solutions. But for now it is easier with just one. We will however need to be careful not to reference between them as one could be deployed without the other.

    [![image](images/image_thumb15-5-5.png "image")](http://blog.hinshelwood.com/files/2011/06/image15.png)  
    { .post-img }
    **Figure: Where do the files go?**

    I will be looking more at the Plugins layout later, and how you can start building Plugins now. I will be upgrading my [TFS Event Handler](http://tfseventhandler.codeplex.com) project code to this platform soon.

    I am trying very hard to make it easy to develop for this platform. I don’t think it will be something that anyone can do as there will be a learning curve for what goes where, and especially how you can debug against TFS in process.

    Now that everything is checked in, I will be encouraging my team mates to explore the solution.

    [![SNAGHTML5342ea](images/SNAGHTML5342ea_thumb-6-6.png "SNAGHTML5342ea")](http://blog.hinshelwood.com/files/2011/06/SNAGHTML5342ea.png)  
    { .post-img }
    **Figure: Lots of lovely places to put code**

    Let me know what improvements you can observe as noting is perfect, especially not if it was done by me.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-12-constructing-a-framework-for-the-tfs-automation-platform\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-12-constructing-a-framework-for-the-tfs-automation-platform
- FrontMatter:
    title: Test Track Pro and the case of the missing data
    description: Explore the challenges of creating a Test Track Pro Adapter for TFS Integration. Discover solutions to data retrieval issues and optimize your workflow!
    ResourceId: h4j0yIumt7h
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3596
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-06-06
    weight: 690
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: test-track-pro-and-the-case-of-the-missing-data
    aliases:
    - /resources/h4j0yIumt7h
    aliasesArchive:
    - /blog/test-track-pro-and-the-case-of-the-missing-data
    - /test-track-pro-and-the-case-of-the-missing-data
    - /resources/blog/test-track-pro-and-the-case-of-the-missing-data
    tags:
    - Troubleshooting
    - Software Development
    categories:
    - Uncategorized
  BodyContent: |
    [![ttp2011_1](images/ttp2011_1_thumb-6-6.gif "ttp2011_1")](http://blog.hinshelwood.com/files/2011/06/ttp2011_1.gif)
    { .post-img }

    As you may know, I have been having lots of problems with creating a Test Track Pro Adapter for the TFS Integration Platform. You may have been following my trials and tribulations in trying to get the data through.

    ---

    It looks as if someone dropped the ball at Seapine when they wrote the query code for TTP. When you query the server to get a list of data the only control you have over the number of records that you get back is to use a “filter”. These filter are pre-setup and I have on on the production TTP system that will give me all of the data that I need to migrate. The problem is that it take around 15 minutes for the query to return the 3000+ records.

    So, I first run the query as is and retrieve all of the records and suffer the long load.

    [![SNAGHTML2899f19](images/SNAGHTML2899f19_thumb-3-3.png "SNAGHTML2899f19")](http://blog.hinshelwood.com/files/2011/06/SNAGHTML2899f19.png)  
    { .post-img }
    **Figure: Initial Query loads the entire data set**

    [![image](images/image_thumb6-1-1.png "image")](http://blog.hinshelwood.com/files/2011/06/image6.png)  
    { .post-img }
    **Figure: This produces a large data set, but check the top**

    Once the initial run is done, there is really no need to load the entire data set, just to find the two or three or sum records that have changed since the last run. I decided, just to be safe, to load the data from the last day, some ~25 records, as that is almost the balance between load and loss.

    So lets add an additional filter for data in the last month…

    [![SNAGHTML2979ebb](images/SNAGHTML2979ebb_thumb-4-4.png "SNAGHTML2979ebb")](http://blog.hinshelwood.com/files/2011/06/SNAGHTML2979ebb.png)  
    { .post-img }
    **Figure: Only get data in the last Day**

    With my recent debugging efforts I was maybe looking more closely at things than I would normally, and I noticed that the most recent changes were not being displayed.

    [![image](images/image_thumb7-2-2.png "image")](http://blog.hinshelwood.com/files/2011/06/image7.png)  
    { .post-img }
    **Figure: Where has my data gone**

    If you look closely you will see that the top two records have disappeared. What the heck!

    If I change the query to be the last 24 hours instead of the last day then the data miraculously appears.

    [![SNAGHTML29b421b](images/SNAGHTML29b421b_thumb-5-5.png "SNAGHTML29b421b")](http://blog.hinshelwood.com/files/2011/06/SNAGHTML29b421b.png)  
    { .post-img }
    **Figure: Last 24 hours works**

    In fact I just checked again and the data is now there! Oh, it has just gone midnight in Boston (where the TTP server is) and the data now appears.

    You may now ask, “What is the problem? The data will eventually get into the list?”… well, by that time it is too late. Let me explain.

    As part of the TFS Integration Platform there is something called a “High Water Mark” and in this case it is a Date. This stores the date of the last run of data so we can check which records to add and which to edit.

    ```
    Me._highWaterMarkDelta.Reload()
    '------------------------------------------------------
    Dim context As TtpContext = GetTtpContext()
    Dim raw As List(Of TtpDefectMigrationItem) = GetTtpRawData(context, viewName)
    TraceManager.TraceInformation("Located {0} raw updates since {1} in {2} seconds", raw.Count, _highWaterMarkDelta.Value, Now.Subtract(_tstart).TotalSeconds)
    Dim deltaNew = (From ri In raw Where ri.CreatedOn.CompareTo(_highWaterMarkDelta.Value) > 0).ToList
    TraceManager.TraceInformation("Located {0} deltas as NEW in {1} seconds", deltaNew.Count, Now.Subtract(_tstart).TotalSeconds)
    deltaNew = GetDeltaWorkflow(context, deltaNew)
    TraceManager.TraceInformation("Updated {0} deltas with workflow in {1} seconds", deltaNew.Count, Now.Subtract(_tstart).TotalSeconds)
    Dim changesNew As List(Of ChangeGroup) = GetChangeGroupsForAdds(deltaNew)
    TraceManager.TraceInformation("Created {0} add change groups in {1} seconds", changesNew.Count, Now.Subtract(_tstart).TotalSeconds)
    For Each c In changesNew
        c.Save()
    Next
    TraceManager.TraceInformation("Saved {0} add change groups in {1} seconds", changesNew.Count, Now.Subtract(_tstart).TotalSeconds)
    Dim deltaEdit = (From ri In raw Where ri.ModifiedOn.CompareTo(_highWaterMarkDelta.Value) > 0 And Not ri.CreatedOn.CompareTo(_highWaterMarkDelta.Value) > 0).ToList
    TraceManager.TraceInformation("Located {0} deltas as EDIT in {1} seconds", deltaEdit.Count, Now.Subtract(_tstart).TotalSeconds)
    deltaEdit = GetDeltaWorkflow(context, deltaEdit)
    TraceManager.TraceInformation("Updated {0} deltas with workflow in {1} seconds", deltaEdit.Count, Now.Subtract(_tstart).TotalSeconds)
    Dim changesEdit As List(Of ChangeGroup) = GetChangeGroupsForEdits(deltaEdit)
    TraceManager.TraceInformation("Created {0} edit change groups in {1} seconds", changesEdit.Count, Now.Subtract(_tstart).TotalSeconds)
    For Each c In changesEdit
        c.Save()
    Next
    TraceManager.TraceInformation("Saved {0} edit change groups in {1} seconds", changesEdit.Count, Now.Subtract(_tstart).TotalSeconds)
    '------------------------------------------------------
    Me._highWaterMarkDelta.Update(DateTime.Now)
    Me._changeGroupService.PromoteDeltaToPending()
    ```

    **Figure:**

    As you can see on lines 6 and 16 we do a query based on the High Water Mark to make sure that we only import data once, and that we can tell the difference between add and update.

    - If the date that the item was _created_ is after the last high water mark then it is an add

    - If the date that the item was _modified_ is after the last high water mark, while also not being in the previous category then it is an _edit_

    So, if you are using “last day” in your query then by the time the data is returned in the query then all the dates are before the high water mark. Not good as all of this data gets missed and you will not get any updates after the first run.

    The solution is to use the number of “hours” since, rather than days…
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-06-test-track-pro-and-the-case-of-the-missing-data\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-06-test-track-pro-and-the-case-of-the-missing-data
- FrontMatter:
    title: A working Test Track Pro Adapter for the TFS Integration Platform
    description: Discover a reliable Test Track Pro Adapter for the TFS Integration Platform, enabling seamless updates and efficient work item management. Learn more!
    ResourceId: W5oq_99ThZi
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3606
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-06-06
    weight: 690
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: a-working-test-track-pro-adapter-for-the-tfs-integration-platform
    aliases:
    - /resources/W5oq_99ThZi
    aliasesArchive:
    - /blog/a-working-test-track-pro-adapter-for-the-tfs-integration-platform
    - /a-working-test-track-pro-adapter-for-the-tfs-integration-platform
    - /resources/blog/a-working-test-track-pro-adapter-for-the-tfs-integration-platform
    tags:
    - Software Development
    categories:
    - Uncategorized
  BodyContent: |
    [![ALMRangersLogo_Tiny](images/ALMRangersLogo_Tiny_thumb-1-1.png "ALMRangersLogo_Tiny")](http://blog.hinshelwood.com/files/2011/06/ALMRangersLogo_Tiny.png)
    { .post-img }

    Well, it has been a long road from [misery](http://blog.hinshelwood.com/creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history/) to [hope](http://blog.hinshelwood.com/what-do-you-do-with-a-work-item-history-not-found-conflict-type-details/) with a little [disbelief](http://blog.hinshelwood.com/test-track-pro-and-the-case-of-the-missing-data/) thrown in for good measure, but I finally have a working Adapter for the TFS Integration Platform.

    ### Acknowledgements

    - [Jose Luis Soria Teruel](http://geeks.ms/blogs/jlsoria/ "http://geeks.ms/blogs/jlsoria/") – For his excellent advice and some sample code. I only used some of his code, but knowing that it can be done is the first step to achieving the goal.

    ### Updates

    - 2011-06-06 11:00 – I found a last minute bug where by the adapter thinks that a work item that was created before the high water mark but was not in scope before it was edited was converted to an “Edit” Change Action instead of a “Add”. I updated lines 89 and 102 of the source. The result is a WorkItemHistoryNotFound conflict
      ```
      [06/06/2011 10:12:14] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #3214, change 3143:2
      [06/06/2011 10:12:15] MigrationConsole.exe Information: 0 : WorkItemTracking: Unresolved conflict:
      [06/06/2011 10:12:15]   Session: adea805d-51df-489a-b2fd-9717b4af3703
      [06/06/2011 10:12:15]   Source: 6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857
      [06/06/2011 10:12:15]   Message: Cannot find applicable resolution rule.
      [06/06/2011 10:12:15]   Conflict Type: TFS WIT history not found conflict type
      [06/06/2011 10:12:15]   Conflict Type Reference Name: 1722df87-ab61-4ad0-8b41-531d3d804089
      [06/06/2011 10:12:15]   Conflict Details: <?xml version="1.0"?>
      [06/06/2011 10:12:15] <WorkItemHistoryNotFoundConflictTypeDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
      [06/06/2011 10:12:15]   <SourceWorkItemID>3143</SourceWorkItemID>
      [06/06/2011 10:12:15]   <SourceWorkItemRevision>2</SourceWorkItemRevision>
      [06/06/2011 10:12:15]   <SourceMigrationSourceId>c513f930-2602-400d-a0bf-a2a3ab434df5</SourceMigrationSourceId>
      [06/06/2011 10:12:15]   <TargetMigrationSourceId>6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857</TargetMigrationSourceId>
      [06/06/2011 10:12:15] </WorkItemHistoryNotFoundConflictTypeDetails>
      ```

    ---

    With the new code, which has gone through many refactors for the sake of last ditch efforts to figure out the bug I am now able to update TFS from TTP in an incremental fashion.

    [![image](images/image_thumb8-3-3.png "image")](http://blog.hinshelwood.com/files/2011/06/image8.png)
    { .post-img }

    **Figure: Work Items are now being updated**

    ```
    Imports Microsoft.TeamFoundation.Migration.Toolkit
    Imports System.ComponentModel.Design
    Imports System.Collections.ObjectModel
    Imports Microsoft.TeamFoundation.Migration.Toolkit.Services
    Imports Microsoft.TeamFoundation.Migration.BusinessModel
    Imports Microsoft.TeamFoundation.Migration.Toolkit.ErrorManagement
    Imports System.Globalization
    Imports System.Xml
    Imports Microsoft.TeamFoundation.Migration.Toolkit.SyncOrchestrator
    Imports System.Net
    Imports System.IO
    Imports System.ServiceModel
    Imports System.ServiceModel.Security
    Imports NorthwestCadence.TtpTipAdapter.TtpSoapSdk
    Imports NorthwestCadence.TtpTipAdapter.TtpSoapSdk.api

    Public Class TtpAnalysisProvider
        Inherits AnalysisProviderBase

        ' Fields
        Private _analysisServiceContainer As IServiceContainer
        Private _changeGroupService As ChangeGroupService
        Private _configurationService As ConfigurationService
        Private _conflictManagerService As ConflictManager
        Private _highWaterMarkDelta As HighWaterMark(Of DateTime)
        Private _highWaterMarkChangeSet As HighWaterMark(Of Integer)
        Private _supportedChangeActions As Dictionary(Of Guid, ChangeActionHandler)
        Private _supportedContentTypes As Collection(Of ContentType)
        Private _dataSourceConfig As TtpMigrationDataSource
        Private _highWaterMarkRevisions As New Dictionary(Of String, HighWaterMark(Of Integer))
        Private _tstart As DateTime = Now

        ' Properties
        Public Overrides ReadOnly Property SupportedChangeActions As Dictionary(Of Guid, ChangeActionHandler)
            Get
                Return Me._supportedChangeActions
            End Get
        End Property

        Public Overrides ReadOnly Property SupportedContentTypes As Collection(Of ContentType)
            Get
                Return Me._supportedContentTypes
            End Get
        End Property

        Private Shared Function CreateFieldRevisionDescriptionDoc(row As TtpDefectMigrationItem) As XmlDocument
            Dim columns As New XElement("Columns", New Object() {New XElement("Column", New Object() {New XAttribute("DisplayName", "Author"), New XAttribute("ReferenceName", "Author"), New XAttribute("Type", "String"), New XElement("Value", row.AuthorId)}), New XElement("Column", New Object() {New XAttribute("DisplayName", "DisplayName"), New XAttribute("ReferenceName", "DisplayName"), New XAttribute("Type", "String"), New XElement("Value", row.DisplayName)}), New XElement("Column", New Object() {New XAttribute("DisplayName", "Id"), New XAttribute("ReferenceName", "Id"), New XAttribute("Type", "String"), New XElement("Value", row.Id.ToString)})})
            Dim column As KeyValuePair(Of String, Object)
            For Each column In row.Columns
                If Not String.IsNullOrEmpty(column.Value) Then
                    columns.Add(New XElement("Column", New Object() {New XAttribute("DisplayName", column.Key), New XAttribute("ReferenceName", column.Key), New XAttribute("Type", "String"), New XElement("Value", column.Value)}))
                End If
            Next
            Dim descriptionDoc As New XElement("WorkItemChanges", New Object() {New XAttribute("Revision", row.Revision), New XAttribute("WorkItemType", row.WorItemType), New XAttribute("Author", IIf(String.IsNullOrEmpty(row.AuthorId), "", row.AuthorId)), New XAttribute("ChangeDate", row.ModifiedOn.ToString(CultureInfo.CurrentCulture)), New XAttribute("WorkItemID", row.Id.ToString), columns})
            Dim doc As New XmlDocument
            doc.LoadXml(descriptionDoc.ToString)
            Return doc
        End Function

        Private Shared Function CreateFieldColumn(migrationActionDetails As XmlDocument, displayName As String, referenceName As String, fieldType As String, value As Object, isSkippingField As Boolean) As XmlElement
            Dim c As XmlElement = migrationActionDetails.CreateElement("Column")
            c.SetAttribute("DisplayName", displayName)
            c.SetAttribute("ReferenceName", referenceName)
            c.SetAttribute("Type", fieldType)
            c.SetAttribute("IsSkippingField", isSkippingField.ToString())
            Dim v As XmlElement = migrationActionDetails.CreateElement("Value")
            'object translatedValue = TranslateFieldValue(f, fieldValue);
            Dim translatedValue As Object = value
            If translatedValue Is Nothing Then
                v.InnerText = String.Empty
            Else
                translatedValue.ToString()
            End If
            c.AppendChild(v)
            Return c
        End Function

        Public Overrides Sub GenerateDeltaTable()
            _tstart = Now
            Try
                Dim viewName As String = Me._configurationService.Filters.Item(0).Path
                TraceManager.TraceInformation("TtpWIT:AP:GenerateDeltaTable:View - {0}", New Object() {viewName})
                Me._highWaterMarkDelta.Reload()
                '------------------------------------------------------
                Dim context As TtpContext = GetTtpContext()
                Dim raw As List(Of TtpDefectMigrationItem) = GetTtpRawData(context, viewName)
                TraceManager.TraceInformation("Located {0} raw updates since {1} in {2} seconds", raw.Count, _highWaterMarkDelta.Value, Now.Subtract(_tstart).TotalSeconds)
                ' Find all of the data that needs to be added in this run
                Dim deltaNew = (From ri In raw Where ri.CreatedOn.CompareTo(_highWaterMarkDelta.Value) > 0 Or ri.Revision = 0).ToList
                ' Get any extra data and create the add changesets
                TraceManager.TraceInformation("Located {0} deltas as NEW in {1} seconds", deltaNew.Count, Now.Subtract(_tstart).TotalSeconds)
                deltaNew = GetDeltaWorkflow(context, deltaNew)
                TraceManager.TraceInformation("Updated {0} deltas with workflow in {1} seconds", deltaNew.Count, Now.Subtract(_tstart).TotalSeconds)
                Dim changesNew As List(Of ChangeGroup) = GetChangeGroupsForAdds(deltaNew)
                TraceManager.TraceInformation("Created {0} add change groups in {1} seconds", changesNew.Count, Now.Subtract(_tstart).TotalSeconds)
                ' Save the chnagesets to the backing store
                For Each c In changesNew
                    c.Save()
                Next
                TraceManager.TraceInformation("Saved {0} add change groups in {1} seconds", changesNew.Count, Now.Subtract(_tstart).TotalSeconds)
                ' Find all of the data that needs to be edited in this run
                Dim deltaEdit = (From ri In raw Where (ri.ModifiedOn.CompareTo(_highWaterMarkDelta.Value) > 0 And Not ri.CreatedOn.CompareTo(_highWaterMarkDelta.Value) > 0) Or ri.Revision > 0).ToList
                ' Get any extra data and create the edit changesets
                TraceManager.TraceInformation("Located {0} deltas as EDIT in {1} seconds", deltaEdit.Count, Now.Subtract(_tstart).TotalSeconds)
                deltaEdit = GetDeltaWorkflow(context, deltaEdit)
                TraceManager.TraceInformation("Updated {0} deltas with workflow in {1} seconds", deltaEdit.Count, Now.Subtract(_tstart).TotalSeconds)
                Dim changesEdit As List(Of ChangeGroup) = GetChangeGroupsForEdits(deltaEdit)
                TraceManager.TraceInformation("Created {0} edit change groups in {1} seconds", changesEdit.Count, Now.Subtract(_tstart).TotalSeconds)
                ' Save the chnagesets to the backing store
                For Each c In changesEdit
                    c.Save()
                Next
                TraceManager.TraceInformation("Saved {0} edit change groups in {1} seconds", changesEdit.Count, Now.Subtract(_tstart).TotalSeconds)
                '------------------------------------------------------
                ' Update the High water mark and send the changes through
                Me._highWaterMarkDelta.Update(DateTime.Now)
                Me._changeGroupService.PromoteDeltaToPending()
            Catch ex As Exception
                TraceManager.TraceException(ex)
            End Try
        End Sub

        Public Overrides Sub InitializeClient()
            TraceManager.TraceInformation("TtpWIT:AP:InitializeClient")
        End Sub

        Private Shared Function InitializeMigrationDataSource() As TtpMigrationDataSource
            Return New TtpMigrationDataSource
        End Function

        Public Overrides Sub InitializeServices(ByVal analysisService As IServiceContainer)
            TraceManager.TraceInformation("TtpWIT:AP:InitializeServices")
            If (analysisService Is Nothing) Then
                Throw New ArgumentNullException("analysisService")
            End If
            Me._analysisServiceContainer = analysisService
            Me._configurationService = DirectCast(analysisService.GetService(GetType(ConfigurationService)), ConfigurationService)
            Dim migrationSourceConfiguration As MigrationSource = Me._configurationService.MigrationSource
            _dataSourceConfig = TtpAnalysisProvider.InitializeMigrationDataSource
            Dim customSetting As CustomSetting
            Dim username As String = ""
            Dim password As String = ""
            Dim IsWorkflowIncluded As Boolean = True
            Dim hwmDateOveride As DateTime = DateTime.MinValue
            For Each customSetting In Me._configurationService.MigrationSource.CustomSettings.CustomSetting
                If customSetting.SettingKey.Equals("Username", StringComparison.OrdinalIgnoreCase) Then
                    username = customSetting.SettingValue
                End If
                If customSetting.SettingKey.Equals("Password", StringComparison.OrdinalIgnoreCase) Then
                    password = customSetting.SettingValue
                End If
                If customSetting.SettingKey.Equals("OverrideHWM", StringComparison.OrdinalIgnoreCase) Then
                    If Not DateTime.TryParse(customSetting.SettingValue, hwmDateOveride) Then
                        Throw New InvalidCastException("Date is not in the correct format: OverrideHWM")
                    End If
                End If
                If customSetting.SettingKey.Equals("IsWorkflowIncluded", StringComparison.OrdinalIgnoreCase) Then
                    If Not Boolean.TryParse(customSetting.SettingValue, IsWorkflowIncluded) Then
                        Throw New InvalidCastException("Date is not in the correct format: IsWorkflowIncluded")
                    End If
                End If
            Next

            _dataSourceConfig.Credentials = New NetworkCredential(username, password)
            _dataSourceConfig.DatabaseName = migrationSourceConfiguration.SourceIdentifier
            _dataSourceConfig.FilterName = IIf(migrationSourceConfiguration.ServerIdentifier = "[enterFiltername]", "", migrationSourceConfiguration.ServerIdentifier)
            _dataSourceConfig.Url = migrationSourceConfiguration.ServerUrl
            _dataSourceConfig.IsWorkflowIncluded = IsWorkflowIncluded


            Me._supportedContentTypes = New Collection(Of ContentType)
            Me.SupportedContentTypes.Add(WellKnownContentType.WorkItem)

            Dim handler As New TtpChangeActionHandlers(Me)

            Me._supportedChangeActions = New Dictionary(Of Guid, ChangeActionHandler)
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Add, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Edit, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Delete, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me._highWaterMarkDelta = New HighWaterMark(Of DateTime)("HWMDelta")
            Me._highWaterMarkChangeSet = New HighWaterMark(Of Integer)("LastChangeSet")
            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkDelta)
            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkChangeSet)

            If hwmDateOveride > DateTime.MinValue Then
                _highWaterMarkDelta.Update(hwmDateOveride)
            End If

            Me._changeGroupService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ChangeGroupService)), ChangeGroupService)

            Me._changeGroupService.RegisterDefaultSourceSerializer(New TtpDefectMigrationItemSerializer)
        End Sub

        Public Overrides Sub RegisterConflictTypes(ByVal conflictManager As ConflictManager)
            TraceManager.TraceInformation("TtpWIT:AP:RegisterConflictTypes")
            Me._conflictManagerService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ConflictManager)), ConflictManager)
            Me._conflictManagerService.RegisterConflictType(New GenericConflictType)
            Me._conflictManagerService.RegisterConflictType(New TtpGeneralConflictType, ConflictsSyncOrchOptions.Continue)
        End Sub

        Public Overrides Sub RegisterSupportedChangeActions(ByVal changeActionRegistrationService As ChangeActionRegistrationService)
            TraceManager.TraceInformation("TtpWIT:AP:RegisterSupportedChangeActions")
            changeActionRegistrationService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ChangeActionRegistrationService)), ChangeActionRegistrationService)
            Dim supportedChangeAction As KeyValuePair(Of Guid, ChangeActionHandler)
            For Each supportedChangeAction In Me.SupportedChangeActions
                Dim contentType As ContentType
                For Each contentType In Me.SupportedContentTypes
                    changeActionRegistrationService.RegisterChangeAction(supportedChangeAction.Key, contentType.ReferenceName, supportedChangeAction.Value)
                Next
            Next
        End Sub

        Public Overrides Sub RegisterSupportedContentTypes(contentTypeRegistrationService As Microsoft.TeamFoundation.Migration.Toolkit.Services.ContentTypeRegistrationService)

        End Sub

        Private Function GetTtpContext() As TtpContext
            TraceManager.TraceInformation("-GetTtpContext")
            Dim TtpServer As Uri = New Uri(String.Format("{0}/scripts/ttsoapcgi.exe", _dataSourceConfig.Url))
            TraceManager.TraceInformation(ChrW(9) & "-GetTtpContext Loading Ttp  {0}", New Object() {TtpServer})
            Dim context As TtpContext = Nothing
            Try
                context = TtpSoapSdkApi.CreateContext(TtpServer, _dataSourceConfig.DatabaseName, _dataSourceConfig.Credentials.UserName, _dataSourceConfig.Credentials.Password)
                TraceManager.TraceInformation("-GetTtpContext Connected to '{0}' on '{1}' in {2}", context.Project.database, TtpServer, Now.Subtract(_tstart).ToFriendly)
            Catch ex As Exception
                TraceManager.TraceException(ex)
            End Try
            Return context
        End Function

        Private Function GetTtpRawData(context As TtpContext, filter As String) As List(Of TtpDefectMigrationItem)
            Dim raw As New List(Of TtpDefectMigrationItem)
            Try
                Dim columns As List(Of CTableColumn) = context.GetColumns("Defect")
                TraceManager.TraceInformation("-GetTtpRawData '{0}' columns in {1}", columns.Count, Now.Subtract(_tstart).ToFriendly)
                TraceManager.TraceInformation("-GetTtpRawData Atempting get on all data")
                Dim rows As CRecordListSoap = context.GetRecords("Defect", filter, columns)
                TraceManager.TraceInformation("-GetTtpRawData Found {0} records in {1} seconds", rows.records.Count, Now.Subtract(_tstart).TotalSeconds)
                Dim currentRecord As Integer = 1
                Dim countRecords = rows.records.Count
                For Each record In rows.records
                    ' item has been modified since HWM & before deltra table start time
                    Try
                        Dim DefectMI As TtpDefectMigrationItem = TtpDefectMigrationItem.ConvertCDefectToTtpDefectMigrationItem(_configurationService, columns.ToArray, record)
                        '----------------
                        raw.Add(DefectMI)
                        TraceManager.TraceInformation("-GetTtpRawData  {0} of {1} - '{2}' Number '{3}' has loaded in {4} seconds", currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, Now.Subtract(_tstart).TotalSeconds)
                    Catch ex As Exception
                        TraceManager.TraceError("-GetTtpRawData  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds", currentRecord, countRecords, "unknown", "unknown", "failed", Now.Subtract(_tstart).TotalSeconds)
                        TraceManager.TraceException(ex)
                    End Try
                    currentRecord = currentRecord + 1
                Next
            Catch ex As Exception
                TraceManager.TraceException(ex)
            End Try
            Return raw
        End Function

        Private Function GetDeltaWorkflow(context As TtpContext, ByVal deltas As List(Of TtpDefectMigrationItem)) As List(Of TtpDefectMigrationItem)
            Try
                Dim currentRecord As Integer = 1
                Dim countRecords = deltas.Count
                For Each di In deltas
                    ' item has been modified since HWM & before deltra table start time
                    If _dataSourceConfig.IsWorkflowIncluded Then
                        di.ImportDefectData(context)
                        TraceManager.TraceInformation("-GetDeltaWorkflow  {0} of {1} - '{2}' Number '{3}' has {4} processing revision {5} in {6} seconds", currentRecord, countRecords, di.WorItemType, di.Id, "UPDATED", di.Revision, Now.Subtract(_tstart).TotalSeconds)
                    Else
                        TraceManager.TraceInformation("-GetDeltaWorkflow  {0} of {1} - '{2}' Number '{3}' has {4} processing revision {5} in {6} seconds", currentRecord, countRecords, di.WorItemType, di.Id, "SKIPPED", di.Revision, Now.Subtract(_tstart).TotalSeconds)
                    End If
                    currentRecord = currentRecord + 1
                Next
            Catch ex As Exception
                TraceManager.TraceException(ex)
            End Try
            Return deltas
        End Function

        Private Function GetChangeGroupsForAdds(ByVal deltas As List(Of TtpDefectMigrationItem)) As List(Of ChangeGroup)
            Dim changes As New List(Of ChangeGroup)
            Try
                Dim currentRecord As Integer = 1
                Dim countRecords = deltas.Count
                For Each delta In deltas
                    ' item has been modified since HWM & before deltra table start time
                    Try
                        ' Create and add acction group
                        delta.ResetRevision()
                        Dim changeGroup As ChangeGroup = Me._changeGroupService.CreateChangeGroupForDeltaTable(String.Format("{0}:{1}", delta.Id, delta.Revision))
                        changeGroup.Status = ChangeStatus.Delta
                        changeGroup.Owner = Nothing
                        changeGroup.Comment = String.Format(CultureInfo.CurrentCulture, "Changeset {0}", _highWaterMarkChangeSet.Value)
                        changeGroup.ChangeTimeUtc = DateTime.UtcNow
                        changeGroup.Status = ChangeStatus.Delta
                        changeGroup.ExecutionOrder = 0

                        changeGroup.CreateAction( _
                                WellKnownChangeActionId.Add, _
                                delta, _
                                delta.Id, _
                                _dataSourceConfig.DatabaseName, _
                                delta.Revision, _
                                " ", _
                                WellKnownContentType.WorkItem.ReferenceName, _
                                TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(delta) _
                                )
                        changes.Add(changeGroup)
                        _highWaterMarkChangeSet.Update((_highWaterMarkChangeSet.Value + 1))
                        ' DONE
                    Catch ex As Exception
                        TraceManager.TraceError("-GetChangeGroups  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds", currentRecord, countRecords, "unknown", "unknown", "failed", Now.Subtract(_tstart).TotalSeconds)
                        TraceManager.TraceException(ex)
                    End Try
                    currentRecord = currentRecord + 1
                Next
            Catch ex As Exception
                TraceManager.TraceException(ex)
            End Try
            Return changes
        End Function

        Private Function GetChangeGroupsForEdits(ByVal deltas As List(Of TtpDefectMigrationItem)) As List(Of ChangeGroup)
            Dim changes As New List(Of ChangeGroup)
            Try
                Dim currentRecord As Integer = 1
                Dim countRecords = deltas.Count
                For Each delta In deltas
                    ' item has been modified since HWM & before deltra table start time
                    Try
                        ' Create and add acction group
                        delta.IncrementRevision()
                        Dim changeGroup As ChangeGroup = Me._changeGroupService.CreateChangeGroupForDeltaTable(String.Format("{0}:{1}", delta.Id, delta.Revision))
                        changeGroup.Status = ChangeStatus.Delta
                        changeGroup.Owner = Nothing
                        changeGroup.Comment = String.Format(CultureInfo.CurrentCulture, "Changeset {0}", _highWaterMarkChangeSet.Value)
                        changeGroup.ChangeTimeUtc = DateTime.UtcNow
                        changeGroup.Status = ChangeStatus.Delta
                        changeGroup.ExecutionOrder = 0

                        changeGroup.CreateAction( _
                                WellKnownChangeActionId.Edit, _
                                delta, _
                                delta.Id, _
                                _dataSourceConfig.DatabaseName, _
                                delta.Revision, _
                                " ", _
                                WellKnownContentType.WorkItem.ReferenceName, _
                                TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(delta) _
                                )
                        changes.Add(changeGroup)
                        _highWaterMarkChangeSet.Update((_highWaterMarkChangeSet.Value + 1))
                        ' DONE
                    Catch ex As Exception
                        TraceManager.TraceError("-GetChangeGroups  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds", currentRecord, countRecords, "unknown", "unknown", "failed", Now.Subtract(_tstart).TotalSeconds)
                        TraceManager.TraceException(ex)
                    End Try
                    currentRecord = currentRecord + 1
                Next
            Catch ex As Exception
                TraceManager.TraceException(ex)
            End Try
            Return changes
        End Function

    End Class
    ```

    **Figure: Full source for the Analysis Provider**

    ```
    Private Function GetChangeGroupsForEdits(ByVal deltas As List(Of TtpDefectMigrationItem)) As List(Of ChangeGroup)
        Dim changes As New List(Of ChangeGroup)
        Try
            Dim currentRecord As Integer = 1
            Dim countRecords = deltas.Count
            For Each delta In deltas
                ' item has been modified since HWM & before deltra table start time
                Try
                    ' Create and add acction group
                    delta.IncrementRevision()
                    Dim changeGroup As ChangeGroup = Me._changeGroupService.CreateChangeGroupForDeltaTable(String.Format("{0}:{1}", delta.Id, delta.Revision))
                    changeGroup.Status = ChangeStatus.Delta
                    changeGroup.Owner = Nothing
                    changeGroup.Comment = String.Format(CultureInfo.CurrentCulture, "Changeset {0}", _highWaterMarkChangeSet.Value)
                    changeGroup.ChangeTimeUtc = DateTime.UtcNow
                    changeGroup.Status = ChangeStatus.Delta
                    changeGroup.ExecutionOrder = 0

                    changeGroup.CreateAction( _
                            WellKnownChangeActionId.Edit, _
                            delta, _
                            delta.Id, _
                            _dataSourceConfig.DatabaseName, _
                            delta.Revision, _
                            " ", _
                            WellKnownContentType.WorkItem.ReferenceName, _
                            TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(delta) _
                            )
                    changes.Add(changeGroup)
                    _highWaterMarkChangeSet.Update((_highWaterMarkChangeSet.Value + 1))
                    ' DONE
                Catch ex As Exception
                    TraceManager.TraceError("-GetChangeGroups  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds", currentRecord, countRecords, "unknown", "unknown", "failed", Now.Subtract(_tstart).TotalSeconds)
                    TraceManager.TraceException(ex)
                End Try
                currentRecord = currentRecord + 1
            Next
        Catch ex As Exception
            TraceManager.TraceException(ex)
        End Try
        Return changes
    End Function
    ```

    **Figure: New code to get change groups**

    I am not exactly positive what made the difference as much of my debugging efforts were hampered by the [nasty query bug in TTP](http://blog.hinshelwood.com/test-track-pro-and-the-case-of-the-missing-data/), but I am very glad that it is working. It looks like I do not need to have consecutive Revision's although as I have already implemented the code for it I am not going to change it at this stage in the game.

    It is now a mater of configuration, but I am creating a table with all of the values of the 120+ fields as well as a neat table for the workflow and inserting it into the history.

    [![image](images/image_thumb10-2-2.png "image")](http://blog.hinshelwood.com/files/2011/06/image10.png)
    { .post-img }

    **Figure: Loooong history built from TTP Data**

    This history shows all of the values for the fields at the point in time that the data was migrated.

    All in, I am quite happy with the process and will be implementing in production really soon. Still some testing to do, but all looks good so far.

    - **Can you share your experiences of creating a TFS Integration Platform Adapter?**
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-06-a-working-test-track-pro-adapter-for-the-tfs-integration-platform\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-06-a-working-test-track-pro-adapter-for-the-tfs-integration-platform
- FrontMatter:
    title: What do you do with a Work Item History Not Found Conflict Type Details
    description: Discover solutions for TFS migration conflicts in work item history. Learn how to tackle 'not found' errors and streamline your integration process.
    ResourceId: XOt3b4gzyH8
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3460
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-06-04
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: what-do-you-do-with-a-work-item-history-not-found-conflict-type-details
    aliases:
    - /resources/XOt3b4gzyH8
    aliasesArchive:
    - /blog/what-do-you-do-with-a-work-item-history-not-found-conflict-type-details
    - /what-do-you-do-with-a-work-item-history-not-found-conflict-type-details
    - /resources/blog/what-do-you-do-with-a-work-item-history-not-found-conflict-type-details
    tags:
    - Troubleshooting
    - Software Development
    categories:
    - Uncategorized
    preview: metro-binary-vb-128-link-4-4.png
  BodyContent: |
    ![](images/image_thumb-1-1.png)
    { .post-img }

    If you have no history in the system you are migrating to TFS, you may have problems when you try to do a continuous unidirectional sink due to your system not having a “revision” of the work item.

    _WARNING: I have currently no answer for this issue and I will update this post when I get a resolution.  
    _

    ### Updates

    - **2011-06-12 15:25** – All fixed :) Check out [A working Test Track Pro Adapter for the TFS Integration Platform](http://blog.hinshelwood.com/a-working-test-track-pro-adapter-for-the-tfs-integration-platform/)

    ---

    You will have seen my previous [post](http://blog.hinshelwood.com/creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history/) on the trial and tribulations with a custom Integration Platform Adapter, but Now, after the first successful run-through if I have edits that have happened since the last run and pass a history ID. Even if you take the latest version of the TFS Integration Platform (May) you will find that unless you can pass a consecutive revision number for each work item you will get a history not found error:

    ```
    [03/06/2011 14:58:50] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1225, change 3267:3
    [03/06/2011 14:58:50] MigrationConsole.exe Information: 0 : WorkItemTracking: Unresolved conflict:
    [03/06/2011 14:58:50]   Session: adea805d-51df-489a-b2fd-9717b4af3703
    [03/06/2011 14:58:50]   Source: 6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857
    [03/06/2011 14:58:50]   Message: Cannot find applicable resolution rule.
    [03/06/2011 14:58:50]   Conflict Type: TFS WIT history not found conflict type
    [03/06/2011 14:58:50]   Conflict Type Reference Name: 1722df87-ab61-4ad0-8b41-531d3d804089
    [03/06/2011 14:58:50]   Conflict Details: <?xml version="1.0"?>
    [03/06/2011 14:58:50] <WorkItemHistoryNotFoundConflictTypeDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    [03/06/2011 14:58:50]   <SourceWorkItemID>3267</SourceWorkItemID>
    [03/06/2011 14:58:50]   <SourceWorkItemRevision>3</SourceWorkItemRevision>
    [03/06/2011 14:58:50]   <SourceMigrationSourceId>c513f930-2602-400d-a0bf-a2a3ab434df5</SourceMigrationSourceId>
    [03/06/2011 14:58:50]   <TargetMigrationSourceId>6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857</TargetMigrationSourceId>
    [03/06/2011 14:58:50] </WorkItemHistoryNotFoundConflictTypeDetails>
    ```

    **Figure: TFS WIT history not found conflict type**

    I needed to simulate the revision and as you say in my previous post the idea was posited that I could have a single counter that applied the revision to all the work items. The belief was that revisions did not need to be consecutive.

    This does not seam to be the case as I always get a WorkItemHistoryNotFoundConflictTypeDetails exception when they are not consecutive. This seams to happen when you try to save revision 3 after you have saved revision 1 for a work item. I am skipping revision 2 as it never happen.

    ```
    [03/06/2011 15:48:43] MigrationConsole started...
    [03/06/2011 15:48:59] MigrationConsole.exe Information: 0 : ConfigurationChangeTracker did not detect any non-transient changes. No cached data will be deleted for session group '00000000-0000-0000-0000-000000000000'
    [03/06/2011 15:48:59] MigrationConsole.exe Information: 0 : : StartSessionGroup: Enter with sessionGroupUniqueId: 9dd3ca16-d443-454a-8351-783c85c37b83
    [03/06/2011 15:48:59] MigrationConsole.exe Information: 0 : : StartSessionGroup: Creating new SyncOrchestrator
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider ChangeGroup Label AnalysisAddin Provider a4f53905-25b6-4311-ac0c-637da6688f2b is available
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider Northwest Cadence CSV Adapter 06a2457f-ebba-4979-bc5f-0f5006b8b4e6 is available
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider TFS 2008 User Identity Lookup Add-In Provider eecc0227-8006-45f0-888d-10ab03019ad5 is available
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider File System Provider for TFS 2008 3a27f4de-8637-483c-945d-d2b20541df7c is available
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider File System Provider for TFS 2010 43b0d301-9b38-4caa-a754-61e854a71c78 is available
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider Semaphore File Analysis Addin Provider e8cec3c5-5848-4b83-904f-4324094c3f78 is available
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider TFS 2008 Migration VC Provider 2f82c6c4-bbee-42fb-b3d0-4799cabcf00e is available
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider TFS 2008 Migration WIT Provider 663a8b36-7852-4750-87fc-d189b0640fc1 is available
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider TFS 2010 Migration VC Provider febc091f-82a2-449e-aed8-133e5896c47a is available
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider TFS 2010 Migration WIT Provider 04201d39-6e47-416f-98b2-07f0013f8455 is available
    [03/06/2011 15:49:00] MigrationConsole.exe Information: 0 : : Provider TestTrackPro TIP Adapter c0e63c2b-e06c-48bb-8698-243a82bb950e is available
    [03/06/2011 15:49:01] MigrationConsole.exe Information: 0 : : CsvAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAddin
    [03/06/2011 15:49:01] MigrationConsole.exe Information: 0 : : Provider TFS 2010 Migration WIT Provider 04201d39-6e47-416f-98b2-07f0013f8455 is loaded
    [03/06/2011 15:49:01] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAddin
    [03/06/2011 15:49:01] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Cant find--
    [03/06/2011 15:49:01] MigrationConsole.exe Information: 0 : : Provider TestTrackPro TIP Adapter c0e63c2b-e06c-48bb-8698-243a82bb950e is loaded
    [03/06/2011 15:49:01] MigrationConsole.exe Information: 0 : : 2 Adapter instance(s) loaded
    [03/06/2011 15:49:01] MigrationConsole.exe Information: 0 : : 3 Add-Ins loaded
    [03/06/2011 15:49:05] MigrationConsole.exe Information: 0 : : Active Directory lookup will be used for this end point.
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAnalysisProvider
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Creating - TtpAnalysisProvider
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Returning - NorthwestCadence.TtpTipAdapter.TtpAnalysisProvider
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpWIT:AP:InitializeServices
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpWIT:AP:RegisterSupportedChangeActions
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpWIT:AP:RegisterConflictTypes
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.Services.IServerPathTranslationService
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Cant find--
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IMigrationProvider
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Creating - TtpMigrationProvider
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Returning - NorthwestCadence.TtpTipAdapter.TtpAnalysisProvider
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpWIT:AP:RegisterConflictTypes
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.ILinkProvider
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Cant find--
    [03/06/2011 15:49:09] MigrationConsole.exe Information: 0 : : Connecting to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:10] MigrationConsole.exe Information: 0 : : Connected to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:10] MigrationConsole.exe Information: 0 : : Connecting to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:10] MigrationConsole.exe Information: 0 : : Connected to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:11] MigrationConsole.exe Information: 0 : : TtpWIT:AP:InitializeClient
    [03/06/2011 15:49:11] MigrationConsole.exe Information: 0 : : Connecting to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:11] MigrationConsole.exe Information: 0 : : Connected to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:12] MigrationConsole.exe Information: 0 : : Connecting to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:12] MigrationConsole.exe Information: 0 : : Connected to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:13] MigrationConsole.exe Information: 0 : : StartSessionGroup: Starting SyncOrchestrator; now 0 running sessions
    [03/06/2011 15:49:13] MigrationConsole.exe Information: 0 : WorkItemTracking: Session worker thread [WorkItemTracking] started
    [03/06/2011 15:49:13] MigrationConsole.exe Information: 0 : WorkItemTracking: Pipeline flow from 03962300-f2ab-4ebe-8693-9a69d62523ca to 2edeeb84-fec1-4a69-8e71-61516037875d
    [03/06/2011 15:49:13] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating delta tables for the migration source 03962300-f2ab-4ebe-8693-9a69d62523ca
    [03/06/2011 15:49:13] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpWIT:AP:GenerateDeltaTable:View - NWC_Test
    [03/06/2011 15:49:13] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpContext
    [03/06/2011 15:49:13] MigrationConsole.exe Information: 0 : WorkItemTracking:     -GetTtpContext Loading Ttp  http://ttp.nwcadence.com/scripts/ttsoapcgi.exe
    [03/06/2011 15:49:17] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpContext Connected to 'NorthwestCadence.TtpTipAdapter.TtpSoapSdk.api.CDatabase' on 'http://ttp.nwcadence.com/scripts/ttsoapcgi.exe' in 4.131 seconds
    [03/06/2011 15:49:18] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData '137' columns in 5.153 seconds
    [03/06/2011 15:49:18] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData Atempting get on all data
    [03/06/2011 15:49:22] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData Found 27 records in 9.279 seconds
    [03/06/2011 15:49:22] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  1 of 27 - 'Defect' Number '3280' has loaded in 9.425 seconds
    [03/06/2011 15:49:22] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  2 of 27 - 'Defect' Number '3106' has loaded in 9.469 seconds
    [03/06/2011 15:49:22] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  3 of 27 - 'Defect' Number '3123' has loaded in 9.513 seconds
    [03/06/2011 15:49:22] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  4 of 27 - 'Support Ticket' Number '3214' has loaded in 9.556 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  5 of 27 - 'Defect' Number '3274' has loaded in 9.602 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  6 of 27 - 'Defect' Number '3277' has loaded in 9.646 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  7 of 27 - 'Defect' Number '3279' has loaded in 9.69 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  8 of 27 - 'Defect' Number '3281' has loaded in 9.735 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  9 of 27 - 'Defect' Number '3282' has loaded in 9.778 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  10 of 27 - 'Defect' Number '3283' has loaded in 9.824 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  11 of 27 - 'Defect' Number '3284' has loaded in 9.865 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  12 of 27 - 'Defect' Number '3285' has loaded in 9.955 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  13 of 27 - 'Defect' Number '3287' has loaded in 10.062 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  14 of 27 - 'Defect' Number '3196' has loaded in 10.209 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  15 of 27 - 'Defect' Number '3206' has loaded in 10.28 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  16 of 27 - 'Defect' Number '3212' has loaded in 10.326 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  17 of 27 - 'Defect' Number '3260' has loaded in 10.367 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  18 of 27 - 'Defect' Number '3263' has loaded in 10.409 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  19 of 27 - 'Defect' Number '3275' has loaded in 10.451 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  20 of 27 - 'Defect' Number '3288' has loaded in 10.49 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  21 of 27 - 'Defect' Number '3164' has loaded in 10.528 seconds
    [03/06/2011 15:49:23] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  22 of 27 - 'Defect' Number '3190' has loaded in 10.566 seconds
    [03/06/2011 15:49:27] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  23 of 27 - 'Defect' Number '3202' has loaded in 10.607 seconds
    [03/06/2011 15:49:27] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  24 of 27 - 'Defect' Number '3266' has loaded in 10.646 seconds
    [03/06/2011 15:49:27] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  25 of 27 - 'Defect' Number '3267' has loaded in 10.689 seconds
    [03/06/2011 15:49:27] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  26 of 27 - 'Defect' Number '3270' has loaded in 10.729 seconds
    [03/06/2011 15:49:27] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  27 of 27 - 'Defect' Number '3286' has loaded in 10.769 seconds
    [03/06/2011 15:49:27] MigrationConsole.exe Information: 0 : WorkItemTracking: Located 27 raw updates since 01/01/0001 00:00:00 in 10.771 seconds
    [03/06/2011 15:49:27] MigrationConsole.exe Information: 0 : WorkItemTracking: Located 27 deltas in 10.774 seconds
    [03/06/2011 15:49:27] MigrationConsole.exe Information: 0 : WorkItemTracking: SKIPPED: Updated 27 deltas with workflow in 10.775 seconds
    [03/06/2011 15:49:28] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  1 of 27 - 'Defect' Number '3280' has passed processing revision 0 as ADD in 14.707 seconds
    [03/06/2011 15:49:30] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  2 of 27 - 'Defect' Number '3106' has passed processing revision 0 as ADD in 15.717 seconds
    [03/06/2011 15:49:31] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  3 of 27 - 'Defect' Number '3123' has passed processing revision 0 as ADD in 17.38 seconds
    [03/06/2011 15:49:31] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  4 of 27 - 'Support Ticket' Number '3214' has passed processing revision 0 as ADD in 18.013 seconds
    [03/06/2011 15:49:41] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  5 of 27 - 'Defect' Number '3274' has passed processing revision 0 as ADD in 18.684 seconds
    [03/06/2011 15:49:41] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  6 of 27 - 'Defect' Number '3277' has passed processing revision 0 as ADD in 19.19 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  7 of 27 - 'Defect' Number '3279' has passed processing revision 0 as ADD in 28.997 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  8 of 27 - 'Defect' Number '3281' has passed processing revision 0 as ADD in 29.074 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  9 of 27 - 'Defect' Number '3282' has passed processing revision 0 as ADD in 29.154 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  10 of 27 - 'Defect' Number '3283' has passed processing revision 0 as ADD in 29.234 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  11 of 27 - 'Defect' Number '3284' has passed processing revision 0 as ADD in 29.312 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  12 of 27 - 'Defect' Number '3285' has passed processing revision 0 as ADD in 29.39 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  13 of 27 - 'Defect' Number '3287' has passed processing revision 0 as ADD in 29.465 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  14 of 27 - 'Defect' Number '3196' has passed processing revision 0 as ADD in 29.54 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  15 of 27 - 'Defect' Number '3206' has passed processing revision 0 as ADD in 29.614 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  16 of 27 - 'Defect' Number '3212' has passed processing revision 0 as ADD in 29.692 seconds
    [03/06/2011 15:49:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  17 of 27 - 'Defect' Number '3260' has passed processing revision 0 as ADD in 29.767 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  18 of 27 - 'Defect' Number '3263' has passed processing revision 0 as ADD in 29.909 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  19 of 27 - 'Defect' Number '3275' has passed processing revision 0 as ADD in 30.024 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  20 of 27 - 'Defect' Number '3288' has passed processing revision 0 as ADD in 30.106 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  21 of 27 - 'Defect' Number '3164' has passed processing revision 0 as ADD in 30.182 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  22 of 27 - 'Defect' Number '3190' has passed processing revision 0 as ADD in 30.257 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  23 of 27 - 'Defect' Number '3202' has passed processing revision 0 as ADD in 30.333 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  24 of 27 - 'Defect' Number '3266' has passed processing revision 0 as ADD in 30.414 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  25 of 27 - 'Defect' Number '3267' has passed processing revision 0 as ADD in 30.499 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  26 of 27 - 'Defect' Number '3270' has passed processing revision 0 as ADD in 30.574 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  27 of 27 - 'Defect' Number '3286' has passed processing revision 0 as ADD in 30.676 seconds
    [03/06/2011 15:49:43] MigrationConsole.exe Information: 0 : WorkItemTracking: Created 27 change groups in 30.721 seconds
    [03/06/2011 15:49:46] MigrationConsole.exe Information: 0 : WorkItemTracking: Saved 27 change groups in 33.711 seconds
    [03/06/2011 15:49:46] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating linking delta for the migration source 03962300-f2ab-4ebe-8693-9a69d62523ca
    [03/06/2011 15:49:46] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating delta tables for the migration source 2edeeb84-fec1-4a69-8e71-61516037875d
    [03/06/2011 15:49:46] MigrationConsole.exe Information: 0 : WorkItemTracking: Getting modified items from '2edeeb84-fec1-4a69-8e71-61516037875d!tfs01.nwcadence.comDefaultCollection (MPT2Sandbox)'
    [03/06/2011 15:49:46] MigrationConsole.exe Information: 0 : WorkItemTracking: Connecting to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:46] MigrationConsole.exe Information: 0 : WorkItemTracking: Connected to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:47] MigrationConsole.exe Information: 0 : WorkItemTracking: TFS Query: SELECT [System.Id], [System.Rev] FROM WorkItems WHERE ([System.TeamProject]=@project AND ([System.Id] = 0)) ORDER BY [System.Id]
    [03/06/2011 15:49:47] MigrationConsole.exe Information: 0 : WorkItemTracking: TFS Query: returned 0 item(s)
    [03/06/2011 15:49:47] MigrationConsole.exe Information: 0 : WorkItemTracking: Received modified items from '2edeeb84-fec1-4a69-8e71-61516037875d!tfs01.nwcadence.comDefaultCollection (MPT2Sandbox)'
    [03/06/2011 15:49:47] MigrationConsole.exe Information: 0 : WorkItemTracking: Persisted WIT HWM: HWMDeltaWit
    [03/06/2011 15:49:47] MigrationConsole.exe Information: 0 : WorkItemTracking: Updated high watermark to '06/03/2011 22:49:47'
    [03/06/2011 15:49:47] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instructions for the migration source 2edeeb84-fec1-4a69-8e71-61516037875d
    [03/06/2011 15:49:47] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1335
    [03/06/2011 15:49:49] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1336
    [03/06/2011 15:49:50] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1337
    [03/06/2011 15:49:50] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1338
    [03/06/2011 15:49:50] MigrationConsole.exe Information: 0 : WorkItemTracking: Aggregating field 'Verify Version' is not in the WIT update document of Change Action 1338'
    [03/06/2011 15:49:50] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1339
    [03/06/2011 15:49:50] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1340
    [03/06/2011 15:49:51] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1341
    [03/06/2011 15:49:51] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1342
    [03/06/2011 15:49:51] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1343
    [03/06/2011 15:49:51] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1344
    [03/06/2011 15:49:52] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1345
    [03/06/2011 15:49:52] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1346
    [03/06/2011 15:49:52] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1347
    [03/06/2011 15:49:52] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1348
    [03/06/2011 15:49:52] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1349
    [03/06/2011 15:49:53] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1350
    [03/06/2011 15:49:53] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1351
    [03/06/2011 15:49:53] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1352
    [03/06/2011 15:49:53] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1353
    [03/06/2011 15:49:54] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1354
    [03/06/2011 15:49:54] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1355
    [03/06/2011 15:49:54] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1356
    [03/06/2011 15:49:54] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1357
    [03/06/2011 15:49:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1358
    [03/06/2011 15:49:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1359
    [03/06/2011 15:49:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1360
    [03/06/2011 15:49:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1361
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: Starting basic conflict detection
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: Finishing basic conflict detection
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: Loading 50 ChangeGroup(s)
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1362
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1363
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1364
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1365
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1366
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1367
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1368
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1369
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1370
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1371
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1372
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1373
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1374
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1375
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1376
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1377
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1378
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1379
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1380
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1381
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1382
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1383
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1384
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1385
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1386
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1387
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1388
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Post-processing delta table entries from the migration source 2edeeb84-fec1-4a69-8e71-61516037875d
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Marking as 'DeltaComplete' the target-side delta table for uni-directional session
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Migrating to the migration source 2edeeb84-fec1-4a69-8e71-61516037875d
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Loading 50 ChangeGroup(s)
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1362, change 3280:0
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Connecting to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Connected to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Connecting to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:49:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Connected to 'http://tfs01.nwcadence.com:8080/tfs/defaultcollection'
    [03/06/2011 15:50:00] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1482:1
    [03/06/2011 15:50:00] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1363, change 3106:0
    [03/06/2011 15:50:02] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:02] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1483:1
    [03/06/2011 15:50:03] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1364, change 3123:0
    [03/06/2011 15:50:03] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:08] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1484:1
    [03/06/2011 15:50:08] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1365, change 3214:0
    [03/06/2011 15:50:08] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Continuing Engineering Request' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:09] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1485:1
    [03/06/2011 15:50:09] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1366, change 3274:0
    [03/06/2011 15:50:09] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:09] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1486:1
    [03/06/2011 15:50:10] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1367, change 3277:0
    [03/06/2011 15:50:10] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:10] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1487:1
    [03/06/2011 15:50:10] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1368, change 3279:0
    [03/06/2011 15:50:10] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:11] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1488:1
    [03/06/2011 15:50:11] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1369, change 3281:0
    [03/06/2011 15:50:11] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:11] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1489:1
    [03/06/2011 15:50:12] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1370, change 3282:0
    [03/06/2011 15:50:12] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:12] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1490:1
    [03/06/2011 15:50:12] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1371, change 3283:0
    [03/06/2011 15:50:12] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:13] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1491:1
    [03/06/2011 15:50:13] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1372, change 3284:0
    [03/06/2011 15:50:13] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:13] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1492:1
    [03/06/2011 15:50:14] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1373, change 3285:0
    [03/06/2011 15:50:14] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:14] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1493:1
    [03/06/2011 15:50:14] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1374, change 3287:0
    [03/06/2011 15:50:14] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:15] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1494:1
    [03/06/2011 15:50:15] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1375, change 3196:0
    [03/06/2011 15:50:15] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:15] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1495:1
    [03/06/2011 15:50:16] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1376, change 3206:0
    [03/06/2011 15:50:16] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:16] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1496:1
    [03/06/2011 15:50:16] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1377, change 3212:0
    [03/06/2011 15:50:16] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:17] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1497:1
    [03/06/2011 15:50:17] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1378, change 3260:0
    [03/06/2011 15:50:17] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:17] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1498:1
    [03/06/2011 15:50:17] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1379, change 3263:0
    [03/06/2011 15:50:18] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:18] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1499:1
    [03/06/2011 15:50:18] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1380, change 3275:0
    [03/06/2011 15:50:18] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:18] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1500:1
    [03/06/2011 15:50:19] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1381, change 3288:0
    [03/06/2011 15:50:19] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:19] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1501:1
    [03/06/2011 15:50:19] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1382, change 3164:0
    [03/06/2011 15:50:19] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:20] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1502:1
    [03/06/2011 15:50:20] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1383, change 3190:0
    [03/06/2011 15:50:20] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:20] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1503:1
    [03/06/2011 15:50:20] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1384, change 3202:0
    [03/06/2011 15:50:21] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:21] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1504:1
    [03/06/2011 15:50:21] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1385, change 3266:0
    [03/06/2011 15:50:21] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:22] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1505:1
    [03/06/2011 15:50:22] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1386, change 3267:0
    [03/06/2011 15:50:22] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:22] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1506:1
    [03/06/2011 15:50:23] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1387, change 3270:0
    [03/06/2011 15:50:23] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:23] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1507:1
    [03/06/2011 15:50:23] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1388, change 3286:0
    [03/06/2011 15:50:23] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 15:50:24] MigrationConsole.exe Information: 0 : WorkItemTracking: Completed migration, result change: 1508:1
    [03/06/2011 15:50:24] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing linking delta
    [03/06/2011 15:50:24] MigrationConsole.exe Information: 0 : WorkItemTracking: Migrating links to the migration source 2edeeb84-fec1-4a69-8e71-61516037875d
    [03/06/2011 15:50:24] MigrationConsole.exe Information: 0 : WorkItemTracking: Recorded sync point for migration source 03962300-f2ab-4ebe-8693-9a69d62523ca of session 16d45549-29a4-4b8a-b777-b4e089e1ff7a with Source High Water Mark 'HWMDelta' value of '03/06/2011 15:49:46'
    [03/06/2011 15:50:24] MigrationConsole.exe Information: 0 : WorkItemTracking:
    [03/06/2011 15:50:25] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItemTracking: Migration is done!
    [03/06/2011 15:50:25] MigrationConsole.exe Information: 0 : WorkItemTracking: Session worker thread [WorkItemTracking] completed
    [03/06/2011 15:50:49] MigrationConsole completed...
    ```

    **Figure: First Log of a full run with no errors**

    I have now updated the system so that it creates and stores a high water mark for each work item so that I can give it a consecutive revision ID. The result? No errors when runing through the first time above. You can see the “Completed migration” lines above and it results in 27 new work items.

    [![image](images/image_thumb3-2-2.png "image")](http://blog.hinshelwood.com/files/2011/06/image3.png)
    { .post-img }

    **Figure: New work items from the migration**

    However, when I run it again all looks well:

    ```
    [03/06/2011 17:20:57] MigrationConsole started...
    [03/06/2011 17:21:13] MigrationConsole.exe Information: 0 : ConfigurationChangeTracker did not detect any non-transient changes. No cached data will be deleted for session group '00000000-0000-0000-0000-000000000000'
    [03/06/2011 17:21:13] MigrationConsole.exe Information: 0 : : StartSessionGroup: Enter with sessionGroupUniqueId: fece4d93-8498-4ed4-87d2-22599336a07d
    [03/06/2011 17:21:13] MigrationConsole.exe Information: 0 : : StartSessionGroup: Creating new SyncOrchestrator
    [03/06/2011 17:21:13] MigrationConsole.exe Information: 0 : : Provider ChangeGroup Label AnalysisAddin Provider a4f53905-25b6-4311-ac0c-637da6688f2b is available
    [03/06/2011 17:21:13] MigrationConsole.exe Information: 0 : : Provider Northwest Cadence CSV Adapter 06a2457f-ebba-4979-bc5f-0f5006b8b4e6 is available
    [03/06/2011 17:21:13] MigrationConsole.exe Information: 0 : : Provider TFS 2008 User Identity Lookup Add-In Provider eecc0227-8006-45f0-888d-10ab03019ad5 is available
    [03/06/2011 17:21:13] MigrationConsole.exe Information: 0 : : Provider File System Provider for TFS 2008 3a27f4de-8637-483c-945d-d2b20541df7c is available
    [03/06/2011 17:21:13] MigrationConsole.exe Information: 0 : : Provider File System Provider for TFS 2010 43b0d301-9b38-4caa-a754-61e854a71c78 is available
    [03/06/2011 17:21:13] MigrationConsole.exe Information: 0 : : Provider Semaphore File Analysis Addin Provider e8cec3c5-5848-4b83-904f-4324094c3f78 is available
    [03/06/2011 17:21:13] MigrationConsole.exe Information: 0 : : Provider TFS 2008 Migration VC Provider 2f82c6c4-bbee-42fb-b3d0-4799cabcf00e is available
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : Provider TFS 2008 Migration WIT Provider 663a8b36-7852-4750-87fc-d189b0640fc1 is available
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : Provider TFS 2010 Migration VC Provider febc091f-82a2-449e-aed8-133e5896c47a is available
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : Provider TFS 2010 Migration WIT Provider 04201d39-6e47-416f-98b2-07f0013f8455 is available
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : Provider TestTrackPro TIP Adapter c0e63c2b-e06c-48bb-8698-243a82bb950e is available
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : CsvAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAddin
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : Provider TFS 2010 Migration WIT Provider 04201d39-6e47-416f-98b2-07f0013f8455 is loaded
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAddin
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Cant find--
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : Provider TestTrackPro TIP Adapter c0e63c2b-e06c-48bb-8698-243a82bb950e is loaded
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : 2 Adapter instance(s) loaded
    [03/06/2011 17:21:14] MigrationConsole.exe Information: 0 : : 3 Add-Ins loaded
    [03/06/2011 17:21:19] MigrationConsole.exe Information: 0 : : Active Directory lookup will be used for this end point.
    [03/06/2011 17:21:28] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAnalysisProvider
    [03/06/2011 17:21:28] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Creating - TtpAnalysisProvider
    [03/06/2011 17:21:28] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Returning - NorthwestCadence.TtpTipAdapter.TtpAnalysisProvider
    [03/06/2011 17:21:28] MigrationConsole.exe Information: 0 : : TtpWIT:AP:InitializeServices
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : TtpWIT:AP:RegisterSupportedChangeActions
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : TtpWIT:AP:RegisterConflictTypes
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.Services.IServerPathTranslationService
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Cant find--
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IMigrationProvider
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Creating - TtpMigrationProvider
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Returning - NorthwestCadence.TtpTipAdapter.TtpAnalysisProvider
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : TtpWIT:AP:RegisterConflictTypes
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.ILinkProvider
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Cant find--
    [03/06/2011 17:21:29] MigrationConsole.exe Information: 0 : : Connecting to 'http://peterf-tfs.corp.microsoft.com:8080/tfs/defaultcollection'
    [03/06/2011 17:21:34] MigrationConsole.exe Information: 0 : : Connected to 'http://peterf-tfs.corp.microsoft.com:8080/tfs/defaultcollection'
    [03/06/2011 17:21:35] MigrationConsole.exe Information: 0 : : Connecting to 'http://peterf-tfs.corp.microsoft.com:8080/tfs/defaultcollection'
    [03/06/2011 17:21:35] MigrationConsole.exe Information: 0 : : Connected to 'http://peterf-tfs.corp.microsoft.com:8080/tfs/defaultcollection'
    [03/06/2011 17:21:36] MigrationConsole.exe Information: 0 : : TtpWIT:AP:InitializeClient
    [03/06/2011 17:21:36] MigrationConsole.exe Information: 0 : : Connecting to 'http://peterf-tfs.corp.microsoft.com:8080/tfs/defaultcollection'
    [03/06/2011 17:21:36] MigrationConsole.exe Information: 0 : : Connected to 'http://peterf-tfs.corp.microsoft.com:8080/tfs/defaultcollection'
    [03/06/2011 17:21:36] MigrationConsole.exe Information: 0 : : Connecting to 'http://peterf-tfs.corp.microsoft.com:8080/tfs/defaultcollection'
    [03/06/2011 17:21:36] MigrationConsole.exe Information: 0 : : Connected to 'http://peterf-tfs.corp.microsoft.com:8080/tfs/defaultcollection'
    [03/06/2011 17:21:38] MigrationConsole.exe Information: 0 : : StartSessionGroup: Starting SyncOrchestrator; now 0 running sessions
    [03/06/2011 17:21:38] MigrationConsole.exe Information: 0 : WorkItemTracking: Session worker thread [WorkItemTracking] started
    [03/06/2011 17:21:38] MigrationConsole.exe Information: 0 : WorkItemTracking: Pipeline flow from c513f930-2602-400d-a0bf-a2a3ab434df5 to 6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857
    [03/06/2011 17:21:38] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating delta tables for the migration source c513f930-2602-400d-a0bf-a2a3ab434df5
    [03/06/2011 17:21:38] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpWIT:AP:GenerateDeltaTable:View - NWC_Test
    [03/06/2011 17:21:38] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpContext
    [03/06/2011 17:21:38] MigrationConsole.exe Information: 0 : WorkItemTracking:     -GetTtpContext Loading Ttp  http://10.191.164.95/scripts/ttsoapcgi.exe
    [03/06/2011 17:21:42] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpContext Connected to 'NorthwestCadence.TtpTipAdapter.TtpSoapSdk.api.CDatabase' on 'http://10.191.164.95/scripts/ttsoapcgi.exe' in 3.6563656 seconds
    [03/06/2011 17:21:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData '137' columns in 4.6584658 seconds
    [03/06/2011 17:21:43] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData Atempting get on all data
    [03/06/2011 17:21:46] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData Found 26 records in 8.6378637 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  1 of 26 - 'Defect' Number '3280' has loaded in 8.7438743 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  2 of 26 - 'Defect' Number '3106' has loaded in 8.7868786 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  3 of 26 - 'Defect' Number '3123' has loaded in 8.8418841 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  4 of 26 - 'Support Ticket' Number '3214' has loaded in 8.8828882 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  5 of 26 - 'Defect' Number '3274' has loaded in 8.9248924 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  6 of 26 - 'Defect' Number '3277' has loaded in 8.970897 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  7 of 26 - 'Defect' Number '3279' has loaded in 9.0129012 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  8 of 26 - 'Defect' Number '3281' has loaded in 9.0549054 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  9 of 26 - 'Defect' Number '3282' has loaded in 9.1489148 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  10 of 26 - 'Defect' Number '3283' has loaded in 9.1979197 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  11 of 26 - 'Defect' Number '3284' has loaded in 9.2389238 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  12 of 26 - 'Defect' Number '3285' has loaded in 9.2789278 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  13 of 26 - 'Defect' Number '3287' has loaded in 9.3279327 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  14 of 26 - 'Defect' Number '3196' has loaded in 9.3759375 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  15 of 26 - 'Defect' Number '3206' has loaded in 9.4179417 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  16 of 26 - 'Defect' Number '3212' has loaded in 9.4659465 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  17 of 26 - 'Defect' Number '3260' has loaded in 9.5079507 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  18 of 26 - 'Defect' Number '3263' has loaded in 9.5489548 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  19 of 26 - 'Defect' Number '3288' has loaded in 9.5929592 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  20 of 26 - 'Defect' Number '3164' has loaded in 9.6349634 seconds
    [03/06/2011 17:21:47] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  21 of 26 - 'Defect' Number '3190' has loaded in 9.6799679 seconds
    [03/06/2011 17:21:55] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  22 of 26 - 'Defect' Number '3202' has loaded in 9.7329732 seconds
    [03/06/2011 17:21:55] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  23 of 26 - 'Defect' Number '3266' has loaded in 9.7769776 seconds
    [03/06/2011 17:21:55] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  24 of 26 - 'Defect' Number '3267' has loaded in 9.8259825 seconds
    [03/06/2011 17:21:55] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  25 of 26 - 'Defect' Number '3270' has loaded in 9.8699869 seconds
    [03/06/2011 17:21:55] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetTtpRawData  26 of 26 - 'Defect' Number '3286' has loaded in 9.910991 seconds
    [03/06/2011 17:21:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Located 26 raw updates since 03/06/2011 16:03:51 in 9.9119911 seconds
    [03/06/2011 17:21:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Located 16 deltas in 9.9149914 seconds
    [03/06/2011 17:21:55] MigrationConsole.exe Information: 0 : WorkItemTracking: SKIPPED: Updated 16 deltas with workflow in 9.9159915 seconds
    [03/06/2011 17:21:56] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  1 of 16 - 'Defect' Number '3106' has passed processing revision 3 as EDIT in 18.1388137 seconds
    [03/06/2011 17:22:05] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  2 of 16 - 'Defect' Number '3123' has passed processing revision 2 as EDIT in 19.6389637 seconds
    [03/06/2011 17:22:14] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  3 of 16 - 'Defect' Number '3274' has passed processing revision 2 as EDIT in 34.6504647 seconds
    [03/06/2011 17:22:15] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  4 of 16 - 'Defect' Number '3282' has passed processing revision 2 as EDIT in 37.1907187 seconds
    [03/06/2011 17:22:15] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  5 of 16 - 'Defect' Number '3287' has passed processing revision 2 as EDIT in 37.3047301 seconds
    [03/06/2011 17:22:15] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  6 of 16 - 'Defect' Number '3196' has passed processing revision 2 as EDIT in 37.4277424 seconds
    [03/06/2011 17:22:15] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  7 of 16 - 'Defect' Number '3206' has passed processing revision 2 as EDIT in 37.5427539 seconds
    [03/06/2011 17:22:15] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  8 of 16 - 'Defect' Number '3260' has passed processing revision 2 as EDIT in 37.6557652 seconds
    [03/06/2011 17:22:15] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  9 of 16 - 'Defect' Number '3263' has passed processing revision 2 as EDIT in 37.7687765 seconds
    [03/06/2011 17:22:15] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  10 of 16 - 'Defect' Number '3288' has passed processing revision 2 as EDIT in 37.8807877 seconds
    [03/06/2011 17:22:15] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  11 of 16 - 'Defect' Number '3164' has passed processing revision 2 as EDIT in 37.9917988 seconds
    [03/06/2011 17:22:16] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  12 of 16 - 'Defect' Number '3190' has passed processing revision 2 as EDIT in 38.1448141 seconds
    [03/06/2011 17:22:16] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  13 of 16 - 'Defect' Number '3202' has passed processing revision 2 as EDIT in 38.2868283 seconds
    [03/06/2011 17:22:16] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  14 of 16 - 'Defect' Number '3266' has passed processing revision 2 as EDIT in 38.3848381 seconds
    [03/06/2011 17:22:16] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  15 of 16 - 'Defect' Number '3267' has passed processing revision 2 as EDIT in 38.4848481 seconds
    [03/06/2011 17:22:16] MigrationConsole.exe Information: 0 : WorkItemTracking: -GetChangeGroups  16 of 16 - 'Defect' Number '3270' has passed processing revision 2 as EDIT in 38.5928589 seconds
    [03/06/2011 17:22:16] MigrationConsole.exe Information: 0 : WorkItemTracking: Created 16 change groups in 38.6428639 seconds
    [03/06/2011 17:22:18] MigrationConsole.exe Information: 0 : WorkItemTracking: Saved 16 change groups in 40.8450841 seconds
    [03/06/2011 17:22:18] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating linking delta for the migration source c513f930-2602-400d-a0bf-a2a3ab434df5
    [03/06/2011 17:22:18] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating delta tables for the migration source 6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857
    [03/06/2011 17:22:18] MigrationConsole.exe Information: 0 : WorkItemTracking: Getting modified items from '6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857!peterf-tfs.corp.microsoft.comDefaultCollection (MPT2Sandbox)'
    [03/06/2011 17:22:18] MigrationConsole.exe Information: 0 : WorkItemTracking: Connecting to 'http://peterf-tfs.corp.microsoft.com:8080/tfs/defaultcollection'
    [03/06/2011 17:22:18] MigrationConsole.exe Information: 0 : WorkItemTracking: Connected to 'http://peterf-tfs.corp.microsoft.com:8080/tfs/defaultcollection'
    [03/06/2011 17:22:18] MigrationConsole.exe Information: 0 : WorkItemTracking: TFS Query: SELECT [System.Id], [System.Rev] FROM WorkItems WHERE ([System.TeamProject]=@project AND ([System.Id] = 0) AND [System.ChangedDate] > '2011-06-03 23:02:52Z') ORDER BY [System.Id]
    [03/06/2011 17:22:19] MigrationConsole.exe Information: 0 : WorkItemTracking: TFS Query: returned 0 item(s)
    [03/06/2011 17:22:19] MigrationConsole.exe Information: 0 : WorkItemTracking: Received modified items from '6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857!peterf-tfs.corp.microsoft.comDefaultCollection (MPT2Sandbox)'
    [03/06/2011 17:22:19] MigrationConsole.exe Information: 0 : WorkItemTracking: Persisted WIT HWM: HWMDeltaWit
    [03/06/2011 17:22:19] MigrationConsole.exe Information: 0 : WorkItemTracking: Updated high watermark to '06/04/2011 00:22:19'
    [03/06/2011 17:22:19] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instructions for the migration source 6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857
    [03/06/2011 17:22:19] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:20] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:20] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:20] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:20] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:20] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:20] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:20] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:20] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:20] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:21] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:21] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:21] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:21] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:21] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:21] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:21] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1475
    [03/06/2011 17:22:21] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1476
    [03/06/2011 17:22:21] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1477
    [03/06/2011 17:22:22] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1478
    [03/06/2011 17:22:22] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1479
    [03/06/2011 17:22:22] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1480
    [03/06/2011 17:22:23] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1481
    [03/06/2011 17:22:23] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1482
    [03/06/2011 17:22:23] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1483
    [03/06/2011 17:22:23] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1484
    [03/06/2011 17:22:24] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1485
    [03/06/2011 17:22:24] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1486
    [03/06/2011 17:22:24] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1487
    [03/06/2011 17:22:24] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1488
    [03/06/2011 17:22:24] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1489
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 1490
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: Starting basic conflict detection
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: Finishing basic conflict detection
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: Loading 50 ChangeGroup(s)
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:25] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1491
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1492
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1493
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1494
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1495
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1496
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1497
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1498
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1499
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1500
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1501
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1502
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1503
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1504
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #1505
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Post-processing delta table entries from the migration source 6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Marking as 'DeltaComplete' the target-side delta table for uni-directional session
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Migrating to the migration source 6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Loading 50 ChangeGroup(s)
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [03/06/2011 17:22:26] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1491, change 3106:3
    [03/06/2011 17:22:27] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1492, change 3123:2
    [03/06/2011 17:22:27] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1493, change 3274:2
    [03/06/2011 17:22:27] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1494, change 3282:2
    [03/06/2011 17:22:27] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1495, change 3287:2
    [03/06/2011 17:22:27] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1496, change 3196:2
    [03/06/2011 17:22:28] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1497, change 3206:2
    [03/06/2011 17:22:28] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1498, change 3260:2
    [03/06/2011 17:22:28] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1499, change 3263:2
    [03/06/2011 17:22:28] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1500, change 3288:2
    [03/06/2011 17:22:29] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1501, change 3190:2
    [03/06/2011 17:22:29] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1502, change 3202:2
    [03/06/2011 17:22:29] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1503, change 3266:2
    [03/06/2011 17:22:29] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1504, change 3267:2
    [03/06/2011 17:22:29] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1505, change 3270:2
    [03/06/2011 17:22:30] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing linking delta
    [03/06/2011 17:22:30] MigrationConsole.exe Information: 0 : WorkItemTracking: Migrating links to the migration source 6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857
    [03/06/2011 17:22:30] MigrationConsole.exe Warning: 0 : WorkItemTracking: Unable to record sync point for migration source c513f930-2602-400d-a0bf-a2a3ab434df5 of session adea805d-51df-489a-b2fd-9717b4af3703 because lastMigratedTargetItem.ItemId is null or empty
    [03/06/2011 17:22:30] MigrationConsole.exe Information: 0 : WorkItemTracking:
    [03/06/2011 17:22:30] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItemTracking: Migration is done!
    [03/06/2011 17:22:30] MigrationConsole.exe Information: 0 : WorkItemTracking: Session worker thread [WorkItemTracking] completed
    [03/06/2011 17:22:54] MigrationConsole completed...
    ```

    **Figure: 16 Edits are detected and processed**

    You can see that 16 edits have been detected and the revision has been incremented. The problem is that even though I get a nice “Processing ChangeGroup #1501, change 3190:2” line i never get any updates in TFS. If I look in the Actions table I find that they are all on the backlog (whatever that means).

    ```
    SELECT grp.Name,grp.Status,[ChangeActionId],[ActionId],[SourceItem],[FromPath],[Version],[ActionData],[Backlogged]
    FROM [Tfs_IntegrationPlatform].[dbo].[RUNTIME_CHANGE_ACTION] as act
    JOIN [Tfs_IntegrationPlatform].[dbo].[RUNTIME_CHANGE_GROUPS] as grp on act.ChangeGroupId = grp.Id
    Where ChangeActionId > 1490
    ```

    **Figure: SQL to see what state the Change Actions are in**

    The data that comes back all has a status of 5 and a backlog value of 1:

    [![image](images/image_thumb5-3-3.png "image")](http://blog.hinshelwood.com/files/2011/06/image5.png)
    { .post-img }

    **Figure: What this means is anyone's guess**

    This is a blocking issue from me and I have no idea how to “un-backlog” these items….
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-04-what-do-you-do-with-a-work-item-history-not-found-conflict-type-details\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-04-what-do-you-do-with-a-work-item-history-not-found-conflict-type-details
- FrontMatter:
    title: Creating a WIT Adapter for the TFS Integration Platform for a source with no history
    description: Learn how to create a WIT adapter for the TFS Integration Platform, enabling seamless integration with Test Track Pro, even without historical data.
    ResourceId: bSv-E4Y5zk0
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3408
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-06-02
    weight: 675
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history
    aliases:
    - /resources/bSv-E4Y5zk0
    aliasesArchive:
    - /blog/creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history
    - /creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history
    - /resources/blog/creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history
    tags:
    - Software Development
    - Troubleshooting
    - Pragmatic Thinking
    - System Configuration
    - Technical Mastery
    preview: metro-visual-studio-2005-128-link-4-4.png
    categories:
    - Uncategorized
  BodyContent: |
    [![image](images/image_thumb-1-1.png "image")](http://blog.hinshelwood.com/files/2011/06/image.png)I have recently been working on a TFS Integration Platform Adapter for integrating with Test Track Pro. The problem with TTP is that it does not contain any history.
    { .post-img }

    - **_Update 2011-06-03_** – Found the problem with the “index” and I can now migrate new work items again.

    ---

    Although I have had my Test Track Pro Tip Adapter working for quite some time, the customer came back and asked if they could have a rolling migration. i.e. Shipping changes on a regular basis, but only the TIP each time.

    ```
    <?xml version="1.0" encoding="utf-16"?>
    <Configuration xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                   UniqueId="ADD2D39C-C44A-4046-93AC-03A4970B2312"
                   FriendlyName="(3)Northwest Cadence Test Track Pro to TFS">
      <Providers>
        <Provider ReferenceName="c0e63c2b-e06c-48bb-8698-243a82bb950e" FriendlyName="TestTrackPro TIP Adapter" />
        <Provider ReferenceName="04201d39-6e47-416f-98b2-07f0013f8455" FriendlyName="TFS 2010 Migration WIT Provider" />
      </Providers>
      <Addins>
        <Addin ReferenceName="cdde6b6b-72fc-43b6-bbd1-b8a89a788c6f"
              FriendlyName="TFS Active Directory User Id Lookup Service Addin" />
      </Addins>
      <SessionGroup CreationTime="2011-04-14T14:59:58.72-07:00"
                    FriendlyName="(3)Northwest Cadence Test Track Pro to TFS"
                    SessionGroupGUID="FECE4D93-8498-4ED4-87D2-22599336A07D"
                    Creator="martinhinshelwood"
                    SyncIntervalInSeconds="0"
                    SyncDurationInMinutes="0">
        <MigrationSources>
          <MigrationSource InternalUniqueId="C513F930-2602-400D-A0BF-A2A3AB434DF5"
                           FriendlyName="TestTrackPro source"
                           ServerIdentifier="ttpDatabase@http://ttpserver.domain.com:80"
                           ServerUrl="http://10.191.164.95:80"
                           SourceIdentifier="ttpDatabase"
                           ProviderReferenceName="c0e63c2b-e06c-48bb-8698-243a82bb950e">
            <Settings>
              <Addins />
              <UserIdentityLookup>

                <LookupAddin Precedence="1" ReferenceName="cdde6b6b-72fc-43b6-bbd1-b8a89a788c6f" />

              </UserIdentityLookup>

              <DefaultUserIdProperty UserIdPropertyName="DisplayName" />
            </Settings>
            <CustomSettings>
              <CustomSetting SettingKey="Username" SettingValue="mhinshelwood" />
              <CustomSetting SettingKey="Password" SettingValue="password" />
              <!--<CustomSetting SettingKey="OverrideHWM" SettingValue="2011-05-5T14:59:58.72-07:00" />-->
            </CustomSettings>
            <StoredCredential />
          </MigrationSource>
          <MigrationSource InternalUniqueId="6E3BDF70-F1AE-4CD5-8EE4-133C8AEE0857"
                           FriendlyName="tfs01.nwcadence.com (WIT)"
                           ServerIdentifier="346dd524-18b0-4eda-ba05-0f4d6b14e076"
                           ServerUrl="http://tfs01.nwcadence.com:8080/tfs/defaultcollection"
                           SourceIdentifier="ttpImportTest"
                           ProviderReferenceName="04201d39-6e47-416f-98b2-07f0013f8455">
            <Settings>
              <Addins />
              <UserIdentityLookup>

                <LookupAddin Precedence="1" ReferenceName="cdde6b6b-72fc-43b6-bbd1-b8a89a788c6f" />

              </UserIdentityLookup>

              <DefaultUserIdProperty UserIdPropertyName="DisplayName" />
            </Settings>
            <CustomSettings>
              <CustomSetting SettingKey="EnableBypassRuleDataSubmission" SettingValue="True" />
              <CustomSetting SettingKey="DisableAreaPathAutoCreation" SettingValue="False" />
              <CustomSetting SettingKey="DisableIterationPathAutoCreation" SettingValue="False" />
            </CustomSettings>
            <StoredCredential />
          </MigrationSource>
        </MigrationSources>
        <Sessions>
          <Session CreationTime="2011-04-14T14:59:58.703-07:00"
                   SessionUniqueId="adea805d-51df-489a-b2fd-9717b4af3703"
                   FriendlyName="Work Item Tracking Session"
                   LeftMigrationSourceUniqueId="C513F930-2602-400D-A0BF-A2A3AB434DF5"
                   RightMigrationSourceUniqueId="6E3BDF70-F1AE-4CD5-8EE4-133C8AEE0857"
                   SessionType="WorkItemTracking">
            <EventSinks />
            <CustomSettings>
              <SettingXml>
                <WITSessionCustomSetting>
                  <WorkItemTypes>
                    <WorkItemType LeftWorkItemTypeName="Defect" RightWorkItemTypeName="Bug" fieldMap="Defect2BugFieldMap" />
                  </WorkItemTypes>
                  <FieldMaps>
                    <FieldMap name="Defect2BugFieldMap">
                      <MappedFields>
                        <MappedField LeftName="Summary" RightName="System.Title" MapFromSide="Left" valueMap="" />
                        <MappedField LeftName="Description" RightName="System.Description" MapFromSide="Left" valueMap="" />
                        <MappedField LeftName="Severity" RightName="Microsoft.VSTS.Common.Severity" MapFromSide="Left" valueMap="SeverityMapTTP2TFS" />
                        <MappedField LeftName="Status" RightName="System.State" MapFromSide="Left" valueMap="StatusMapTTP2TFS" />
                        <MappedField LeftName="Reason" RightName="System.Reason" MapFromSide="Left" valueMap="ReasonMapTTP2TFS" />
                        <MappedField LeftName="Priority" RightName="Microsoft.VSTS.Common.Priority" MapFromSide="Left" valueMap="PriorityMapTTP2TFS" />
                        <MappedField LeftName="Steps to Reproduce" RightName="Microsoft.VSTS.TCM.ReproSteps" MapFromSide="Left" />
                        <MappedField LeftName="History" RightName="System.History" MapFromSide="Left" />
                        <MappedField LeftName="Assigned To User" RightName="System.AssignedTo" MapFromSide="Left" valueMap="UserMapTTP2TFS" />
                        <MappedField LeftName="Date Created" RightName="Microsoft.VSTS.Common.CreatedDate" MapFromSide="Left"  />
                        <MappedField LeftName="Found by" RightName="Microsoft.VSTS.Common.HowFoundCategory" MapFromSide="Left"  valueMap="HowFoundCategoryTFS" />
                        <!-- WORKAROUND using unused field: Manual Testing -->
                        <!--
                        <MappedField LeftName="@@MISSINGFIELD@@" RightName="Microsoft.VSTS.Common.Triage" MapFromSide="Left" valueMap="TfsTriageMapping" />
                        <MappedField LeftName="@@MISSINGFIELD@@" RightName="Microsoft.VSTS.Common.Regression" MapFromSide="Left" valueMap="TfsRegressionMapping" />
                        <MappedField LeftName="@@MISSINGFIELD@@" RightName="Microsoft.VSTS.Build.Changelist" MapFromSide="Left" valueMap="TfsChangelistMapping" />
                        -->
                        <MappedField LeftName="Date Modified" RightName="System.ChangedDate" MapFromSide="Left" />
                        <!--<MappedField LeftName="Modified By" RightName="System.ChangedBy" MapFromSide="Left" valueMap="StatusMapTTP2TFS" /-->
                        <MappedField LeftName="Verify Version" RightName="Microsoft.VSTS.Build.FoundIn" MapFromSide="Left" valueMap="VerifyVersionMapTTP2TFS" />
                      </MappedFields>
                      <AggregatedFields>
                        <FieldsAggregationGroup   MapFromSide="Left" TargetFieldName="System.AreaPath" Format="TestTrackProImport{0}{1}">
                          <SourceField Index="0" SourceFieldName="Component" valueMap="ComponentMapTTP2TFS" />
                          <SourceField Index="1" SourceFieldName="Functional Area" valueMap="FunctionalAreaMapTTP2TFS" />
                        </FieldsAggregationGroup>
                        <FieldsAggregationGroup   MapFromSide="Left" TargetFieldName="System.IterationPath" Format="TestTrackProImport{0}">
                          <SourceField Index="0" SourceFieldName="Version Found" valueMap="VerifyVersionMapTTP2TFS"/>
                        </FieldsAggregationGroup>
                      </AggregatedFields>
                      <UserIdentityFields>
                        <LeftUserIdentityFields />
                        <RightUserIdentityFields>
                          <UserIdField FieldReferenceName="System.AssignedTo" UserIdPropertyName="DisplayName" />
                        </RightUserIdentityFields>
                      </UserIdentityFields>
                    </FieldMap>
                  </FieldMaps>
                  <ValueMaps>
                    <ValueMap name="HowFoundCategoryTFS">
                      <Value LeftValue="*" RightValue="Manual Testing">
                      </Value>
                    </ValueMap>
                    <ValueMap name="SeverityMapTTP2TFS">
                      <Value LeftValue="" RightValue="2" />
                      <Value LeftValue="3-Usability" RightValue="3" />
                      <Value LeftValue="4-Cosmetic" RightValue="4" />
                      <Value LeftValue="2-Feature not functioning" RightValue="2" />
                      <Value LeftValue="1-Critical, Crash" RightValue="1" />
                      <Value LeftValue="5-Security" RightValue="4" />
                    </ValueMap>
                     <ValueMap name="TfsChangelistMapping">
                      <Value LeftValue="" RightValue="Unknown" />
                      <Value LeftValue="*" RightValue="*" />
                    </ValueMap>
                    <ValueMap name="TfsTriageMapping">
                      <!-- Approved Rejected Submitted -->
                      <Value LeftValue="" RightValue="Approved">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="Submitted" />
                      </Value>
                      <Value LeftValue="" RightValue="Rejected">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="Verify Failed" />
                      </Value>
                    </ValueMap>
                    <ValueMap name="TfsRegressionMapping">
                      <!-- No Yes -->
                      <Value LeftValue="" RightValue="Yes">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="New (Re-Opened)" />
                      </Value>
                      <Value LeftValue="" RightValue="Yes">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="Verify Failed" />
                      </Value>
                    </ValueMap>
                    <ValueMap name="StatusMapTTP2TFS">
                      <!-- STRIP ALL AFTER THE "," -->
                      <Value LeftValue="" RightValue="Proposed" />
                      <Value LeftValue="*" RightValue="Proposed" />
                      <Value LeftValue="Verified" RightValue="Validated" />
                      <Value LeftValue="Closed" RightValue="Closed" />
                      <Value LeftValue="Fixed" RightValue="Resolved" />
                      <Value LeftValue="Release to Testing" RightValue="Resolved" />
                      <Value LeftValue="Verify Failed" RightValue="Resolved" />
                      <Value LeftValue="New (Re-Opened)" RightValue="Proposed" />
                      <Value LeftValue="Deferred" RightValue="Resolved" />
                    </ValueMap>
                    <ValueMap name="ReasonMapTTP2TFS">
                      <Value LeftValue="" RightValue="New">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="New (Re-Opened)" />
                      </Value>
                      <Value LeftValue="" RightValue="Resolved">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="Release to Testing" />
                      </Value>
                      <Value LeftValue="" RightValue="Verification Rejected">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="Verify Failed" />
                      </Value>
                      <Value LeftValue="" RightValue="Resolved">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="Fixed" />
                      </Value>
                      <Value LeftValue="" RightValue="Verified">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="Validated" />
                      </Value>
                      <Value LeftValue="" RightValue="Cut">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="Deferred" />
                      </Value>
                      <Value LeftValue="Duplicate" RightValue="Duplicate" />
                      <Value LeftValue="Not a bug" RightValue="Not a bug" />
                      <Value LeftValue="Not reproducible" RightValue="Not reproducible" />
                      <Value LeftValue="Deprecated Functionality" RightValue="Deprecated Functionality" />
                      <Value LeftValue="Functions as Designed" RightValue="Functions as Designed" />
                    </ValueMap>
                    <ValueMap name="ComponentMapTTP2TFS">
                      <Value LeftValue="*" RightValue="*" />
                      <Value LeftValue="" RightValue="None" />

                    </ValueMap>
                    <ValueMap name="FunctionalAreaMapTTP2TFS">
                      <Value LeftValue="*" RightValue="*" />
                      <Value LeftValue="" RightValue="None" />

                    </ValueMap>
                    <ValueMap name="VerifyVersionMapTTP2TFS">
                      <Value LeftValue="*" RightValue="*" />
                      <Value LeftValue="" RightValue="None" />

                    </ValueMap>
                    <ValueMap name="PriorityMapTTP2TFS">
                      <Value LeftValue="*" RightValue="2" />
                      <Value LeftValue="4-Low" RightValue="3" />
                      <Value LeftValue="3-Medium" RightValue="3" />
                      <Value LeftValue="2-High" RightValue="2" />
                      <Value LeftValue="1-Must Be Fixed" RightValue="1" />
                      <Value LeftValue="Highest (QA)" RightValue="0" />
                    </ValueMap>
                    <ValueMap name="UserMapTTP2TFS">
                      <Value LeftValue="*" RightValue="*" />
                      <Value LeftValue="" RightValue="Triage">
                        <When ConditionalSrcFieldName="Status" ConditionalSrcFieldValue="New" />
                      </Value>

                    </ValueMap>

                    <ValueMap name="TypeofCRMapTTP2TFS">
                      <Value LeftValue="*" RightValue="*" />
                    </ValueMap>

                  </ValueMaps>
                </WITSessionCustomSetting>
              </SettingXml>
              <SettingXmlSchema />
            </CustomSettings>
            <Filters>
              <FilterPair Neglect="false">
                <FilterItem MigrationSourceUniqueId="C513F930-2602-400D-A0BF-A2A3AB434DF5" FilterString="NWC_Test" />
                <FilterItem MigrationSourceUniqueId="6E3BDF70-F1AE-4CD5-8EE4-133C8AEE0857" FilterString="[System.Id] = 0" />
              </FilterPair>
            </Filters>
          </Session>
        </Sessions>
        <Linking>
          <CustomSettings />
          <LinkTypeMappings />
        </Linking>
        <WorkFlowType Frequency="ContinuousManual" DirectionOfFlow="Unidirectional" SyncContext="Disabled" />
        <CustomSettings />
        <UserIdentityMappings EnableValidation="false">
          <UserIdentityLookupAddins />
        </UserIdentityMappings>
        <ErrorManagement>
          <ErrorRouters />
          <ReportingSettings />
        </ErrorManagement>
      </SessionGroup>
    </Configuration>
    ```

    The problem I ran into was that as all of the example Adapters are TIP adapters they do not take into account history at all. Here is the code for my first run through that was heavily based on [Robert MacLean’s](http://www.sadev.co.za) code from [How to create an adapter for the TFS Integration Platform](http://www.sadev.co.za/content/how-create-adapter-tfs-integration-platform-series-index "http://www.sadev.co.za/content/how-create-adapter-tfs-integration-platform-series-index"):

    ```
    Imports Microsoft.TeamFoundation.Migration.Toolkit
    Imports System.ComponentModel.Design
    Imports System.Collections.ObjectModel
    Imports Microsoft.TeamFoundation.Migration.Toolkit.Services
    Imports Microsoft.TeamFoundation.Migration.BusinessModel
    Imports Microsoft.TeamFoundation.Migration.Toolkit.ErrorManagement
    Imports System.Globalization
    Imports System.Xml
    Imports Microsoft.TeamFoundation.Migration.Toolkit.SyncOrchestrator
    Imports System.Net
    Imports System.IO
    Imports System.ServiceModel
    Imports System.ServiceModel.Security
    Imports NorthwestCadence.TtpTipAdapter.TtpSoapSdk
    Imports NorthwestCadence.TtpTipAdapter.TtpSoapSdk.api

    Public Class TtpAnalysisProvider
        Inherits AnalysisProviderBase

        ' Fields
        Private _analysisServiceContainer As IServiceContainer
        Private _changeGroupService As ChangeGroupService
        Private _configurationService As ConfigurationService
        Private _conflictManagerService As ConflictManager
        Private _highWaterMarkDelta As HighWaterMark(Of DateTime)
        Private _highWaterMarkChangeSet As HighWaterMark(Of Integer)
        Private _supportedChangeActions As Dictionary(Of Guid, ChangeActionHandler)
        Private _supportedContentTypes As Collection(Of ContentType)
        Private _dataSourceConfig As TtpMigrationDataSource

        ' Properties
        Public Overrides ReadOnly Property SupportedChangeActions As Dictionary(Of Guid, ChangeActionHandler)
            Get
                Return Me._supportedChangeActions
            End Get
        End Property

        Public Overrides ReadOnly Property SupportedContentTypes As Collection(Of ContentType)
            Get
                Return Me._supportedContentTypes
            End Get
        End Property

        ' Methods
        Private Function CreateChangeGroup(ByVal changeset As Integer, ByVal executionOrder As Long) As ChangeGroup
            Dim group As ChangeGroup = Me._changeGroupService.CreateChangeGroupForDeltaTable(changeset.ToString(CultureInfo.CurrentCulture))
            group.Owner = Nothing
            group.Comment = String.Format(CultureInfo.CurrentCulture, "Changeset {0}", New Object() {changeset})
            group.ChangeTimeUtc = DateTime.UtcNow
            group.Status = ChangeStatus.Delta
            group.ExecutionOrder = executionOrder
            Return group
        End Function

        Private Shared Function CreateFieldRevisionDescriptionDoc(row As TtpDefectMigrationItem) As XmlDocument
            Dim columns As New XElement("Columns", New Object() {New XElement("Column", New Object() {New XAttribute("DisplayName", "Author"), New XAttribute("ReferenceName", "Author"), New XAttribute("Type", "String"), New XElement("Value", row.AuthorId)}), New XElement("Column", New Object() {New XAttribute("DisplayName", "DisplayName"), New XAttribute("ReferenceName", "DisplayName"), New XAttribute("Type", "String"), New XElement("Value", row.DisplayName)}), New XElement("Column", New Object() {New XAttribute("DisplayName", "Id"), New XAttribute("ReferenceName", "Id"), New XAttribute("Type", "String"), New XElement("Value", row.Id.ToString)})})
            Dim column As KeyValuePair(Of String, Object)
            For Each column In row.Columns
                If Not String.IsNullOrEmpty(column.Value) Then
                    columns.Add(New XElement("Column", New Object() {New XAttribute("DisplayName", column.Key), New XAttribute("ReferenceName", column.Key), New XAttribute("Type", "String"), New XElement("Value", column.Value)}))
                End If
            Next
            Dim descriptionDoc As New XElement("WorkItemChanges", New Object() {New XAttribute("Revision", "0"), New XAttribute("WorkItemType", row.WorItemType), New XAttribute("Author", IIf(String.IsNullOrEmpty(row.AuthorId), "", row.AuthorId)), New XAttribute("ChangeDate", row.ModifiedOn.ToString(CultureInfo.CurrentCulture)), New XAttribute("WorkItemID", row.Id.ToString), columns})
            Dim doc As New XmlDocument
            doc.LoadXml(descriptionDoc.ToString)
            Return doc
        End Function

        Public Overrides Sub GenerateDeltaTable()
            Dim viewName As String = Me._configurationService.Filters.Item(0).Path
            TraceManager.TraceInformation("TtpWIT:AP:GenerateDeltaTable:View - {0}", New Object() {viewName})
            Me._highWaterMarkDelta.Reload()
            Me.GetTtpUpdates(viewName)
            Me._highWaterMarkDelta.Update(DateTime.Now)
            Me._changeGroupService.PromoteDeltaToPending()
        End Sub

        Public Overrides Sub InitializeClient()
            TraceManager.TraceInformation("TtpWIT:AP:InitializeClient")
        End Sub

        Private Shared Function InitializeMigrationDataSource() As TtpMigrationDataSource
            Return New TtpMigrationDataSource
        End Function

        Public Overrides Sub InitializeServices(ByVal analysisService As IServiceContainer)
            TraceManager.TraceInformation("TtpWIT:AP:InitializeServices")
            If (analysisService Is Nothing) Then
                Throw New ArgumentNullException("analysisService")
            End If
            Me._analysisServiceContainer = analysisService
            Me._configurationService = DirectCast(analysisService.GetService(GetType(ConfigurationService)), ConfigurationService)
            Dim migrationSourceConfiguration As MigrationSource = Me._configurationService.MigrationSource
            _dataSourceConfig = TtpAnalysisProvider.InitializeMigrationDataSource
            Dim customSetting As CustomSetting
            Dim username As String = ""
            Dim password As String = ""
            For Each customSetting In Me._configurationService.MigrationSource.CustomSettings.CustomSetting
                If customSetting.SettingKey.Equals("Username", StringComparison.OrdinalIgnoreCase) Then
                    username = customSetting.SettingValue
                End If
                If customSetting.SettingKey.Equals("Password", StringComparison.OrdinalIgnoreCase) Then
                    password = customSetting.SettingValue
                End If
            Next

            _dataSourceConfig.Credentials = New NetworkCredential(username, password)
            _dataSourceConfig.DatabaseName = migrationSourceConfiguration.SourceIdentifier
            _dataSourceConfig.FilterName = IIf(migrationSourceConfiguration.ServerIdentifier = "[enterFiltername]", "", migrationSourceConfiguration.ServerIdentifier)
            _dataSourceConfig.Url = migrationSourceConfiguration.ServerUrl

            Me._supportedContentTypes = New Collection(Of ContentType)
            Me.SupportedContentTypes.Add(WellKnownContentType.WorkItem)

            Dim handler As New TtpChangeActionHandlers(Me)

            Me._supportedChangeActions = New Dictionary(Of Guid, ChangeActionHandler)
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Add, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Edit, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Delete, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me._highWaterMarkDelta = New HighWaterMark(Of DateTime)("HWMDelta")
            Me._highWaterMarkChangeSet = New HighWaterMark(Of Integer)("LastChangeSet")

            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkDelta)
            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkChangeSet)

            Me._changeGroupService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ChangeGroupService)), ChangeGroupService)

            Me._changeGroupService.RegisterDefaultSourceSerializer(New TtpDefectMigrationItemSerializer)
        End Sub

        Public Overrides Sub RegisterConflictTypes(ByVal conflictManager As ConflictManager)
            TraceManager.TraceInformation("TtpWIT:AP:RegisterConflictTypes")
            Me._conflictManagerService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ConflictManager)), ConflictManager)
            Me._conflictManagerService.RegisterConflictType(New GenericConflictType)
            Me._conflictManagerService.RegisterConflictType(New TtpGeneralConflictType, ConflictsSyncOrchOptions.Continue)
        End Sub

        Public Overrides Sub RegisterSupportedChangeActions(ByVal changeActionRegistrationService As ChangeActionRegistrationService)
            TraceManager.TraceInformation("TtpWIT:AP:RegisterSupportedChangeActions")
            changeActionRegistrationService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ChangeActionRegistrationService)), ChangeActionRegistrationService)
            Dim supportedChangeAction As KeyValuePair(Of Guid, ChangeActionHandler)
            For Each supportedChangeAction In Me.SupportedChangeActions
                Dim contentType As ContentType
                For Each contentType In Me.SupportedContentTypes
                    changeActionRegistrationService.RegisterChangeAction(supportedChangeAction.Key, contentType.ReferenceName, supportedChangeAction.Value)
                Next
            Next
        End Sub

        Public Overrides Sub RegisterSupportedContentTypes(contentTypeRegistrationService As Microsoft.TeamFoundation.Migration.Toolkit.Services.ContentTypeRegistrationService)

        End Sub

        Private Sub GetTtpUpdates(ByVal viewName As String)
            TraceManager.TraceInformation("TtpWIT:AP:GetTtpDefectUpdates")
            Dim TtpServer As Uri = New Uri(String.Format("{0}/scripts/ttsoapcgi.exe", _dataSourceConfig.Url))

            TraceManager.TraceInformation(ChrW(9) & "TtpWIT:AP:Loading Ttp  {0}", New Object() {TtpServer})
            Try

                Dim _ttpsoapclient = New TtpSoapSdkApi(TtpServer)
                Dim _sourceProject As CProject = Nothing
                TraceManager.TraceInformation("TTP:AP:GetTtpDefectsAsDeltaFromSource:GetProjectList")
                Dim projects() As CProject = _ttpsoapclient.getProjectList(_dataSourceConfig.Credentials.UserName, _dataSourceConfig.Credentials.Password)
                TraceManager.TraceInformation("TTP:AP:GetTtpDefectsAsDeltaFromSource:FindSourceProject")
                For Each project In projects
                    If project.database.name.ToLower = _dataSourceConfig.DatabaseName.ToLower Then
                        _sourceProject = project
                        TraceManager.TraceInformation("TTP:AP:GetTtpDefectsAsDeltaFromSource:SourceProjectFound")
                        Exit For
                    End If
                Next

                If _sourceProject Is Nothing Then
                    TraceManager.TraceInformation("TTP:AP:GetTtpDefectsAsDeltaFromSource:Project Not Found")
                    Exit Sub
                End If

                TraceManager.TraceInformation("TTP:AP:InitializeClient:GetSessionId")
                Dim _lSession = _ttpsoapclient.ProjectLogon(_sourceProject, _dataSourceConfig.Credentials.UserName, _dataSourceConfig.Credentials.Password)
                TraceManager.TraceInformation("TTP:AP:InitializeClient:Logged onto {0}", _sourceProject.database.name)
                Dim _deltaTableStartTime As DateTime = DateTime.Now

                ' Dim atc() As CTableColumn = {New CTableColumn With {.name = "Number"}, New CTableColumn With {.name = "Date Modified"}}
                Dim atc() As CTableColumn = _ttpsoapclient.getColumnsForTable(_lSession, "Defect")
                Dim tstart As DateTime = Now
                TraceManager.TraceInformation("TTP:AP:InitializeClient:Atempting get on all data")
                Dim rows As CRecordListSoap = _ttpsoapclient.getRecordListForTable(_lSession, "Defect", viewName, atc)
                TraceManager.TraceInformation("TTP:AP:InitializeClient:Found {0} records in {1} seconds", rows.records.Count, Now.Subtract(tstart).TotalSeconds)
                Dim currentRecord As Integer = 1
                Dim countRecords = rows.records.Count
                For Each record In rows.records
                    ' item has been modified since HWM & before deltra table start time
                    Try
                        Dim DefectMI As TtpDefectMigrationItem = TtpDefectMigrationItem.ConvertCDefectToTtpDefectMigrationItem(atc, record)
                        ' Dim Modified As DateTime = DateTime.Parse(record.row(1).value)

                        If DefectMI.ModifiedOn.CompareTo(_highWaterMarkDelta.Value) > 0 And DefectMI.ModifiedOn.CompareTo(_deltaTableStartTime) Then
                            ' Atempt to import additional data from objects
                            DefectMI.ImportDefectData(_ttpsoapclient, _lSession)

                            ' Create and add acction group
                            Dim actionGuid As Guid = WellKnownChangeActionId.Add
                            If ((Not _highWaterMarkDelta.Value = DateTime.MinValue) AndAlso (DefectMI.ModifiedOn.CompareTo(_highWaterMarkDelta.Value) > 0)) Then
                                actionGuid = WellKnownChangeActionId.Edit
                            Else
                                actionGuid = WellKnownChangeActionId.Add
                            End If
                            Dim changeGroup As ChangeGroup = Me.CreateChangeGroup(_highWaterMarkChangeSet.Value, 0)
                            changeGroup.CreateAction(actionGuid, DefectMI, String.Empty, _dataSourceConfig.DatabaseName, String.Empty, String.Empty, WellKnownContentType.WorkItem.ReferenceName, TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(delta))
                            changeGroup.Save()
                            _highWaterMarkChangeSet.Update((_highWaterMarkChangeSet.Value + 1))
                            ' DONE
                            TraceManager.TraceInformation("  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds", currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, "passed", Now.Subtract(tstart).TotalSeconds)
                        Else
                            TraceManager.TraceInformation("  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds", currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, "skipped", Now.Subtract(tstart).TotalSeconds)
                        End If

                    Catch ex As Exception
                        TraceManager.TraceError("  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds", currentRecord, countRecords, "unknown", "unknown", "failed", Now.Subtract(tstart).TotalSeconds)
                        TraceManager.TraceException(ex)
                    End Try
                    currentRecord = currentRecord + 1

                Next

            Catch ex As Exception
                TraceManager.TraceException(ex)
            End Try

        End Sub

    End Class
    ```

    **Figure: Full source for the Analysis Provider v1**

    ```
    Dim changeGroup As ChangeGroup = Me.CreateChangeGroup(_highWaterMarkChangeSet.Value, 0)
    changeGroup.CreateAction(actionGuid, DefectMI, String.Empty, _dataSourceConfig.DatabaseName, String.Empty, String.Empty, WellKnownContentType.WorkItem.ReferenceName, TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(delta))
    changeGroup.Save()
    ```

    **Figure: Snipit of the Analysis Provider v1**

    The problem that I have encountered is that although it adds new Work Items that come into scope, it does not do any updates to those work item. Now, I can understand this if there had been any updates on the TFS side, but I can guarantee that there has not. So I sought help:

    > - **Action** == **Edit** when pushing changes and == **Add** for a new one is correct.
    > - **Version** … without debugging the consensus is that the lack of version information is causing the TIP type migration, rather than auctioning the history (edits).
    > - **Version Merge** property … for VC only.
    > - Ideas for Version property:
    >   - **Option 1** - Create fake version numbers for the TTP side and using a single incrementing integer watermark across all of the TTP items.
    >   - **Option 1** - Create fake version numbers for the TTP side and just copy the ChangeAction’s ChangeActionId value for this.
    >
    > \-**_Willy-Peter Schaub_**, VSALM Ranger Mother

    So I changed my code so that when the create action occurred it passed in a version (work item revision) number. As my source system does not have revisions, and does not even keep track of edits I just have to make up the number as long as it is greater than the one before. I went for **Option 1** provided by Willy.

    ```
    Imports Microsoft.TeamFoundation.Migration.Toolkit
    Imports System.ComponentModel.Design
    Imports System.Collections.ObjectModel
    Imports Microsoft.TeamFoundation.Migration.Toolkit.Services
    Imports Microsoft.TeamFoundation.Migration.BusinessModel
    Imports Microsoft.TeamFoundation.Migration.Toolkit.ErrorManagement
    Imports System.Globalization
    Imports System.Xml
    Imports Microsoft.TeamFoundation.Migration.Toolkit.SyncOrchestrator
    Imports System.Net
    Imports System.IO
    Imports System.ServiceModel
    Imports System.ServiceModel.Security
    Imports NorthwestCadence.TtpTipAdapter.TtpSoapSdk
    Imports NorthwestCadence.TtpTipAdapter.TtpSoapSdk.api

    Public Class TtpAnalysisProvider
        Inherits AnalysisProviderBase

        ' Fields
        Private _analysisServiceContainer As IServiceContainer
        Private _changeGroupService As ChangeGroupService
        Private _configurationService As ConfigurationService
        Private _conflictManagerService As ConflictManager
        Private _highWaterMarkDelta As HighWaterMark(Of DateTime)
        Private _highWaterMarkChangeSet As HighWaterMark(Of Integer)
        Private _highWaterMarkRevision As HighWaterMark(Of Integer)
        Private _supportedChangeActions As Dictionary(Of Guid, ChangeActionHandler)
        Private _supportedContentTypes As Collection(Of ContentType)
        Private _dataSourceConfig As TtpMigrationDataSource

        ' Properties
        Public Overrides ReadOnly Property SupportedChangeActions As Dictionary(Of Guid, ChangeActionHandler)
            Get
                Return Me._supportedChangeActions
            End Get
        End Property

        Public Overrides ReadOnly Property SupportedContentTypes As Collection(Of ContentType)
            Get
                Return Me._supportedContentTypes
            End Get
        End Property

        Private Shared Function CreateFieldRevisionDescriptionDoc(row As TtpDefectMigrationItem) As XmlDocument
            Dim columns As New XElement("Columns", New Object() {New XElement("Column", New Object() {New XAttribute("DisplayName", "Author"), New XAttribute("ReferenceName", "Author"), New XAttribute("Type", "String"), New XElement("Value", row.AuthorId)}), New XElement("Column", New Object() {New XAttribute("DisplayName", "DisplayName"), New XAttribute("ReferenceName", "DisplayName"), New XAttribute("Type", "String"), New XElement("Value", row.DisplayName)}), New XElement("Column", New Object() {New XAttribute("DisplayName", "Id"), New XAttribute("ReferenceName", "Id"), New XAttribute("Type", "String"), New XElement("Value", row.Id.ToString)})})
            Dim column As KeyValuePair(Of String, Object)
            For Each column In row.Columns
                If Not String.IsNullOrEmpty(column.Value) Then
                    columns.Add(New XElement("Column", New Object() {New XAttribute("DisplayName", column.Key), New XAttribute("ReferenceName", column.Key), New XAttribute("Type", "String"), New XElement("Value", column.Value)}))
                End If
            Next
            Dim descriptionDoc As New XElement("WorkItemChanges", New Object() {New XAttribute("Revision", row.Revision), New XAttribute("WorkItemType", row.WorItemType), New XAttribute("Author", IIf(String.IsNullOrEmpty(row.AuthorId), "", row.AuthorId)), New XAttribute("ChangeDate", row.ModifiedOn.ToString(CultureInfo.CurrentCulture)), New XAttribute("WorkItemID", row.Id.ToString), columns})
            Dim doc As New XmlDocument
            doc.LoadXml(descriptionDoc.ToString)
            Return doc
        End Function

        Public Overrides Sub GenerateDeltaTable()
            Dim viewName As String = Me._configurationService.Filters.Item(0).Path
            TraceManager.TraceInformation("TtpWIT:AP:GenerateDeltaTable:View - {0}", New Object() {viewName})
            Me._highWaterMarkDelta.Reload()
            Me.GetTtpUpdates(viewName)
            Me._highWaterMarkDelta.Update(DateTime.Now)
            Me._changeGroupService.PromoteDeltaToPending()
        End Sub

        Public Overrides Sub InitializeClient()
            TraceManager.TraceInformation("TtpWIT:AP:InitializeClient")
        End Sub

        Private Shared Function InitializeMigrationDataSource() As TtpMigrationDataSource
            Return New TtpMigrationDataSource
        End Function

        Public Overrides Sub InitializeServices(ByVal analysisService As IServiceContainer)
            TraceManager.TraceInformation("TtpWIT:AP:InitializeServices")
            If (analysisService Is Nothing) Then
                Throw New ArgumentNullException("analysisService")
            End If
            Me._analysisServiceContainer = analysisService
            Me._configurationService = DirectCast(analysisService.GetService(GetType(ConfigurationService)), ConfigurationService)
            Dim migrationSourceConfiguration As MigrationSource = Me._configurationService.MigrationSource
            _dataSourceConfig = TtpAnalysisProvider.InitializeMigrationDataSource
            Dim customSetting As CustomSetting
            Dim username As String = ""
            Dim password As String = ""
            Dim hwmDateOveride As DateTime = DateTime.MinValue
            For Each customSetting In Me._configurationService.MigrationSource.CustomSettings.CustomSetting
                If customSetting.SettingKey.Equals("Username", StringComparison.OrdinalIgnoreCase) Then
                    username = customSetting.SettingValue
                End If
                If customSetting.SettingKey.Equals("Password", StringComparison.OrdinalIgnoreCase) Then
                    password = customSetting.SettingValue
                End If
                If customSetting.SettingKey.Equals("OverrideHWM", StringComparison.OrdinalIgnoreCase) Then
                    If Not DateTime.TryParse(customSetting.SettingValue, hwmDateOveride) Then
                        Throw New InvalidCastException("Date is not in the correct format: OverrideHWM")
                    End If
                End If
            Next

            _dataSourceConfig.Credentials = New NetworkCredential(username, password)
            _dataSourceConfig.DatabaseName = migrationSourceConfiguration.SourceIdentifier
            _dataSourceConfig.FilterName = IIf(migrationSourceConfiguration.ServerIdentifier = "[enterFiltername]", "", migrationSourceConfiguration.ServerIdentifier)
            _dataSourceConfig.Url = migrationSourceConfiguration.ServerUrl

            Me._supportedContentTypes = New Collection(Of ContentType)
            Me.SupportedContentTypes.Add(WellKnownContentType.WorkItem)

            Dim handler As New TtpChangeActionHandlers(Me)

            Me._supportedChangeActions = New Dictionary(Of Guid, ChangeActionHandler)
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Add, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Edit, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me.SupportedChangeActions.Add(WellKnownChangeActionId.Delete, New ChangeActionHandler(AddressOf handler.BasicActionHandler))
            Me._highWaterMarkDelta = New HighWaterMark(Of DateTime)("HWMDelta")
            Me._highWaterMarkChangeSet = New HighWaterMark(Of Integer)("LastChangeSet")
            _highWaterMarkRevision = New HighWaterMark(Of Integer)("Revision")

            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkDelta)
            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkChangeSet)
            Me._configurationService.RegisterHighWaterMarkWithSession(Me._highWaterMarkRevision)

            If hwmDateOveride > DateTime.MinValue Then
                _highWaterMarkDelta.Update(hwmDateOveride)
            End If

            Me._changeGroupService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ChangeGroupService)), ChangeGroupService)

            Me._changeGroupService.RegisterDefaultSourceSerializer(New TtpDefectMigrationItemSerializer)
        End Sub

        Public Overrides Sub RegisterConflictTypes(ByVal conflictManager As ConflictManager)
            TraceManager.TraceInformation("TtpWIT:AP:RegisterConflictTypes")
            Me._conflictManagerService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ConflictManager)), ConflictManager)
            Me._conflictManagerService.RegisterConflictType(New GenericConflictType)
            Me._conflictManagerService.RegisterConflictType(New TtpGeneralConflictType, ConflictsSyncOrchOptions.Continue)
        End Sub

        Public Overrides Sub RegisterSupportedChangeActions(ByVal changeActionRegistrationService As ChangeActionRegistrationService)
            TraceManager.TraceInformation("TtpWIT:AP:RegisterSupportedChangeActions")
            changeActionRegistrationService = DirectCast(Me._analysisServiceContainer.GetService(GetType(ChangeActionRegistrationService)), ChangeActionRegistrationService)
            Dim supportedChangeAction As KeyValuePair(Of Guid, ChangeActionHandler)
            For Each supportedChangeAction In Me.SupportedChangeActions
                Dim contentType As ContentType
                For Each contentType In Me.SupportedContentTypes
                    changeActionRegistrationService.RegisterChangeAction(supportedChangeAction.Key, contentType.ReferenceName, supportedChangeAction.Value)
                Next
            Next
        End Sub

        Public Overrides Sub RegisterSupportedContentTypes(contentTypeRegistrationService As Microsoft.TeamFoundation.Migration.Toolkit.Services.ContentTypeRegistrationService)

        End Sub

        Private Sub GetTtpUpdates(ByVal viewName As String)
            TraceManager.TraceInformation("TtpWIT:AP:GetTtpDefectUpdates")
            Dim TtpServer As Uri = New Uri(String.Format("{0}/scripts/ttsoapcgi.exe", _dataSourceConfig.Url))

            TraceManager.TraceInformation(ChrW(9) & "TtpWIT:AP:Loading Ttp  {0}", New Object() {TtpServer})
            Try

                Dim _ttpsoapclient = New TtpSoapSdkApi(TtpServer)
                Dim _sourceProject As CProject = Nothing
                TraceManager.TraceInformation("TTP:AP:GetTtpDefectsAsDeltaFromSource:GetProjectList")
                Dim projects() As CProject = _ttpsoapclient.getProjectList(_dataSourceConfig.Credentials.UserName, _dataSourceConfig.Credentials.Password)
                TraceManager.TraceInformation("TTP:AP:GetTtpDefectsAsDeltaFromSource:FindSourceProject")
                For Each project In projects
                    If project.database.name.ToLower = _dataSourceConfig.DatabaseName.ToLower Then
                        _sourceProject = project
                        TraceManager.TraceInformation("TTP:AP:GetTtpDefectsAsDeltaFromSource:SourceProjectFound")
                        Exit For
                    End If
                Next

                If _sourceProject Is Nothing Then
                    TraceManager.TraceInformation("TTP:AP:GetTtpDefectsAsDeltaFromSource:Project Not Found")
                    Exit Sub
                End If

                TraceManager.TraceInformation("TTP:AP:InitializeClient:GetSessionId")
                Dim _lSession = _ttpsoapclient.ProjectLogon(_sourceProject, _dataSourceConfig.Credentials.UserName, _dataSourceConfig.Credentials.Password)
                TraceManager.TraceInformation("TTP:AP:InitializeClient:Logged onto {0}", _sourceProject.database.name)
                Dim _deltaTableStartTime As DateTime = DateTime.Now

                ' Dim atc() As CTableColumn = {New CTableColumn With {.name = "Number"}, New CTableColumn With {.name = "Date Modified"}}
                Dim atc() As CTableColumn = _ttpsoapclient.getColumnsForTable(_lSession, "Defect")
                Dim tstart As DateTime = Now
                TraceManager.TraceInformation("TTP:AP:InitializeClient:Atempting get on all data")
                Dim rows As CRecordListSoap = _ttpsoapclient.getRecordListForTable(_lSession, "Defect", viewName, atc)
                TraceManager.TraceInformation("TTP:AP:InitializeClient:Found {0} records in {1} seconds", rows.records.Count, Now.Subtract(tstart).TotalSeconds)

                _highWaterMarkRevision.Reload()
                _highWaterMarkRevision.Update(_highWaterMarkRevision.Value + 1)

                Dim currentRecord As Integer = 1
                Dim countRecords = rows.records.Count
                For Each record In rows.records
                    ' item has been modified since HWM & before deltra table start time
                    Try
                        Dim DefectMI As TtpDefectMigrationItem = TtpDefectMigrationItem.ConvertCDefectToTtpDefectMigrationItem(atc, record)
                        ' Dim Modified As DateTime = DateTime.Parse(record.row(1).value)

                        If DefectMI.ModifiedOn.CompareTo(_highWaterMarkDelta.Value) > 0 And DefectMI.ModifiedOn.CompareTo(_deltaTableStartTime) Then
                            ' Atempt to import additional data from objects
                            DefectMI.ImportDefectData(_ttpsoapclient, _lSession)

                            ' Create and add acction group
                            Dim actionGuid As Guid = WellKnownChangeActionId.Add
                            If ((Not _highWaterMarkDelta.Value = DateTime.MinValue) AndAlso (DefectMI.CreatedOn.CompareTo(_highWaterMarkDelta.Value) > 0)) Then
                                actionGuid = WellKnownChangeActionId.Add
                                TraceManager.TraceInformation("  {0} of {1} - '{2}' Number '{3}' has {4} processing revision {5} as add in {6} seconds", currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, "passed", _highWaterMarkRevision.Value, Now.Subtract(tstart).TotalSeconds)
                            ElseIf ((Not _highWaterMarkDelta.Value = DateTime.MinValue) AndAlso (DefectMI.ModifiedOn.CompareTo(_highWaterMarkDelta.Value) > 0)) Then
                                actionGuid = WellKnownChangeActionId.Edit
                                TraceManager.TraceInformation("  {0} of {1} - '{2}' Number '{3}' has {4} processing revision {5} as edit in {6} seconds", currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, "passed", _highWaterMarkRevision.Value, Now.Subtract(tstart).TotalSeconds)
                            Else
                                TraceManager.TraceInformation("  {0} of {1} - '{2}' Number '{3}' has {4} processing revision {5} as edit in {6} seconds", currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, "skipped", _highWaterMarkRevision.Value, Now.Subtract(tstart).TotalSeconds)
                            End If

                            ' Add revision to obejct
                            DefectMI.Revision = _highWaterMarkRevision.Value

                            Dim changeGroup As ChangeGroup = Me._changeGroupService.CreateChangeGroupForDeltaTable(String.Format("{0}:{1}", DefectMI.Id, DefectMI.Revision))
                            changeGroup.CreateAction(actionGuid, DefectMI, DefectMI.Id, "", _highWaterMarkRevision.Value, "", WellKnownContentType.WorkItem.ReferenceName, TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(DefectMI))
                            TraceManager.TraceInformation("  {0} of {1} - '{2}' Number '{3}' CreateAction: action={4};sourceItem={5};fromPath={5};version={6};mergeVersionTo=;itemTypeRefName={7};actionDetails=[xml]", currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, actionGuid, DefectMI.Id, _highWaterMarkRevision.Value, WellKnownContentType.WorkItem.ReferenceName)
                            changeGroup.Save()

                            _highWaterMarkChangeSet.Update((_highWaterMarkChangeSet.Value + 1))
                            ' DONE

                        Else
                            TraceManager.TraceInformation("  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds", currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, "skipped", Now.Subtract(tstart).TotalSeconds)
                        End If

                    Catch ex As Exception
                        TraceManager.TraceError("  {0} of {1} - '{2}' Number '{3}' has {4} processing in {5} seconds", currentRecord, countRecords, "unknown", "unknown", "failed", Now.Subtract(tstart).TotalSeconds)
                        TraceManager.TraceException(ex)
                    End Try
                    currentRecord = currentRecord + 1

                Next

            Catch ex As Exception
                TraceManager.TraceException(ex)
            End Try

        End Sub

    End Class
    ```

    **Figure: Full source code for new Analysis Provider v2**

    ```
    Dim changeGroup As ChangeGroup = Me._changeGroupService.CreateChangeGroupForDeltaTable(String.Format("{0}:{1}", DefectMI.Id, DefectMI.Revision))
    changeGroup.CreateAction(actionGuid, DefectMI, DefectMI.Id, "", _highWaterMarkRevision.Value, "", WellKnownContentType.WorkItem.ReferenceName, TtpAnalysisProvider.CreateFieldRevisionDescriptionDoc(DefectMI))
    TraceManager.TraceInformation("  {0} of {1} - '{2}' Number '{3}' CreateAction: action={4};sourceItem={5};fromPath={5};version={6};mergeVersionTo=;itemTypeRefName={7};actionDetails=[xml]", currentRecord, countRecords, DefectMI.WorItemType, DefectMI.Id, actionGuid, DefectMI.Id, _highWaterMarkRevision.Value, WellKnownContentType.WorkItem.ReferenceName)
    changeGroup.Save()
    ```

    **Figure: Snipit of the Analysis Provider v2**

    You can see in the full source for v2 of the Analysis Provider that I have added a new high watermark for the revision that should stay in sync with the number of runs of the migration there have been. This way, all of the edit’s  that happen on the third run will have a revision number of 3.

    [![image](images/image_thumb1-2-2.png "image")](http://blog.hinshelwood.com/files/2011/06/image1.png)
    { .post-img }

    **Figure: None of the originally imported data has a revision.**

    The problem now is that no matter how many times I run the import in my test environment I can’t get it to perform an edit. I am hoping that someone will be able to spot a silly mistake on my code that will solve this problem. it is one of those “stare at it for hours hoping it will just work” problems.

    And it gets worse, now when I try to run the code I get an “Index was out of range” exception for the TFS server that I just can’t track down. I have even backed all my code back to a known working version and I still get the error. I have even gone so far as to restart the Target TFS server and try another one. Here is the log I keep getting:

    ```
    [02/06/2011 18:14:15] MigrationConsole started...
    [02/06/2011 18:14:29] MigrationConsole.exe Information: 0 : ConfigurationChangeTracker did not detect any non-transient changes. No cached data will be deleted for session group '00000000-0000-0000-0000-000000000000'
    [02/06/2011 18:14:29] MigrationConsole.exe Information: 0 : : StartSessionGroup: Enter with sessionGroupUniqueId: a69d4175-24ad-4f12-8fb5-4edd33f40ada
    [02/06/2011 18:14:29] MigrationConsole.exe Information: 0 : : StartSessionGroup: Creating new SyncOrchestrator
    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider ChangeGroup Label AnalysisAddin Provider a4f53905-25b6-4311-ac0c-637da6688f2b is available
    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider ClearQuest Adapter d9637401-7385-4643-9c64-31585d77ed16 is available
    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider Northwest Cadence CSV Adapter 06a2457f-ebba-4979-bc5f-0f5006b8b4e6 is available
    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider TFS 2008 User Identity Lookup Add-In Provider eecc0227-8006-45f0-888d-10ab03019ad5 is available
    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider Semaphore File Analysis Addin Provider e8cec3c5-5848-4b83-904f-4324094c3f78 is available
    [02/06/2011 18:14:30] MigrationConsole.exe Information: 0 : : Provider TFS 2010 Migration VC Provider febc091f-82a2-449e-aed8-133e5896c47a is available
    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : Provider TFS 2010 Migration WIT Provider 04201d39-6e47-416f-98b2-07f0013f8455 is available
    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : Provider TestTrackPro TIP Adapter c0e63c2b-e06c-48bb-8698-243a82bb950e is available
    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : CsvAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAddin
    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : Provider TFS 2010 Migration WIT Provider 04201d39-6e47-416f-98b2-07f0013f8455 is loaded
    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAddin
    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Cant find--
    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : Provider TestTrackPro TIP Adapter c0e63c2b-e06c-48bb-8698-243a82bb950e is loaded
    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : 2 Adapter instance(s) loaded
    [02/06/2011 18:14:31] MigrationConsole.exe Information: 0 : : 5 Add-Ins loaded
    [02/06/2011 18:14:35] MigrationConsole.exe Information: 0 : : Active Directory lookup will be used for this end point.
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IAnalysisProvider
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Creating - TtpAnalysisProvider
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Returning - NorthwestCadence.TtpTipAdapter.TtpAnalysisProvider
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpWIT:AP:InitializeServices
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpWIT:AP:RegisterSupportedChangeActions
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpWIT:AP:RegisterConflictTypes
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.Services.IServerPathTranslationService
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Cant find--
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.IMigrationProvider
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Creating - TtpMigrationProvider
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService Returning - NorthwestCadence.TtpTipAdapter.TtpAnalysisProvider
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpWIT:AP:RegisterConflictTypes
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Microsoft.TeamFoundation.Migration.Toolkit.ILinkProvider
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : TtpAdapter:GetService - Cant find--
    [02/06/2011 18:14:39] MigrationConsole.exe Information: 0 : : Connecting to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:41] MigrationConsole.exe Information: 0 : : Connected to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:42] MigrationConsole.exe Information: 0 : : Connecting to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:42] MigrationConsole.exe Information: 0 : : Connected to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:42] MigrationConsole.exe Information: 0 : : TtpWIT:AP:InitializeClient
    [02/06/2011 18:14:42] MigrationConsole.exe Information: 0 : : Connecting to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:42] MigrationConsole.exe Information: 0 : : Connected to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:43] MigrationConsole.exe Information: 0 : : Connecting to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:43] MigrationConsole.exe Information: 0 : : Connected to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 : : StartSessionGroup: Starting SyncOrchestrator; now 0 running sessions
    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 : WorkItemTracking: Session worker thread [WorkItemTracking] started
    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 : WorkItemTracking: Pipeline flow from bcf2ef19-dbaf-48a3-bbd1-82424ef9d7f2 to 90acdef5-e512-4df5-a680-cb2f386b08fd
    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating delta tables for the migration source bcf2ef19-dbaf-48a3-bbd1-82424ef9d7f2
    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpWIT:AP:GenerateDeltaTable:View - NWC_Test
    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpWIT:AP:GetTtpDefectUpdates
    [02/06/2011 18:14:44] MigrationConsole.exe Information: 0 : WorkItemTracking:     TtpWIT:AP:Loading Ttp  http://ttp01.nwcadence.com/scripts/ttsoapcgi.exe
    [02/06/2011 18:14:45] MigrationConsole.exe Information: 0 : WorkItemTracking: TTP:AP:GetTtpDefectsAsDeltaFromSource:GetProjectList
    [02/06/2011 18:14:47] MigrationConsole.exe Information: 0 : WorkItemTracking: TTP:AP:GetTtpDefectsAsDeltaFromSource:FindSourceProject
    [02/06/2011 18:14:47] MigrationConsole.exe Information: 0 : WorkItemTracking: TTP:AP:GetTtpDefectsAsDeltaFromSource:SourceProjectFound
    [02/06/2011 18:14:47] MigrationConsole.exe Information: 0 : WorkItemTracking: TTP:AP:InitializeClient:GetSessionId
    [02/06/2011 18:14:48] MigrationConsole.exe Information: 0 : WorkItemTracking: TTP:AP:InitializeClient:Logged onto expreSSO_Vergence
    [02/06/2011 18:14:49] MigrationConsole.exe Information: 0 : WorkItemTracking: TTP:AP:InitializeClient:Atempting get on all data
    [02/06/2011 18:14:51] MigrationConsole.exe Information: 0 : WorkItemTracking: TTP:AP:InitializeClient:Found 3 records in 1.9663932 seconds
    [02/06/2011 18:14:52] MigrationConsole.exe Information: 0 : WorkItemTracking:   1 of 3 - 'Defect' Number '3284' has skipped processing revision 1 as edit in 3.2796558 seconds
    [02/06/2011 18:14:52] MigrationConsole.exe Information: 0 : WorkItemTracking:   1 of 3 - 'Defect' Number '3284' CreateAction: action=cb71d043-bede-4092-aa87-cf0f14586625;sourceItem=3284;fromPath=3284;version=0;mergeVersionTo=;itemTypeRefName=Microsoft.TeamFoundation.Migration.Toolkit.WorkItem;actionDetails=[xml]
    [02/06/2011 18:14:54] MigrationConsole.exe Information: 0 : WorkItemTracking:   2 of 3 - 'Defect' Number '3285' has skipped processing revision 1 as edit in 4.8739746 seconds
    [02/06/2011 18:14:54] MigrationConsole.exe Information: 0 : WorkItemTracking:   2 of 3 - 'Defect' Number '3285' CreateAction: action=cb71d043-bede-4092-aa87-cf0f14586625;sourceItem=3285;fromPath=3285;version=0;mergeVersionTo=;itemTypeRefName=Microsoft.TeamFoundation.Migration.Toolkit.WorkItem;actionDetails=[xml]
    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 : WorkItemTracking:   3 of 3 - 'Defect' Number '3243' has skipped processing revision 1 as edit in 6.1952388 seconds
    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 : WorkItemTracking:   3 of 3 - 'Defect' Number '3243' CreateAction: action=cb71d043-bede-4092-aa87-cf0f14586625;sourceItem=3243;fromPath=3243;version=0;mergeVersionTo=;itemTypeRefName=Microsoft.TeamFoundation.Migration.Toolkit.WorkItem;actionDetails=[xml]
    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating linking delta for the migration source bcf2ef19-dbaf-48a3-bbd1-82424ef9d7f2
    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating delta tables for the migration source 90acdef5-e512-4df5-a680-cb2f386b08fd
    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Getting modified items from '90acdef5-e512-4df5-a680-cb2f386b08fd!http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)'
    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Connecting to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 : WorkItemTracking: Connected to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:55] MigrationConsole.exe Information: 0 : WorkItemTracking: TFS Query: SELECT [System.Id], [System.Rev] FROM WorkItems WHERE ([System.TeamProject]=@project AND ([System.Id] = 0)) ORDER BY [System.Id]
    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TFS Query: returned 0 item(s)
    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 : WorkItemTracking: Received modified items from '90acdef5-e512-4df5-a680-cb2f386b08fd!http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)'
    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 : WorkItemTracking: Persisted WIT HWM: HWMDeltaWit
    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 : WorkItemTracking: Updated high watermark to '06/02/2011 22:14:55'
    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instructions for the migration source 90acdef5-e512-4df5-a680-cb2f386b08fd
    [02/06/2011 18:14:56] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [02/06/2011 18:14:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [02/06/2011 18:14:57] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [02/06/2011 18:14:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 4382
    [02/06/2011 18:14:57] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 4383
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Generating migration instruction for ChangeGroup 4384
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Starting basic conflict detection
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Finishing basic conflict detection
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Loading 50 ChangeGroup(s)
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #4385
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #4386
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Target AnalysisProvider detecting conflicts in ChangeGroup #4387
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Post-processing delta table entries from the migration source 90acdef5-e512-4df5-a680-cb2f386b08fd
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Marking as 'DeltaComplete' the target-side delta table for uni-directional session
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Migrating to the migration source 90acdef5-e512-4df5-a680-cb2f386b08fd
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Loading 50 ChangeGroup(s)
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: TtpDefectMigrationItemSerializer:LoadItem
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #4385, change 3284:0
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Connecting to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:58] MigrationConsole.exe Information: 0 : WorkItemTracking: Connected to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:14:59] MigrationConsole.exe Information: 0 : WorkItemTracking: Area 'TestTrackProTestTrackProImportAdministrators DesktopInstallation' does not exist in the TFS work item store 'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)' or access is denied.
    [02/06/2011 18:15:00] MigrationConsole.exe Information: 0 : WorkItemTracking: Wake up from 100 millisec sleep for polling CSS node Id
    [02/06/2011 18:15:01] MigrationConsole.exe Information: 0 : WorkItemTracking: Wake up from 500 millisec sleep for polling CSS node Id
    [02/06/2011 18:15:01] MigrationConsole.exe Information: 0 : WorkItemTracking: Created path 'TestTrackProTestTrackProImportAdministrators DesktopInstallation'(Id: 605) in the TFS Work Item store 'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)'
    [02/06/2011 18:15:01] MigrationConsole.exe Information: 0 : WorkItemTracking: Iteration 'TestTrackProTestTrackProImportexpreSSO 2.5 SP3 CD5' does not exist in the TFS work item store 'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)' or access is denied.
    [02/06/2011 18:15:02] MigrationConsole.exe Information: 0 : WorkItemTracking: Wake up from 100 millisec sleep for polling CSS node Id
    [02/06/2011 18:15:03] MigrationConsole.exe Information: 0 : WorkItemTracking: Wake up from 500 millisec sleep for polling CSS node Id
    [02/06/2011 18:15:03] MigrationConsole.exe Information: 0 : WorkItemTracking: Wake up from 500 millisec sleep for polling CSS node Id
    [02/06/2011 18:15:04] MigrationConsole.exe Information: 0 : WorkItemTracking: Created path 'TestTrackProTestTrackProImportexpreSSO 2.5 SP3 CD5'(Id: 607) in the TFS Work Item store 'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)'
    [02/06/2011 18:15:04] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [02/06/2011 18:15:04] MigrationConsole.exe Information: 0 : WorkItemTracking: Connecting to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:15:04] MigrationConsole.exe Information: 0 : WorkItemTracking: Connected to 'http://tfs01.nwcadence.com:8080/tfs/sandbox'
    [02/06/2011 18:15:04] MigrationConsole.exe Error: 0 : WorkItemTracking: System.Web.Services.Protocols.SoapException: Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 18:15:04] Parameter name: index ---> Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 18:15:04] Parameter name: index
    [02/06/2011 18:15:04]    at Microsoft.TeamFoundation.WorkItemTracking.Proxy.RetryHandler.HandleSoapException(SoapException se)
    [02/06/2011 18:15:04]    at Microsoft.TeamFoundation.WorkItemTracking.Proxy.WorkItemServer.Update(String requestId, XmlElement package, XmlElement& result, MetadataTableHaveEntry[] metadataHave, String& dbStamp, IMetadataRowSets& metadata)
    [02/06/2011 18:15:04]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.Tfs2010WorkItemServer.Update(String requestId, XmlElement package, XmlElement& result, MetadataTableHaveEntry[] metadataHave, String& dbStamp, IMetadataRowSets& metadata)
    [02/06/2011 18:15:04]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsBatchUpdateHelper.Submit(Int32 firstItem, Int32 lastItem)
    [02/06/2011 18:15:05] MigrationConsole.exe Information: 0 : WorkItemTracking: Unresolved conflict:
    [02/06/2011 18:15:05]   Session: 1c1faa2a-0d43-4381-b877-2df1d232694c
    [02/06/2011 18:15:05]   Source: 90acdef5-e512-4df5-a680-cb2f386b08fd
    [02/06/2011 18:15:05]   Message: Cannot find applicable resolution rule.
    [02/06/2011 18:15:05]   Conflict Type: TFS WIT invalid submission conflict type
    [02/06/2011 18:15:05]   Conflict Type Reference Name: c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374
    [02/06/2011 18:15:05]   Conflict Details: <?xml version="1.0"?>
    [02/06/2011 18:15:05] <InvalidSubmissionConflictDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    [02/06/2011 18:15:05]   <ExceptionType>System.Web.Services.Protocols.SoapException</ExceptionType>
    [02/06/2011 18:15:05]   <ExceptionMessage>Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 18:15:05] Parameter name: index ---&gt; Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 18:15:05] Parameter name: index</ExceptionMessage>
    [02/06/2011 18:15:05]   <InnerExceptionType />
    [02/06/2011 18:15:05]   <InnerExceptionMessage />
    [02/06/2011 18:15:05]   <ActionData />
    [02/06/2011 18:15:05]   <SourceItemId>3284</SourceItemId>
    [02/06/2011 18:15:05]   <SourceItemRevision>0</SourceItemRevision>
    [02/06/2011 18:15:05] </InvalidSubmissionConflictDetails>
    [02/06/2011 18:15:05]
    [02/06/2011 18:15:05]
    [02/06/2011 18:15:05] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #4386, change 3285:0
    [02/06/2011 18:15:05] MigrationConsole.exe Information: 0 : WorkItemTracking: Area 'TestTrackProTestTrackProImportAdministrators DesktopBridges' does not exist in the TFS work item store 'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)' or access is denied.
    [02/06/2011 18:15:06] MigrationConsole.exe Information: 0 : WorkItemTracking: Wake up from 100 millisec sleep for polling CSS node Id
    [02/06/2011 18:15:06] MigrationConsole.exe Information: 0 : WorkItemTracking: Wake up from 500 millisec sleep for polling CSS node Id
    [02/06/2011 18:15:07] MigrationConsole.exe Information: 0 : WorkItemTracking: Created path 'TestTrackProTestTrackProImportAdministrators DesktopBridges'(Id: 608) in the TFS Work Item store 'http://tfs01.nwcadence.com:8080/tfs/sandbox (TestTrackPro)'
    [02/06/2011 18:15:07] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [02/06/2011 18:15:07] MigrationConsole.exe Error: 0 : WorkItemTracking: System.Web.Services.Protocols.SoapException: Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 18:15:07] Parameter name: index ---> Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 18:15:07] Parameter name: index
    [02/06/2011 18:15:07]    at Microsoft.TeamFoundation.WorkItemTracking.Proxy.RetryHandler.HandleSoapException(SoapException se)
    [02/06/2011 18:15:07]    at Microsoft.TeamFoundation.WorkItemTracking.Proxy.WorkItemServer.Update(String requestId, XmlElement package, XmlElement& result, MetadataTableHaveEntry[] metadataHave, String& dbStamp, IMetadataRowSets& metadata)
    [02/06/2011 18:15:07]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.Tfs2010WorkItemServer.Update(String requestId, XmlElement package, XmlElement& result, MetadataTableHaveEntry[] metadataHave, String& dbStamp, IMetadataRowSets& metadata)
    [02/06/2011 18:15:07]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsBatchUpdateHelper.Submit(Int32 firstItem, Int32 lastItem)
    [02/06/2011 18:15:07] MigrationConsole.exe Information: 0 : WorkItemTracking: Unresolved conflict:
    [02/06/2011 18:15:07]   Session: 1c1faa2a-0d43-4381-b877-2df1d232694c
    [02/06/2011 18:15:07]   Source: 90acdef5-e512-4df5-a680-cb2f386b08fd
    [02/06/2011 18:15:07]   Message: Cannot find applicable resolution rule.
    [02/06/2011 18:15:07]   Conflict Type: TFS WIT invalid submission conflict type
    [02/06/2011 18:15:07]   Conflict Type Reference Name: c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374
    [02/06/2011 18:15:07]   Conflict Details: <?xml version="1.0"?>
    [02/06/2011 18:15:07] <InvalidSubmissionConflictDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    [02/06/2011 18:15:07]   <ExceptionType>System.Web.Services.Protocols.SoapException</ExceptionType>
    [02/06/2011 18:15:07]   <ExceptionMessage>Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 18:15:07] Parameter name: index ---&gt; Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 18:15:07] Parameter name: index</ExceptionMessage>
    [02/06/2011 18:15:07]   <InnerExceptionType />
    [02/06/2011 18:15:07]   <InnerExceptionMessage />
    [02/06/2011 18:15:07]   <ActionData />
    [02/06/2011 18:15:07]   <SourceItemId>3285</SourceItemId>
    [02/06/2011 18:15:07]   <SourceItemRevision>0</SourceItemRevision>
    [02/06/2011 18:15:07] </InvalidSubmissionConflictDetails>
    [02/06/2011 18:15:07]
    [02/06/2011 18:15:07]
    [02/06/2011 18:15:07] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #4387, change 3243:0
    [02/06/2011 18:15:07] MigrationConsole.exe Error: 0 : WorkItemTracking: System.FormatException: String was not recognized as a valid DateTime.
    [02/06/2011 18:15:07]    at System.DateTimeParse.Parse(String s, DateTimeFormatInfo dtfi, DateTimeStyles styles)
    [02/06/2011 18:15:07]    at System.DateTime.Parse(String s, IFormatProvider provider)
    [02/06/2011 18:15:07]    at System.Convert.ToDateTime(String value)
    [02/06/2011 18:15:07]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsUpdateDocument.AddColumn(XmlElement cs, String workItemType, String fieldName, String fieldReferenceName, String stringVal)
    [02/06/2011 18:15:07]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsUpdateDocument.AddFields(IMigrationAction action, String workItemType, String author, String changedTime, Boolean insertWorkItem)
    [02/06/2011 18:15:07]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.CreateNewWorkItemOperation(IMigrationAction action, ConflictManager conflictMgrService)
    [02/06/2011 18:15:07]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.CreateUpdateOperationDoc(IMigrationAction action)
    [02/06/2011 18:15:07]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.SubmitChangesWithUpdateDoc(ChangeGroup changeGroup, ConversionResult changeResult, Guid sourceSideSourceId)
    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 : WorkItemTracking: Unresolved conflict:
    [02/06/2011 18:15:08]   Session: 1c1faa2a-0d43-4381-b877-2df1d232694c
    [02/06/2011 18:15:08]   Source: 90acdef5-e512-4df5-a680-cb2f386b08fd
    [02/06/2011 18:15:08]   Message: Cannot find applicable resolution rule.
    [02/06/2011 18:15:08]   Conflict Type: TFS WIT invalid submission conflict type
    [02/06/2011 18:15:08]   Conflict Type Reference Name: c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374
    [02/06/2011 18:15:08]   Conflict Details: <?xml version="1.0"?>
    [02/06/2011 18:15:08] <InvalidSubmissionConflictDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    [02/06/2011 18:15:08]   <ExceptionType>System.FormatException</ExceptionType>
    [02/06/2011 18:15:08]   <ExceptionMessage>String was not recognized as a valid DateTime.</ExceptionMessage>
    [02/06/2011 18:15:08]   <InnerExceptionType />
    [02/06/2011 18:15:08]   <InnerExceptionMessage />
    [02/06/2011 18:15:08]   <ActionData />
    [02/06/2011 18:15:08]   <SourceItemId>3243</SourceItemId>
    [02/06/2011 18:15:08]   <SourceItemRevision>0</SourceItemRevision>
    [02/06/2011 18:15:08] </InvalidSubmissionConflictDetails>
    [02/06/2011 18:15:08]
    [02/06/2011 18:15:08]
    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing linking delta
    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 : WorkItemTracking: Migrating links to the migration source 90acdef5-e512-4df5-a680-cb2f386b08fd
    [02/06/2011 18:15:08] MigrationConsole.exe Warning: 0 : WorkItemTracking: Unable to record sync point for migration source bcf2ef19-dbaf-48a3-bbd1-82424ef9d7f2 of session 1c1faa2a-0d43-4381-b877-2df1d232694c because lastMigratedTargetItem.ItemId is null or empty
    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 : WorkItemTracking:
    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItemTracking: Migration is done!
    [02/06/2011 18:15:08] MigrationConsole.exe Information: 0 : WorkItemTracking: Session worker thread [WorkItemTracking] completed
    ```

    **Figure: Index was out of range. Must be non-negative and less than the size of the collection**

    My last and only hope is that in all the development and debugging the I broke the TFS Integration Platform install, so I am going to:

    1. Uninstall TFS Integration Platform

    2. Clean “C:Program Files (x86)Microsoft Team Foundation Server Integration Tools” of all files

    3. Check all locations where files are stored after the craziness that is getting the source for the TFS Integration Platform to build

    [![SNAGHTML219c74f](images/SNAGHTML219c74f_thumb-5-5.png "SNAGHTML219c74f")](http://blog.hinshelwood.com/files/2011/06/SNAGHTML219c74f.png)
    { .post-img }

    **Figure: Reinstalling the TFS Integration Platform is thankfully quick**

    So, that did not help and I am now getting two error messages for the data that I am parsing. Both of which are coming from TFS and are realy confusing me. The first is a “Index was out of range” error, which is just beyond me as I am not even passing any arrays.

    ```
    [02/06/2011 21:47:22] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #511, change 3270:1
    [02/06/2011 21:47:22] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [02/06/2011 21:47:22] MigrationConsole.exe Error: 0 : WorkItemTracking: System.Web.Services.Protocols.SoapException: Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 21:47:22] Parameter name: index ---> Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 21:47:22] Parameter name: index
    [02/06/2011 21:47:22]    at Microsoft.TeamFoundation.WorkItemTracking.Proxy.RetryHandler.HandleSoapException(SoapException se)
    [02/06/2011 21:47:22]    at Microsoft.TeamFoundation.WorkItemTracking.Proxy.WorkItemServer.Update(String requestId, XmlElement package, XmlElement& result, MetadataTableHaveEntry[] metadataHave, String& dbStamp, IMetadataRowSets& metadata)
    [02/06/2011 21:47:22]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.Tfs2010WorkItemServer.Update(String requestId, XmlElement package, XmlElement& result, MetadataTableHaveEntry[] metadataHave, String& dbStamp, IMetadataRowSets& metadata)
    [02/06/2011 21:47:22]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsBatchUpdateHelper.Submit(Int32 firstItem, Int32 lastItem)
    [02/06/2011 21:47:23] MigrationConsole.exe Information: 0 : WorkItemTracking: Unresolved conflict:
    [02/06/2011 21:47:23]   Session: 583c945a-b2b8-4de3-8090-4a3126506984
    [02/06/2011 21:47:23]   Source: 3e1cfab9-910a-4a92-8c7a-25ff05ac5f48
    [02/06/2011 21:47:23]   Message: Cannot find applicable resolution rule.
    [02/06/2011 21:47:23]   Conflict Type: TFS WIT invalid submission conflict type
    [02/06/2011 21:47:23]   Conflict Type Reference Name: c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374
    [02/06/2011 21:47:23]   Conflict Details: <?xml version="1.0"?>
    [02/06/2011 21:47:23] <InvalidSubmissionConflictDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    [02/06/2011 21:47:23]   <ExceptionType>System.Web.Services.Protocols.SoapException</ExceptionType>
    [02/06/2011 21:47:23]   <ExceptionMessage>Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 21:47:23] Parameter name: index ---&gt; Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 21:47:23] Parameter name: index</ExceptionMessage>
    [02/06/2011 21:47:23]   <InnerExceptionType />
    [02/06/2011 21:47:23]   <InnerExceptionMessage />
    [02/06/2011 21:47:23]   <ActionData />
    [02/06/2011 21:47:23]   <SourceItemId>3270</SourceItemId>
    [02/06/2011 21:47:23]   <SourceItemRevision>1</SourceItemRevision>
    [02/06/2011 21:47:23] </InvalidSubmissionConflictDetails>
    ```

    **Figure: Index was out of range. Must be non-negative and less than the size of the collection**

    The second is a date format exception that I would have thought should be taken care of by the Integration Platform and not wait until it gets to TFS.

    ```
    [02/06/2011 21:47:23] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #512, change 3173:1
    [02/06/2011 21:47:23] MigrationConsole.exe Error: 0 : WorkItemTracking: System.FormatException: String was not recognized as a valid DateTime.
    [02/06/2011 21:47:23]    at System.DateTimeParse.Parse(String s, DateTimeFormatInfo dtfi, DateTimeStyles styles)
    [02/06/2011 21:47:23]    at System.DateTime.Parse(String s, IFormatProvider provider)
    [02/06/2011 21:47:23]    at System.Convert.ToDateTime(String value)
    [02/06/2011 21:47:23]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsUpdateDocument.AddColumn(XmlElement cs, String workItemType, String fieldName, String fieldReferenceName, String stringVal)
    [02/06/2011 21:47:23]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsUpdateDocument.AddFields(IMigrationAction action, String workItemType, String author, String changedTime, Boolean insertWorkItem)
    [02/06/2011 21:47:23]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.CreateNewWorkItemOperation(IMigrationAction action, ConflictManager conflictMgrService)
    [02/06/2011 21:47:23]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.CreateUpdateOperationDoc(IMigrationAction action)
    [02/06/2011 21:47:23]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsMigrationWorkItemStore.SubmitChangesWithUpdateDoc(ChangeGroup changeGroup, ConversionResult changeResult, Guid sourceSideSourceId)
    [02/06/2011 21:47:23] MigrationConsole.exe Information: 0 : WorkItemTracking: Unresolved conflict:
    [02/06/2011 21:47:23]   Session: 583c945a-b2b8-4de3-8090-4a3126506984
    [02/06/2011 21:47:23]   Source: 3e1cfab9-910a-4a92-8c7a-25ff05ac5f48
    [02/06/2011 21:47:23]   Message: Cannot find applicable resolution rule.
    [02/06/2011 21:47:23]   Conflict Type: TFS WIT invalid submission conflict type
    [02/06/2011 21:47:23]   Conflict Type Reference Name: c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374
    [02/06/2011 21:47:23]   Conflict Details: <?xml version="1.0"?>
    [02/06/2011 21:47:23] <InvalidSubmissionConflictDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    [02/06/2011 21:47:23]   <ExceptionType>System.FormatException</ExceptionType>
    [02/06/2011 21:47:23]   <ExceptionMessage>String was not recognized as a valid DateTime.</ExceptionMessage>
    [02/06/2011 21:47:23]   <InnerExceptionType />
    [02/06/2011 21:47:23]   <InnerExceptionMessage />
    [02/06/2011 21:47:23]   <ActionData />
    [02/06/2011 21:47:23]   <SourceItemId>3173</SourceItemId>
    [02/06/2011 21:47:23]   <SourceItemRevision>1</SourceItemRevision>
    [02/06/2011 21:47:23] </InvalidSubmissionConflictDetails>
    ```

    **Figure: String was not recognized as a valid DateTime**

    I have even checked the output that is sent to the TFS web service and I can’t see anything that jumps out as a problem…

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <InsertWorkItem ObjectType="WorkItem" BypassRules="1">
      <Columns>
        <Column Column="System.Title">
          <Value>There is a typing mistake in Product Diagnostic logging status messge</Value>
        </Column>
        <Column Column="Microsoft.VSTS.Common.Priority" Type="Number">
          <Value>3</Value>
        </Column>
        <Column Column="System.State">
          <Value>Proposed</Value>
        </Column>
        <Column Column="Microsoft.VSTS.Common.HowFoundCategory">
          <Value>Manual Testing</Value>
        </Column>
        <Column Column="Microsoft.VSTS.Common.Severity">
          <Value>4</Value>
        </Column>
        <Column Column="System.ChangedDate" Type="DateTime">
          <Value>2011-02-06T20:34:00</Value>
        </Column>
        <Column Column="Microsoft.VSTS.Common.CreatedDate" Type="DateTime">
          <Value>2011-02-06T20:34:00</Value>
        </Column>
        <Column Column="System.AssignedTo">
          <Value>Hinshelwood, Martin; Borg, Steven</Value>
        </Column>
        <Column Column="System.AreaId" Type="Number">
          <Value>108</Value>
        </Column>
        <Column Column="System.IterationId" Type="Number">
          <Value>212</Value>
        </Column>
        <Column Column="System.WorkItemType">
          <Value>Bug</Value>
        </Column>
        <Column Column="System.CreatedDate" Type="ServerDateTime">
          <Value></Value>
        </Column>
        <Column Column="System.CreatedBy">
          <Value>Hinshelwood, Martin</Value>
        </Column>
        <Column Column="System.ChangedBy">
          <Value>Hinshelwood, Martin</Value>
        </Column>
        <Column Column="System.Reason">
          <Value>Unknown</Value>
        </Column>
      </Columns>
      <InsertText FieldName="System.Description" FieldDisplayName="Description">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam at massa sem. Sed elementum, nisl sed bibendum consequat, justo libero sodales elit, a vehicula orci lorem et dui. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum sit amet metus orci. Aenean vulputate condimentum lectus, vel vulputate sem aliquam quis.‏</InsertText>
      <InsertText FieldName="Microsoft.VSTS.TCM.ReproSteps" FieldDisplayName="Repro Steps">Nullam in risus sed diam tincidunt fermentum sit amet non enim. Vestibulum tempus nibh eget nulla viverra iaculis. In a dolor ligula. Sed eget sem tellus, in tempor nisi. Maecenas venenatis cursus eros id rutrum. Nulla tristique, lectus a imperdiet vehicula, metus sapien mattis urna, a bibendum ligula nunc et nibh. Curabitur adipiscing hendrerit odio vel ornare.‏</InsertText>
      <InsertText FieldName="System.History" FieldDisplayName="History">
        &lt;p&gt;This is a dump of the original TTP data&lt;/p&gt;
        &lt;p&gt;Imported by http://nwcadence.com&lt;/p&gt;

        &lt;p&gt;(TFS Integration from 'TestTrackPro source' Id: 3280 (rev 1);)&lt;/p&gt;
      </InsertText>
    </InsertWorkItem>
    ```

    In order to find out what is happening with the data (ChangeGroups) you can run the following query against your tfs_IntegrationPlatform database:

    ```
    SELECT grp.Name
        ,grp.Status
        ,[ChangeActionId]
        ,[ActionId]
        ,[SourceItem]
        ,[FromPath]
        ,[Version]
        ,[ActionData]
        ,[Backlogged]
    FROM [Tfs_IntegrationPlatform].[dbo].[RUNTIME_CHANGE_ACTION] as act
    JOIN [Tfs_IntegrationPlatform].[dbo].[RUNTIME_CHANGE_GROUPS] as grp on act.ChangeGroupId = grp.Id
    WHERE grp.Id = '3251' or grp.Id = '3255'
    ```

    This will show you the actual data that is stored in the middle tier and allow you to maybe debug it. The result?

    ```
    <WorkItemChanges Revision="1" WorkItemType="Bug" Author="Hinshelwood, Martin" ChangeDate="02/06/2011 13:03:00" WorkItemID="3268">
      <Columns>
        <Column DisplayName="Summary" ReferenceName="System.Title" Type="String">
          <Value>Some long text</Value>
        </Column>
        <Column DisplayName="Priority" ReferenceName="Microsoft.VSTS.Common.Priority" Type="String">
          <Value>1</Value>
        </Column>
        <Column DisplayName="Status" ReferenceName="System.State" Type="String">
          <Value>Proposed</Value>
        </Column>
        <Column DisplayName="Found by" ReferenceName="Microsoft.VSTS.Common.HowFoundCategory" Type="String">
          <Value>Manual Testing</Value>
        </Column>
        <Column DisplayName="Severity" ReferenceName="Microsoft.VSTS.Common.Severity" Type="String">
          <Value>1</Value>
        </Column>
        <Column DisplayName="Date Modified" ReferenceName="System.ChangedDate" Type="String">
          <Value>6/2/2011 1:03 PM</Value>
        </Column>
        <Column DisplayName="Date Created" ReferenceName="Microsoft.VSTS.Common.CreatedDate" Type="String">
          <Value>6/1/2011 11:38 AM</Value>
        </Column>
        <Column DisplayName="Description" ReferenceName="System.Description" Type="String">
          <Value>Some long text</Value>
        </Column>
        <Column DisplayName="Steps to Reproduce" ReferenceName="Microsoft.VSTS.TCM.ReproSteps" Type="String">
          <Value>Some long text</Value>
        </Column>
        <Column DisplayName="Assigned To User" ReferenceName="System.AssignedTo" Type="String">
          <Value>Dann, Ron</Value>
        </Column>
        <Column DisplayName="History" ReferenceName="System.History" Type="String">
          <Value>Long histry that has been trunkated...
    </Value>
        </Column>
        <Column ReferenceName="System.AreaPath" Type="" DisplayName="">
          <Value>TestTrackProImportGlobalizationReporting</Value>
        </Column>
        <Column ReferenceName="System.IterationPath" Type="" DisplayName="">
          <Value>TestTrackProImportProduct 2.5</Value>
        </Column>
      </Columns>
    </WorkItemChanges>
    ```

    This data is what is actually produced as a change to be saved to TFS. I am a little concerned that the dates are in a variety of formats, but it was one of the ones that resulted in the “index” error:

    ```
    [02/06/2011 21:47:22] MigrationConsole.exe Error: 0 : WorkItemTracking: System.Web.Services.Protocols.SoapException: Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 21:47:22] Parameter name: index ---> Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 21:47:22] Parameter name: index
    [02/06/2011 21:47:22]    at Microsoft.TeamFoundation.WorkItemTracking.Proxy.RetryHandler.HandleSoapException(SoapException se)
    [02/06/2011 21:47:22]    at Microsoft.TeamFoundation.WorkItemTracking.Proxy.WorkItemServer.Update(String requestId, XmlElement package, XmlElement& result, MetadataTableHaveEntry[] metadataHave, String& dbStamp, IMetadataRowSets& metadata)
    [02/06/2011 21:47:22]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.Tfs2010WorkItemServer.Update(String requestId, XmlElement package, XmlElement& result, MetadataTableHaveEntry[] metadataHave, String& dbStamp, IMetadataRowSets& metadata)
    [02/06/2011 21:47:22]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsBatchUpdateHelper.Submit(Int32 firstItem, Int32 lastItem)
    [02/06/2011 21:47:22] MigrationConsole.exe Information: 0 : WorkItemTracking: Unresolved conflict:
    [02/06/2011 21:47:22]   Session: 583c945a-b2b8-4de3-8090-4a3126506984
    [02/06/2011 21:47:22]   Source: 3e1cfab9-910a-4a92-8c7a-25ff05ac5f48
    [02/06/2011 21:47:22]   Message: Cannot find applicable resolution rule.
    [02/06/2011 21:47:22]   Conflict Type: TFS WIT invalid submission conflict type
    [02/06/2011 21:47:22]   Conflict Type Reference Name: c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374
    [02/06/2011 21:47:22]   Conflict Details: <?xml version="1.0"?>
    [02/06/2011 21:47:22] <InvalidSubmissionConflictDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    [02/06/2011 21:47:22]   <ExceptionType>System.Web.Services.Protocols.SoapException</ExceptionType>
    [02/06/2011 21:47:22]   <ExceptionMessage>Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 21:47:22] Parameter name: index ---&gt; Index was out of range. Must be non-negative and less than the size of the collection.
    [02/06/2011 21:47:22] Parameter name: index</ExceptionMessage>
    [02/06/2011 21:47:22]   <InnerExceptionType />
    [02/06/2011 21:47:22]   <InnerExceptionMessage />
    [02/06/2011 21:47:22]   <ActionData />
    [02/06/2011 21:47:22]   <SourceItemId>3268</SourceItemId>
    [02/06/2011 21:47:22]   <SourceItemRevision>1</SourceItemRevision>
    [02/06/2011 21:47:22] </InvalidSubmissionConflictDetails>
    ```

    Hopefully someone on the team will be able to help me out, but so far I have not been able to get this running…

    On an whim I decided that the Dates might be  the problem all along and that the “Index was out of range” issue was a red hearing. So I commented out all of the date fields in the configuration file and what do you know… the “Index was out of range” errors went way…

    So I dutifully check all of the date input and redo it so that everything is in the correct time zone and that

    ```
    Dim d As Date
    If DateTime.TryParseExact(record.row(i).value, "g", dateProvider, DateTimeStyles.None, d) Then
    ' TODO: Timezone should not be hard coded
    d = TimeZoneInfo.ConvertTimeToUtc(d, TimeZoneInfo.FindSystemTimeZoneById("Eastern Standard Time"))
    ' This is a date but lets get some specific values
    Select Case atc(i).name
        Case "Date Modified"
            newMigIt.ModifiedOn = d
        Case "Date Created"
            newMigIt.CreatedOn = d
    End Select
    ' Then add it to columns
    newMigIt.Columns.Add(atc(i).name, d.ToString("o")) ' TODO: Output format needs to be good
    ```

    **Figure: Refactored code to process the dates to the correct timezone**

    This did nothing! What I eventually had to do was to remove that mapping from the file. So no dates…

    ```
    <MappedFields>
      <MappedField LeftName="Summary" RightName="System.Title" MapFromSide="Left" valueMap="" />
      <MappedField LeftName="Description" RightName="System.Description" MapFromSide="Left" valueMap="" />
      <MappedField LeftName="Severity" RightName="Microsoft.VSTS.Common.Severity" MapFromSide="Left" valueMap="SeverityMapTTP2TFS" />
      <MappedField LeftName="Status" RightName="System.State" MapFromSide="Left" valueMap="StatusMapTTP2TFS" />
      <MappedField LeftName="Reason" RightName="System.Reason" MapFromSide="Left" valueMap="ReasonMapTTP2TFS" />
      <MappedField LeftName="Priority" RightName="Microsoft.VSTS.Common.Priority" MapFromSide="Left" valueMap="PriorityMapTTP2TFS" />
      <MappedField LeftName="Steps to Reproduce" RightName="Microsoft.VSTS.TCM.ReproSteps" MapFromSide="Left" />
      <MappedField LeftName="History" RightName="System.History" MapFromSide="Left" />
      <MappedField LeftName="Assigned To User" RightName="System.AssignedTo" MapFromSide="Left" valueMap="UserMapTTP2TFS" />
      <MappedField LeftName="Verify Version" RightName="Microsoft.VSTS.Build.FoundIn" MapFromSide="Left" valueMap="VerifyVersionMapTTP2TFS" />
      <MappedField LeftName="Closed By" RightName="System.ClosedBy" MapFromSide="Left" />
      <MappedField LeftName="Found by" RightName="Microsoft.VSTS.Common.HowFoundCategory" MapFromSide="Left"  valueMap="HowFoundCategoryTFS" />
      <!--<MappedField LeftName="Date Modified" RightName="System.ChangedDate" MapFromSide="Left" />-->
      <!--<MappedField LeftName="Date Created" RightName="Microsoft.VSTS.Common.CreatedDate" MapFromSide="Left"  />-->
      <!--<MappedField LeftName="Closed Date" RightName="System.ClosedDate" MapFromSide="Left" />-->
      <!-- WORKAROUND using unused field: Manual Testing -->
      <!--
      <MappedField LeftName="@@MISSINGFIELD@@" RightName="Microsoft.VSTS.Common.Triage" MapFromSide="Left" valueMap="TfsTriageMapping" />
      <MappedField LeftName="@@MISSINGFIELD@@" RightName="Microsoft.VSTS.Common.Regression" MapFromSide="Left" valueMap="TfsRegressionMapping" />
      <MappedField LeftName="@@MISSINGFIELD@@" RightName="Microsoft.VSTS.Build.Changelist" MapFromSide="Left" valueMap="TfsChangelistMapping" />
      <MappedField LeftName="Modified By" RightName="System.ChangedBy" MapFromSide="Left" />
      <MappedField LeftName="Created By" RightName="System.CreatedBy" MapFromSide="Left" valueMap="" />
      -->
    </MappedFields>
    ```

    **Figure: New mapping for Bugs**

    There are a number of things to note on the new mapping. After removing all of the Date fields I found that due to coning changes in the Adapter to achieve the “on behalf of” capability I have to remove both the “Modified By” and the “Created By” fields from the mapping otherwise I get a TF223001 error during the mapping.

    [![image](images/image_thumb2-3-3.png "image")](http://blog.hinshelwood.com/files/2011/06/image2.png)
    { .post-img }

    **Figure: Editing on behalf of**

    During the production run the “Created by \[account\]” will be the service account that Team Foundation Server runs under so it will be a little cleaner than having my name plastered all over it. Although it is OK to have the company name there ![Winking smile](images/wlEmoticon-winkingsmile-6-6.png)
    { .post-img }

    ```
    [03/06/2011 16:57:12] MigrationConsole.exe Information: 0 : WorkItemTracking: Processing ChangeGroup #1003, change 3206:1
    [03/06/2011 16:57:13] MigrationConsole.exe Information: 0 : WorkItemTracking: WorkItem type 'Bug' does not contain field 'TfsMigrationTool.ReflectedWorkItemId'. Writing source item Id will be skipped.
    [03/06/2011 16:57:13] MigrationConsole.exe Error: 0 : WorkItemTracking: System.Web.Services.Protocols.SoapException: TF223001: The update package contains more than one entry that sets the value of field System.ChangedBy for work item 1391. ---> TF223001: The update package contains more than one entry that sets the value of field System.ChangedBy for work item 1391.
    [03/06/2011 16:57:13]    at Microsoft.TeamFoundation.WorkItemTracking.Proxy.RetryHandler.HandleSoapException(SoapException se)
    [03/06/2011 16:57:13]    at Microsoft.TeamFoundation.WorkItemTracking.Proxy.WorkItemServer.Update(String requestId, XmlElement package, XmlElement& result, MetadataTableHaveEntry[] metadataHave, String& dbStamp, IMetadataRowSets& metadata)
    [03/06/2011 16:57:13]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.Tfs2010WorkItemServer.Update(String requestId, XmlElement package, XmlElement& result, MetadataTableHaveEntry[] metadataHave, String& dbStamp, IMetadataRowSets& metadata)
    [03/06/2011 16:57:13]    at Microsoft.TeamFoundation.Migration.Tfs2010WitAdapter.TfsBatchUpdateHelper.Submit(Int32 firstItem, Int32 lastItem)
    [03/06/2011 16:57:13] MigrationConsole.exe Information: 0 : WorkItemTracking: Unresolved conflict:
    [03/06/2011 16:57:13]   Session: adea805d-51df-489a-b2fd-9717b4af3703
    [03/06/2011 16:57:13]   Source: 6e3bdf70-f1ae-4cd5-8ee4-133c8aee0857
    [03/06/2011 16:57:13]   Message: Cannot find applicable resolution rule.
    [03/06/2011 16:57:13]   Conflict Type: TFS WIT invalid submission conflict type
    [03/06/2011 16:57:13]   Conflict Type Reference Name: c9d80b52-bb8a-4f7b-a40c-f8f63d6fd374
    [03/06/2011 16:57:13]   Conflict Details: <?xml version="1.0"?>
    [03/06/2011 16:57:13] <InvalidSubmissionConflictDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    [03/06/2011 16:57:13]   <ExceptionType>System.Web.Services.Protocols.SoapException</ExceptionType>
    [03/06/2011 16:57:13]   <ExceptionMessage>TF223001: The update package contains more than one entry that sets the value of field System.ChangedBy for work item 1391. ---&gt; TF223001: The update package contains more than one entry that sets the value of field System.ChangedBy for work item 1391.</ExceptionMessage>
    [03/06/2011 16:57:13]   <InnerExceptionType />
    [03/06/2011 16:57:13]   <InnerExceptionMessage />
    [03/06/2011 16:57:13]   <ActionData />
    [03/06/2011 16:57:13]   <SourceItemId>3206</SourceItemId>
    [03/06/2011 16:57:13]   <SourceItemRevision>1</SourceItemRevision>
    [03/06/2011 16:57:13] </InvalidSubmissionConflictDetails>
    ```

    **Figure: When there are duplicate entries you get a TF223001**

    Once I got rid of the duplicate mappings I started getting data through and I can now get back to the route problem of “Edit” now that “Add” is working again.

    Woot…
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-02-creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-02-creating-a-wit-adapter-for-the-tfs-integration-platform-for-a-source-with-no-history
- FrontMatter:
    title: Anatomy of an Automation for the Tfs Automation Platform
    description: Explore the anatomy of automations for the TFS Automation Platform. Learn how to integrate and deploy extensions effectively for enhanced productivity.
    ResourceId: 5naWQQ14MHe
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3361
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-06-01
    weight: 690
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: anatomy-of-an-automation-for-the-tfs-automation-platform
    aliases:
    - /resources/5naWQQ14MHe
    aliasesArchive:
    - /blog/anatomy-of-an-automation-for-the-tfs-automation-platform
    - /anatomy-of-an-automation-for-the-tfs-automation-platform
    - /resources/blog/anatomy-of-an-automation-for-the-tfs-automation-platform
    tags:
    - Install and Configuration
    - System Configuration
    - Software Development
    - Internal Developer Platform
    categories:
    - Uncategorized
  BodyContent: |
    [![Turk-Automaton](images/Turk-Automaton_thumb1-3-3.gif "Turk-Automaton")](http://blog.hinshelwood.com/files/2011/06/Turk-Automaton1.gif)If you can’t wait for the Tfs Automation Platform, but you still want to eventually deploy your extensions using it, what can you do?
    { .post-img }

    We would really like for you to still be able to build out automations without the Automation Platform, but you would not have the delivery and management aspects. Hopefully this post will guide you on how you can integrate your work with the Tfs Automation Platform later.

    ## Updates (in purple)

    - **2011-06-09 - [Mattias Sköld](http://mskold.blogspot.com/)** – Mattias had a bunch of questions, and I want to provide answers. You will find the questions and answers inline at the relevant sections.
    - **2011-06-10 - [Michael Ockie Fourie](http://mikefourie.wordpress.com/)** – Mike had some very good questions and we are starting to get into specifics and implementation details. This is good as we need to get moving.

    _note: This product is still under development and this document is subject to change. There is also the strong possibility that these are just rambling fantasies of a mad programmer with an architect complex._

    ---

    Well, we will be integrating integrating with many of the TFS elements as proxies so that we can leverage existing code without having to rewrite things. For a rough understanding of the architecture and where you can start building things now lets look at the generic scenario:

    1. **Installation**

       Assemblies and other supporting files are dropped into the correct Plugins folder on the server

    2. **Configuration**

       There is some settings stored somewhere that will control how the process runs

    3. **Action  
       **There are three types of action:

       1. User Action - The user deliberately setts a process running
       2. Event – An event is raised on the server (e.g. WorkItemChangedEvent)
       3. Schedule – A particular time is reached

       > Will User actions trigger events or simply queue an TFS job directly ? Will the automations framework handle Events and simply queue TFS jobs ?  
       > **\-Mattias Sköld**

       User Actions and Events will simply trigger a TFS job :)

    4. **Processing**

       Some amount of work is done

    [![image](images/image_thumb11-1-1.png "image")](http://blog.hinshelwood.com/files/2011/06/image11.png)  
    { .post-img }
    **Figure: Simple diagram showing how an automation gets to run from source**

    ## Installation

    There are a number of places that you need to put files on the TFS Server to have them loaded effectively:

    - Event Handlers (ISubscribers) – C:Program FilesMicrosoft Team Foundation Server 2010Application TierWeb ServicesbinPlugins
    - TFS Jobs (ITeamFoundationJobExtension) - C:Program FilesMicrosoft Team Foundation Server 2010Application TierTFSJobAgentplugins\*

    > Are the two listed above all of them? What about loaded at all? Any specific requirements or is it just basic .net loading?  
    > \- [Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    This is not all of them, bit this is the main places that we will be using for Release 1. For example if you want TFS to load an Event Handler you need to place a .NET 4.0 Assembly into the “~Application TierWeb ServicesbinPlugins” folder above with one or more classes that implement the ISubscribers interface. Something to beware of is that TFS will unload any plugins that produce errors, so everything needs to be handled properly.

    Our installation will be two fold. First is the download of the ".zip” archive containing all of the require files and unpacking them, probably to:

    > c:Program FilesTeam Foundation Server Automation PlatformAutomations\[Automationname\]

    **Figure: Example location of an Automation**

    > Manually?  
    > \- [Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    I would expect that you would select an “Automation” from a provided list and you would click an “Install” button that would automatically download and unpack the .zip file for you. The user would not be required to do this manually and no access to the server would be required.

    > What if two people create the same automation name? any issues? I assume the folder name means nothing and is just a container?  
    > \- [Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    This is one of the reasons that we really need a central store or repository that serves up the automations. It would be responsible for telling a user that they have a duplicate name and need to choose another. I would expect the file to download from [http://downloads.tfsautomationplatform.com/automations/\[automationname\].zip](http://downloads.tfsautomationplatform.com/automations/[automationname].zip) so it would need to be unique.

    > - Anything to consider for x86 vs x64 platforms? Will TFS just load plugins build to anycpu ok or do we need specific bits? I’m thinking anycpu will be ok
    > - We will have to drop the Microsoft in the path ie, just c:Program Files Team Foundation Server Automation PlatformAutomations\[Automationname\]
    > - What will actually create that path? Sounds like we will also deliver an installer to lay some groundwork?\]
    >
    > \- [Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    I think you are right that x86 vs x64 will not be a problem and I have always used “anycpu”. The “Microsoft” in the title was a copy-o (as in copy paste error) and I agree should not be there…

    Yes, We will have an installer that installs the base hooks we need to get onto the system including whatever add in we need to add an extra Tab to Team Web Access and maybe the “Admin Console”. We may want to separate out the “Server Admin” from the “User Admin”.

    The second stage will occur when an administrator “activates” the plugin for your server. This will look for a manifest file in the Automation folder that will tell it what components are part of the Automation. The installer will know where on the server the files need to go and deploy them to that location.

    > How? With what? What installer? Would this be something installed by the installer that lays the groundwork? By location do you mean one of the plugins folders you mention above?  
    > \- [Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    I think I confused Mike. It all makes sense in my head… honestly. Let me try again…

    The Administrator will be able to “Activate” any of the Automations that have been “Installed” in the previous step by opening the Administration UI and selecting to “Activate” an Automation. The Activation process consists of the system automatically deploying, according to a manifest or other method, each of the relevant Assemblies and other files to the location it needs to be in to run. It may be that we can “proxy” some of the loads so we do not have to physically move the file, but I am not relaying on that in my architecture. We may need to physically copy Assemblies into a specific folder for TFS to load it correctly. This process would be conducted on the TFS server by something that we have installed there. I am being deliberately vague as we have no POC yet to know what that might be.

    ## Configuration

    For configuration we are probably going to have a class that holds the settings that is serialised and stored in TFS as Property's. This will allow us to have both static and instance config, but I would not worry about were these are currently stored as you will probably need to have your own storage mechanism for now. There are really two sorts of automations. Ones that can only have one instance, and those that can be configured multiple times with multiple settings. If an automation is if the multiple flavour then there will likely me more than once instance of the configuration.  If you are curious on the current thinking:

    <table border="0" cellspacing="0" cellpadding="2" width="654"><tbody><tr><td valign="top" width="241"><strong>Category</strong></td><td valign="top" width="159"><strong>Name</strong></td><td valign="top" width="252"><strong>Value</strong></td></tr><tr><td valign="top" width="241">Tfs<font color="#9b00d3">Automation</font>Platform</td><td valign="top" width="159">Generic</td><td valign="top" width="252">Generic <font color="#9b00d3">Automation</font> Platform settings and configuration</td></tr><tr><td valign="top" width="241">Tfs<font color="#9b00d3">Automation</font>Platform</td><td valign="top" width="159">Plugins</td><td valign="top" width="252">List of installed plugins and their current status</td></tr><tr><td valign="top" width="241">Tfs<font color="#9b00d3">Automation</font>Platform</td><td valign="top" width="159">Mappings</td><td valign="top" width="252">List of TFS objects and which plugins are mapped to each one</td></tr><tr><td valign="top" width="241">Tfs<font color="#9b00d3">Automation</font>Platform -[Automation]</td><td valign="top" width="159">Default</td><td valign="top" width="252">Default and single instance settings</td></tr><tr><td valign="top" width="241">Tfs<font color="#9b00d3">Automation</font>Platform -[Automation]</td><td valign="top" width="159">[Instance]</td><td valign="top" width="252">Settings that pertain to an individual configured instance of an automation</td></tr><tr><td valign="top" width="241">&nbsp;</td><td valign="top" width="159">&nbsp;</td><td valign="top" width="252">&nbsp;</td></tr></tbody></table>

    **Figure: Where will the data be stored**

    > So help me clarify, does an administrator install these automations at the TFS instance level or Collection level or Project Level? If we are targeting Project level granularity, then we need to be able to isolate different versions of automations as some Projects may require a diff version. Also, some projects may not want the automation to even be available.. Also, we should discover automations in a bubble down manner. So if we have n instance with 1000s projects, we can install once at the instance level and all TPCs / projects get it. Then a selective few can get different version / other automations. Am I making sense?  
    > \- [Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    Kind of… All Automations are installed and activated at the Server level. this would then make them “available”. Some Automations would require some “Admin” configuration to be set while others would not. Now that we have an automation installed and any high level configuration set (like “domain” or “server URL”, or some other thing that does not vary) we can consider where we would like to have it running.

    Automations should be able to target Server, Collections, Team Projects, Areas, Iterations, Branches or some combination. The mapping data above, stored in “Mappings” was likely to store a list of “targets” (TPC, TP, Branch), the Automation and the “instance”. This should give us enough information to configure and run in any of your combinations above.

    As Automations can be set at any level they need to be evaluated from the top down and can only be configures by someone with permission at that level. I had planned to query the TFS servers own security to work out who has permission.

    With the scaling issue above we will probably need to come up with a seriously efficient way of managing that data. I am not opposed to having a database “Tfs_Automation” like the Integration Platform does if it makes more sense.

    Any UI required to edit the plugin data will need to be included in the package and we have not yet decided how this should happen. With .NET it is a little more difficult to inject UI and it will probably end up being Silverlight.

    [![image_thumb5](images/image_thumb5_thumb-2-2.png "image_thumb5")](http://blog.hinshelwood.com/files/2011/05/image_thumb51.png)  
    { .post-img }
    **Figure: Injecting UI in Silverlight is easy**

    > Sounds like you have some thoughts on this already ? Will the UI download Action specific UI to inject ?  
    > **\-Mattias Sköld**

    That is the idea. Probably need to look at what plugin options are available for Silverlight as that is currently the most likely Admin delivery medium.

    > oh wow, so we need to deliver a generic UI engine too? Is that easy? Not tried it.  
    > Yeah, invest in the future ;-). Seriously though, not a WPF form? Found this: [http://www.tanguay.info/web/index.php?pg=codeExamples&id=186](http://www.tanguay.info/web/index.php?pg=codeExamples&id=186)\]  
    > \- [Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    In fact I had though of it not being “generic”, but more like providing a “Panel” that is a template location for the user to inject their own UI. We would provide the static UI for all plugins and then they can have us load whatever they set. I have done this a little before and while a little fiddly to setup and interact with it beats trying to recreate the WIT forms!

    > ok cool I’ll take your word for it. I never thought much of UI’s for this project. Hope they don’t complicate things  
    > \- [Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    Did you expect user to have to edit XML to apply settings?

    ## Action

    Although there are a number of types of action, the goal is the same; to add a Job to the Job Queue in TFS that will do the processing. The action can be triggered either by the user or when an event is fired in TFS.

    ### Server Side Actions

    If it is a user interaction that caused the action then there was probably a Silverlight UI assembly or package stored within the installable Automation Package. When it was unpacked the new UI became available.

    It it was a server event driven action then an assembly with a class that implements ISubscriber was installed to the Plugins folder of the website where it was loaded into the pipeline for events.

    The result is that configuration will be added to “TfsIntegrationPlatform-\[Automation\]” that will be loaded by the TFS Job next time it is run.

    **_NOTE: If you build normal server side event handlers then we will try to allow you to wrap them later with minimal code changes_**

    ### Client Side Actions

    If the action was based on a Check-In Event on the client or server then the assembly that contained the Check-In Policy was loaded into the correct place and the correct registry entries added. There was previously some progress in this direction with the Power Tools, but it was difficult to implement and little known.

    > huh? Are these events raised on client and server?  
    > \- [Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    While Check-In Policy integration is WAY out of scope for Release 1, we do need a client install to inject some menu options into Visual Studio at the appropriate place. This also lays the groundwork for getting onto the client.

    **_NOTE: If you build normal CheckIn Policies we will try to allow you to wrap them later and deploy as part of an Automation package without having to change the code._**

    ## Processing

    The processing is where the magic happens and in order to provided some level of robustness this should be run on the  TFS Job Agent (ITeamFoundationJobExtension) that can be restarted when the server is rebooted. Once the “Action” has updated the correct settings for the Automation the Job will queued. When the Job runs it will load its settings from at “TfsIntegrationPlatform-\[Automation\]” and run through each configured instance as needed.

    The only communication between the outside world and the Job is through the settings stored as TFS Properties.

    > _V1?  
    > \- [Michael Ockie Fourie](http://mikefourie.wordpress.com/)_

    Indeed it would be a v1 feature as we need somewhere to run the processing. Think of it like some triggers and then an engine. The trigger just makes sure that the engine is run so all our Tfs Event or User Event gas to do is add a job to the job queue. Scheduling can also be taken care of by the Job Queue.

    **_NOTE: If you build a ITeamFoundationJobExtension then we will try to allow you to wrap it later with minimal code changes_**

    ## Conclusion

    It should be possible for you to create iSubscribers, ITeamFoundationJobExtension and PolicyBase classes that perform your needs and we will allow you to package them separately or together with space for a UI and other functionality later.

    There is no reason not to extend TFS now and once the TFS Automation Platform releases there will be no need to ever install another extension again ![Smile](images/wlEmoticon-smile2-4-4.png) apart from the TFS Automation Platform itself…
    { .post-img }
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-01-anatomy-of-an-automation-for-the-tfs-automation-platform\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-01-anatomy-of-an-automation-for-the-tfs-automation-platform
- FrontMatter:
    title: How might we implement the Change Iteration Automation for the Tfs Automation Platform
    description: Explore the implementation of Change Iteration Automation for the TFS Automation Platform, enhancing efficiency in managing queries across sprints.
    ResourceId: sE7yYXG4Th_
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3383
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-06-01
    weight: 690
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: how-might-we-implement-the-change-iteration-automation-for-the-tfs-automation-platform
    aliases:
    - /resources/sE7yYXG4Th_
    aliasesArchive:
    - /blog/how-might-we-implement-the-change-iteration-automation-for-the-tfs-automation-platform
    - /how-might-we-implement-the-change-iteration-automation-for-the-tfs-automation-platform
    - /resources/blog/how-might-we-implement-the-change-iteration-automation-for-the-tfs-automation-platform
    tags:
    - Software Development
    preview: metro-visual-studio-2010-128-link-4-4.png
    categories:
    - Uncategorized
  BodyContent: |
    [![Turk-Automaton](images/Turk-Automaton_thumb-5-5.gif "Turk-Automaton")](http://blog.hinshelwood.com/files/2011/06/Turk-Automaton.gif)
    { .post-img }

    As we get organised to start development on the Tfs Automation Platform there is the need to do in-depth investigations into the way things are going to work.

    > “Epic 1: As Dave or Gary I want WIQL queries to be automatically updated when I move from iteration to iteration+1 or sprint to sprint+1”

    ## Updates (in purple)

    - **2011-06-10 - [Michael Ockie Fourie](http://mikefourie.wordpress.com/)** – Although Mike called these out as “a few random thoughts” I think that they are still things that need answered around capacity planning and resilience.

    **note: This product is still under development and this document is subject to change. There is also the strong possibility that these are just rambling fantasies of a mad programmer with an architect complex.**

    ---

    This story revolves around on of the most common iteration issues. When I progress from working on “\[Team Project\]R1Sprint 1” to working on “\[Team Project\]R1Sprint 2” I have to go through all of the queries that I created in the “Current Iteration” folder and update each of the Queries to reflect the new Sprint.

    [![image](images/image_thumb20-1-1.png "image")](http://blog.hinshelwood.com/files/2011/05/image27.png)  
    { .post-img }
    **Figure: All the “Current Sprint” queries need changed**

    Although in this example there are only 6 queries I have worked with teams that have many many queries in this list. I have worked with still more teams that keep creating “Sprint \[X\]” folders and duplicating queries, but that tis another storey.

    If there are many queries (15+) it may take more than a minute to edit them. That is enough time for a user doing this manually to get distracted and forget where they are in the list. Not good… on top of that this job is just plain boring and is what computers were made to do.

    > Is it not possible to just run a sql script which does this?  
    > \-[Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    Any use of SQL against the TFS Database would result in your TFS database being in an unserviceable state. Even the Integration Platform is not allowed to do any database work ![Smile](images/wlEmoticon-smile-6-6.png)
    { .post-img }

    Enter the TFS Automation Platform and one of the core automations of the TFS Iteration Automation project. What we need is a “Change Iteration” option on the menu of Team Explorer…

    [![image](images/image_thumb21-2-2.png "image")](http://blog.hinshelwood.com/files/2011/05/image29.png)  
    { .post-img }
    **Figure: Changing the Iteration should be obvious and easy**

    I can now only apologise for my diagrams ![Smile](images/wlEmoticon-smile1-7-7.png) I am not the best drawer. There will likely be some sort of configuration screen where you can select options for enabling this Automation. For example, are you using Area’s as sub projects? If you are then a whole new dimension opens up for having multiple nested queries.
    { .post-img }

    You would also need to be able to select, for each of your Projects (wither they be Team Projects or Area Projects) which folder to use as your “Current Sprint” folder so the system knows which queries to change.

    [![image](images/image_thumb22-3-3.png "image")](http://blog.hinshelwood.com/files/2011/05/image30.png)  
    { .post-img }
    **Figure: Setting the new values for Current Iteration**

    When the user selects the “Change” option the application will queue the TfsAutomation.Iteration.ChangeIterationJob on the TFS Job Service for execution.

    > What sort of processing times are we looking at for these queued jobs to be executed?  
    > \-[Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    I would expect the job to start almost instantly, but it would depend on the server load. I certainly would not expect this job to take any longer than a few seconds to run with minimal lag.

    This will provide some level of resilience in case of the server being restarted during the process.

    > Is this a realistic concern? I’m guessing our automation will run in < 10seconds. TFS uptime should be 99% + in organisations  
    > \-[Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    Although it is not likely for this type of collision to happen for this to happen and for this automation it would not really matter, there will be other automation where it will. We need to be consistent in our deployment and implementation between Automations in order to be able to automatically deploy and manage effectively.

    It will also provide an easy way to protect ourselves from 2 users trying to achieve the same task at the same time.

    > Is this a realistic concern? Even in large organisations, how many people would (and have permission) to change the active iterations for example  
    > \-[Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    Only likely to be “Project Administrator”, but if there were 1000 projects… So for this automation I agree, not likely, and how much of a big deal is it anyway. I can however imagine occupancies where is does matter.

    We can check to see if the Job is already running before starting it and prevent another from starting.

    > I fear over complexity here. What am I missing  
    > \-[Michael Ockie Fourie](http://mikefourie.wordpress.com/)

    This particular automation is a very short run thing, but there may be others that take much longer to run. I may want to add rollup to my process template, send emails to everyone that has something checked out for longer than 5 days or delete all workspaces that have not been accessed in 3 months. There are many things that could take time and the Platform needs to be considerate of that.

    This process will be a welcome first addition to the TFS Automation Platform and it looks like it is going to exercise at least the UI, Configuration and TFS Job Service sections that we plan on building.

    I am really looking forward to getting started on this…
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-01-how-might-we-implement-the-change-iteration-automation-for-the-tfs-automation-platform\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-06-01-how-might-we-implement-the-change-iteration-automation-for-the-tfs-automation-platform
- FrontMatter:
    title: What is the Tfs Automation Platform
    description: Discover the TFS Automation Platform, designed to streamline iteration management and enhance automation in TFS. Unlock efficiency in your development process!
    ResourceId: AavdFKxGJg9
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3373
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-05-31
    weight: 790
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: what-is-the-tfs-automation-platform
    aliases:
    - /resources/AavdFKxGJg9
    aliasesArchive:
    - /blog/what-is-the-tfs-automation-platform
    - /what-is-the-tfs-automation-platform
    - /resources/blog/what-is-the-tfs-automation-platform
    tags:
    - Software Development
    - Internal Developer Platform
    preview: metro-visual-studio-2010-128-link-2-2.png
    categories:
    - Uncategorized
  BodyContent: |
    [![Turk-Automaton](images/Turk-Automaton_thumb2-3-3.gif "Turk-Automaton")](http://blog.hinshelwood.com/files/2011/06/Turk-Automaton2.gif)The TFS Automation Platform is a project that will be developed initially as the [TFS Iteration Automation](http://blogs.msdn.com/b/willy-peter_schaub/archive/2011/02/20/new-rangers-project-tfs-iteration-automation.aspx) project for the Rangers, but which has a grander  vision to solve a need for customers to have things just happen within TFS.
    { .post-img }

    Currently, the scope of this project is to create automations that assist with iteration management, but my eventual goal for this project is to enable a wide variety of automation solutions. This platform enables the development of three major classifications of automations: automations that can be called on a schedule; automations that can respond to an event in TFS; automations that can be called on demand.

    ## Updates

    - **2011-06-09 - Mattias Sköld** – Mattias had a bunch of questions, and I want to provide answers. You will find the questions and answers inline at the relevant sections.

    **note: This product is still under development and this document is subject to change. There is also the strong possibility that these are just rambling fantasies of a mad programmer with an architect complex.**

    ---

    ## Releases

    This project is an anomaly in the wave of new [Visual Studio ALM Ranger projects,](http://msdn.microsoft.com/en-us/vstudio/ee358786) whereby we are trying something new. Instead of the Rangers creating, owning and maintaining the project, we are trying a two-phased approach with this project:

    1. [Release 1 - TFS Iteration Automation](http://blogs.msdn.com/b/willy-peter_schaub/archive/2011/02/20/new-rangers-project-tfs-iteration-automation.aspx "Release 1 - TFS Iteration Automation") – Ranger project, which delivers core value to the Rangers community … automating the painful administration of fixing queries when switching iterations. The other value is to deliver an extensible platform for release 2 and beyond.
    2. Release 2+ - Community project, owned/driven by external Rangers to extend the Release 1.0 product.

    ## TFS Automation Platform Scope

    Team Foundation Server is currently comprised of several major feature areas, including, version control, work item tracking, build automation, reporting, and SharePoint.

    At this point in time, the TFS Automation Platform is scoped to only support a the following TFS features:

    - Work Item Tracking

    ## TFS Automation Platform Vision

    The TFS Automation Platform is a development platform for partners and customers who are interested in building automations against TFS. One goal of the project is to make it simple to write a simple automation to perform some action. We intend to build a reusable framework with the ability to provide a menu of “automations” from a server that can be configured and/or run from any client with a single install on that client. An administrator would be able to add “automation” to a “menu” that allows users with appropriate permissions to select and configure those “automations” from a Visual Studio integrated UI at the Server, Collection, Project or Branch level.

    An install on either the client or the server would only be required when the platform is updated and not to add “automations”. Think of it like the Wordpress Plugin system.

    ## Tfs Automation Platform Architecture

    The purpose of this section is to help the team understand the way that the system goes together without locking them into an tight architecture at this early stage in the process.

    [![image](images/image_thumb16-1-1.png "image")](http://blog.hinshelwood.com/files/2011/06/image16.png)  
    { .post-img }
    **Figure: TFS Automation main components brainstorm**

    ### Automaton Package

    With the need to run everything on the server to alleviate installs and maintained client side I would expect to have a package created (CurrentIteration.auto) that can be upload to the server and contains a manifest to describe its contents and where those content will reside.

    - UI -
    - ISubscribers
    - Tfs Jobs
    - Check In Policies
    - Request Filters
    - etc…

    A folder naming should be maintained that relates as closely as possible to standard TFS naming. These packages will be stored in a “Store” that is accessed through a model that allows Multiple stores to be made available and combined for presentation to the users.

    Where possible all automations should reflect the same API’s used within TFS in order to maintain feature parity and allow the development team to concentrate building against the TFS API. This will also allow an exacting ease of transitioning any existing Automations to this platform.

    For those Automations that do not need a UI, but instead only require an “Enabled/Disabled” option the platform should provide this by default.

    _note: It should be possible to turn an existing CheckinPolicy or ISubscriber into an Automation Package with winzip and notepad._

    > I’m not really sure if that’s should be a requirement, I was expecting a lot more information to be transformed with code through a decorated Interface. I guess you plan to accomplish the same through some kind of manifest/config files ?  
    > I can see both advantages and disadvantages with putting metadata in code and config files…  
    > **\-Mattias Sköld**

    No matter what decoration you did a manifest would still be required. For example, for an Automation that sends emails you would probably have an .htm email template. Where would you put that? How would you know that it even existed? Much better to have an XML file that lists where everything should go. We can however do a bunch of extra checks like:

    - Don't put a ISubscribe in the job folder

    These are all things that will help, but the core will be the manifest

    _note: Some automations are single instance and others can be configured for multi-instance_

    ### Visual Studio Extension

    This will likely be that main UI for users wishing to access and configure Automations. Any features that are beyond the default should be provided by a call to the server. There are a number of ways to achieve this that are built into .NET, from deep-linking into Silverlight and WPF, to the ability to instantiate a class that is contained in a DLL on the server. These all provide a level of extensibility that would allow a zero based (or at least infrequent) client install which is one of the goals.

    My current bias is for a WPF application that is provided by the server and an add-on component for the Visual Studio client that loads a list of extension points from the server. The server would provide a list of GUID, image, text and URL to link to. The URL’s would be deep links into a single instance WPF application that is deployed from the server via ClickOnce. This should make it possible to frequently update the UI from the server without having to continuously force users to install updates.

    ### TfsAutomation.Platform.Core (Web Service or System Service)

    The core platform should provide the core services for setting up and maintaining the platform. It will likely:

    - Download chosen Automation packages from source store
    - Storage of all unpacked Automations
    - Keep all Automation Packages updated
    - Deploy files to the correct locations
    - retract the correct files and configurations
    - Store instance configuration for Automations

    The idea is that the core service will keep all of the Automation up to date and deploy them on demand to the correct location within TFS is required.For example, while I think we can easily proxy the Event Model, it would be a lot more difficult to proxy the Job model.

    ### TfsAutomation.Platform.Store (Web Service and Aggregation)

    The PackageStore provides all of the automation packages that are available along with any meta data that is required. The system should be able to load from one or more stores simultaneously. This will allow smaller organisations or individuals to take advantage of a hosted store, or many hosted stores. This again allows for less installation changes as users can choose to load automations from external lists that are maintained separately.

    > I don’t get this Multi Store thing ? Ive envisioned a “store” for each team project collection. Will we supply multi stores – what is the benefit of multi stores and what will a store relate to ?
    >
    > I was thinking more of an Automation Manager for project collections (compare to Process template manager).  
    > **\-Mattias Sköld**

    The Store refers to a source of plugins and not the list of installed plugins. Plugins are downloaded from the store prior to being installed and activated. The Store can be hosted locally for enterprises or for the vast majority of customer we can provide a hosted store that we maintain (MSDN Free Azure). In either regard think of the store like [http://wordpress.org/extend/plugins/](http://wordpress.org/extend/plugins/)

    ### TfsAutomation.SincProxy (ISubscriber)

    The SinkProxy is a hook into the eventing model that will redirect events into the correct Automation Package for the Tfs Event that is fired. It will be responsible only for making sure that the correct event handlers are fired with the correct configuration.

    _note: Configuration is set by the UI and stored by the Platform Core._

    _note: I did indeed mean “Sink” and not “Synch”._

    > In order to provide a reliable extension framework I would like the SincProxy to be responsible for providing isolation in the cases there it can be provided. For example if I make an automation that is async , I would like the Framework to que the execution of my automation in a separate process . This might be a less of a problem from a technical view if actions use the tfsJob for asyncronous work... For a TFS Admin it might be an issue to enable custom code if it will run inside the TFS process. If Im not misstaken the Tfs Job Agent by default is a bit to infrequent to provide a reasonable fast response for actions started from the UI, but I suspect you have a solution for this ?  
    > **\-Mattias Sköld**

    All processing will be done as part of the TFS Job and not in the SincProxy. Once you are in the running Job you can do that you are referring to, but you will need to handle the main thread waiting for the async one. The SincProxy is just one way of getting a job queued.

    ### TfsAutomation.RequestFilterProxy (ITeamFoundationRequestFilter)

    For certain types of automation, like auditing, there is the need to have an injected filter on all requests so we can implement auditing.

    ### TfsAutomation.CheckInPolicyProxy (PolicyBase)

    This is a single Check-In Policy that will proxy to any number of Check-In Polices that have been enabled server side. These policies are enabled as part of Automations and run Locally on the client. However the assemblies can be downloaded prior to execution from the Platform.Core service.

    ## Scenarios

    There are really two scenarios I want to concentrate on for testing the TFS Iteration Automation release.

    ### Scenario 1: Change current iteration

    When we get to the end of an iteration we need all of the queres in the “Current iteration” folder to reference “project1R1I2” rather than “project1R1I1”

    1. **User logs onto TFS Automation UI and installs the “Current Iteration Changer” automation from the Store**
       1. TfsAutomation Core downloads the selected Automation and unpacks it locally.
       2. TfsAutomation Core deploys the correct files to the correct location defined in the manifest
       3. TfsAutomation sets automation to only work at the Project Level
    2. **User enables the “Area/Iteration Rename Fixer”**
       1. TfsAutomation UI adds the default configuration for the new Automation
    3. **User configures the “Area/Iteration Rename Fixer” for the Team Project “TeamProject1”**
       1. TfsAutomation UI adds the configuration for the new Automation to that team project and configures the folder that contains the current iteration queries
    4. **User right-clicks on their Team Project and selects “Change Iteration”**
       1. TfsAutomation shows the UI to let the user select an iteration to change to
       2. TfsAutomation UI adds TfsAutomation.Iterations.ChangeCurrentJob to the TFS Jobs queue
       3. Job runs and does a replace in all of the queries in that project for the change.
       4. **Done** – Notify original calling user that the task is complete

    ### Scenario 2: User renames Iteration

    When the user renames an iteration then a job needs to be kicked off that will fix all queries that use that iteration.

    1. **User logs onto TFS Automation UI and installs the “Area/Iteration Rename Fixer” automation from the Store**
       1. TfsAutomation Core downloads the selected Automation and unpacks it locally.
       2. TfsAutomation Core deploys the correct files to the correct location defined in the manifest
    2. **User enables the “Area/Iteration Rename Fixer” at the Server level**
       1. TfsAutomation UI adds the configuration for the new Automation
    3. **User renames Iteration**
       1. Tfs Iteration Changed event fires on server
       2. TfsAutomation.SincProxy captures event and runs all appropriate “inner” subscribers
       3. TfsAutomation.Iterations.RenameSubscriber subscriber is run and adds TfsAutomation.Iterations.RenameJob to the TFS Jobs queue
       4. Job runs and does a replace in all of the queries in that project for the change.
       5. **Done** – Notify original calling user that the task is complete

    ## Conclusion

    This poses to be a very interesting project if we can get the resource together to be effective. The idea is to start small, so expect to see some smaller, more focused architectures coming down the line.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-05-31-what-is-the-tfs-automation-platform\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-05-31-what-is-the-tfs-automation-platform
- FrontMatter:
    title: What about hosting the Tfs Automation Platform
    description: Explore the hosting options for the TFS Automation Platform, balancing functionality and server-side components for optimal performance in cloud environments.
    ResourceId: je145Y3qB7P
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 3365
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-05-31
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: what-about-hosting-the-tfs-automation-platform-2
    aliases:
    - /resources/je145Y3qB7P
    aliasesArchive:
    - /blog/what-about-hosting-the-tfs-automation-platform-2
    - /what-about-hosting-the-tfs-automation-platform-2
    - /what-about-hosting-the-tfs-automation-platform
    - /blog/what-about-hosting-the-tfs-automation-platform
    - /resources/blog/what-about-hosting-the-tfs-automation-platform-2
    tags: []
    preview: metro-visual-studio-2010-128-link-1-1.png
    categories:
    - Uncategorized
  BodyContent: |
    [![](images/4810.TFSonAzure.jpg)](http://blogs.msdn.com/cfs-file.ashx/__key/communityserver-blogs-components-weblogfiles/00-00-01-44-14/4810.TFSonAzure.jpg)I have been asked what would be the process or support for hosting the Tfs Automation Platform either from a hosting provider, or in the cloud if we have server side components. If you are not familiar with TFS on Azure make sure you read:
    { .post-img }

    - [Update on TFS on Azure](http://blogs.msdn.com/b/bharry/archive/2011/05/18/update-on-tfs-on-azure.aspx) from [Brian Harry](http://blogs.msdn.com/b/bharry)
    - [“To the cloud” with TFS](http://blogs.msdn.com/b/bryang/archive/2011/05/20/to-the-cloud-with-tfs.aspx) from [Bryan Group](http://blogs.msdn.com/b/bryang)
    - [The Future of Microsoft Visual Studio Application Lifecycle Management](http://channel9.msdn.com/Events/TechEd/NorthAmerica/2011/FDN03) on [Channel 9](http://channel9.msdn.com/)
    - [Team Foundation Server on Windows Azure Preview](http://www.microsoft.com/visualstudio/en-us/team-foundation-server-on-windows-azure-preview "http://www.microsoft.com/visualstudio/en-us/team-foundation-server-on-windows-azure-preview")

    **note: This product is still under development and this document is subject to change. There is also the strong possibility that these are just rambling fantasies of a mad programmer with an architect complex.**

    ---

    The Platform architecture currently involves extensive server side components. In fact almost all of the functionality is provided from the server from configuration to implementation.

    I have thought about this a lot and although I recognise the problem I would not want to sacrifice functionality for this scenario. Although some of the functionality would be possible a large chuck of possible features as well as all of the resilience would be severely impaired by removing the server side components.

    It would be up to the hosting provider to install the server-side components to enable the user to use this system. Think of it like the Wordpress Plugin system. Some hosting providers allow you to have any plugin you like, while others require that you can only select from a list of approved plugins.

    I would want to make it as easy as possible to configure the hosted TFS server to only load “Automation packages” from a Store provided by the host themselves. For example if they deployed a managed server on “nwcadence.tfsazure.com” they would also deploy the server side components and configure it to look at “automationstore.tfsazure.com” that would provide a vetted list of add-ons. I do want to look at the possibility of having a kind of “validated proxy” as part of the store so a “Super Admin” can log into the proxy and approve updates and new Automations from the central store.

    In saying that, although I have thought about it, that by no means guarantees that this feature will be above the cut line for Release 1.

    _Boy, I am sounding more Microsoft by the year!_

    I would be very interested in what you think of the option to have a client only install.

    What functionality would we loose if we settled for client ony:

    - **No additional client installs (apart from framework updates)** If components are  not loading from a server then there would need to be frequent updated to the client tool. This would not be so bad with a small user base (<5) but once you get more (>5) then it becomes unworkable and no longer a viable solution.
    - **Resilience from communication or infrastructure problems** What happens when the server is rebooted, or a user looses VPN?
    - **Multi-User support** What if two users perform the same task at the same time. We have customers who have 500+ users, the chances of a conflict are high. How does one user change the configuration setup by another user?
    - **more…**

    What do you think, are the features above important?
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-05-31-what-about-hosting-the-tfs-automation-platform-2\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-05-31-what-about-hosting-the-tfs-automation-platform-2
- FrontMatter:
    title: In-Place upgrade of TFS 2008 to TFS 2010 with move to new domain
    description: Learn how to successfully upgrade TFS 2008 to TFS 2010 while migrating to a new domain. Follow expert tips to avoid common pitfalls and ensure a smooth transition.
    ResourceId: LSYjtifbvOt
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 5
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-04-19
    weight: 665
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: in-place-upgrade-of-tfs-2008-to-tfs-2010-with-move-to-new-domain
    aliases:
    - /resources/LSYjtifbvOt
    aliasesArchive:
    - /blog/in-place-upgrade-of-tfs-2008-to-tfs-2010-with-move-to-new-domain
    - /in-place-upgrade-of-tfs-2008-to-tfs-2010-with-move-to-new-domain
    - /resources/blog/in-place-upgrade-of-tfs-2008-to-tfs-2010-with-move-to-new-domain
    tags:
    - Install and Configuration
    - Windows
    - Software Development
    - Troubleshooting
    - System Configuration
    - Release Management
    - Azure DevOps
    - Technical Mastery
    preview: metro-visual-studio-2010-128-link-24-24.png
    categories:
    - Uncategorized
  BodyContent: |
    [![vs2010logo](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159vs2010logo_thumb-22-22.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159vs2010logo_2.png)I had a particularly complicated upgrade this time that required me to do two things:
    { .post-img }

    - In-Place upgrade of TFS 2008 to TFS 2010
    - Move new TFS 2010 server from one domain to another

    I followed [Vasu Sankaran](http://blogs.msdn.com/b/vasu_sankaran/)’s post on [Guidance for upgrading to TFS 2010 along with domain move](http://blogs.msdn.com/b/vasu_sankaran/archive/2010/05/11/guidance-for-upgrading-to-tfs-2010-along-with-domain-move.aspx) to make sure I did not fall into any of the known pitfalls, but unfortunately everything went screwy when we tried to move domain.

    WARNING: Do not install Team Foundation Server SP1 as part of your Upgrade and domain migration; Do it after!

    UPDATE: 2012-02-28 - Microsoft re-released the Service Pack to fix a bunch of issues with this!

    ---

    There are a number of things we need to accomplish:

    1. In-place Upgrade of Team Foundation Server 2008 to Team Foundation Server 2010
    2. In-place upgrade of Team Foundation Build 2008 to Team Foundation Build 2010
    3. Move Team Foundation Server 2010 Team Project Collection to a new Domain

    ### #1 In-place Upgrade of Team Foundation Server 2008 to Team Foundation Server 2010

    The best way to do a domain migration of TFS 2008 and upgrade to TFS 2010 is to do the upgrade first. The [**Identities Change**](http://msdn.microsoft.com/en-us/library/ms253054.aspx) commands required to do the migration are much more stable under TFS 2010.

    1.  Run Best Practice Analyser for Team Foundation Server 2008 and fix all problems found[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_3-14-14.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_8.png)  
        { .post-img }
        **Figure: There are always things highlighted in the BPA. Luckily these were all easily fixed**
    2.  Backup all TFS 2008 databases*note: Make sure you remember to take the Reporting Services Key* [![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_1-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_4.png)  
        { .post-img }
        **Figure: With TFS 2008 there are a lot of databases to backup.  
         **
    3.  Uninstall Team Foundation Server 2008It is a LOT easier to uninstall TFS 2008 than it ever was to install it ![Smile](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159wlEmoticon-smile_2-23-23.png)
        { .post-img }
    4.  Install Team Foundation Server 2010 (But do not configure)
    5.  Install Team Foundation Server 2010 Service Pack 1 – Do not do this!
    6.  Configure Team Foundation Server 2010Select the “Upgrade”  option to upgrade the exiting TFS 2008 databases to TFS 2010. The wizard will find all of the valid databases on any instance of SQL you specify.[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb-21-21.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_2.png)  
        { .post-img }
        **Figure: The Upgrade process took around 30 minutes for ~3GB of data**
    7.  Configure Team Foundation Build 2010 Controller[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_4-17-17.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_10.png)  
        { .post-img }
        **Figure: I am running the Team Foundation Build Controller on the TFS Server**
        In cases of low load I always run the Team Foundation Build Controller on the same server as Team Foundation Server. This allows for less servers under low load and simplifies the topology.
    8.  Install Visual Studio 2010 Team Explorer
    9.  Install Visual Studio 2010 Service Pack 1
    10. Test new environment (Create Team Project | Connect to Source Control | Connect to Work Item Tracking | Run a Build)[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_5-18-18.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_12.png)  
        { .post-img }
        **Figure: Agile 5 sandbox**
    11. ## Backup Team Project Collection\*This is just a precautionary backup so I can get back to this point if I need to. I also have backups for the Team Foundation Server 2008 databases.
    12. Run Best Practices Analyser 2010[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_7-19-19.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_16.png)  
        { .post-img }
        **Figure: Acceptable errors**
        I am OK with these errors as they will not impact the domain move.

    ### #2 In-place upgrade of Team Foundation Build 2008 to Team Foundation Build 2010

    Upgrading Team Foundation Build is even simpler than upgrading Team Foundation Server. Make sure however that you clean up all of the old build details as the upgrade will create “controllers” for all of the Build servers that you currently have.

    1. Uninstall Team Build 2008
    2. Install Team Build 2010
    3. Configure Team Build 2010
    4. Connect to Controller on TFS 2010 Server
    5. Test Build servers  
        [![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_15-4-4.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_33.png)  
       { .post-img }
       **Figure: Woot, a build just runs**This is an Upgraded project so all of the builds are just wrapped “TFSBuild.proj” files.
    6. Test All existing build definitions still run[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_17-5-5.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_36.png)  
       { .post-img }
       **Figure: Its even better when ALL of the builds work**
    7. Clean off all old Build Servers

    I was very surprised that all of the builds still worked, but there is currently limited validation as part of these existing builds.

    At this point the system works perfectly. I am able to connect to TFS, detach and reattach the collection as well as do builds and work with code. Little did I know that there was a gremlin hidden in the mix.

    ### #3 Move Team Foundation Server 2010 Team Project Collection to a new Domain

    It is now time to follow the documentation for [Moving Team Foundation Server from One Environment to Another](<http://msdn.microsoft.com/en-us/library/ms404883(v=VS.100).aspx>), but with the caveat that we are only migrating the Team Project Collection and not changing the domain of the old Team Foundation Server.

    1.  Remove all accounts from new Team Foundation Server 2010  
         Why you might ask! [Guidance for upgrading to TFS 2010 along with domain move](http://blogs.msdn.com/b/vasu_sankaran/archive/2010/05/11/guidance-for-upgrading-to-tfs-2010-along-with-domain-move.aspx)
        [![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_18-6-6.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_38.png)
        { .post-img }
        **Figure: make sure there are no groups with the same users**
    2.  Install Team Foundation Server 2010 (But do not configure)
    3.  Install Team Foundation Server 2010 SP1 – Do not do this!
    4.  Install Team Explorer 2010
    5.  Install Visual Studio 2010 SP1 – Do not do this!
    6.  Install SQL Server 2008 R2 Client toolsYou need this to connect to Analysis Services on a remote computer[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_9-20-20.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_20.png)  
        { .post-img }
        **Figure: You get TF255040 if you don’t have the client tools installed**
    7.  DBA Installed SQL Server (Database Engine | Analysis Services | Reporting Services)[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_14-3-3.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_30.png)  
        { .post-img }
        **Figure: I always get caught by this one**
        Make sure that you install Reporting Services in “Default” configuration and not “SharePoint Integrated”. As the team I am Woking with usually works with reporting services integrated with SharePoint their default was naturally “SharePoint Integrated”. Luckily Reporting Services is easy to reinstall.

            For some reason I always forget to install “Fill-test search” and get a TF254027. Because I always forget I neglected to tell the DBA to install also. In this case all parts of SQL are remote to the TFS server which is a configuration that I know is supported, but this is the first time I have used it.

    8.  Configure TFS selecting “Advanced”  to set the Database, Cube and Reporting to use another server. At this point we are NOT installing or integrating with SharePoint.[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_13-2-2.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_28.png)  
        { .post-img }
        **Figure: I do love green ticks**
        If we want to Integrate _[SharePoint 2010 with Team Foundation Server 2010](http://geekswithblogs.net/hinshelm/archive/2010/05/03/integrate-sharepoint-2010-with-team-foundation-server-2010.aspx)_ at a later date we can
    9.  Add any Admin users you need[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_23-9-9.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_48.png)  
        { .post-img }
        **Figure: Remembering that Reporting Services in Remote**
    10. Detach Team Project Collection from OLD server[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_20-7-7.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_42.png)  
        { .post-img }
        **Figure: Detach before backup as changes are made to the collection**
        if you do not detach the collection prior to backup and move to the new server you may encounter problems trying to get the collection back up.
    11. Backup Collection and Restore to Team Foundation Server in new Domain[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_22-8-8.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_46.png)  
        { .post-img }
        **Figure: You get a chance to change the name when you restore**
        I would recommend this as “DefaultCollection” does not really sound good. I prefer “\[CompanyName\]Collection” as it will make everyone feel that it is more important.
    12. Make sure that your account has permission to the databases[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_32-16-16.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_66.png)  
        { .post-img }
        **Figure: Permission to the database is required**
    13. Attach the collection[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_25-10-10.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_52.png)  
        { .post-img }
        **Figure: Oh, why do I get a TF254078?**
    14. Lets try that again through the command line[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_26-11-11.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_54.png)  
        { .post-img }
        **Figure: Oh, so really its a TF246081! That's nice.  
         **  
         note: [Make sure that you run the command prompt in elevated permissions](http://geekswithblogs.net/hinshelm/archive/2010/03/04/microsoft-please-help-me-diagnose-tfs-administration-permission-issues.aspx)
    15. Rerun all previous steps without installing SP1 (the long shot)[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_27-12-12.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_56.png)  
        { .post-img }
        **Figure: Would you believe it!**
        \*\*[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_29-13-13.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_60.png)
        { .post-img }
        Figure: Woooohooooo!\*\*
    16. Change all of the Identities ([**Identities Change**](http://msdn.microsoft.com/en-us/library/ms253054.aspx))Well, it looks like this server is now on its 4th domain! That's right, the company has had this server since TFS 2005 and has kept it moving around. As TFS only recently gained the ability to migrate accounts I was only able to migrate some of the accounts.
    17. Create user account groups[![image](images/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_thumb_31-15-15.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-WriterIn-Place-upgrade-of-TFS-2008-to-TFS-2010_A159image_64.png)  
        { .post-img }
        **Figure: Adding users can be done through the project or at the TPC level  
         **
    18. Connect up build serversAs these build server do not yet have all of the components installed to run the build I was unable to get the build running on the day. To be installed for my next visit is:
        - SharePoint 2007 – The developers are creating SharePoint apps
        - Visual Studio 2008 – you always need to add VS to a build server

    ### Conclusion

    After trying a while bunch of options including re-running everything from scratch without installing Service Pack 1. With the success of running without SP1 installed I am inclined to think that the product team broke something in the Attach Team Project Collection command.

    ### References

    - [Move Team Foundation Server from One Environment to Another](http://msdn.microsoft.com/en-us/library/ms404883.aspx)
    - [TF30040: The database is not correctly configured - After applying SP1](http://social.msdn.microsoft.com/forums/en-US/tfssetup/thread/f4357f08-2839-4ddd-a23c-6e9ccc1e8639)
    - [Moving TFS project collection that wasn't detached](http://stackoverflow.com/questions/2589886/moving-tfs-project-collection-that-wasnt-detached)
    - [Team Project Collections – Upgrade from TFS2010 beta2 to TFS2010 RC](http://www.dailyworkaround.com/tag/rror-tf254078-no-attachable-databases-were-found-on-the-following-instance-of-sql-server-server-name/)
    - [Guidance for upgrading to TFS 2010 along with domain move](http://blogs.msdn.com/b/vasu_sankaran/archive/2010/05/11/guidance-for-upgrading-to-tfs-2010-along-with-domain-move.aspx)
    - [Move Team Foundation Server from One Environment to Another](<http://msdn.microsoft.com/en-us/library/ms404883(v=VS.100).aspx>)

    BNX4P3AT2EP3
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-04-19-in-place-upgrade-of-tfs-2008-to-tfs-2010-with-move-to-new-domain\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-04-19-in-place-upgrade-of-tfs-2008-to-tfs-2010-with-move-to-new-domain
- FrontMatter:
    title: My first Scrum team in the wild
    description: Discover insights from my first Scrum team experience, highlighting key practices and lessons learned to enhance your agile journey. Join the conversation!
    ResourceId: ov2kV0DI9xR
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 9892
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-04-03
    weight: 540
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: my-first-scrum-team-in-the-wild
    aliases:
    - /resources/ov2kV0DI9xR
    aliasesArchive:
    - /blog/my-first-scrum-team-in-the-wild
    - /my-first-scrum-team-in-the-wild
    - /resources/blog/my-first-scrum-team-in-the-wild
    tags:
    - Software Development
    - Professional Scrum
    - Scrum Team
    - Team Performance
    - Agile Product Management
    - Agile Frameworks
    - Agile Planning
    - Estimation
    - Product Delivery
    - Pragmatic Thinking
    - Team Collaboration
    - Working Software
    - Agile Transformation
    - Product Backlog
    categories:
    - Scrum
    preview: nakedalm-logo-128-link-6-6.png
  BodyContent: |
    [![image](images/GWB-Windows-Live-Writer3cf46226a54f_DA4Fimage_thumb-4-4.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer3cf46226a54f_DA4Fimage_2.png)Over the last year I have invested a lot in Scrum. A few months ago I was assigned to teach a two day Scrum course for which I had to build and deliver the material. The team that received the _beta_ of the course has now just finished their first sprint!
    { .post-img }

    ---

    Although I was unable to be the teams Scrum Coach (paperwork relating to citizenship issues) one of my very experienced colleagues (Rennie Araucto) took up the challenge. This was Rennie’s first foray into serious Scrum and he attended the same training course; well I honestly could not have asked for a better person to take this team through its first sprint.

    [![image](images/GWB-Windows-Live-Writer3cf46226a54f_DA4Fimage_thumb_1-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer3cf46226a54f_DA4Fimage_4.png)  
    { .post-img }
    **Figure: Pretty much the best sprint 1 burn down I have ever seen**

    This is probably the very best Sprint 1 burndown I have ever seen. Usually a team will over commit on at least the first, second and third sprints as well as having a tendency to remain oblivious to the _opportunities_ they have in the Scrum process to correct their mistakes. This is usually through no fault of the individuals, but of a IT industry that has consistently taught and rewarded people for anti-patterns to delivering better software.

    The data show above is the difference that can be achieve by both having a Scrum Coach and listening to their advice. Most teams fall down on the latter even when the former is satisfied, but I can only applaud the openness of The Scrum Team and their management in adopting both the action and the theory of Scrum in addition to the verbiage. I am sure once they are passed their 10th sprint there will be many changes that they want to make to the process they will have achieved, but _sticking to their guns_ at this stage will serve them well. The trap that they could still fall into is complacency on having such a good sprint. I do worry that their second sprint could be a disaster if they fall back on unhealthy anti-patterns.

    Here are a few of the questions that came up during the course of the sprint:

    ### When are Story Points added and updated?

    When used correctly Story Points are a fantastic way of doing estimation. Once you accept that we humans generally suck at estimating things far in the future as well as things we will not be doing ourselves things can get a lot better.

    If we take estimation as a team effort and make sure that there is consensus within a team for how _complicated_ something is in relation to the previous complexity estimates we should at least know which _stories_ are more complicated to implement than the previous one. I always urge teams to reach an agreement as a whole, but not to the point of arguing over wither something is a 8 or and 8.5 (or even a 2 or a 3). When it gets to that level I always recommend an average and move on.

    Back to the question, I believe that Story Points are ONLY added or changed at the Sprint Planning meeting. Rough order of events:

    - **Backlog Creation**: - Product Owner created the backlog and prioritises based on business value
    - **Release Planning**: - _The Team_ helps the Product Owner flesh out the user stories by making sure that the Description and Acceptance Criteria are understood and that there is enough information for Test Cases to be built and development to commence. Obviously large User Stories may be broken down at this point. The Team’s initial Definition of Done may also be devised at this time.
    - **Backlog Reprioritisation**: - The Product Owner re-prioritises the backlog based the new information that came out of the Release Planning
    - **Sprint Planning (Part 1)**: - The Team with the assistance of the Product Owner works through the Product Backlog in Stack Rank order to estimate in Story Points roughly 2-3 times the number of User Stories that they think they can deliver during the Sprint. The Product Owner can now roughly predict what will be delivered from the next 2-3 Sprints. All User Stories that can’t be delivered in a single Spring need to be broken down into smaller User Stories
    - **Backlog Reprioritisation: -** The Product Owner re-prioritises the backlog based the new information that came out of the Release Planning
    - **Sprint Planning (Part 2): -** _The Team_ pulls the highest priority User Story from the Product Backlog and breaks it down into Tasks that are added to the Sprint Backlog. These Tasks are sized in Hours and the Team decides if they are able to commit to delivering that User Story. They then repeat the process with the next User Story.

    In reality the _pruning_ of the Product Backlog by the Product Owner happens all the time and anyone is able to add new User Stories to the **end** of the Product Backlog at any time.

    ### We will end up eventually breaking things down into hours, so why bother doing story points at all?

    This is a really common questions and is pretty easy to explain. First lets assume again that we are totally crap at estimating. If that is the case, we want to spend a minimal amount of time estimating things that we will do in the future, or even not end up doing at all. When we do a complexity estimate we let the Product Owner know that we think _that_ things are only so big. This gives them a chance to reprioritise the things that they thought were quick wins, but which are hard, and visa-a-versa.

    Now, in  Sprint Planning (Part 2) we can concentrate on only doing the hard work of breaking the top story down into fine grained tasks without the need to worry that we are doing this unnecessarily. Yes, at the start we will have say two User Stories at 12 points that end up being 80 hours and 120 hours respectively, but once you get around to your next Sprint Planning (Part 1) session you will have a better idea of how much complexity you have in your application. This knowledge can only increase over time.

    ### When should the team activate a User Story?  At the beginning of the sprint or when they start working on it?

    I love easy ones: When you start working on it.

    In order to understand the relationship between the amount of work that you committed to and the amount of work that you got done it can be handy to see exactly what you did not even have time to start.

    ### What do you do with stories that are not finished in a single sprint?

    There is a lot of debate on this one. If you are using physical cards then that physical card just goes onto the backlog and all of the outstanding tasks go into the bin. I like to follow that with my data as well. Just move the incomplete User Stories back to the Backlog and Close it indicating that is was not done (Using the Visual Studio Scrum template you mark it as _**Removed**_ with a reason of _**Removed from the backlog**_.

    [![image](images/GWB-Windows-Live-Writer3cf46226a54f_DA4Fimage_thumb_2-2-2.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer3cf46226a54f_DA4Fimage_6.png)  
    { .post-img }
    **Figure: Agile 5.0 Task removed from the sprint backlog**

    [![image](images/GWB-Windows-Live-Writer3cf46226a54f_DA4Fimage_thumb_3-3-3.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer3cf46226a54f_DA4Fimage_8.png)  
    { .post-img }
    **Figure: Visual Studio Scrum 1.0 Task removed from sprint backlog**

    The User Story may then be added to the next Sprint if it is prioritised by the Product Owner. It would be up to the team to pitch its completeness or otherwise to the Product Owner in order to prioritise it.

    Rule: Never leave uncompleted work in a sprint. Its untidy and causes confusion

    ### Conclusion

    This team has made some fantastic efforts for their first sprint, but should not get complacent. I am very impressed of the work that Rennie has put in and I really enjoyed our long Scrum conversations ![Smile](images/GWB-Windows-Live-Writer3cf46226a54f_DA4FwlEmoticon-smile_2-5-5.png)
    { .post-img }
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-04-03-my-first-scrum-team-in-the-wild\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-04-03-my-first-scrum-team-in-the-wild
- FrontMatter:
    title: Installing Visual Studio Team Foundation Server Service Pack 1
    description: Learn how to install Visual Studio Team Foundation Server Service Pack 1 smoothly, troubleshoot common issues, and enhance your development environment.
    ResourceId: LpdTshxayAB
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 8
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-03-10
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: installing-visual-studio-team-foundation-server-service-pack-1
    aliases:
    - /resources/LpdTshxayAB
    aliasesArchive:
    - /blog/installing-visual-studio-team-foundation-server-service-pack-1
    - /installing-visual-studio-team-foundation-server-service-pack-1
    - /resources/blog/installing-visual-studio-team-foundation-server-service-pack-1
    tags:
    - Install and Configuration
    - Windows
    - Troubleshooting
    - System Configuration
    categories:
    - Uncategorized
  BodyContent: |
    [![vs2010logo](images/Installing-Visual-Studio-Team-Foundatio_6DBD-vs2010logo_thumb-14-14.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-vs2010logo_2.png)As has become customary when the product team releases a new patch, SP or version I like to document the install. Although I had no errors on my main computer, my netbook did have problems. Although I am not ready to call it a Service Pack problem just yet!
    { .post-img }

    - Update 2011-03-10 – Running the Team Foundation Server 2010 Service Pack 1 install a second time worked

    ---

    As per [Brian's post](http://blogs.msdn.com/b/bharry/archive/2011/03/09/installing-all-the-new-stuff.aspx) I am installing the Team Foundation Server Service Pack first and indeed as this is a single server local deployment I need to install both. If I only install one it will leave the other product broken.

    This however does not affect you if you are running Visual Studio and Team Foundation Server on separate computers as is normal in a production deployment.

    ### Main workhorse

    I will be installing the service pack first on my main computer as I want to actually use it here.

    [![SNAGHTML1065c18](images/Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTML1065c18_thumb-6-6.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTML1065c18.png)  
    { .post-img }
    **Figure: My main workhorse**

    I will also be installing this on my netbook which is obviously of significantly lower spec, but I will do that one after. Although, as always I had my fingers crossed, I was not really worried.

    [![SNAGHTMLf88846](images/Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLf88846_thumb-8-8.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLf88846.png)  
    { .post-img }
    **Figure: KB2182621**

    Compared to Visual Studio there are not really a lot of components to update.

    [![image](images/Installing-Visual-Studio-Team-Foundatio_6DBD-image_thumb-5-5.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-image_2.png)  
    { .post-img }
    **Figure: TFS 2010 and SQL 2008 are the main things to update**

    There is no “web” installer for the Team Foundation Server 2010 Service Pack, but that is ok as most people will be installing it on a production server and will want to have everything local. I would have liked a Web installer, but the added complexity for the product team is not work the capability for a 500mb patch.

    [![SNAGHTMLf9823e](images/Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLf9823e_thumb-9-9.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLf9823e.png)  
    { .post-img }
    **Figure: There is currently no way to roll SP1 and RTM together**

    [![SNAGHTMLf9ac69](images/Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLf9ac69_thumb-10-10.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLf9ac69.png)  
    { .post-img }
    **Figure: No problems with the file verification, phew[![coffee-cup](images/Installing-Visual-Studio-Team-Foundatio_6DBD-coffee-cup_thumb_1-1-1.jpg)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-coffee-cup_5.jpg)**
    { .post-img }

    [![SNAGHTMLf9e46a](images/Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLf9e46a_thumb-11-11.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLf9e46a.png)  
    { .post-img }
    **Figure: Although the install took a while, it progressed smoothly[![coffee-cup](images/Installing-Visual-Studio-Team-Foundatio_6DBD-coffee-cup_thumb-2-2.jpg)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-coffee-cup_2.jpg)**
    { .post-img }

    [![SNAGHTMLfa11b1](images/Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLfa11b1_thumb-12-12.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLfa11b1.png)  
    { .post-img }
    **Figure: I always like a success screen**

    Well, as far as the install is concerned everything is OK, but what about TFS? Can I still connect and can I still administer it.

    [![SNAGHTMLfdde61](images/Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLfdde61_thumb-13-13.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTMLfdde61.png)  
    { .post-img }
    **Figure: Service Pack 1 is reflected correctly in the Administration Console**

    I am confident that there are no major problems with TFS on my system and that it has been updated to SP1. I can do all of the things that I used before with ease, and with the new features detailed by [Brian](http://blogs.msdn.com/b/bharry/archive/2011/03/09/installing-all-the-new-stuff.aspx) I think I will be happy.

    ### Netbook

    The great god Murphy has stuck, and my poor wee laptop spat the Team Foundation Server 2010 Service Pack 1 out so fast it hit me on the back of the head. That will teach me for not looking…

    [![image](images/Installing-Visual-Studio-Team-Foundatio_6DBD-image_thumb_1-3-3.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-image_4.png)  
    { .post-img }
    **Figure: “Installation did not succeed” I am pretty sure should not be all caps!**

    On examining the file I found that everything worked, except the actual Team Foundation Server 2010 serving step.

    ```
    Action: System Requirement Checks...
    Action complete
    Action: Downloading and/or Verifying Items
    c:757fe6efe9f065130d4838081911VS10-KB2182621.msp: Verifying signature for VS10-KB2182621.msp
    c:757fe6efe9f065130d4838081911VS10-KB2182621.msp Signature verified successfully for VS10-KB2182621.msp
    c:757fe6efe9f065130d4838081911DACFramework_enu.msi: Verifying signature for DACFramework_enu.msi
    c:757fe6efe9f065130d4838081911DACFramework_enu.msi Signature verified successfully for DACFramework_enu.msi
    c:757fe6efe9f065130d4838081911DACProjectSystemSetup_enu.msi: Verifying signature for DACProjectSystemSetup_enu.msi
    Exists: evaluating
    Exists evaluated to false
    c:757fe6efe9f065130d4838081911DACProjectSystemSetup_enu.msi Signature verified successfully for DACProjectSystemSetup_enu.msi
    c:757fe6efe9f065130d4838081911TSqlLanguageService_enu.msi: Verifying signature for TSqlLanguageService_enu.msi
    c:757fe6efe9f065130d4838081911TSqlLanguageService_enu.msi Signature verified successfully for TSqlLanguageService_enu.msi
    c:757fe6efe9f065130d4838081911SharedManagementObjects_x86_enu.msi: Verifying signature for SharedManagementObjects_x86_enu.msi
    c:757fe6efe9f065130d4838081911SharedManagementObjects_x86_enu.msi Signature verified successfully for SharedManagementObjects_x86_enu.msi
    c:757fe6efe9f065130d4838081911SharedManagementObjects_amd64_enu.msi: Verifying signature for SharedManagementObjects_amd64_enu.msi
    c:757fe6efe9f065130d4838081911SharedManagementObjects_amd64_enu.msi Signature verified successfully for SharedManagementObjects_amd64_enu.msi
    c:757fe6efe9f065130d4838081911SQLSysClrTypes_x86_enu.msi: Verifying signature for SQLSysClrTypes_x86_enu.msi
    c:757fe6efe9f065130d4838081911SQLSysClrTypes_x86_enu.msi Signature verified successfully for SQLSysClrTypes_x86_enu.msi
    c:757fe6efe9f065130d4838081911SQLSysClrTypes_amd64_enu.msi: Verifying signature for SQLSysClrTypes_amd64_enu.msi
    c:757fe6efe9f065130d4838081911SQLSysClrTypes_amd64_enu.msi Signature verified successfully for SQLSysClrTypes_amd64_enu.msi
    c:757fe6efe9f065130d4838081911vcruntimeVc_runtime_x86.cab: Verifying signature for vcruntimeVc_runtime_x86.cab
    c:757fe6efe9f065130d4838081911vcruntimeVc_runtime_x86.cab Signature verified successfully for vcruntimeVc_runtime_x86.cab
    c:757fe6efe9f065130d4838081911vcruntimeVc_runtime_x86.msi: Verifying signature for vcruntimeVc_runtime_x86.msi
    c:757fe6efe9f065130d4838081911vcruntimeVc_runtime_x86.msi Signature verified successfully for vcruntimeVc_runtime_x86.msi
    c:757fe6efe9f065130d4838081911SetupUtility.exe: Verifying signature for SetupUtility.exe
    c:757fe6efe9f065130d4838081911SetupUtility.exe Signature verified successfully for SetupUtility.exe
    c:757fe6efe9f065130d4838081911vcruntimeVc_runtime_x64.cab: Verifying signature for vcruntimeVc_runtime_x64.cab
    c:757fe6efe9f065130d4838081911vcruntimeVc_runtime_x64.cab Signature verified successfully for vcruntimeVc_runtime_x64.cab
    c:757fe6efe9f065130d4838081911vcruntimeVc_runtime_x64.msi: Verifying signature for vcruntimeVc_runtime_x64.msi
    c:757fe6efe9f065130d4838081911vcruntimeVc_runtime_x64.msi Signature verified successfully for vcruntimeVc_runtime_x64.msi
    c:757fe6efe9f065130d4838081911NDP40-KB2468871.exe: Verifying signature for NDP40-KB2468871.exe
    c:757fe6efe9f065130d4838081911NDP40-KB2468871.exe Signature verified successfully for NDP40-KB2468871.exe
    Action complete
    Action: Performing actions on all Items
    Entering Function: BaseMspInstallerT >::PerformAction
    Action: Performing Install on MSP: c:757fe6efe9f065130d4838081911VS10-KB2182621.msp targetting Product: Microsoft Team Foundation Server 2010 - ENU
    Returning IDOK. INSTALLMESSAGE_ERROR [Error 1935.An error occurred during the installation of assembly 'Microsoft.TeamFoundation.WebAccess.WorkItemTracking,version="10.0.0.0",publicKeyToken="b03f5f7f11d50a3a",processorArchitecture="MSIL",fileVersion="10.0.40219.1",culture="neutral"'. Please refer to Help and Support for more information. HRESULT: 0x80070005. ]
    Returning IDOK. INSTALLMESSAGE_ERROR [Error 1712.One or more of the files required to restore your computer to its previous state could not be found. Restoration will not be possible.]
    Patch (c:757fe6efe9f065130d4838081911VS10-KB2182621.msp) Install failed on product (Microsoft Team Foundation Server 2010 - ENU). Msi Log:
    MSI returned 0x643
    Entering Function: MspInstallerT >::Rollback

    Action Rollback changes
    PerformMsiOperation returned 0x643
    PerformMsiOperation returned 0x643
    OnFailureBehavior for this item is to Rollback.
    Action complete
    Final Result: Installation failed with error code: (0x80070643), "Fatal error during installation. " (Elapsed time: 0 00:14:09).
    ```

    **Figure: Error log for Team Foundation Server 2010 install shows a failure**

    As there is really no information in this log as to why the installation failed so I checked the event log on that box.

    [![image](images/Installing-Visual-Studio-Team-Foundatio_6DBD-image_thumb_3-4-4.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-image_9.png)
    { .post-img }

    **Figure: There are hundreds of errors and it actually looks like there are more problems than a failed Service Pack**

    I am going to just run it again and see if it was because the netbook was slow to catch on to the update. Hears hoping, but even if it fails, I would question the installation of Windows (PDC laptop original install) before I question the Service Pack ![Smile](images/Installing-Visual-Studio-Team-Foundatio_6DBD-wlEmoticon-smile_2-15-15.png)
    { .post-img }

    [![SNAGHTML1874adc](images/Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTML1874adc_thumb-7-7.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-Team-Foundatio_6DBD-SNAGHTML1874adc.png)
    { .post-img }

    **Figure: Second run through was successful**

    I don’t know if the laptop was just slow, or what…

    **Did you get this error?**

    If you did I will push this to the product team as a problem, but unless more people have this sort of error, I will just look to write this off as a corrupted install of Windows and reinstall.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-03-10-installing-visual-studio-team-foundation-server-service-pack-1\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-03-10-installing-visual-studio-team-foundation-server-service-pack-1
- FrontMatter:
    title: Installing Visual Studio 2010 Service Pack 1
    description: Learn how to install Visual Studio 2010 Service Pack 1 smoothly with tips and insights from Martin Hinshelwood. Enhance your development experience today!
    ResourceId: tZ9fOZUusrh
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 9893
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-03-10
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: installing-visual-studio-2010-service-pack-1
    aliases:
    - /resources/tZ9fOZUusrh
    aliasesArchive:
    - /blog/installing-visual-studio-2010-service-pack-1
    - /installing-visual-studio-2010-service-pack-1
    - /resources/blog/installing-visual-studio-2010-service-pack-1
    tags:
    - Install and Configuration
    - Windows
    preview: metro-visual-studio-2010-128-link-13-13.png
    categories:
    - Uncategorized
  BodyContent: |
    [![vs2010logo_thumb[1]](images/Installing-Visual-Studio-2010-Service-Pa_77C9-vs2010logo_thumb1_thumb-11-11.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-vs2010logo_thumb1_2.png)As has become customary when the product team releases a new patch, SP or version I like to document the install. This post seams almost redundant as I had no problems, but I think that is as valuable to other thinking of installing the Service Pack as all the problems that we sometimes get.
    { .post-img }

    ---

    As per [Brian's post](http://blogs.msdn.com/b/bharry/archive/2011/03/09/installing-all-the-new-stuff.aspx) I am [Installing Visual Studio Team Foundation Server Service Pack 1](http://blog.hinshelwood.com/archive/2011/03/10/installing-visual-studio-team-foundation-server-service-pack-1.aspx) first and indeed as this is a single server local deployment I need to install both. If I only install one it will leave the other product broken.

    [![SNAGHTMLfb6887_thumb](images/Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfb6887_thumb_thumb-4-4.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfb6887_thumb_2.png)  
    { .post-img }
    **Figure: Hopefully this will be more uneventful[![coffee-cup](images/Installing-Visual-Studio-2010-Service-Pa_77C9-coffee-cup_thumb_2-2-2.jpg)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-coffee-cup_8.jpg)**
    { .post-img }

    It takes a little while for your system to be checked to see what components need updating. On my main computer this was pretty quick, but on the laptop it took some time.

    [![SNAGHTMLfb9042_thumb](images/Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfb9042_thumb_thumb-5-5.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfb9042_thumb_2.png)  
    { .post-img }
    **Figure: There are a lot of components to update**

    With this update also comes an update to .NET as well as many other components.

    [![SNAGHTMLfbc47b_thumb](images/Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfbc47b_thumb_thumb-6-6.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfbc47b_thumb_2.png)  
    { .post-img }
    **Figure: I downloaded the full 1.5GB’s, but you could do a web install**

    It depends on how good you internet connection is to how long it would take to download, but as I am now in the US I decided not to trust the internet connection speeds. It took around 30-40 minutes to download the full thing which is a little slow.

    [![SNAGHTMLfbfde3_thumb](images/Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfbfde3_thumb_thumb-7-7.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfbfde3_thumb_2.png)  
    { .post-img }
    **Figure: I did not need to download, but that would increase the install time[![coffee-cup](images/Installing-Visual-Studio-2010-Service-Pa_77C9-coffee-cup_thumb-3-3.jpg)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-coffee-cup_2.jpg)**
    { .post-img }

    So on my main computer again this was fast, but again on my netbook this took a little while.

    [![SNAGHTMLfc232e_thumb](images/Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfc232e_thumb_thumb-8-8.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfc232e_thumb_2.png)  
    { .post-img }
    **Figure: The actual install took around 30-40 minutes (2 hours on netbook)[![coffee-cup](images/Installing-Visual-Studio-2010-Service-Pa_77C9-coffee-cup_thumb_1-1-1.jpg)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-coffee-cup_5.jpg)**
    { .post-img }

    I was pretty impressed with the speed of the install, and as Team Explore is now out of the box with Visual Studio 2010 I don’t get the problem of the SP being installed before Team Explorer and having a disjointed experience ![Smile](images/Installing-Visual-Studio-2010-Service-Pa_77C9-wlEmoticon-smile_2-12-12.png)
    { .post-img }

    [![SNAGHTMLfc4d69_thumb](images/Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfc4d69_thumb_thumb-9-9.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfc4d69_thumb_2.png)  
    { .post-img }
    **Figure: As I suspected, no problems with the install**

    [![SNAGHTMLfd0091_thumb](images/Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfd0091_thumb_thumb-10-10.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Installing-Visual-Studio-2010-Service-Pa_77C9-SNAGHTMLfd0091_thumb_2.png)  
    { .post-img }
    **Figure: Checking in Visual Studio shows that all the servicing points were successful**

    This was an easy experience even if the SP was over 1.5GB’s to download ![Smile](images/Installing-Visual-Studio-2010-Service-Pa_77C9-wlEmoticon-smile_2-12-12.png) Hopefully I will be discovering things that work better for a good while to come, as well as not seeing holes in the product that I had no encountered yet.
    { .post-img }

    **What were your experiences of installing Visual Studio 2010 Service pack 1?**
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-03-10-installing-visual-studio-2010-service-pack-1\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-03-10-installing-visual-studio-2010-service-pack-1
- FrontMatter:
    title: Visual Studio ALM MVP of the Year 2011
    description: Discover Martin Hinshelwood's journey as the Visual Studio ALM MVP of the Year 2011, sharing insights and valuable resources for TFS enthusiasts.
    ResourceId: EN9cabHmNmb
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 9
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-03-06
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: visual-studio-alm-mvp-of-the-year-2011
    aliases:
    - /resources/EN9cabHmNmb
    aliasesArchive:
    - /blog/visual-studio-alm-mvp-of-the-year-2011
    - /visual-studio-alm-mvp-of-the-year-2011
    - /resources/blog/visual-studio-alm-mvp-of-the-year-2011
    tags: []
    categories:
    - Uncategorized
    preview: metro-award-link-2-2.png
  BodyContent: |
    [![trophy](images/Visual-Studio-ALM-MVP-of-the-Year-2011_DD0A-trophy_thumb-1-1.jpg)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Visual-Studio-ALM-MVP-of-the-Year-2011_DD0A-trophy_2.jpg)
    { .post-img }

    For some reason this year some of my peers decided to vote for me as a contender for Visual Studio ALM MVP of the year. I am not sure what I did to deserve this, but a number of people have commented that I have a rather useful blog.

    ---

    I feel wholly unworthy to join the ranks of previous winners:

    - [Ed Blankenship (2010)](http://www.edsquared.com/2010/02/24/Microsoft+MVP+Of+The+Year+For+VSTS+TFS.aspx)
    - [Martin Woodward (2009)](http://www.woodwardweb.com/vsts/team_system_mvp.html)

    Thank you to everyone who voted regardless of who you voted for. If there was a prize for the best group of MVP’s then the Visual Studio ALM MVP would be a clear winner, as would the product group of product groups that is Visual Studio ALM Group. To use a phrase that I have learned since moving to Seattle and probably use too much: you guys are all just **_awesome_**.

    I have tried my best in the last year to document not only every problem that I have had with Team Foundation Server (TFS), but also to document as many of the things I am doing as possible. I have taken some of Adam Cogan’s rules to heart and when a customer asks me a question I always blog the answer and send them a link.

    This allows both my blog and my understanding of TFS to grow while creating a useful bank of content. The idea is that if one customer asks, all benefit. I try, when writing for my blog, to capture both the essence and the context for a problem being solved. This allows more people to benefit as they do not need to understand the specifics of an environment to gain value.

    I have a number of goals for this year that I think will help increase value in the community:

    - persuade my new colleagues at Northwest Cadence to do more [blogging](http://blog.nwcadence.com) (Steve, Jeff, Shad and Rennie)
    - Rangers Project – [TFS Iteration Automation](http://blogs.msdn.com/b/willy-peter_schaub/archive/2011/02/20/new-rangers-project-tfs-iteration-automation.aspx) with [Willy-Peter Schaub](http://blogs.msdn.com/b/willy-peter_schaub/archive/2010/10/20/introducing-the-visual-studio-alm-rangers-willy-peter-schaub.aspx), Bill Essary, [Martin Hinshelwood](http://blogs.msdn.com/b/willy-peter_schaub/archive/2010/07/08/introducing-the-visual-studio-alm-rangers-martin-hinshelwood.aspx), [Mike Fourie](http://blogs.msdn.com/b/willy-peter_schaub/archive/2010/09/28/introducing-the-visual-studio-alm-rangers-michael-fourie-also-known-as-mike.aspx), [Jeff Bramwell](http://blogs.msdn.com/b/willy-peter_schaub/archive/2010/06/21/introducing-the-visual-studio-alm-rangers-jeff-bramwell.aspx) and [Brian Blackman](http://blogs.msdn.com/b/willy-peter_schaub/archive/2010/06/24/introducing-the-visual-studio-alm-rangers-brian-blackman.aspx)
    - Write a book on the Team Foundation Server API with [Willy-Peter Schaub](http://blogs.msdn.com/b/willy-peter_schaub/archive/2010/10/20/introducing-the-visual-studio-alm-rangers-willy-peter-schaub.aspx), [Mike Fourie](http://blogs.msdn.com/b/willy-peter_schaub/archive/2010/09/28/introducing-the-visual-studio-alm-rangers-michael-fourie-also-known-as-mike.aspx) and [Jeff Bramwell](http://blogs.msdn.com/b/willy-peter_schaub/archive/2010/06/21/introducing-the-visual-studio-alm-rangers-jeff-bramwell.aspx)
    - write more useful blog posts

    I do not think that these things are beyond the realms of do-ability, but we will see…
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-03-06-visual-studio-alm-mvp-of-the-year-2011\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-03-06-visual-studio-alm-mvp-of-the-year-2011
- FrontMatter:
    title: Do you know how to move the Team Foundation Server cache
    description: Learn how to efficiently move the Team Foundation Server cache to optimize server space and improve performance with this easy step-by-step guide.
    ResourceId: aF0H8q5h-Yg
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 9894
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-03-03
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: do-you-know-how-to-move-the-team-foundation-server-cache
    aliases:
    - /resources/aF0H8q5h-Yg
    aliasesArchive:
    - /blog/do-you-know-how-to-move-the-team-foundation-server-cache
    - /do-you-know-how-to-move-the-team-foundation-server-cache
    - /resources/blog/do-you-know-how-to-move-the-team-foundation-server-cache
    tags:
    - Install and Configuration
    - Windows
    - System Configuration
    categories:
    - Uncategorized
  BodyContent: |
    [![question mark](images/Do-you-know-how-to-move-the-Team-Foundat_DD94-ErrorOcurred1_thumb-1-1.jpg)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-how-to-move-the-Team-Foundat_DD94-ErrorOcurred1_2.jpg)There are a number of reasons why you may want to change the folder that you store the TFS Cache. It can take up “some” amount of room so moving it to another drive can be beneficial. This is the source control Cache that TFS uses to cache data from the database.
    { .post-img }

    ---

    Moving the Cache is pretty easy and should allow you to organise your server space a little more efficiently. You may also get a performance improvement (although small) by putting it on another drive..

    1.  Create a new directory to store the Cache. e.g. “d:TfsCache”
        [![SNAGHTML1b76e16](images/Do-you-know-how-to-move-the-Team-Foundat_DD94-SNAGHTML1b76e16_thumb-3-3.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-how-to-move-the-Team-Foundat_DD94-SNAGHTML1b76e16.png) **Figure: Create a new folder**
        { .post-img }
    2.  Give the local TFS WPG group full control of the directory
        [![image](images/Do-you-know-how-to-move-the-Team-Foundat_DD94-image_thumb_1-2-2.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-how-to-move-the-Team-Foundat_DD94-image_4.png) **Figure: You need to use the App Tier Service WPG**
        { .post-img }
    3.  In the application tier web.config (~Application TierWeb Servicesweb.config) add the following setting (to the appSettings section).
        [![SNAGHTML1be463c](images/Do-you-know-how-to-move-the-Team-Foundat_DD94-SNAGHTML1be463c_thumb-4-4.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-how-to-move-the-Team-Foundat_DD94-SNAGHTML1be463c.png) **Figure: The web.config for TFS is stored in the application folder**
        { .post-img } > ` > <appsettings>

        >     ...
        >     <add value="D:" key="dataDirectory" />
        >     ...
        >
        > </appsettings>
        > `

            **Figure: Adding this to the web.config will trigger a restart of the app pool**

            [![SNAGHTML1c223fd](images/Do-you-know-how-to-move-the-Team-Foundat_DD94-SNAGHTML1c223fd_thumb-5-5.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-how-to-move-the-Team-Foundat_DD94-SNAGHTML1c223fd.png)

        { .post-img }
        **Figure: Your web.config should look something like this**

    4.  The app pool will automatically recycle and Team Web Access will start using the new location.

    If you then download a file (not via a proxy) a folder with a GUID should be created immediately in the folder from #1.  If the folder doesn’t appear, then you probably don’t have permissions set up properly.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-03-03-do-you-know-how-to-move-the-team-foundation-server-cache\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-03-03-do-you-know-how-to-move-the-team-foundation-server-cache
- FrontMatter:
    title: Should GeeksWithBlogs move to the Wordpress Platform?
    description: Explore the debate on migrating GeeksWithBlogs to WordPress. Join the conversation and vote for enhanced features and better blogging capabilities!
    ResourceId: INzImndgeUG
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 9895
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-02-16
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: should-geekswithblogs-move-to-the-wordpress-platform
    aliases:
    - /resources/INzImndgeUG
    aliasesArchive:
    - /blog/should-geekswithblogs-move-to-the-wordpress-platform
    - /should-geekswithblogs-move-to-the-wordpress-platform
    - /should-geekswithblogs-move-to-the-wordpress-platform-
    - /blog/should-geekswithblogs-move-to-the-wordpress-platform-
    - /resources/blog/should-geekswithblogs-move-to-the-wordpress-platform
    tags: []
    categories:
    - Uncategorized
    preview: nakedalm-logo-128-link-4-4.png
  BodyContent: |
    [![](https://s3.amazonaws.com/uploads.uservoice.com/logo/subdomain/48516/original/gwb_small.gif?1274098879)](http://geekswithblogs.uservoice.com/forums/57394-suggestions-for-the-community/suggestions/1494319-move-to-wordpress-as-a-platform?ref=title)
    { .post-img }

    Geekswithblogs was my first ever blog and my first post was on 22nd June 2006. Since then very little functionality has been added. This is not a complaint, but rather an observation that it is very hard to keep up with all of the blogging capabilities that people want. My point would be: “Why bother!”

    Vote now for a migration of the awesome Geekswithblogs content from SubText to Wordpress.

    **Update 2011-01-06 - Due to some friction and lack of interest in the wants of users over technology I have moved my blog to Wordpress anyway. [Do you want to know how?](http://gwbtowp.codeplex.com/)**

    ---

    Having been a long time user of GWB I have been worried of late by my envy of other blogging platforms. I made a number of requests around 10 months ago for things that almost all blogging platforms provide, but which are not available on GWB.

    - **Support other comment frameworks** – The current comment system is so antiquated that it does not even have the common filters like Facebook, twitter or Google login to help prevent spam.
    - **Tags are not listed in the RSS** – This can prevent you from getting the Google juice that you deserve
    - 301 redirects to a single URL– If you use a custom URL then all your posts are split between both the GWB URL and the custom one. This is VERY bas for SEO.

    I realise that it is difficult to find time to add all of the features that all the uber geeks on this site want, so why bother… lets move to the most popular and moded platform available and allow everyone to add whatever widgets they like.

    [![image](images/Should-GeeksWithBlogs-move-to-the-Wordpr_B321-image_3-2-2.png)](http://geekswithblogs.uservoice.com/forums/57394-suggestions-for-the-community/suggestions/1494319-move-to-wordpress-as-a-platform?ref=title) **Figure: [Vote for Geekswithblogs moving to Wordpress](http://geekswithblogs.uservoice.com/forums/57394-suggestions-for-the-community/suggestions/1494319-move-to-wordpress-as-a-platform?ref=title)**
    { .post-img }

    ### Why would I want this?

    [![wplogo-notext-cmyk](images/Should-GeeksWithBlogs-move-to-the-Wordpr_B321-wplogo-heart4-3-3.png)](http://geekswithblogs.uservoice.com/forums/57394-suggestions-for-the-community/suggestions/1494319-move-to-wordpress-as-a-platform?ref=title)
    { .post-img }

    - There are over 13k plugins available
    - Easy augmentation model
    - Full mobile support
    - Regular releases
    - lots more…

    This could be a turning point in the legendary history of Geeks With Blogs, be part of it…

    ### What can I do to make this happen?

    [![We-Need-You1-324x500[1]](images/Do-you-want-to-be-an-ALM-Consultant_A55E-We-Need-You1-324x5001_thumb-1-1.jpg)](http://geekswithblogs.uservoice.com/forums/57394-suggestions-for-the-community/suggestions/1494319-move-to-wordpress-as-a-platform?ref=title)I need your help to make this happen:
    { .post-img }

    - [**Vote for it**](http://geekswithblogs.uservoice.com/forums/57394-suggestions-for-the-community/suggestions/1494319-move-to-wordpress-as-a-platform?ref=title)
    - [**Discuss it**](http://geekswithblogs.uservoice.com/forums/57394-suggestions-for-the-community/suggestions/1494319-move-to-wordpress-as-a-platform?ref=title)
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-16-should-geekswithblogs-move-to-the-wordpress-platform\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-16-should-geekswithblogs-move-to-the-wordpress-platform
- FrontMatter:
    title: Do you know about the Visual Studio 2010 Database Projects Guidance?
    description: Discover essential guidance for Visual Studio 2010 Database Projects, enhancing your team's database management and deployment strategies. Unlock your potential!
    ResourceId: 84KSaMagvy0
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 9896
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: Wordpress
    date: 2011-02-16
    weight: 640
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: do-you-know-about-the-visual-studio-2010-database-projects-guidance
    aliases:
    - /resources/84KSaMagvy0
    aliasesArchive:
    - /blog/do-you-know-about-the-visual-studio-2010-database-projects-guidance
    - /do-you-know-about-the-visual-studio-2010-database-projects-guidance
    - /do-you-know-about-the-visual-studio-2010-database-projects-guidance-
    - /blog/do-you-know-about-the-visual-studio-2010-database-projects-guidance-
    - /resources/blog/do-you-know-about-the-visual-studio-2010-database-projects-guidance
    tags:
    - Software Development
    preview: metro-visual-studio-2010-128-link-3-3.png
    categories:
    - Uncategorized
  BodyContent: |
    [![vs2010almRanger](images/Do-you-know-about-the-Visual-Studio-2010_D160-vs2010almRanger_thumb-1-2-2.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-about-the-Visual-Studio-2010_D160-vs2010almRanger_2.png)Early on in the Team System (now Visual Studio ALM) cycle a new product surfaced within Team System that was affectionately called “Data Dude”, but had the more formal name of “Visual Studio 2005 Team Edition for Database Professionals”. The purpose of this product was to try and make the database a “first class citizen” in the development world.
    { .post-img }

    ---

    Those that started using Visual Studio 2005 Team Edition for Database Professionals (Data Dude) loved it, but everyone else did not get it. The capabilities were a little patchy, but the one thing it did bring to the party was the ability to put your database schema under source control. This was revolutionary as previously your DBA sat as far away from the team as possible, and usually in a dark cupboard, now they could partake of all the goodness of Version Control, Work Item Tracking and automated builds.

    The problem was that the understanding required to manage these projects was very different to that needed previously. Then the Visual Studio ALM Rangers got a hold of it…and produced some of the best guidance available.

    [![image](images/Do-you-know-about-the-Visual-Studio-2010_D160-image_thumb-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-about-the-Visual-Studio-2010_D160-image_2.png)
    { .post-img }

    **Figure: Download the guidance from** [**http://vsdatabaseguide.codeplex.com/**](http://vsdatabaseguide.codeplex.com/)

    This guidance discusses scenarios and approaches of using the Database Projects in Visual Studio 2010 to help you use the tools more effectively and maximize their value to your organization

    This guidance is focused on these five areas:

    - **Solution and Project Management**
    - **Source Code Control and Configuration Management**
    - **Integrating External Changes with the Project System**
    - **Build and Deployment Automation with Visual Studio Database Projects**
    - **Database Testing and Deployment Verification**

    Each of these areas has common guidance, usage scenarios, hands on labs, and lessons learned from real world engagements and the community discussions.

    The guidance is broken down into three packages:

    - **Guidance documentation**
    - **Hands-on-lab (HOL) documentation**  
       note: The documentation is available in XPS-only format packages or complete XPS,PDF,DOCX format packages
    - **HOL Package**

    If you need assistance and no one else can help, then you may need to call the Visual Studio ALM Rangers.

    The Visual Studio ALM Rangers have the mission to provide out of band solutions for missing features or guidance. They are supported by Microsoft Product Group, Microsoft Consulting Services, Microsoft Most Valued Professionals (MVPs) and technical specialists from technology communities around the globe, giving you a real-world view from the field, where the technology has been tested and used.

    For more information on the Rangers please visit [http://msdn.microsoft.com/en-us/vstudio/ee358786.aspx](http://msdn.microsoft.com/en-us/vstudio/ee358786.aspx) and for more a list of other Rangers projects please see [http://msdn.microsoft.com/en-us/vstudio/ee358787.aspx](http://msdn.microsoft.com/en-us/vstudio/ee358787.aspx).
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-16-do-you-know-about-the-visual-studio-2010-database-projects-guidance\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-16-do-you-know-about-the-visual-studio-2010-database-projects-guidance
- FrontMatter:
    title: Can I run two versions of Microsoft Project side-by-side?
    description: Discover the challenges of running multiple Microsoft Project versions side-by-side. Learn key insights and workarounds to optimize your project management.
    ResourceId: BPWVrzpIhxt
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 13
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: GeeksWithBlogs
    date: 2011-02-11
    weight: 1000
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: can-i-run-two-versions-of-microsoft-project-side-by-side
    aliases:
    - /resources/BPWVrzpIhxt
    aliasesArchive:
    - /blog/can-i-run-two-versions-of-microsoft-project-side-by-side
    - /can-i-run-two-versions-of-microsoft-project-side-by-side
    - /can-i-run-two-versions-of-microsoft-project-side-by-side-
    - /blog/can-i-run-two-versions-of-microsoft-project-side-by-side-
    - /resources/blog/can-i-run-two-versions-of-microsoft-project-side-by-side
    tags:
    - Windows
    preview: nakedalm-logo-128-link-5-5.png
    categories:
    - Uncategorized
  BodyContent: |
    [![image](images/Can_84C0-image_thumb_1-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Can_84C0-image_4.png)
    { .post-img }

    A number of out customers have asked if there are any problems in installing and running multiple versions of Microsoft Project on a single client. Although this is a case of Caveat utilitor (Let the user beware), as long as the user understands and accepts the issues that can occur then they can do this.

    ---

    Although Microsoft provide the ability to leave old versions of Office products (except Outlook) on your client when you are installing a new version of the product they certainly do not endorse doing so.

    [![image](images/Can_84C0-image_thumb_3-2-2.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Can_84C0-image_8.png)  
    { .post-img }
    **Figure: For Project you can choose to keep the old stuff**

    That being the case I would have preferred that they put a “(NOT RECOMMENDED)” after the options to impart that knowledge to the rest of us, but they did not. The default and recommended behaviour is for the newer version installer to remove the older versions. Of course this does not apply in the revers. There are no forward compatibility packs for Office.

    There are a number of negative behaviours (or bugs) that can occur in this configuration:

    - **There is only one MS Project**
      In Windows a file extension can only be associated with a single program.  In this case, MPP files can be associated with only one version of winproj.exe.  The executables are in different folders so if a user double-clicks a Project file on the desktop, file explorer, or Outlook email, Windows will launch the winproj.exe associated with MPP and then load the MPP file.  There are problems associated with this situation and in some cases workarounds.
      The user double-clicks on a Project 2010 file, Project 2007 launches but is unable to open the file because it is a newer version.  The workaround is for the user to launch Project 2010 from the Start menu then open the file.  If the file is attached to an email they will need to first drag the file to the desktop.
    - **All your linked MS Project files need to be of the same version**
      There are a number of problems that occur when people use on Microsoft’s Object Linking and Embedding (OLE) technology.  The three common uses of OLE are:
      - for inserted projects where a Master project contains sub-projects and each sub-project resides in its own MPP file
      - shared resource pools where multiple MPP files share a common resource pool kept in a single MPP file
      - cross-project links where a task or milestone in one MPP file has a  predecessor/successor relationship with a task or milestone in a different MPP file
        > What I’ve seen happen before is that if you are running in a version of Project that is not associated with the MPP extension and then try and activate an OLE link then Project tries to launch the other version of Project.  Things start getting very confused since different MPP files are being controlled by different versions of Project running at the same time.  I haven’t tried this in awhile so I can’t give you exact symptoms but I suspect that if Project 2010 is involved the symptoms will be different then in a Project 2003/2007 scenario.  I’ve noticed that Project 2010 gives different error messages for the exact same problem when it occurs in Project 2003 or 2007.   
        > \-Anonymous
        > The recommendation would be either not to use this feature if you have to have multiple versions of Project installed or to use only a single version of Project.

    You may get unexpected negative behaviours if you are using shared resource pools or resource pools even when you are not running multiple versions as I have found that they can get broken very easily. If you need these thing then it is probably best to use Project Server as it was created to solve many of these specific issues.

    Note: I would not even allow multiple people to access a network copy of a Project file because of the way Windows locks files in write mode. This can cause write-locks that get so bad a server restart is required I’ve seen user’s files get write-locked to the point where the only resolution is to reboot the server.

    ### Changing the default version to run for an extension

    So what if you want to change the default association from Project 2007 to Project 2010?

    [![SNAGHTMLe20419](images/Can_84C0-SNAGHTMLe20419_thumb-4-4.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Can_84C0-SNAGHTMLe20419.png)  
    { .post-img }
    **Figure: “Control Panel | Folder Options | Change the file associated with a file extension”**

    Windows normally only lists the last version installed for a particular extension. You can select a specific version by selecting the program you want to change and clicking “Change program… | Browse…” and then selecting the .exe you want to use on the file system.

    [![image](images/Can_84C0-image_thumb_4-3-3.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Can_84C0-image_10.png)  
    { .post-img }
    **Figure: You will need to select the exact version of “winproj.exe” that you want to run**

    ### Conclusion

    Although it is possible to run multiple versions of Project on one system in the main it does not really make sense.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-11-can-i-run-two-versions-of-microsoft-project-side-by-side\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-11-can-i-run-two-versions-of-microsoft-project-side-by-side
- FrontMatter:
    title: How Visual Studio 2010 and Team Foundation Server enable Compliance
    description: Discover how Visual Studio 2010 and Team Foundation Server enhance compliance through powerful traceability, ensuring your team meets regulatory standards effortlessly.
    ResourceId: gUB-uq9tH-d
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 14
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: GeeksWithBlogs
    date: 2011-02-09
    weight: 640
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: how-visual-studio-2010-and-team-foundation-server-enable-compliance
    aliases:
    - /resources/gUB-uq9tH-d
    aliasesArchive:
    - /blog/how-visual-studio-2010-and-team-foundation-server-enable-compliance
    - /how-visual-studio-2010-and-team-foundation-server-enable-compliance
    - /resources/blog/how-visual-studio-2010-and-team-foundation-server-enable-compliance
    tags:
    - Application Lifecycle Management
    - Azure DevOps
    - Software Development
    - Product Delivery
    categories:
    - Uncategorized
    preview: metro-visual-studio-2010-128-link-30-30.png
  BodyContent: |
    [![Visual Studio 2010 ALM with the word Audit stamped accross it](images/Deep-traceability-in-Team-Foundation-Ser_7737-vs2010AuditLogo_thumb-5-29-29.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-vs2010AuditLogo_2.png)
    { .post-img }

    One of the things that makes Team Foundation Server (TFS) the most powerful Application Lifecycle Management (ALM) platform is the traceability it provides to those that use it. This traceability is crucial to enable many companies to adhere to many of the Compliance regulations to which they are bound (e.g. [CFR 21 Part 11](http://en.wikipedia.org/wiki/Title_21_CFR_Part_11) or [Sarbanes–Oxley](http://en.wikipedia.org/wiki/Sarbanes%E2%80%93Oxley_Act).)

    ---

    From something as simple as relating Tasks to Check-in’s or being able to see the top 10 files in your codebase that are causing the most Bugs, to identifying which Bugs and Requirements are in which Release. All that information is available and more in TFS.

    Although all of this tradability is available within TFS you do need to understand that it is not for free. Well… I say that, but if you are using TFS properly you will have this information with no additional work except for firing up the reporting.

    Using Visual Studio ALM and Team Foundation Server you can relate every line of code changes all the way up to requirements and back down through Test Cases to the Test Results.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_33-14-14.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_74.png)  
    { .post-img }
    **Figure: The only thing missing is Build**

    In order to build the relationship model below we need to examine how each of the relationships get there. Each member of your team from programmer to tester and Business Analyst to Business have their roll to play to knit this together.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_44-20-20.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_96.png)  
    { .post-img }
    **Figure: The relationships required to make this work can get a little confusing**

    If Build is added to this to relate Work Items to Builds and with knowledge of which builds are in which environments you can easily identify what is contained within a Release.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_40-18-18.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_88.png)  
    { .post-img }
    **Figure: How are things progressing**

    Along with the ability to produce the progress and trend reports the tractability that is built into TFS can be used to fulfil most audit requirements out of the box, and augmented to fulfil the rest.

    In order to understand the relationships, lets look at each of the important Artifacts and how they are associated with each other…

    ### Requirements – The root of all knowledge

    Requirements are the thing that the business cares about delivering. These could be derived as User Stories or Business Requirements Documents (BRD’s) but they should be what the Business asks for.

    Requirements can be related to many of the Artifacts in TFS, so lets look at the model:

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_1-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_4.png)  
    { .post-img }
    **Figure: If the centre of the world was a requirement**

    We can track which releases Requirements were scheduled in, but this can change over time as more details come to light.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_13-3-3.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_28.png)  
    { .post-img }
    **Figure: Who edited the Requirement and when**

    There is also the ability to query Work Items based on the History of changed that were made to it. This is particularly important with Requirements. It might not be enough to say what Requirements were completed in a given but also to know which Requirements were ever assigned to a particular release.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_14-4-4.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_30.png)  
    { .post-img }
    **Figure: Some magic required, but result still achieved**

    As an augmentation to this it is also possible to run a query that shows results from the past, just as if we had a time machine. You can take any Query in the system and add a “Asof” clause at the end to query historical data in the operational store for TFS.

    ```
    select  from WorkItems [where ] [order by ] [asof ]
    ```

    **Figure: Work Item Query Language (WIQL) format**

    In order to achieve this you do need to save the query as a \*.wiql file to your local computer and edit it in notepad, but one imported into TFS you run it any time you want.

    [![SNAGHTML21c2556](images/Deep-traceability-in-Team-Foundation-Ser_7737-SNAGHTML21c2556_thumb-1-25-25.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-SNAGHTML21c2556.png)
    { .post-img }

    **Figure: Saving Queries locally can be useful**

    All of these Audit features are available throughout the Work Item Tracking (WIT) system within TFS.

    ### Tasks – Where the real work gets done

    Tasks are the work horse of the development team, but they only as useful as Excel if you do not relate them properly to other Artifacts.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_45-21-21.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_98.png)
    { .post-img }

    **Figure: The Task Work Item Type has its own relationships**

    Requirements should be broken down into Tasks that the development team work from to build what is required by the business. This may be done by a small dedicated group or by everyone that will be working on the software team but however it happens all of the Tasks create should be a Child of a Requirement Work Item Type.

    [![All tasks that are required to implement this requirement should be children of the requirement](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_12-2-2.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_26.png)
    { .post-img }

    **Figure: Tasks are related to the Requirement**

    Tasks should be used to track the day-to-day activities of the team working to complete the software and as such they should be kept simple and short lest developers think they are more trouble than they are worth.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_21-5-5.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_46.png)
    { .post-img }

    **Figure: Task Work Item Type has a narrower purpose**

    Although the Task Work Item Type describes the work that will be done the actual development work involves making changes to files that are under Source Control. These changes are bundled together in a single atomic unit called a Changeset which is committed to TFS in a single operation. During this operation developers can associate Work Item with the Changeset.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_22-6-6.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_48.png)
    { .post-img }

    **Figure: Tasks are associated with Changesets**

    ### Changesets – Who wrote this crap

    Changesets themselves are just an inventory of the changes that were made to a number of files to complete a Task.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_46-22-22.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_100.png)
    { .post-img }

    **Figure: Changesets are linked by Tasks and Builds**

    [![SNAGHTML23775c6](images/Deep-traceability-in-Team-Foundation-Ser_7737-SNAGHTML23775c6_thumb-2-26-26.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-SNAGHTML23775c6.png)
    { .post-img }

    **Figure: Changesets tell us what happened to the files in Version Control**

    Although comments can be changed after the fact, the inventory and Work Item associations are permanent which allows us to Audit all the way down to the individual change level.

    [![SNAGHTMLf71e0f](images/Deep-traceability-in-Team-Foundation-Ser_7737-SNAGHTMLf71e0f_thumb_1-4-28-28.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-SNAGHTMLf71e0f_1.png)
    { .post-img }

    **Figure: On Check-in you can resolve a Task which automatically associates it**

    Because of this we can view the history on any file within the system and see how many changes have been made and what Changesets they belong to.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_23-7-7.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_50.png)
    { .post-img }

    **Figure: Changes are tracked at the File level**

    What would be even more powerful would be if we could view these changes super imposed over the top of the lines of code. Some people call this a blame tool because it is commonly used to find out which of the developers introduced a bug, but it can also be used as another method of Auditing changes to the system.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_24-8-8.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_52.png)
    { .post-img }

    **Figure: Annotate shows the lines**

    the Annotate functionality allows us to visualise the relationship between the individual lines of code and the Changesets. In addition to this you can create a Label and apply it to a version of your version control. The problem with Label’s is that they can be changed after they have been created with no tractability. This makes them practically useless for any sort of compliance audit. So what do you use?

    ### Branches – And why we need them

    Branches are a really powerful tool for development and release management, but they are most important for audits.

    [![SNAGHTML253a011](images/Deep-traceability-in-Team-Foundation-Ser_7737-SNAGHTML253a011_thumb-3-27-27.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-SNAGHTML253a011.png)
    { .post-img }

    **Figure: One way to Audit releases**

    The R1.0 branch can be created from the Label that the Build creates on the R1 line when a Release build was created. It can be created as soon as the Build has been signed of for release. However it is still possible that someone changed the Label between this time and its creation. Another better method can be to explicitly link the Build output to the Build.

    ### Builds – Lets tie some more of this together

    Builds are the glue that helps us enable the next level of tractability by tying everything together.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_47-23-23.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_102.png)
    { .post-img }

    **Figure: The dashed pieces are not out of the box but can be enabled**

    When the Build is called and starts it looks at what it has been asked to build and determines what code it is going to get and build.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_28-9-9.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_60.png)
    { .post-img }

    **Figure: The folder identifies what changes are included in the build**

    The Build sets a Label on the Source with the same name as the Build, but the Build itself also includes the latest Changeset ID that it will be building.

    At the end of the Build the Build Agent identifies the new Changesets it is building by looking at the Check-ins that have occurred since the last Build.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_29-10-10.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_63.png)
    { .post-img }

    **Figure: What changes have been made since the last successful Build**

    It will then use that information to identify the Work Items that are associated with all of the Changesets

    Changesets are associated with Build and change the “Integrated In” field of those Work Items .

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_30-11-11.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_66.png)
    { .post-img }

    **Figure: Find all of the Work Items to associate with**

    The “Integrated In” field of all of the Work Items identified by the Build Agent as being integrated into the completed Build are updated to reflect the Build number that successfully integrated that change.[![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_31-12-12.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_69.png)
    { .post-img }

    **Figure: Now we know which Work Items were completed in a build**

    Now that we can link a single line of code changed all the way back through the Task that initiated the action to the Requirement that started the whole thing and back down to the Build that contains the finished Requirement.

    But how do we know wither that Requirement has been fully tested or even meets the original Requirements?

    ### Test Cases – How we know we are done

    The only way we can know wither a Requirement has been completed to the required specification is to Test that Requirement. In TFS there is a Work Item type called a Test Case

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_32-13-13.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_71.png)
    { .post-img }

    Test Cases enable two scenarios. The first scenario is the ability to track and validate Acceptance Criteria in the form of a Test Case. If you agree with the Business a set of goals that must be met for a Requirement to be accepted by them it makes it both difficult for them to reject a Requirement when it passes all of the tests, but also provides a level of traceable and validation for audit that a feature has been built and tested to order.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_36-15-15.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_80.png)
    { .post-img }

    **Figure: You can have many Acceptance Criteria for a single Requirement**

    It is crucial for this to work that someone from the Business has to sign-off on the Test Case moving from the  “Design” to “Ready” states.

    The Second is the ability to associate an MS Test test with the Test Case thereby tracking the automated test. This is useful in the circumstance when you want to Track a test and the test results of a Unit Test designed to test the existence of and then re-existence of a a Bug.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_38-16-16.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_842.png)
    { .post-img }

    **Figure: Associating a Test Case with an automated Test**

    Although it is possible it may not make sense to track the execution of every Unit Test in your system, there are many Integration and Regression tests that may be automated that it would make sense to track in this way.

    ### Bug – Lets not have regressions

    In order to know wither a Bug in the application has been fixed and to make sure that it does not reoccur it needs to be tracked.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_39-17-17.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_86.png)
    { .post-img }

    **Figure: Bugs are the centre of their own world**

    If the fix to a Bug is big enough to require that it is broken down into Tasks then it is probably a Requirement. You can associate a check-in with a Bug and have it tracked against a Build. You would also have one or more Test Cases to prove the fix for the Bug.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_42-19-19.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_92.png)
    { .post-img }

    **Figure: Bugs have many associations**

    This allows you to track Bugs / Defects in your system effectively and report on them.

    ### Change Request – I am not a feature

    In the CMMI Process template Change Requests can also be easily tracked through the system. In some cases it can be very important to track Change Requests separately as an Auditor may want to know what was changed and who authorised it.

    Again and similar to Bugs, if the Change Request is big enough that it would require to be broken down into Tasks it is in reality a new feature and should be tracked as a Requirement.

    [![image](images/Deep-traceability-in-Team-Foundation-Ser_7737-image_thumb_48-24-24.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Deep-traceability-in-Team-Foundation-Ser_7737-image_104.png)
    { .post-img }

    **Figure: Make sure your Change Requests only Affect Requirements and not rewrite them**

    ### Conclusion

    Visual Studio 2010 and Team Foundation Server together provide an exceptional Application Lifecycle Management platform that can help your team comply with even the harshest of Compliance requirements while still enabling them to be Agile. Most Audits are heavy on required documentation but most of that information is captured for you as long a you do it right. You don’t even need every team member to understand it all as each of the Artifacts are relevant to a different type of team member.

    - Business Analysts manage Requirements and Change Requests
    - Programmers manage Tasks and check-in against Change Requests and Bugs
    - Testers manage Bugs and Test Cases
    - Build Masters manage Builds

    Although there is some crossover there are still rolls or “hats” that are worn.

    - **Do you thing this is all achievable?**
    - **Have I missed anything that you think should be there?**
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-09-how-visual-studio-2010-and-team-foundation-server-enable-compliance\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-09-how-visual-studio-2010-and-team-foundation-server-enable-compliance
- FrontMatter:
    title: Do you know about the Visual Studio ALM Rangers Guidance?
    description: Discover the Visual Studio ALM Rangers Guidance for 2010. Explore valuable insights and resources to enhance your development experience and tools.
    ResourceId: X_Bw0WdCwEc
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 15
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: GeeksWithBlogs
    date: 2011-02-04
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: do-you-know-about-the-visual-studio-alm-rangers-guidance
    aliases:
    - /resources/X_Bw0WdCwEc
    aliasesArchive:
    - /blog/do-you-know-about-the-visual-studio-alm-rangers-guidance
    - /do-you-know-about-the-visual-studio-alm-rangers-guidance
    - /do-you-know-about-the-visual-studio-alm-rangers-guidance-
    - /blog/do-you-know-about-the-visual-studio-alm-rangers-guidance-
    - /resources/blog/do-you-know-about-the-visual-studio-alm-rangers-guidance
    tags: []
    preview: metro-visual-studio-2010-128-link-3-3.png
    categories:
    - Uncategorized
  BodyContent: |
    [![vs2010almRanger](images/Do-you-know-about-the-Visual-Studio-ALM-_D18D-vs2010almRanger_thumb-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-about-the-Visual-Studio-ALM-_D18D-vs2010almRanger_2.png)
    { .post-img }

    I have been tasked with investigating the Guidance available around Visual Studio 2010 for one of our customers and it makes sense to make this available to everyone. The official guidance around Visual Studio 2010 has been created by the Visual Studio ALM Rangers and is a brew of a bunch of really clever guys experiences working with the tools and customers.

    - **Updated 16th February 2011** - Added link to Visual Studio 2010 Database Projects Guidance

    ---

    I will be creating a series of posts on the different guidance options as many people still do not know about them ![Smile](images/Do-you-know-about-the-Visual-Studio-ALM-_D18D-wlEmoticon-smile_2-2-2.png) even though [Willy-Peter Schaub](http://blogs.msdn.com/b/willy-peter_schaub) has done a fantastic job of making sure they get the [recognition](http://blogs.msdn.com/b/willy-peter_schaub/archive/2009/08/07/vsts-rangers-introducing-the-vsts-rangers-recognition-program.aspx) they deserve. There is a full list of all of the [Rangers Solutions and Projects](http://msdn.microsoft.com/en-us/vstudio/ee358787) on MSDN, but I wanted to add my own point of view to the usefulness of each one. If you don’t know who the rangers are you should have a look at the [Visual Studio ALM Rangers Index](http://blogs.msdn.com/b/willy-peter_schaub/archive/2010/06/18/introducing-the-visual-studio-alm-rangers-an-index-to-all-rangers-covered-on-this-blog.aspx) to see the full breadth of where the rangers are. All of the [Rangers Solutions are available on Codeplex](http://www.codeplex.com/site/search?TagName=Rangers&ProjectSearchText=%22Rangers%22) where you can download them and add reviews…
    { .post-img }

    ## Rangers Solutions and Projects

    - [Do you know about the Visual Studio 2010 Architecture Guidance?](http://blog.hinshelwood.com/archive/2011/02/04/do-you-know-about-the-visual-studio-2010-architecture-guidance.aspx)
    - [Do you know about the Visual Studio 2010 Database Projects Guidance?](http://blog.hinshelwood.com/archive/2011/02/16/do-you-know-about-the-visual-studio-2010-database-projects.aspx)
    - More coming soon…

    These solutions took a very long time to put together and I wanted to make sure that we all understand the value of the free time that member of The Product Team, Visual Studio ALM MVP’s and partners put in to make them happen.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-04-do-you-know-about-the-visual-studio-alm-rangers-guidance\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-04-do-you-know-about-the-visual-studio-alm-rangers-guidance
- FrontMatter:
    title: Do you know about the Visual Studio 2010 Architecture Guidance?
    description: Discover the Visual Studio 2010 Architecture Guidance! Enhance your development skills with practical tips, hands-on labs, and easy access to essential tools.
    ResourceId: _88PkXdkKu8
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 16
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: GeeksWithBlogs
    date: 2011-02-04
    weight: 790
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: do-you-know-about-the-visual-studio-2010-architecture-guidance
    aliases:
    - /resources/_88PkXdkKu8
    aliasesArchive:
    - /blog/do-you-know-about-the-visual-studio-2010-architecture-guidance
    - /do-you-know-about-the-visual-studio-2010-architecture-guidance
    - /do-you-know-about-the-visual-studio-2010-architecture-guidance-
    - /blog/do-you-know-about-the-visual-studio-2010-architecture-guidance-
    - /resources/blog/do-you-know-about-the-visual-studio-2010-architecture-guidance
    tags: []
    preview: metro-visual-studio-2010-128-link-4-4.png
    categories:
    - Uncategorized
  BodyContent: |
    [![image](images/Do-you-know-about-the-Visual-Studio-2010_E583-image_thumb-2-2.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-about-the-Visual-Studio-2010_E583-image_2.png)
    { .post-img }

    If you have not seen the Visual Studio 2010 Architectural Guidance from the Visual Studio ALM Rangers then you are missing out.

    ---

    I have been spelunking the TFS Guidance recently and I discovered the Visual Studio 2010 Architectural Guidance. This is not an in-depth look at the capabilities of the architectural tools that shipped with Visual Studio 2010 Ultimate, but is instead a set of samples that lead you by example through real world scenarios. There is practical guidance and checklists to help guide lead developers and architects through the common challenges in understanding both existing and new applications. The content concentrates on practical guidance for Visual Studio 2010 Ultimate and is focused on modelling tools.

    There is integration into Visual Studio so all you need to do to access it is select “**Architecture | Visual Studio ALM Rangers – Architecture Guidance**”.

    [![image](images/Do-you-know-about-the-Visual-Studio-2010_E583-image_thumb_1-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-about-the-Visual-Studio-2010_E583-image_4.png)  
    { .post-img }
    **Figure: Accessing the Architecture guidance is easy**

    This brings up an inline version of the documentation and a kind of Explorer that lets you pick the tasks you want to perform and takes you strait to that part of the Guidance.

    [![SNAGHTML115d5654](images/Do-you-know-about-the-Visual-Studio-2010_E583-SNAGHTML115d5654_thumb-3-3.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-know-about-the-Visual-Studio-2010_E583-SNAGHTML115d5654.png)  
    { .post-img }
    **Figure: Access the Guidance from right within Visual Studio 2010**

    This is a big help when you just want to figure out how to do something and can’t be bothered searching for and through the content in the provided Word documents. The Question and Answer section is full of useful content and there are six Hands-On-Labs to sink your teeth into:

    - Creating extensions with the feature extension
    - Explore an Existing System Scenario
    - Extensibility Layer Diagrams
    - New Solution Scenario
    - Reusable Architecture Scenario
    - Validation an Architecture Scenario

    I’m sold! Where can i get my hands on this fantastic content?

    Download the [Visual Studio 2010 Architecture Tooling Guidance](http://vsarchitectureguide.codeplex.com/) and if you like it don’t forget to [add a review](http://vsarchitectureguide.codeplex.com/releases/view/47828?RateReview=true) to make the team that put it together in their spare time feel all the mere loved.
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-04-do-you-know-about-the-visual-studio-2010-architecture-guidance\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-02-04-do-you-know-about-the-visual-studio-2010-architecture-guidance
- FrontMatter:
    title: Do you want to be an ALM Consultant?
    description: Join Northwest Cadence as an ALM Consultant! Leverage your expertise in software development and help clients build better software efficiently.
    ResourceId: VWFF90m9BYG
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 17
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: GeeksWithBlogs
    date: 2011-01-14
    weight: 355
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: do-you-want-to-be-an-alm-consultant
    aliases:
    - /resources/VWFF90m9BYG
    aliasesArchive:
    - /blog/do-you-want-to-be-an-alm-consultant
    - /do-you-want-to-be-an-alm-consultant
    - /do-you-want-to-be-an-alm-consultant-
    - /blog/do-you-want-to-be-an-alm-consultant-
    - /resources/blog/do-you-want-to-be-an-alm-consultant
    tags:
    - Software Development
    categories:
    - Uncategorized
    preview: metro-visual-studio-2010-128-link-3-3.png
  BodyContent: |
    [![northwestCadenceLogo](images/Do-you-want-to-be-an-ALM-Consultant_A55E-northwestCadenceLogo_thumb-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-want-to-be-an-ALM-Consultant_A55E-northwestCadenceLogo_2.png)
    { .post-img }

    Northwest Cadence is looking for our next great consultant! At Northwest Cadence, we have created a work environment that emphasizes excellence, integrity, and out-of-the-box thinking.  Our customers have high expectations (rightfully so) and we wouldn’t have it any other way!

    ---

    Northwest Cadence has some of the most exciting customers I have ever worked with and even though I have only been here just over a month I have already:

    - Provided training/consulting for 3 government departments
    - Created and taught courseware for delivering Scrum to teams within a high profile multinational company
    - Started presenting [Microsoft's ALM Engagement Program](http://blog.hinshelwood.com/archive/2011/01/04/free-training-at-northwest-cadence.aspx)

    So if you are interested in helping companies build better software more efficiently, then..

    [![We-Need-You1-324x500[1]](images/Do-you-want-to-be-an-ALM-Consultant_A55E-We-Need-You1-324x5001_thumb1-2-2.jpg)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-Do-you-want-to-be-an-ALM-Consultant_A55E-We-Need-You1-324x5001_2.jpg)
    { .post-img }

    Enquire at [careers@nwcadence.com](mailto:careers@nwcadence.com)

    ### **Application Lifecycle Management (ALM) Consultant**

    An ALM Consultant with a minimum of 8 years of relevant experience with Application Lifecycle Management, Visual Studio (including Visual Studio Team System) and software design is needed. Must provide thought leadership on best practices for enterprise architecture, understand the Microsoft technology solution stack, and have a thorough understanding of enterprise application integration. The ALM Practice Lead will play a central role in designing and implementing the overall ALM Practice strategy, including creating, updating, and delivering ALM courseware and consultancy engagements. This person will also provide project support, deliverables, and quality solutions on VSTS that exceed client expectations. Engagements will vary and will involve providing expert training, consulting, mentoring, formulating technical strategies and policies and acting as a “trusted advisor” to customers and internal teams. Sound sense of business and technical strategy required. Strong interpersonal skills as well as solid strategic thinking are key.

    The ideal candidate will be capable of envisioning the solution based on the early client requirements, communicating the vision to both technical and business stakeholders, leading teams through implementation, as well as training, mentoring, and hands-on software development. The ideal candidate will demonstrate successful use of both agile and formal software development methods, enterprise application patterns, and effective leadership on prior projects.

    #### **_Job Requirements_**

    _Minimum Education_: Bachelor’s Degree (computer science, engineering, or math preferred).

    _Locale / Travel:_ The Practice Lead position requires estimated 50% travel, most of which will be in the Continental US (a valid national Passport must be maintained).  This is a full time position and will be based in the Kirkland office.

    _Preferred Education_: Master’s Degree in Information Technology or Software Engineering; Premium Microsoft Certifications on .NET (MCSD) or MCPD or relevant experience; Microsoft Certified Trainer (MCT) or relevant experience.

    _Minimum Experience and Skills_: 7+ years experience with business information systems integration or custom business application design and development in a professional technology consulting, corporate MIS or software development environment.

    _Essential Duties & Responsibilities_: Provide training, consulting, and mentoring to organizations on topics that include Visual Studio Team Foundation Server and ALM. Create content, including labs and demonstrations, to be delivered as training classes by Northwest Cadence employees. Lead development teams through the complete ALM and/or Visual Studio solution. Be able to communicate in detail how a solution will integrate into the larger technical problem space for large, complex enterprises. Define technical solution requirements. Provide guidance to the customer and project team with respect to technical feasibility, complexity, and level of effort required to deliver a custom solution. Ensure that the solution is designed, developed and deployed in accordance with the agreed upon development work plan. Create and deliver weekly status reports of training and/or consulting progress.

    _Engagement Responsibilities:_

    · Provide a strong desire to provide thought leadership related to technology and to help grow the business.

    · Work effectively and professionally with employees at all levels of a customer’s organization.

    · Have strong verbal and written communication skills.

    · Have effective presentation, organizational and planning skills.

    · Have effective interpersonal skills and ability to work in a team environment.

    Enquire at [careers@nwcadence.com](mailto:careers@nwcadence.com)
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-01-14-do-you-want-to-be-an-alm-consultant\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-01-14-do-you-want-to-be-an-alm-consultant
- FrontMatter:
    title: What to do after a servicing fails on TFS 2010
    description: Discover essential steps to take when a servicing fails on TFS 2010. Learn from real-world challenges and expert solutions to ensure a smooth upgrade.
    ResourceId: 3MtCtNaIpU3
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 20
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: GeeksWithBlogs
    date: 2011-01-04
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: what-to-do-after-a-servicing-fails-on-tfs-2010
    aliases:
    - /resources/3MtCtNaIpU3
    aliasesArchive:
    - /blog/what-to-do-after-a-servicing-fails-on-tfs-2010
    - /what-to-do-after-a-servicing-fails-on-tfs-2010
    - /resources/blog/what-to-do-after-a-servicing-fails-on-tfs-2010
    tags:
    - Troubleshooting
    - Software Development
    - System Configuration
    - Windows
    categories:
    - Uncategorized
  BodyContent: |
    [![vs2010alm](images/7e1d3e9df51b_12C53-vs2010alm_thumb-8-8.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-7e1d3e9df51b_12C53-vs2010alm_2.png)What do you do if you run a couple of hotfixes against your [TFS](http://msdn2.microsoft.com/en-us/teamsystem/aa718934.aspx "Team Foundation Server") 2010 server and you start to see seem odd behaviour?
    { .post-img }

    A customer of mine encountered that very problem, but they could not just, or at least not easily, go back a version.

    ---

    You see, around the time of the TFS 2010 launch this company decided to upgrade their entire 250+ development team from TFS 2008 to TFS 2010. They encountered a few problems, owing mainly to the size of their TFS deployment, and the way they were using TFS. They were not doing anything wrong, but when you have the largest deployment of TFS outside of Microsoft you tend to run into problems that most people will never encounter. We are talking half a terabyte of source control in TFS with over 80 proxy servers. Its certainly the largest deployment I have ever heard of.

    When they did their upgrade way back in April, they found two major flaws in the product that meant that they had to back out of the upgrade and wait for a couple of hotfixes.

    - KB983504 – Hotfix
    - KB983578 – Patch
    - KB2401992 -Hotfix

    In the time since they got the hotfixes they have run 6 successful trial migrations, but we are not talking minutes or hours here. When you have 400+ GB of data it takes time to copy it around. It takes time to do the upgrade and it takes time to do a backup.

    Well, last week it was crunch time with their developers off for Christmas they had a window of opportunity to complete the upgrade.

    Now these guys are good, but they wanted Northwest Cadence to be available “just in case”. They did not expect any problems as they already had 6 successful trial upgrades.

    The problems surfaced around 20 hours in after the first set of hotfixes had been applied. The new Team Project Collection, the only thing of importance, had disappeared from the Team Foundation Server Administration console.

    The collection would not reattach either. It would not even list the new collection as attachable!

    [![SNAGHTML26ffe67](images/7e1d3e9df51b_12C53-SNAGHTML26ffe67_thumb-7-7.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-7e1d3e9df51b_12C53-SNAGHTML26ffe67.png)  
    { .post-img }
    **Figure: We know there is a database there, but it does not**

    This was a dire situation as 20+ hours to repeat would leave the customer over time with 250+ developers sitting around doing nothing.

    We tried everything, and then we stumbled upon the command of last resort.

    > _TFSConfig Recover /ConfigurationDB:SQLServerInstanceName;TFS_ConfigurationDBName /CollectionDB:SQLServerinstanceName;"Collection Name"  
    > \-[http://msdn.microsoft.com/en-us/library/ff407077.aspx](http://msdn.microsoft.com/en-us/library/ff407077.aspx)  
    > _

    **WARNING: Never run this command!**

    Now this command does something a little nasty. It assumes that there really should not be anything wrong and sets about fixing it. It ignores any servicing levels in the Team Project Collection database and forcibly applies the latest version of the schema.

    I am sure you can imagine the types of problems this may cause when the schema is updated leaving the data behind.

    That said, as far as we could see this collection looked good, and we were even able to find and attach the team project collection to the Configuration database.

    [![image](images/7e1d3e9df51b_12C53-image_thumb_7-4-4.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-7e1d3e9df51b_12C53-image_16.png)  
    { .post-img }
    **Figure: After attaching the TPC it enters a servicing mode**

    After reattaching the team project collection we found the message “Re-Attaching”. Well, fair enough that sounds like something that may need to happen, and after checking that there was disk IO we left it to it.

    14+ hours later, it was still not done so the customer raised a priority support call with MSFT and an engineer helped them out.

    [![image](images/7e1d3e9df51b_12C53-image_thumb_3-2-2.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-7e1d3e9df51b_12C53-image_8.png)  
    { .post-img }
    **Figure: Everything looks good, it is just offline.**  
    Tip: Did you know that these logs are not represented in the ~/Logs/\* folder until they are opened once?

    The engineer dug around a bit and listened to our situation. He knew that we had run the dreaded “tfsconfig restore”, but was not phased.

    [![image](images/7e1d3e9df51b_12C53-image_thumb_2-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-7e1d3e9df51b_12C53-image_6.png)  
    { .post-img }
    **Figure: This message looks suspiciously like the wrong servicing version**

    As it turns out, the servicing version was slightly out of sync with the schema.

    <table border="0" cellspacing="0" cellpadding="2" width="400"><tbody><tr><td valign="top" width="100"><strong>KB</strong></td><td valign="top" width="100"><strong>Schema</strong></td><td valign="top" width="100"><strong>Successful</strong></td><td valign="top" width="100">&nbsp;</td></tr><tr><td valign="top" width="100">&nbsp;</td><td valign="top" width="100">&nbsp;</td><td valign="top" width="100">&nbsp;</td><td valign="top" width="100">&nbsp;</td></tr><tr><td valign="top" width="100"><p><strong>KB983504</strong></p></td><td valign="top" width="100">341</td><td valign="top" width="100">Yes</td><td valign="top" width="100">&nbsp;</td></tr><tr><td valign="top" width="100"><p><strong>KB983578</strong></p></td><td valign="top" width="100">344</td><td valign="top" width="100">sort of</td><td valign="top" width="100">&nbsp;</td></tr><tr><td valign="top" width="100"><p><strong>KB2401992</strong></p></td><td valign="top" width="100">360</td><td valign="top" width="100">nope</td><td valign="top" width="100">&nbsp;</td></tr></tbody></table>

    **Figure: KB, Schema table with notation to its success**

    The Schema version above represents the final end of run version for that hotfix or patch.

    ## The only way forward

    The problem was that the version was somewhere between 341 and 344. This is not a nice place to be in and the engineer give us the  only way forward as the removal of the servicing number from the database so that the re-attach process would apply the latest schema. if his sounds a little like the “tfsconfig recover” command then you are exactly right.

    [![image](images/7e1d3e9df51b_12C53-image_thumb_5-3-3.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-7e1d3e9df51b_12C53-image_12.png)  
    { .post-img }
    **Figure: Sneakily changing that 3 to a 1 should do the trick**

    [![image](images/7e1d3e9df51b_12C53-image_thumb_9-5-5.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-7e1d3e9df51b_12C53-image_21.png)  
    { .post-img }
    **Figure: Changing the status and dropping the version should do it**

    Now that we have done that we should be able to safely reattach and enable the Team Project Collection.

    [![image](images/7e1d3e9df51b_12C53-image_thumb-6-6.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-7e1d3e9df51b_12C53-image_2.png)  
    { .post-img }
    **Figure: The TPC is now all attached and running**

    You may think that this is the end of the story, but it is not. After a while of mulling and seeking expert advice we came to the opinion that the database was, for want of a better term, “hosed”.

    There could well be orphaned data in there and the likelihood that we would have problems later down the line is pretty high. We contacted the customer back and made them aware that in all likelihood the repaired database was more like a “[cut and shut](<http://en.wikipedia.org/wiki/Lemon_(automobile)>)” than anything else, and at the first sign of trouble later down the line was likely to split in two.

    So with 40+ hours invested in getting this new database ready the customer threw it away and started again.

    - What would you do?
    - Would you take the “cut and shut” to production and hope for the best?
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-01-04-what-to-do-after-a-servicing-fails-on-tfs-2010\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-01-04-what-to-do-after-a-servicing-fails-on-tfs-2010
- FrontMatter:
    title: Project of Projects with team Foundation Server 2010
    description: Discover best practices for using Team Foundation Server 2010 effectively. Learn to structure projects intuitively for enhanced collaboration and efficiency.
    ResourceId: qiY3IH2aMYV
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 18
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: GeeksWithBlogs
    date: 2011-01-04
    weight: 665
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: project-of-projects-with-team-foundation-server-2010
    aliases:
    - /resources/qiY3IH2aMYV
    aliasesArchive:
    - /blog/project-of-projects-with-team-foundation-server-2010
    - /project-of-projects-with-team-foundation-server-2010
    - /resources/blog/project-of-projects-with-team-foundation-server-2010
    tags:
    - Software Development
    - Azure DevOps
    categories:
    - Uncategorized
    preview: metro-visual-studio-2010-128-link-8-8.png
  BodyContent: |
    It is pretty much [accepted that you should use Areas](http://blog.hinshelwood.com/archive/2010/03/09/when-should-i-use-areas-in-tfs-instead-of-team.aspx) instead of having many small Team Projects when you are using Team Foundation Server 2010. I have implemented this scenario many times and this is the current iteration of layout and considerations.

    [Updated 2012-08-06](#collapseOne)

    I have updated this as [One Team Project for Visual Studio 2012](http://blog.hinshelwood.com/one-team-project/ "One Team Project with Visual Studio 2012").

    If like me you work with many customers you will find that you get into a grove for how to set these things up to make them as easily understandable for everyone, while giving the best functionality. The trick is in making it as intuitive as possible for both you and the developers that need to work with it.

    There are five main places where you need to have the Product or Project name in prominence of any other value.

    - Area
    - Iteration
    - Source Code
    - Work Item Queries
    - Build

    Once you decide how you are doing this in each of these places you need to keep to it religiously. Evan if you have one source code file to keep, make sure it is in the right place. This makes your developers and others working with the format familiar with where everything should go, as well as building up mussel memory. This prevents the neat system degenerating into a nasty mess.

    ### Areas

    Areas are traditionally used to separate out parts of your product / project so that you can see how much effort has gone into each.

    [![SNAGHTML1016b83](images/43a228bc7013_C558-SNAGHTML1016b83_thumb-5-5.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-43a228bc7013_C558-SNAGHTML1016b83.png)  
    { .post-img }
    **Figure: The top level areas are for reporting and work item separation**

    There are massive advantages of using this method. You can:

    - move work from one project to another
    - rename a project / product

    It is far more likely that a project or product gets renamed than a department.

    Tip: If you have many projects, over 100, you should consider categorising them here, but make sure that the actual project name always sits at the same level so you know which is which.

    [![SNAGHTML14f8cca](images/43a228bc7013_C558-SNAGHTML14f8cca_thumb-7-7.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-43a228bc7013_C558-SNAGHTML14f8cca.png)  
    { .post-img }
    **Figure: Always keep things that are the same at the same level**

    Note: You may use these categories only at the Area/Iteration level to make it easier to select on drop down lists. You may not want to use them everywhere. On the other hand, for consistency it would be better to.

    ### Iterations

    Iterations are usually used to some sort of time based consideration. Here I am splitting into Iterations with periodic releases.

    [![SNAGHTML102871e](images/43a228bc7013_C558-SNAGHTML102871e_thumb-6-6.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-43a228bc7013_C558-SNAGHTML102871e.png)  
    { .post-img }
    **Figure: Each product needs to be able to have its own cadence**

    The ability to have each project run at its own pace and to enable them to have their own release schedule is often of paramount importance and you don’t want to fix your 100+ projects to all be released on the same date.

    ### Source Code

    Having a good structure for your source even if you are not branching or having multiple products under the same structure is always a good idea.

    [![image](images/43a228bc7013_C558-image_thumb-4-4.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-43a228bc7013_C558-image_2.png)  
    { .post-img }
    **Figure: Separate out your products source**

    You need to think about both your branches as well as the structure of your source. All your code should be under “Source” and everything you need to build your solution including Build Scripts and 3rd party tools should be under your “Main” (branch) folder. This should them be branched by “Quality”, “Release” or both to get the most out of your branching structure.

    The important thing is to make sure you branch (or be able to branch) everything you need to build, test and deploy your application to an environment. That environment may be development, test or even production, but I can’t stress the importance of having everything your need.

    _Note: You usually will not be able to install custom software on your build server. Store any \*.dll’s or \*.exe’s that you need under the “ToolsTool1” folder._

    _Note: Consult the_ [_Branching Guidance for Team Foundation Server 2010_](http://tfsbranchingguideiii.codeplex.com/) _for more on branching_

    [![image](images/43a228bc7013_C558-image_thumb_4-3-3.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-43a228bc7013_C558-image_10.png)  
    { .post-img }
    **Figure: Adding category may be a necessary evil**

    Even if you have to have a couple of categories called “Default”, it is better than not knowing the difference between a folder, Product and Branch.

    ### Work Item Queries

    Queries are used to load lists of Work Items out of TFS so you can see what work you have. This means that you want to also separate queries out by Product / project to make it easier to find the correct data for a particular product.

    [![image](images/43a228bc7013_C558-image_thumb_2-2-2.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-43a228bc7013_C558-image_6.png)  
    { .post-img }
    **Figure: Again you have the same first level structure**

    Having Folders also in Work Item Tracking we do the same thing. We put all the queries under a folder named for the Product / Project and change each query to have “AreaPath=\[TeamProject\]\[ProductX\]” in the query instead of the standard [“Project=@Project](mailto:“Project=@Project)”.

    _Tip: Don’t have a folder with new queries for each iteration. Instead have a single “Current” folder that has queries that point to the current iteration. Just change the queries as you move from one iteration to another._

    _Tip: You can ctrl+drag the “Product1” folder to create your “Product2” folder._

    ### Builds

    You may have many builds both for individual products but also for different quality's. This can be further complicated by having some builds that action “Gated Check-In” and others that are specifically for “Release”, “Test” or another purpose.

    [![image](images/43a228bc7013_C558-image_thumb_1-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-43a228bc7013_C558-image_4.png)  
    { .post-img }
    **Figure: There are no folders, yet, for the builds so you need a good naming convention**

    Its a pity that there are no folders under builds, some way to categorise would be nice. In lue of that at the moment you can use a functional naming convention that at least allows you to find what you want.

    ### Conclusion

    It is really easy to both achieve and to stick to this format if you take the time to do it. Unless you have 1000+ builds or 100+ Products you are unlikely

    run into any issues. Even then there are things you can do to mitigate the issues and I have describes some of them above.

    **Let me know if you can think of any other things to make this easier.**
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-01-04-project-of-projects-with-team-foundation-server-2010\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-01-04-project-of-projects-with-team-foundation-server-2010
- FrontMatter:
    title: Free training at Northwest Cadence
    description: Discover free training sessions at Northwest Cadence! Join engaging Coffee Talks to enhance your skills in ALM and Quality Assurance. Don't miss out!
    ResourceId: uZaKwlACVT_
    ResourceType: blog
    ResourceContentOrigin: Human
    ResourceImport: true
    ResourceImportId: 19
    ResourceImportSource: Wordpress
    ResourceImportOriginalSource: GeeksWithBlogs
    date: 2011-01-04
    weight: 840
    creator: Martin Hinshelwood
    layout: blog
    resourceTypes: blog
    slug: free-training-at-northwest-cadence
    aliases:
    - /resources/uZaKwlACVT_
    aliasesArchive:
    - /blog/free-training-at-northwest-cadence
    - /free-training-at-northwest-cadence
    - /resources/blog/free-training-at-northwest-cadence
    tags: []
    categories:
    - Uncategorized
    preview: metro-event-128-link-3-3.png
  BodyContent: |
    **[![NWCadence-Logo](images/d8a99e5b9476_9304-NWCadence-Logo_thumb-1-1.png)](http://blog.hinshelwood.com/files/2011/05/GWB-Windows-Live-Writer-d8a99e5b9476_9304-NWCadence-Logo_2.png)**
    { .post-img }

    Even though I have only been at Northwest Cadence for a short time I have already done so much. What I really wanted to do was let you guys know about a bunch of FREE training that NWC offers.

    These sessions are at a fantastic time for the UK as 9am PST (Seattle time) is around 5pm GMT. Its a fantastic way to finish off your Fridays ![Smile](images/d8a99e5b9476_9304-wlEmoticon-smile_2-2-2.png) and with the lack of love for developers in the UK set to continue I would love some of you guys to get some from the US instead.
    { .post-img }

    ---

    There are really two offerings. The first is something called Coffee talks that take you through an hours worth of detail in a specific category.

    ## Coffee Talks

    These coffee talks have some superb topics and you can get excellent interaction with the presenter as they are kind of informal.

    <table border="0" cellspacing="0" cellpadding="0"><tbody><tr><td valign="top"><p><b>Date</b></p></td><td valign="top"><p><b>Day</b></p></td><td valign="top"><p><b>Time</b></p></td><td valign="top"><p><b>Topic</b></p></td><td valign="top"><p><b>Register Here</b></p></td></tr><tr><td valign="top"><p>01/04/11</p></td><td valign="top"><p>Tuesday</p></td><td valign="top"><p>8:30AM – 9:30AM PST</p></td><td valign="top"><p><b>Real World Business and Technical Benefits of ALM with TFS 2010</b></p></td><td valign="top"><p><a href="http://www.clicktoattend.com/invitation.aspx?code=150656">150656</a></p></td></tr><tr><td valign="top"><p>01/28/11</p></td><td valign="top" width="101"><p>Friday</p></td><td valign="top" width="223"><p>9:00AM - 10:00AM PST</p></td><td valign="top" width="305"><p><b>The Full Testing Experience</b></p><p>Professional Quality Assurance with Visual Studio 2010</p></td><td valign="top" width="77"><p><a href="http://coffeetalktest.eventbrite.com?ref=ebtn" target="_blank"><img border="0" alt="Register for Coffee Talk: The Full Testing Experience- Professional Quality Assurance with Visual Studio2010 on Eventbrite" src="images/GWB-Windows-Live-Writer-d8a99e5b9476_9304-clip_image001_3.jpg" width="800" height="406"></a></p></td></tr></tbody></table>
  FilePath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-01-04-free-training-at-northwest-cadence\index.md
  FolderPath: C:\Users\MartinHinshelwoodNKD\source\repos\NKDAgility.com\site\content\resources\blog\2011\2011-01-04-free-training-at-northwest-cadence

